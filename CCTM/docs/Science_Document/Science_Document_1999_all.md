&EPA 

""'"""" ... ,.cm:::<> 
Environmental Protection 
Agency 

umce ot Hesearch and 
Development 
Washington DC 20460 

EPA/600/R-99/030 
March 1999 

Science Alg<>rithms of the 
EPA Models-3 Community 
Multiscale Aiir Quality 
(CMAQ) Modeling System 

United States 
Environmental Protection 
Agency 

Office of Research and Development 

Washington, DC 20460 

EP N600/R .. 99/030 
March 1999 

SCIENCE ALGORITHMS OF THE EPA MODELS-3 

COMMUNITY MULTISCALE AIR QUALITY (CMAQ) 

MODELING SYSTEM 

Edited by: 

D. W. BYUN• and J. K. S. CHING• 

Atmospheric Modeling Division 

National Exposure Research Laboratory 
U.S. Environmental Protection Agency 

Research Triangle Park, NC 27711 

*On assignment from the National Oceanic and Atmospheric Administration, U.S. Department of 
Commerce 

@  Printed on Recycled Paper 

DISCLAIMER 

BP A/600/R-99/030 

The information in this document has been funded wholly. or in part by the United States 
Environmental Protection Agency.  It has been subjected to the Agency's peer and administrative 
review, and has been approved for publication as an EPA document.  Mention of trade names or 
commercial products does not constitute endorsement nor recommendation for use. 

FOREWORD 

The Models-3 Community Multiscale Air Quality (CMAQ) modeling system has been developed 
under the leadership of the Atmospheric Modeling Division of the EPA National Exposure 
Research Laboratory in Research Triangle Park, NC.  This new generation of modeling software 
was under development for seven years and was made available in June 1998 without charge for 
use by air quality regulators, policy makers, industry, and scientists to address multiscale, 
multi-pollutant air quality concerns. 

Models-3/CMAQ has a unique framework and science design that enables scientists and 
regulators to build their own modeling system to suit their needs.  Users can access pre-installed 
modeling systems provided by the EPA or can incorporate their own modeling systems to work 
within the existing framework software. 

This direct user involvement is key to the concept of a community modeling and analysis 
system.  This approach to model development, application, and analysis leverages the 
community's complementary talents and resources to set new standards for rapid incorporation of 
better science into air quality model applications.  The resulting comprehensive system forms the 
foundation upon which the community, including governments, industry, academia, and other 
stakeholders, can collaborate in the examination of issues and the subsequent development of 
strategies that meet society challenges of environmental protection. 

The release of Models-3/CMAQ is one of the many steps which we hope will unite the 
community under the common goal of advancing our knowledge and abilities to tackle critical 
problems of the future in far more effective ways than have been attempted in the past. 
Scientifically sound modeling systems, developed and supported by the community, are one 
method of achieving this goal. 

The June 1998 release of the Models-3/CMAQ computer code was accompanied by a User 
Manual [EP A-600/R-98/069(b)] to serve as a reference on how to use the software system.  This 
Science Document is the counterpart to the User Manual in that it presents the peer reviewed 
scientific bases for the Models-3/CMAQ modeling systems.  This document also includes 
components such as interface processors, process analysis routines, and the present and planned 
evaluation program. 

F. A.  Schiermeier 
March 1999 

v 

CONTENTS 

FOREWORD  ................................. · ............................... v 

ACRONYMS  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .  xvn 

ACKNOWLEDGMENTS  .................................................... xxi 

EXECUTIVE SUMMARY  .................................................. ES-1 

1. 

2. 

1.1 
1.2 
1.3 
1.4 

INTRODUCTION TO THE MODELS-3 FRAMEWORK AND THE 
COMMUNITY MULTISCALE AIR QUALITY MODEL (CMAQ) 
(J.  Ching and D.  Byun) 
Abstract  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .  1-1 
1.0 

Introduction to the Models-3 Framework and the Community Multiscale Air 
Quality Model (CMAQ)  .......................................... 1-2 
The Models-3 Emissions, Meteorology, and the CMAQ Modeling Systems  . .  1-4 
CMAQ.Interface Processors  ....................................... 1-6 
The CMAQ Chemical Transport Model (CCTM)  . . . . . . . . . . . . . . . . . . . . . . .  1-8 
Analysis of CMAQ Output  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .  1-10 
1.4.1  Process Analysis (Chapter 16)  ... : . . . . . . . . . . . . . . . . . . . . . . . . . . .  1-10 
1.4.2  Aggregation (Chapter 17)  .................................. 1-11 
1.5  Management of CMAQ Science Information Objects and Codes in Models-3  1-11 
1.5.1  Program Control Processors (Chapter 15)  ...................... 1-11 
1.5.2  CMAQ Code Integration (Chapter 18)  ........................ 1-12 
Post Release Studies and Near-Future Plans  .... · ...................... 1-12 
1.6.1  CMAQ Evaluation Study ................................... 1-12 
1.6.2  Testing Operational Configurations . . . . . . . . . . . . . . . . . . . . . . . . . . .  1-12 
1.6.3  Extensions and Science Additions  . . . . . . . . . . . . . . . . . . . . . . . . . . . .  1-13 
Opportunities and Encouragement for Long Term Extensions and Science 
Community Involvement  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .  1-13 
References  .................................................... 1-15 

1.6 

1. 7 

1.8 

MODELS-3 ARCHITECTURE: A UNIFYING FRAMEWORK FOR 
ENVIRONMENTAL MODELING AND ASSESSMENT 
(J.  Novak and S.  Leduc) 
Abstract  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .  2-1 
2.0  Models-3 Architecture: A Unifying Framework for Environmental Modeling and 

Assessment ..................................................... 2-2 
Introduction  .................................................... 2-2 
Overview of the Models-3 Frame~ork  ..................... ."  ......... 2-2 

2.1 
2.2 
2.2.1  Dataset  Manager  : . · ................... : ........ , ........... 2-2 
2.2.2  Program Manager ................ , ......................... 2-3 
2.2.3  Study Planner ...................... , · ................ , ...... 2-3 
2.2.4  Strategy Manager  ................... : ............... , ...... ,  2-4 
2.2.5  Tool Manager ............... · •.... · ....... · .......... , , ......... 2-4 
2.2.6  Science Manager  . . . . .. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .  2-6 
2.2. 7  Model Builder  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .  2-6 
2.2.8  Source Code Manager  .......................... , ........... 2-7 
2.2.9  Framework Administrator  ................................... 2-7 
2.3  Models-3  System Architecture  ......... , .... , . ·,  , . · .................. 2-7 
Schedule and Future Plans  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .  2-10 
2.4. 
References  ..................................... · . , . . . . . . . . . . . . . .  2-10 
2.5 

DEVELOPING METEOROLOGICAL FIELDS 
(I'.  Otte) 
Abstract  ....................................... , , . . . . . . . . . . . . . . . . . . . .  3-1 
3.0 
Developing Meteorological Fields ... , .................... ; .......... 3-2 
3.1 
Credits and Disclaimers for Use ofMM5  ..... ; ........... , ........... 3-2 
3.2  Meteorology Model Pre-Processing  ....................... , ......... 3-2 
3.2.1  Defining the Simulation Domain (TERRAIN)  .................... 3-2 
3.2.2  Processing the Meteorological Background Fields (DATAGRID)  .... 3-3 
3.2.3  Objective Analysis (RAW/NS)  ................ , ............... 3-3 
3.2.4  Setting the Initial and Boundary Conditions (INTERP)  ............ 3-4 
The Meteorology Model (MM5)  ........... , ......................... 3-4 
3.3.1  Brief History  .............................................. 3-4 
3.3.2  Horizontal and Vertical Grid  .................................. 3-5 
3.3.3  Prognostic Equations  .................. · ..... _ ................ 3-5 
3.3.4  Model Physics  ....................... ; .... ~  ............... 3-6 
3.3.5  Nesting  ........... ; .................. : .•................ 3-10 
3.3.6  Four-Dimensional Data Assimilation  .... ~  .... , ............ ; ..  3-10 
3.4  Meteorology Model Post-Processing ................................ 3-11 
3.5 
Changes to the MM5  System's Software for Models-3  .................. 3-11 
References  ............. ; .... · ................. , ................. 3-12 
3.6 

3.3 

EMISSION SUBSYSTEM 
(B.  Benjey, J.  Godowitch,  and G.  Gipson) 
Abstract  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . ...  . . . . . . . . . . . . . . . . . .  4-1 
Emission Subsystem  ............................................. 4-2 
4.0 
4.1 
Emission Inventory Processors  ......................... , ........... 4-2 
4.1.1  Discussion  ............................................... 4-2 
4.1.2  General MEPPS Structure  .................................. 4-11 
The MEPPS Emission Processing System ............................ 4-12 
4.2.1  The Inventory Data Analyzer (IDA)  .......................... 4-14 

4.2 

4.2.2 
the MEPPS Input Processor (INPRO)  ........................ 4-16 
4.2.3  Processing Procedure  .......................... : . . . . . . . . . . .  4-17 
4.2.4  Modeled Emission Data ..................................... 4-33 
4.2.5  Chemical Speciation of Emission Data  .............. ·.  . . . . . . . . .  4-78 
4.2.6  Output Processor (OUTPRO)  ... · .... ; ....... · ...... · ........... 4-90 
4.3  Models-3 Emission Projection Processor (MEPRO)  .................... 4-91 
4.4 
Emission Processing Interface  ................... : .. : . . . . . . . . . . . . . .  4-94 
4.4.1  Overview of Key Features ofECIP  .· ..... : ........ :·.--.  ......... 4-94 
4.4.2  Plume Rise of Point Source Emissions  .... : ~·  ... · . . . . . . . . . . . . . . .  4-96 
4.4.3  Method for the Treatment of Initial Vertical Plunie Spread  . . . . . . . .  4-99 
4.4.4  Vertical Allocation of Plume Emissions  .. ; ......... -....... ~.  .. .  4-100 
4.4.5  Generation of 3-D Emissions .................. · .......... · ... 4-100 
Data Requirements  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .  4-100 
Plans forlmprovement  ....... .' .......... : ...... ; ... .'. · .... ·.: .. ·.: .. 4-102 
References  ............. ~  ................................. · .... 4-103 

4.5 
4.6 
4. 7 

5 .1 

5.2 
5.3 

FUNDAMENTALS OF ONE-ATMOSPHERE DYNAMICS FOR MULTISCALE 
AlR QUALITY MODELING 
(D.  Byun) 
Abstract  ........................................................ · ......................................... : ........................  5-1 
5.0 

Fundamentals of One-Atmosphere Dynamics for Multiscale Air Quality 
Modeling  ............................... : ....... : ........................................... : ........................  5-2 
· Governillg Equations and Approximations for the Atmosphere .. .. .. .. .. .. .... .. .. . . . .  5-2 
5.1.1 ·  Governing Equations in a Generalized Curvilinear Coordinate System  5-3 
5.1.2  Assumptions of Atmospheric Dynrunics  ................ : ..............................  5-6 
Choice of Vertical Coordinate System for Air. Quality Modeling  ...................  5-11 
Coupling of Meteorology and Air Quality ..................................... ." .................  5-18 
5.3.1  Meteorological Data for Air Quality Modeling  .. ~ ................................  5-18 
5.3.2  Off-line and On·line Modeling Paradigms  ............. · .............................  5-18 
5.4  Mass Conservation ............................................................................................  5-22 
5.4.1  Mass Consistency in Meteorological Data ........................ : ..................  5-22 
5.4.2  Techniques for Mass Conservation in Air Quality Models  .................  5-2'.3 
5.4.3  Temporal Interpolation of Meteorological Data  ..................................  5-25 
5.5  ·  Conclusion  .......................................................................................................  5-26 
5.6 
References  .............................................................. , ..... : ............. ~ .. : ... ;; .. : .. : .......  5-27 
Appendix SA.  Tensor Primer and Derivation of the Continuity Equation in a 

Generalized Curvilinear Coordinate System .................................. ; .....  5-30 

Governing Equations And Computational Structure of The  Community 

GOVERNING EQUATIONS AND COMPUTATIONAL STRUCTURE OF THE 
COMMUNITY MULTISCALE AIR QUALITY (CMAQ) CHEMICAL 
TRANSPORT MODEL 
(D.  Byun, J.  Young,  and MT.  Odman) 
Abstract . .. .. . .. .. .. . .. .. .. . . . . .. .. .. . . .. .. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. .  6-1 
6.0 
Multiscale Air Quality (CMAQ) Chemical Transport Model  .......................................  6-2 
Derivation of the Atmospheric Diffusion Equation  ...........................................  6-3 
6.1 
Representation of Science Processes in CMAQ Modeling System .. ..... ..... .......  6-9 
6.2 
6.2.1  Supporting Models and Interface Processors  ...................... ...................  6-9 
6.2.2  Modularity Concept of CMAQ  ... .. ........... .. .. .. .. ....... ..... .................. .... ..  6-10  . 
6.2.3  Description of Science Processes ...... .. . .. .. ............ .. .. .. ....... ... ........ .. ......  6-15 
Equivalent Model Formulations for Different Vertical Coordinates  ...............  6-26 
6.3 
Nesting Techniques ...................................................................................... : ...  6-28 
6.4 
Summary  ..........................................................................................................  6-31 
6.5 
6.6 
References  .........................................................................................................  6-31 
Appendix 6A.  Concentration Units Used for Air Quality Studies  ..............................  6-34 

NUMERICAL TRANSPORT ALGORITHMS FOR THE COMMUNITY 
MUL TISCALE AIR QUALITY (CMAQ) CHEMICAL TRANSPORT MODEL 
IN GENERALIZED COORDINATES 
(D.  Byun, J.  Young,  J.  Pleim,  MT.  Odman,  and K  Alapaty) 
Abstract  . . .. . .. .. . . . .. . . . .. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .  7-1 
7 .0 

Numerical Transport Algorithms for the Community Multiscale Air Quality 
(CMAQ) Chemical Transport Model in Generalized Coordinates  ....................  7-2 
Numerical Advection Algorithms  ....................................... , ..............................  7-3 
7 .1.1  Conservation Form Equation for Advection .. .. .. .. . . .. . . . . .. .. . .. . . . . . .. . . . .. . . . . . . .  7-4 
7 .1.2  Classification of Advection Schemes  . ........ ............ .. .............. ... ............  7-6 
7.1.3  Description of Advection Schemes in CCTM  .......................................  7-6 
7 .1.4  Treatment of Boundary Conditions  .. .... ................ .. .. ............... ..... ... ....  7-11 
7.1.5  Test of Algorithms with Idealized Linear Horizontal Flow Fields  ......  7-12 
7.1.6  Vertical Advection  ...............................................................................  7-15 
7 .1. 7  Adjustment of Mass Conservation Error  . ..... ............. ........ .. .............. ..  7-16 
Vertical Mixing Algorithms . . . . .. . . .. . .. . . . . . . . . . . . .. . . . . .. . .. . . . . . . . . . . . . . .. .. .. . . .. . . . . . . . . .. . . . . . . . ..  7-18 
7.2.1  Closure Problem ................................................... ." ...............................  7-19 
7.2.2  Computing Vertical Mixing with the Eddy Diffusion Formulation: 

7.1 

7 .2 

K-Theory  ............................................................................. · .................  7-21 
7.2.3  Flux Form Representation of Vertical Mixing .....................................  7-31 
7 .3 
Horizontal Mixing Algorithms  . . . . . . .. . .. .. .. .. .. . . . . . .. .. .. . . .. . . . . . . . . . . . . . .. . . .. .. . .. . . . . . . . . . . . . . .  7-4 3 
Conclusions ...................... .... .. .. .... .............. .... .. .. .... .. ...... ...... .... ..... .. ... . .... ... ..... .  7-45 
7 .4 
7 .5 
References  . . . . .. ... . ... .. . . . .. . . . . .. . .. .. . . .. . . . . . . . . . . . .. .. .. .. . . . . . . . . . . . . . . . . .. .. .. . . . . . . . . . . . . . . . . . .. . . . . . . . . .  7-46 
Appendix 7A  Numerical Solvers for Diffusion Equations .........................................  7-51 

GAS-PHASE CHEMISTRY 
(G.  Gipson and J.  Young) 
Abstract  ........... .............. ........................ ..................... ....... ... ..... ........ .... ... ...... ... ... . .. . ... ...  8-1 
Gas-Phase Chemistry  ....................... : .................................................................  8-2 
8.0 
Background  ........................................................................................................  8-3 
8.1 
Chemical Mechanisms in the CMAQ System  ...................................................  8-4 
8.2 
8.2.1  CB4 Mechanism .....................................................................................  8-5 
8.2.2 .  RADM2 Mechanism .......................................... ~ ...................................  8-6 
8.2.3  SAPRC-97 Mechanism  ..........................................................................  8-7 
8.2.4  Extended Mechanisms  ...........................................................................  8-8 
8.2.5  Changing or Adding Mechanisms in CMAQ  .. ........................ ... . .. . .....  8-11 
Reaction Kinetics  ................. · .............................................................................  8-12 
8.3.1  Reaction Rates  .....................................................................................  8-12 
8.3.2  Rate Constant Expressions ...................................................................  8-13 
8.4  Mathematical Modeling  ............... ~ ...................................................................  8-15 
8.4.1  Governing Equations  ...........................................................................  8-16 
8.4.2  SMVGEAR ..........................................................................................  8-18 
8.4.3  QSSA Solver ........................................................................................  8-22 
8.4.4  Summary  ............................................................. , ................................  8-25 
References  .............................................................................. ; .........................  8-25 
8.5 
Appendix 8A  Chemical Mechanisms Included in the CMAQ System  ; .....................  8-29 

8.3 

PLUME-IN-GRID TREATMENT OF MAJOR POINT SOURCE 
EMISSIONS 
(N.  Gillani and J.  Godowitch) 
Abstract  . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . .. . . . . . .. .. . . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .  9-1 
9.0 
Plume-in-Grid Treatment of Major Point Source Emi~sions ..... : .......................  9-2 
Introduction ........................................................................................................  9-2 
9.1 
Overview of the Conceptual  Framework  of the  Plume-in-Grid  Treatment  ..  9-4 
9.2 
Formulation of the Plume-in-Grid Modeling Components  ...............................  9-5 
9.3 
9.3.1  Description of the Plume Dynamics Model  ...........................................  9-5 
9.3.2  Formulation of the Plume-in-Grid Module ............. ~ ............................  9-12 
Summary  ........ ................ .................. ........ ........ .. . ....... ...... .. ... ... ... ... ... ... ....... ... ..  9-28 
References  ........................................................................................................  9-28 

9 .4 
9.5 

10.  AEROSOLS IN MODELS-3  CMAQ 

11. 

12. 

(F.  Binkowski) 
Abstract  . . . . .. .. . . . .. .. . . . . . . . . . . . .. . . .. . .. .. . .. .. .... .. .. .. .. .. .. .. .. .. . . . .. .. . . .. .. . .. .. ..... . .. .. .. . .. .. .. . .. . .. . . . . . . .. .. .. ..  10-1 
10.0  Aerosols in Models-3  CMAQ 
....................................................  10-2 
10.1  Aerosol Dynamics .............. ........................ .... ............................. ...... .. .... .... .. .. ..  10-4 
10.1.1  Modal Definitions  ........................... ........... .................. ............. ...... .. .. .  10-4 
10.1.2  New Particle Production by Nucleation ...............................................  10-5 
10.1.3  Primary Emissions  ........ · .................................. : ....................................  10-6 
10.1.4  Numerical Solvers ..... · ...........................................................................  10-7 
10.1.5  Mode Merging by Renaming  .............................................................  10-10 
10.2  Aerosol Dry Deposition  ........................................................ ......... ..... ...........  10-11 
10.3  Cloud Processing of Aerosols  .. .. .......................... ............ ...... ............ ............  10-11 
10.4  Aerosol Chemistry  ............................................ ...... .............. ... .. .. ..... ...... .... .. .  10-14 
10.5  Visibility  ........................................................................................................  10-15 
10.6  Summary  ........................................................................................................  10-17 
I 0. 7  References  ................................................... : ......... ;.. .. .. .. .. .. .. .. .. .. .... . .. .. .. .. .. .. .. .  1 0-17 

CLOUD DYNAMICS AND CHEMISTRY 
(S.  Roselle and F.  Binkowski) 
Abstract  .................................................... :...................................................................  11-1. 
11.0  Cloud Dynamics and Chemistry  ......................................................................  11-2 
11.1  Background  ......................... ~ ............................................................................  11-2 
11.2  Model Description  ...........................................................................................  11-2 
11.2.1  Subgrid Convective Cloud Scheme  ...................... ; ..............................  11-3 
11.2.2  Resolved Cloud Scheme  . .. .. . .. .. .. .. .. . .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. . ..  11-7 
11.3  Conclusions ......................................... ~ ............................................................  11-8 
11.4  References  ................ .... .. .. .......... ...... .. .. .... .. .. .. .... .. . . .. . .. .. .. .. .. .. . . .. . .. .. .. ... .. . . . . . . .. . . .  11-9 

METEOROLOGY~CHEMISTRY INTERFACE PROCESSOR (MCIP) FOR 
MODELS-3 COMMUNITY MULTISCALE AIR QUALITY (CMAQ) 
MODELING SYSTEM 
(D.  Byun, J.  Pleim,  R.  Tang,  and A.  Bourgeois) 
Abstract  ........................................................................................................................  12-1 
12.0  Meteorology-Chemistry Interface Processor (MCIP) For Models-3  Community 

12.1 

Multiscale Air Quality (CMAQ) Modeling System  ........................................  12-2 
Introduction ......................................................................................................  12-2 
12.1.l  MCIP Functions  ...................................................................................  12-4 
12.1.2  MCIP's Data Dependency  ...................................................................  12-6 
12.1.3  Computational Structure  .. .. .. .. .. . ... .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. ..  12-8 
12.2  Data Types, Coordinates, and Grids  .. .. .. . .. .. .. .. . .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. ..  12-10 
12.2.1  Meteorological Data Types  . .. .. ... . . . .. .. .. .. .. . .. .. .. .. .. .. . .. .. .. .. .. .. .. .. .. .. .. .. .. .. .  12-10 
12.2.2  Coordinates  ........................................................................................  12-14 
12.2.3  Modification of Grid Structure  ..........................................................  12-18 

xii 

12.3  Estimation of Physical Parameters ....... , .........................................................  12-23 
12.3.1  PBL Parameters  .................................................................................  12-23 
12.3.2  Dry Deposition Velocities ..................................................................  12-37 
12.3.3  Cloud Parameters and Solar Radiation  ..............................................  12-49 
12.4  Meteorological Data for CCTM with Generalized Coordinate System .........  12-52 
12.4.1  Thermodynamic Variables: Pressure, Density and Entropy  ..............  12-52 
12.4.2  Vertical Jacobian and Layer Height ...................................................  12-54 
12.4.3  Contravariant Velocity Components ..................................................  12-57 
12.4.4  Mass Consistent Temporal Interpolation of Meteorological 

Parameters ..........................................................................................  12-60 

12.4.5  Optional Conversion ofNonhydrostatic Data to Hydrostatic 

Meteorological Data for MM5  ...........................................................  12-61 
12.5  Operation ofMCIP  ............................................... ; ..............•.........................  12-63 
12.5.1  MCIP Modules  .......................................................... ; ........................  12-63 
12.5.2  Building MCIP ...................................................................................  12-63 
12.5.3  Executing MCIP ................................................................. ; ...............  12-65 
12.5.4  Defining Grid and Domain for MCIP  ................................................  12-68 
12.5.5  Extension ofMCIP for Other Meteorological Models  ................ : .....  12-72 
12.6  Concluding Remarks ......................................................................................  12-73 
12.7  References  ......................................................................................................  12-74 
Appendix 12A MCIP Output Data  ............................................................................  12-80 
Appendix 12B  Examples of Nest Domain Definitions for CMAQ system  ..............  12-83 
Appendix 12C  Sample MCIP Configuration File  .....................................................  12-85 
Appendix 12D  Sample MCIP Run Script  .................................................................  12-87 

THE INITIAL CONCENTRATION AND BOUNDARY CONDITION 
PROCESSORS 
(G.  Gipson) 
Abstract  ........ ; ..................................................................................... .-.: .......................  13-1 
13.0  The Initial Concentration and Boundary Condition Processors  ......................  13-2 
13.1 
Introduction .. ; ...................................................................................................  13-2 
13.2  Overview of the ICON and BCON Processors  ................................................  13-2 
Input Sources  ····································································································' 13-3 
13.3 
13.3.1  Time Invariant Concentration Profiles .................................................  13-3 
13.3.2  CCTM Concentration files  ....................................................................  13-5 
13.3.3  Tracer Species  ........................................................... ~ ...... ~ ...................  13-5 
13.4  Spatial Interpolation ..................................................... ; ...................................  13-7 
13.4.1  Horizontal Interpolation .......................................................................  13-7 
13.4.2  Vertical Interpolation  ...........................................................................  13-8 
13.5 
ICON/BCON Species Processing  ...................................................................  13-9 
13.6  Mechanism Conversions  ................................................................................  13-11 
13.7  .  ICON/BCON Applications  ...................................................................... ~: ....  13-12 
13.8  References  ......................................................................................................  13-13 

PHOTOLYSIS RATES FOR CMAQ 
(S.  Roselle,  K  Schere,  J.  Pleim, A.  Hanna) 
Abstract  . .. .. .. . . . .. . . . .. . . .. .. .. . . . . .. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .  14-1 
14.0  Photolysis Rates for CMAQ  ............................................................................  14-2 
14.1  Background  ......................................................................................................  14-2 
14.2  Preprocessor JPROC: Calculate Clear-sky Photolysis Rate Table  ..................  14-3 
14.3 
Subroutine PHOT: Table Interpolation and Cloud Attenuation  . .. . .. . . . . .. .. . .. . . . . .  14-4 
14.4  Conclusions .................... .. .......... .. .. .. .. .. .. .. .. .. .. .. .. . .. . . .. .. .. .. .. . . .. ... .. ... .. ... .. . . . . .. ... .. .  14-5 
14.5  References  ........................................................................................................  14-6 

PROGRAM CONTROL PROCESSING IN MODELS-3 
(J.  Young) 
Abstract  ........................................................................................................................  15-1 
15.0  Program Control Processing in Models-3  ........................................................  15-2 
15.1  Domain Configuration  .....................................................................................  15-3 
15.2 
Input/Output Applications Programming Interface  .........................................  15-4 
15.3  Other CCTM Configuration Control  ...............................................................  15-4 
15.3.l  CCTM Process Analysis  ......................................................................  15-4 
15.3.2  CCTM Fixed Data ................................................................................  15-5 
15.4  Generalized Chemistry .....................................................................................  15-6 
15.4.1  Design  ..................................................................................................  15-6 
15.4.2  Operation ..............................................................................................  15-7 
15.4.3  Supported Reaction Types  ...................................................................  15-9 
15.4.4  Mechanism Parsing Rules  ..................................................................  15-10 
15.4.5  Chemical Species Include Files  .........................................................  15-10 
15.6  Conclusion  .....................................................................................................  15-16 
15.7  References  ......................................................................................................  15-16 

PROCESSANALYSIS 
(G.  Gipson) 
Abstract  . . .. . . .. . .. . .. .. .. .. . . . .. .. .. . . .. .. .. .. . . . . . . .. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .  16-1 
16.0  Process Analysis  ..............................................................................................  16-2 
Integrated Process Rate Analysis 
..................................................................  16-3 
16.1 
16.1.1  Computation oflntegrated Process Rates  ............................................  16-3 
16.1.2  Example IPR Analyses  ........................................................................  16-5 
16.1.3  Implementation ofIPR Analysis in the CMAQ System ... .. .. . . . ... ... .. .. . .  16-6 
16.1.4  Use of the PACP to set up an IPR Analysis .........................................  16-7 
Integrated Reaction Rate Analysis  .. ... .... ..... .. .... .. .. .. .. .. .. .. ...... .. .. . .. . . .. . .. .. . .. . .. . .. ..  16-9 
16.2.1  Computation oflntegrated Reaction Rates  . .. .. . .. . . .. .. ... .. .. ... .... ... . .. . .. . . .  16-10 
16.2.2  Example IRR Analyses  .... .. .. .... ........ .. .. .. .. .. .. .. .. .. .. .. .... .. . .. .. .. . .. . . . ..... ... .  16-11 
16.2.3  Implementation ofIRR Analysis the CMAQ system  . .. ... .. .. .. . . . . .. . .. ..  16-13 
16.2.4  Use of the PACP to set up an IRR Analysis  ......................................  16-14 
16.3  Conclusion  ..................................................................... ; ..... ~ .........................  16-19 
16.4  References  .....................................................................................................  16-20 

AN AGGREGATION AND EPISODE SELECTION SCHEME DESIGNED TO 
SUPPORT MODELS-3 CMAQ 
(R.  Cohn,  B.  Eder,  and S.  Leduc) 
Abstract  . .. . . . .. . .. . . . . . .. .. .. . .. . . . .. .. . .. . . .. .. . .. . . . .. . . .. . . . . . . . .. . . . .. . . .. . .. . . . . . . . . . . . .. .. . .. . . . . . . . . . . . . . . . . . .. .. . . . . . . .  17-1 
17.0  An Aggregation and Episode Selection Scheme Designed to Support Models-3 

1 7 .1 

CMAQ .................................................................................... : .........................  17-2 
Introduction . . . .. . . . . . . . .. .. . .. . . . . . . . . . . . . . . . . . . .. . . .. . . . .. . . . . . .. .. . . . . . .. . . . . . . . . . . . . .. . .. .. . . . . . . . . . . . . .. . . . . .  17-2 
17.1.l  Background  .................... , .....................................................................  17-2 
17.1.2  Objectives  ........................................................................... ~ ................  17-3 
17.2  Summary of the Approach  ...............................................................................  17-4 
17.2.1  Basic Elements of the Methodology  ....................................................  17-4 
17.2.2  Rationale, Scope, and Limitations  .......................................................  17-5 
17.2.3  Strategy  ...................................................................................... ~ .........  17-6 
17.3  Cluster Analysis of Wind Fields  ......................................................................  17-8 
17.3.1  Description of Wind Data  ....................................................................  17-8 
17.3.2  Basic Cluster Analysis Technique  ........................................................  17-8 
17.3.3  Illustration of Cluster Analysis Results  ...............................................  17-9 
17.4  Evaluation of Alternative Aggregation Approaches  ......................................  17-11 
17.4.1  Description of Alternative Approaches ..............................................  17-11 
17.4.2  Description of Meteorological Data ...................................................  17-12 
17.4.3  Analysis Methods .................. : .......................................... : .................  17-12 
17.4.4  Results  ....................... : ........................................................................  17-13 
17.5  Refinement of the Sampling Approach ..........................................................  17-21 
17.5.1  Determination of Appropriate Numbers of Strata and Events  ...........  17-22 
17.5.2  Selection of Stratified Sample of Events  .......................................... ;  17-27 
17.6  Application and Evaluation ............................................. : .. ···"····~~·····'.··· ........  17-29 
17 .6.1  Application of the Aggregation Procedure  ... ............. ... ............... ... ...  17-29 
17.6.2  Evaluation  ..........................................................................................  17-31 
17.7  Summary and Discussion ............................................................. ; .................  17-32 
17.8  References  ......................................................................................................  17-33 

18. 

INTEGRATION OF SCIENCE CODES INTO MODELS-3 
(J.  Young) 
Abstract  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . ... . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .  18-1 
Integration of Science Codes into Models-3  ............ ~ ........................................  18-2 
18.0 
18.l 
Introduction ......................................................................................................  18-2 
18.2  Classes and Modules  .................... ; ...................................................................  18-4 
18.2.1  Operational Design  ..............................................................................  18-4 
18.2.2  CGRID  .................................................................................................  18-5 
18.2.3  Class Driver  .........................................................................................  18-6 
18.2.4  Synchronization Time Step  ............................................... , ..................  18-7 
Input/Output Applications Programming Interface  .. .. .. .............. ....... ...... .. .. ....  18-8 
18.3 
18.4  Code Configuration Management .................. .... .... .. .... .. ............ ............ ........  18-10 
18.4.1  The Need  ............................................................................................  18-10 
18.4.2  The Tool .............. ....................... ........... .... .. .. .. .. .. . .. .. .. . .............. .........  18-11 
18.4.3  The Repository ...................................................................................  18~12 
18.5  How a Model is Constructed ..........................................................................  18-14 
18.5.1  Object Oriented Concepts  ...................................... : ...........................  18-14 
18.5.2  Global Name Table Data ....................................................................  18-14 
18.5.3  Build Template ..................................................... · ..............................  18-15 
18.6  How a Model is Executed  ................................................ ........ ............ .... .. ....  18-18 
18.7  Using the Models-3 Framework  ....................................................................  18-18 
18.8  Conformant Code .............. ....................................... ............ ... .. ..... .. . .. .. . ... .. . ..  18-19 
18.8.1  Thin Interface .....................................................................................  18-19 
18.8.2  Coding Rules .................................................... ~ .................................  18-20 
18.8.3  Science Process Code Template  ........................................................  18-21 
18.8.4  Robustness and Computational Efficiency  ........................................  18-24 
18.9  Conclusion  ............................. , .......................................................................  18-25 
18. l 0  References  ......................................................................................................  18-25 

ADEOS 
ADOM 
AQM 
ASD 
AVS 
BCs 
BCON 
BDF 
BEIS 
BEIS2 
BELD 
BOT 
CAAA-90 
CB-IV (or CB-4) 
CBWQM 
CCM2 
CCTM 
CEM 
CFL 
CG 
CMAQ 
CO RB A 
CPU 
CTM 
CVS 
ECIP 
EMPRO 
EPA 
FAST 
FDDA 
FG 
FIPS 
FSL 
GCIP 
GEMAP 
HSPF 
I/O API 
ICs  -
ICON 
IDA 
IEEE 

ACRONYMS 

· 

Advanced Earth Observing Satellite 
Acid Deposition and Oxidant Model 
Air Quality Model 
Accurate Space Derivative advectlon scheme 
Advanced Visualization System 
Boundary Conditions 
Boundary Conditions processor 
Backward Differentiation Formulae 
Biogenic Emissions Inventory System 
Biogenic Emissions Invenfory "System ~ version 2  · 
Biogenic Emissions Lailduse Database 
Bott Scheme for advection 
Clean Air Act Amendments of 1990 
Carbon Bond-IV chemical mechanism 
Chesapeake Bay Water Quality Model 
Community Climate Model Version 2 
CMAQ Chemical Transport Model processor 
Continuous Emission Monitor 
Courant-Friedrich-Levy condition 
Coarser Grid 
Community Multiscale Air Quality model 
Common Object Request Broker Architecture 
Central Processing Unit of a computer 
Chemical Transport Model 
Concurrent Versions System 
Emissions-Chemistry Interface Processor 
Emissions Processor 
Environmental Protection Agency 
Flow Analysis Software Toolkit 
Four-Dimensional Data-Assimilation 
Finer Grid  . 
Federal Identification Protocol System 
Forecast Systems Laboratory 
GEW AX Continental Scale International Project 
Geocoded Emission Modeling and Projection 
Hydrologic Simulation Program FORTRAN 
Input/Output Applications Programming Interface 
Initial Concentration 
Initial Conditions processor 
Inventory Data Analyzer 
Institute of Electrical and Electronics Engineers, Inc. 


INPRO 
IPR 
IRR 
JPROC 
LRPM 
LUPROC 
MAPS/RUC 
MCIP 
MEPPS 
MEPRO 
MEPSE 
MBPS Es 
MM5 
MPS 
MRF 
NAAQS 
NARSTO-NE 
NASA 
NCAR 
NCEP 
NOAA 
NO" 
NQS 
NSSDC 
03 
ODE 
OODBMS 
OUTPRO 
PACP 
PAN 
PARTS 
PAVE 
PBL 
PCP 
PDM 
PinG 
PM 
PMIO 
PM2.5 
PPM 
PSU 
QSSA 
RADM 

MEPPS Input Processor 
Integrated Process Rates 
Integrated Reaction Rates 
Photolysis Rate Processor 
LaGrangian Reaction Plume Module 
Landuse processor for MCIP 
Mesoscale Analysis and Prediction System/Rapid Update Cycle 
Meteorology-Chemistry Interface processor 
Models-3 Emissions Processing and Projection System 
Models-3 Emissions Projection Processor 
Major Elevated Point Source Emitter 
Major Elevated Point Source Emitters 
Fifth Generation Mesoscale Model 
Multiple Projection System 
Medium Range Forecast 
National Ambient Air Quality Standards 
North American Research Strategy for Tropospheric Ozone - Northeast 
National Aeronautics and Space Administration 
National Center for Atmospheric Research 
National Centers for Environmental Prediction 
National Oceanic and Atmospheric Administration 
Oxides of Nitrogen 
Network Queuing Service 
National Satellite Service Data Center 
Ozone 
Ordinary Differential Equations 
Object Oriented Data Base Management System 
MEPPS Output Processor 
Process Anaylsis Control Program 
Peroxy Acetyl Nitrate 
Mobile Source Particulate Model 5 
Package for Analysis and Visualization of Environmental Data 
Planetary Boundary Layer 
Program Control Processor 
Plume Dynamics Model 
Plume-in-Grid 
Particulate Matter 
Particulate Matter less than 10 µm in diameter 
Particulate Matter less than 2.5 µm in diameter 
Piecewise-Parabolic Method advective scheme 
Pennsylvania State University 
Quasi-Steady State Approximation method 
Regional Acid Deposition Model 

xvm 


RADM2 
RCS 
REL MAP 
RMSE 
ROG 
ROM 
RPM 
SAPRC 
SAQM 
SAS 
sec 
SCCS 
SIP 
SMO 
SMOKE 
SMVGEAR 
TOG 
SOX 
STEM 
svoc 
TKE 
TOMS 
UAM 
UCAR 
UTC 
VMT 
voe 
WRF 
XDR 
YAM 

Regional Acid Deposition Model Version 2 
Revision Control System 
Regional Lagrangian Modeling of Air Pollution 
Root Mean Square Error 
Reactive Organic Gases 
Regional Oxidant Model 
Regional Particulate Model 
State Air Pollution Research Center chemical mechanisms 
SARMAP Air Quality Model 
Statistical Analysis System 
Source Classification Code 
Source Code Control System 
State Implementation Plan 
Smolarkiewicz advection scheme 
Sparse Matrix Operator Kernel Emissions system 
Sparse Matrix Vectorized Gear algorithm 
Total Organic Gases 
Oxides of Sulfur 
Sulfur Transport and Emissions Model 
Semi-Volatile Organic Compounds 
Turbulent Kinetic Energy 
Total Ozone Mapping Spectrometer 
Urban Airshed Model 
University Corporation for Atmospheric Research 
Universal Time Coordinate 
Vehicle Miles Traveled 
Volatile Organic Compound 
Weather Research and Forecasting 
eXternal Data Representation 
Yamartino-Blackman Cubic Scheme for advection 

ACKNOWLEDGMENTS 

The development of the science components of the Models-3 Community Multiscale Air Quality 
(CMAQ) system represents a major undertaking by a large team of dedicated atmospheric 
scientists and a relatively long term effort beginning in the early 1990s, and covers a wide area of 
subject material as embodied in each of the contributing chapters.  Most of the EPA Models-3 
CMAQ Science Team are from the Atmospheric Modeling Division (AMD) in the EPA Office of 
Research And Development's National Exposure Research Laboratory (NERL). With several 
exceptions the contributing authors from this Division are on detail from the Air Resources 
Laboratory of the National Oceanic and Atmospheric Administration (NOAA).  The NOAA(cid:173)
AMD effort is supported through Interagency Agreement (DW13937252) with the EPA.  The 
authors of each of the chapters of this document would like to collectively express their gratitude 
to the other members of the NOAA Division.  In particular we acknowledge the encouragement 
and support of the Director of the  Atmospheric Modeling Division, Francis Schiermeier.  We are 
indebted to Dr. Robin Dennis for his vision and role in ensuring the implementation ofholistic(cid:173)
one-atmosphere approach into CMAQ.  We also recognize the technical help from our colleagues 
Tom Pierce, Steven Howard, Alfreida Torian, and Gary 'Walter. 

We also want to recognize the contributions, helpful discussions, and assistance of many members 
of the science community, either through formal agreements or through peer interest.  For 
example, the work was supported by several cooperative agreements including: 
• 

Atmospheric Modeling Research-Scientific and Computational (CR-822066: MCNC), 
Principal Investigator (PI): Kenneth Galluppi Ed Bilicki, Steve Fine, Alison Eyth, and 
Rohit Mathur; 
Research on Computational Framework in Generic Grids, Adaptive Grids, and Subgrid 
Treatment of Air Quality Simulation (CR-822053: MCNC), PI: Talat Odman; with R.K. 
Srivastava and D.S. McRae, North Carolina State University); 
Transport Algorithms for Air Quality Simulation Models  (CR-822059, MCNC), PI: Talat 
Odman; 
Emissions Modeling Research with High-Performance Computing (CR-822074: MCNC), 
PI: Carlie Coats; 
Advanced Modeling of Meteorology in Support of Air Quality Models (CR-822628: 
(MCNC), PI: Aijun Xiu, Kiran Alapaty, John N. McHenry, and Adel F.  Hanna; with 
Nelson L. Seaman and Aijun Deng, Pennsylvania State University; and John S. Kain, 
National Severe Storms Laboratory); 
A Flexible and Efficient Methodology for Modeling Aerosol for Air Quality Models 
(CR-823634: MCNC), PI: Uma Shankar, Mark Read and Atanas Trayanov; with Anthony 
Wexler, University of Delaware; and John H.  Seinfeld, California Institute of Technology; 
Develop Methods for Technology Transfer of Advanced Regional/Urban Air Quality 
Models (CR-822080: NCSU),  PI: Alan Schula; and 
Plume-in-Grid development for a Multiscale Air Quality Modeling System (IAG 
DW64937190, Tennessee Valley Authority (TV A)), PI's: Robert E. Imhoff;  with Noor 
Gillani, Arastoo Biazar (now at Monash University, Australia), and Yu-Ling Lu, 

• 

• 

• 

• 

• 

• 

• 

XXl 

University of Alabama, Huntsville). 

The following scientists also contributed under the formal contracts listed: Ruen Tang, Chris 
Maxwell, and Hao Jin of the Technical Support Group, Dyntel Corp.  (General Services 
Administration JAG  DW47937823); Tod Plessel, and Yan Ching Zhang of the Visualization 
Laboratory, Lockheed Martin (EPA Contract 68-W7-0055); and Nick Moghari, Joe Susick, and 
Dave Tivel of Science Applications International Corporation (SAIC) (EPA Contract 68-Wl-
0055). 

Significant contributions were made by: visiting scientists, including Sang-Mi Lee of the Seoul 
National University, Korea, Chong Bum Lee of the KangWeon University, Korea, and Seiji 
Sugata of the National Institute for Environmental Studies, Japan; UCAR's post doctoral fellows 
Yonghong Li, Qingyuan Song and Shoba Kondragunta; and Dr. Ingmar Akermann of Ford 
Research in Aachen, Germany. 

It is also a pleasure to thank the colleagues who engaged us in many seminal technical discussions 
on various aspects of the CMAQ system. We recognize Professors Harvey Jeffries, University of 
North Carolina at Chapel Hill; Ted Russell, Georgia Institute of Technology; Nelson Seaman and 
Jack Kain, Pennsylvania State University; Dick McNider, University of Alabama, Sonia 
Kreidenweis, Colorado State University, Panos Georgeopolus of Rutgers University, and Itsushi 
Uno of Kyushu University, Japan.  Many of our EPA colleagues provided stimulating discussion 
or reviews of our effort including Gail Tonnesen, Deborah Luecken, Carey Jang, John S. Irwin 
(NOAA) and Ed Edney. 

We are indebted to the following peer reviewers, who gave unselfishly of their time and whose 
comments and suggestions were extremely valuable in improving the scientific aspects of the 
report.  Listed in alphabetical order, the reviewers are followed by the chapter(s) they reviewed: 
Jeff Brook, Atmospheric Environment Service, Canada (Ch.  17);  David Chock, Ford Research 
Laboratory (Ch. 2 and 7);  Henry Hogo, Southern California Air Quality Modeling Division (Ch. 
8 and 16);  Sasha Madronich, National Center for Atmospheric Research (Ch.  14);  Paulette 
Middleton, RAND Environmental Science &  Policy Center (Ch.  10);  Ted Russell, Georgia 
Institute of Technology (Ch.  18);  Nelson Seaman, Pennsylvania State University (Ch. 3); 
Christian Seigneur, Atmospheric and Environmental Research, Inc. (Ch.  10 and 11 );  Trevor 
Sholtz, ORTECH Corporation (Ch. 4); Saffet Tanrikulu, California Environmental Protection 
Agency (Ch. 9 and 12);  Robert Yarmartino, Earth Tech (Ch. 5 and 6); and Zion Wang (Ch.  13, 
15, and 16). 

Finally, the editors note with great appreciation, the efforts of Brian Eder, who facilitated many of 
the activities and tasks involved in the preparation and completion of this document.  We thank 
the Raleigh, North Carolina, staff of SAIC, especially Alice Gilliland (now with NOAA-AMD) 
and Andrea Verykoukis for their critical contributions in the area of technical editing, assuring a 
high level of consistency and quality in all the chapters of this manuscript.  We are also grateful to 
Alice Gilliland for her invaluable work on the Executive Summary. 

xxii 

EXECUTIVE SUMMARY 

EP A/600fR-99{030 

THIS SCIENCE DOCUMENT PRESENTS THE PROCESSORS AND ALGORITHMS THAT 
EMBODY THE INITIAL RELEASE OF THE MODELS-3 COMMUNITY MULTISCALE 
AIR QUALITY (CMAQ) MODELING SYSTEM.  ClVIAQ IS A MULTIPLE POLLUTANT 
MODEL THAT CONTAINS NEW SCIENTIFIC APPROACHES TO AIR QUALITY 
MODELING, WIDCH REPRESENT THE CURRENT STATE OF SCIENCE.  This CMAQ 
Science Document is a living document that will be updated as the state of the science progresses. 
The CMAQ Science Document provides a basis and point of reference for the state of the science 
captured in the June1998 initial :release of Models-3.  Current and future efforts to improve the 
Models-3 modeling system(s) will depart from the scientific reference points presented in this 
document. 

Models-3 is a flexible software system that provides a user-interface framework for CMAQ air 
quality modeling applications and tools for analysis, management of model input/output, and 
visualization of data.  The Models:..3  framework relies on two  modeling systems to provide the 
meteorological and emissions data needed for air quality modeling.  With this data, the Models-3 
CMAQ modeling system can be used for urban and regional scale air quality simulation of 
tropospheric ozone, acid deposition, visibility; and particulate matter (PM2.5  and PM10).  The 
meteorological and emissions modeling systems that are provided with the current release of 
Models-3 will be described in this document.  However, CMAQ is designed as an open system 
where alternative models can be used to generate the data. 

This CMAQ Science Document contains chapters that address specific scientific and technical 
issues involved in the development and application of the Models-3 CMAQ modeling system. 
The principal researchers for each model component or fimction authored the· coinciding chapter 
in this document.  They serve as the points of contact for scientific questions regarding their 
CMAQ air quality model components.  For instructions on using the Models-3 framework and 
using the MMS, MEPP·s, and CMAQ modeling systems, refer to the Models-3  User Manual 
(EPA/600/R-98/069b, National Exposure Research Laboratory, Research Triangle Park, NC) and 
Tutorial (EP A/600/R-98/069c, National Exposure Research Laboratory, Research Triangle Park, 
NC). 

. 

An overview of the MEPPS emissions, MMS meteorology, and CMAQ air quality modeling 
systems is provided in Chapter 1.  Chapter 2 then introduces the Models-3 framework and 
structure and explains how the framework's user-interface is used with the MEPPS and CMAQ 
modeling systems.  More detailed discussions ·on the modeling systems are then discussed 
separately in the following chapters.  The amount of detail and the length of these discussions 
vary depending on whether this information has already been provided elsewhere.  Some chapters 
provide a synopsis of the scientific components and refer to· previously published material on the 
subject, while other chapters provide extensive detail on new scientific techniques that are not 
currently described in other publications. 

MM5  Meteorological data are essential for many processes simulated in the CMAQ chemical 
transport model including transport, chemistry, and cloud processes.  The Fifth-Generation Penn 
State/NCAR Mesoscale Model (MMS) is the only meteorology model compatible with the initial 
release ofModels-3.  MMS is a complex, state-of-the-science community model, and it is 
maintained by NCAR..  MMS is well documented by its primary developers in technical notes and 
refereed journal articles.  Chapter 3 briefly describes the scientific aspects ofMMS, including grid 
definitions, model physics, nesting, and four dimensional data assimilation.  These descriptions 
generally direct the user to more complete documentation about particular aspects ofMMS.  To 
promote the flexibility of CMAQ, additional meteorology models will be compatible with Models-
3 future releases. 

MEPPS 
Chapter 4 provides a description of the Models-3 Emission Processing and 
Projection System (MEPPS) structure, its scientific approach, and the assumptions used in 
modeling and processing emission data in the Models-3 framework.  The chapter also discusses 
data flow and quality control used with emission inventory and meteorological input data for 
MEPPS.  The description of the main Emission Processor addresses the basis of spatial and 
temporal allocation procedures, and the methods and assumptions used in modeling mobile and 
biogenic emissions and in the "lumping" of individual chemical species are also presented.  This 
chapter also explains the procedures used by the Models-3 Emission Projection Processor to 
estimate emission data for use in modeling future air quality scenarios. 

THE CMAQ CHEMICAL TRANSPORT MODEL (CCTM) 

Fundamentals of One-Atmosphere Dynamics for Multiscale Air Quality Modeling 
Chapter 5 provides information essential to the proper use of meteorological data in air 
quality modeling systems.  The chapter introduces a robust and fully compressible set of 
governing equations for the atmosphere, which provides an integral view of atmospheric 
modeling.  The limitations of several simplifying assumptions on atmospheric dynamics are 
presented, as are concepts of on-line and off-line coupling of meteorological and air 
quality models.  In addition, this chapter describes a procedure for conserving the mixing 
ratio of trace species even in the case of meteorological data that are not mass consistent. 
In summary, Chapter 5 attempts to bridge the information gap between dynamic 
meteorologists and air quality modelers by highlighting the implication of using different 
meteorological coordinates and dynamic assumptions for air quality simulations. 

Governing Equations and Computational Structure 
diffusion equation is derived in a generalized coordinate system, which is suitable for 
multiscale atmospheric applications.  CMAQ's use of generalized coordinates for its 
governing equations provides the flexibility to span multiple scales and to incorporate 
meteorological data on different coordinates.  The CMAQ system's modularity concepts 
and fractional time-step formulation, and CCTM' s key science processes are described. 
Chapter 6 also presents the dynamic formulations of several popular Eulerian air quality 

In Chapter 6, the governing models as emulated by the governing diffusion equations in the generalized coordinate system. 

Numerical Transport Algorithms  The transport processes in the atmosphere primarily 
consist of advection and diffusion.  In Chapter 7, CMAQ's numerical algorithms for 
advection and vertical and horizontal diffusion are discussed.  To provide the CMAQ 
system with multiscale capability, the transport processes, both advection and diffusion, 
are formulated in conservation (i.e., flux) forms for the generalized coordinate system. 
Therefore, CMAQ's numerical transport algorithms will function under a wide variety of 
dynamical situations and concentration distribution characteristics.  Users are encouraged 
to experiment with their own algorithms to test different numerical schemes for air quality 
simulations. 

Chapter 8 examines the way gas-phase chemistry is treated 

Gas Phase Chemistry 
in CMAQ.  The CMAQ system currently includes two base chemical mechanisms, 
RADM2 and CB4, while the incorporation of a third, the SAPRC97 mechanism, is 
planned for the future.  Chapter 8 describes each of these chemical mechanisms as well as 
the manner in which the first two are linked to the aqueous chemistry and aerosol 
formation processes.  The chapter also discusses procedures for entering new chemical 
mechanisms in the CMAQ system, the representation of reaction kinetics, the numerical 
modeling of gas-phase chemistry, and the two nurnerical solvers included in CMAQ, 
· 
SMVGEAR and a variant of the QSSA method. 

Chapter 9 introduces the plume-in-grid (PinG) technique developed 

Plume-in-Grid 
for CMA.Q.  PinG is designed to treat more realistically the dynamic and chemical 
processes impacting selected major point source pollutant plumes in CMAQ.  The Plume 
Dynamics Model (PDM) simulates plume rise, horizontal and vertical plume growth, and 
transport of each plume section during the subgricl scale phase.  The PinG module 
simulates the relevant physical and chemical processes during a subgrid scale phase.  This 
technique is in contrast to the traditional Eulerian grid modeling method of instantly 
mixing the point source emissions into an entire grid cell volume.  Chapter 9 describes the 
technical approach and model formulation of the relevant processes, and discusses the 
capabilities and limitations of the initial version of the PinG approach. 

The Aerosol Module One of CMAQ's key strengths is that it is a multi-pollutant model 
that fully addresses the criteria pollutants P.M and ozone.  Chapter 10 discusses the 
aerosol module of CMAQ, which is designed to be an efficient and economical depiction 
of aerosol dynamics in the atmosphere.  This chapter discusses the techniques for 
distributing particulates in three modes: coagulation, particle growth by the addition of 
new mass, and particle formation.  The aerosol module considers both PM2.5 and PM10  and 
includes estimates of the primary emissions of elemental and organic carbon, dust, and 
other species not fi.Irther specified.  Secondary species considered are sulfate, nitrate, 
ammonium, water and organic from precursors of anthropogenic and biogenic origin. 

Cloud Chemistry and Dynamics  Chapter 11  discusses the role and functions of 
clouds in CMAQ.  Clouds are involved in aqueous chemical reactions, vertical mixing of 
pollutants, and removal of aerosols by wet deposition, all of which affect the concentration 
of air pollutants.  CMAQ's cloud module performs several functions related to cloud 
physics and chemistry, and it models three types of clouds: sub-grid convective 
precipitating clouds, sub-grid non-precipitating clouds, and grid-resolved clouds.  The 
cloud module vertically redistributes pollutants for the sub-grid clouds, calculates in-cloud 
and precipitation scavenging, performs aqueous chemistry, and accumulates wet 
deposition amounts. 

CMAQ INTERFACE PROCESSORS PREPARE INPUT DATA FROM SOURCES 
INCLUDING THE EMISSION AND METEOROLOGICAL MODELING SYSTEMS FOR USE 
IN THE CMAQ CTM.  EACH OF THESE PROCESSORS, EACH OF WHICH HA VE 
SPECIFIC FUNCTIONS, ARE DESCRIBED IN THE CHAPTERS MENTIONED BELOW.  The 
interface processors that handle input data from the emissions and meteorological models are 
essential because CMAQ is an open system in which meteorological and emissions data are 
calculated separately (i.e., "off-line"), rather than during the chemical transport model simulation. 
These interface processors also add extra quality control, so that inconsistencies between input 
data and the CCTM are minimized. 

ECIP  In addition to describing the Models-3 MEPPS emission modeling system, Chapter 
4 discusses the Emission-Chemistry Interface Processor (ECIP).  ECIP serves as the key 
link between the MEPPS system and CCTM.  ECIP's primary function is to generate 
hourly 3-D emission data files for CCTM from the individual emission file types produced 
by the MEPPS.  The key inputs for ECIP are the area emissions file, the stack parameter 
and emission files for the point sources generated in MEPPS, and a set of meteorological 
data files generated by the Meteorology-Chemistry Interface Processor (MCIP) for the 
CCTM domain.  All major point sources are subject to plume-rise and initial vertical 
dispersion processes before being allocated to a particular vertical model layer. 

MCIP Chapter 12 describes MCIP, which links meteorological models, such as MM5, 
with the CCTM system to provide the complete set of meteorological data needed for air 
quality simulation.  To support CCTM's multiscale generalized coordinate 
implementation, MCIP provides appropriate dynamic meteorological parameters to allow 
mass-consistent air quality computations.  MCIP deals with issues related to data format 
translation, conversion of parameter units, diagnostic estimations of parameters not 
provided, extraction of data for appropriate window domains, and reconstruction of 
meteorological data on different grid and layer structures.  MCIP also relies on the 
Landuse Processor (LUPROC) to provide landuse and vegetation information to define 
surface characteristics to compute dry deposition and other PBL parameters.  LUPROC 
extracts information about landuse in the CMAQ domain from a landuse database and 
converts it into the fractional landuse data used in MCIP. 

Initial conditions provide a simulation's starting 

Initial and Boundary Conditions 
point, while boundary conditions define influences from outside the domain. 
Chapter 13  describes the two interface processors that generate the concentration fields 
for the initial and boundary conditions for CCTM.  The chapter describes how the initial 
condition (ICON) and boundary condition (BCON) processors can be used to generate 
the concentration fields from either predefined default vertical profiles or from other 
CMAQ simulation results when model nesting is being performed.  This chapter also 
discusses generating initial and boundary concentrations for special tracer species and 
procedures for horizontal and vertical interpolation and conversions between chemical 
mechanisms. 

Photolysis Rate Processor  Many chemical reactions in the atmosphere are initiated by 
the photodissociation of numerous trace gases, including N02,  0 3,  and HCHO.  Chapter 
14 describes the photolysis rate processor (JPROC) that produces the photolysis rates 
used in the CMAQ chemical transport simulation.  JPROC predicts photolysis rates for 
various altitudes, latitudes, and zenith angles. Currently, the radiative transfer algorithm 
assumes clear-sky conditions (i.e., no clouds present), and CCTM then attenuates for 
cloudiness. 

As described above, each of the CMAQ interface processors incorporate raw data for CMAQ and 
perform functions such as calculating parameters and inte1polating or converting data.  The 
functions of the interface processors also include capabilities to handle raw data with various 
resolutions or measurement units.  Raw input data is currently specified in the source code for 
JPROC, LUPROC, ICON, and BCON; however, the interface processors in future releases of 
CMAQ will be modified to handle a more generalized set of input data. 

PROGRAM CONTROL PROCESSORS, A SET OF PROGRAMS EMBEDDED IN THE 
MODELS-3 FRAMEWORK, HANDLE SCIENCE INFOJRMATION OBJECTS SUCH AS 
GRID AND LAYER SPECIFICATIONS, CHEMICAL MECHANISMS, AND MODEL 
CONFIGURATIONS FOR REPEATED USE ACROSS SEVERAL PROCESS COMPONENTS 
OFCMAQ. 

Program Control Processing (PCP)Chapter 15 explains how PCP is used within 
Models-3 to set up internal arrays, map species names, define global parameters, and 
establish linkages among processors in the Models-3 CMAQ system.  Specifications 
needed for the CCTM simulation (e.g., grid and coordinate conditions and chemical 
species names) are entered into the Models-3 system once by the graphical user interfaces, 
and an object-oriented database accessible by all model components is established.  PCP 
utilizes this information in the object database and automatically generates the required 
global FORTRAN include files.  As a part of PCP, Models-3 CMAQ system employs a 
generalized chemistry mechanism processor (MP), also called the "mechanism reader."  It 
greatly simplifies the task of implementing or altering gas-phase chemistry mechanisms 
and provides the capability of easily and safely using different mechanisms in the CMAQ 
system. 

Integration of Science Codes into Models-3 
One of the major objectives of the 
Models-3 project was to develop a flexible, comprehensive air quality modeling system 
with a modular coding structure that allows easy replacement of science process 
components.  Chapter 18 describes the modularity concepts, code management method, 
and integration schemes of CMAQ science code with the Models-3 framework.  The 
CMAQ FORTRAN code was integrated into the Models-3 framework with the following 
set of design, coding, and implementation standards: (1) modularity to allow easy 
exchange of science process solvers, (2) a standard subroutine interface at the module 
level, (3) restriction of coding practices, ( 4) the Models-3 I/O API 
(http://www.iceis.mcnc.org/EDSS/ioapi/index.html/), which contains standardized file I/O 
functions and a modeler-friendly interface built on top of self-describing netCDF 
(http://www.unidata.ucar.edu/packages/netcdf/) files that are portable across most Unix 
platforms. 

MODELS-3 ALSO PROVIDES ANALYSIS ROUTINES FOR USE WITH CMAQ OUTPUT, 
WHICH CAN BE USED TO PROVIDE PROCESS ANALYSIS RESULTS AND STATISTICAL 
AGGREGATION TECHNIQUES. 

Chapter 16 describes the implementation of process analysis 

Process Analysis 
techniques in the CMAQ modeling system.  These techniques can be used in CMAQ to 
provide insights into how model predictions are obtained, which is particularly useful 
when modeling nonlinear systems like atmospheric photochemistry.  Two techniques are 
available in the CMAQ system, integrated process rate (IPR) analysis and integrated 
reaction rate (IRR) analysis.  IPR analysis can be used to determine the relative 
contributions of individual physical and chemical processes, and IRR analysis can help 
elucidate important chemical pathways and identify key chemical characteristics. 

Aggregation  Chapter 17 discusses a statistical procedure called aggregation that is 
applied to CMAQ's outputs in order to derive the seasonal and annual estimates required 
by assessment studies.  Assessment studies require CMAQ-based distributional estimates 
of ozone, acidic deposition, and PM2.5,  as well as visibility, on seasonal and annual time 
frames.  Unfortunately, it is not financially feasible to execute CMAQ over such extended 
time periods.  Therefore, in practice CMAQ must be executed for a finite number of 
episodes or "events," which are selected to represent a variety of meteorological classes. 
The aggregation technique is used to incorporate these episode simulations into annual 
and seasonal estimates. 

THE MODEL-3 CMAQ MODELING SYSTEM IS BEING FORMALLY EVALUATED TO 
ASSESS THE PERFORMANCE OF CMAQ'S NEW DEVELOPMENTS IN AIR QUALITY 
MODELING.  THE EVALUATION WILL PROVIDE THE BASIS FOR UNDERSTANDING 
THE STRENGms OR WEAKNESSES OF THE CURRENT STATE-OF-SCIENCE IN 
CMAQ.  With an evaluation ofCMAQ simulations of36, 12, and 4 km grid resolution, 
CMAQ's performance can be evaluated on both the regional and urban scales.  This evaluation 
will include an initial comparison of relative performance against the RADM model and diagnostic 
evaluation against databases from regional studies such as the .1995  Southern Oxidant Study 
conducted in the vicinity of Nashville, TN and the 1995 NARSTO-NE study. 

CMAQ can be configured for a wide range of applications, from scientific studies to regulatory 
applications.  While the scientific community can take advantage of CMAQ's ability to create 
alternative applications for research and development purposes, regulatory applications depend 
upon a standardized, evaluated form of CMAQ for regulatory applications.  The CMAQ 
evaluation program will provide the scientific benchmark needed for this. 

FUTURE EXTENSIONS OF CMAQ INCLUDE NEAR-TERM EFFORTS TO PROVIDE A 
NEW CHEMICAL MECHANISM AND EMISSION MODELING SYSTEM. 

The SAPRC-97 gas phase mechanism will soon be incorporated into CMAQ, in 
addition to the current CB-IV and RADM2 mechanisms available.  The SAPRC 
mechanism will be incorporated with a fixed subset of the approximately 100 organic 
species contained in the semi-explicit version of the SAPRC mechanism. 

The Sparse Matrix Operator Kernel Emissions modeling system (SMOKE) 
(http://envpro.ncsc.org/products/) will also be incorporated into CMAQ in the near-term. 
The SMOKE model formulates emissions modeling in terms of sparse matrix operations 
which require considerably less time to perform than current systems. 

WE ENCOURAGE THE FULL PARTICIPATION AND INVOLVEMENT OF  THE 
SCIENTIFIC AND MODELING COMMUNITIES IN THE GROWTH AND USE OF MODELS-
3 CMAQ.  THERE ARE MANY IDEAS AND PLANS FOR FUTURE DEVELOPMENTS OF 
CMAQ, INCLUDING TOXIC POLLUTANT MODELING AND LINKAGES TO OTHER 
MODELS. 

Modeling atmospheric toxic pollutants  A key opportunity for CMAQ is developing the 
capability to model toxic pollutants.  Models of airborne toxic pollutants are essential for 
human exposure and risk assessments.  They can also be used to assess the exchange of 
toxic compounds between the atmosphere and sensitive ecosystems.  With the ability to 
simulate toxic pollutant processes in addition to the current photochemical oxidants and 
particulates, it is planned to transport the CMAQ model to a finer than urban scale to link 
with human exposure models. 

New linkages with global models  It is hoped that information from the urban and 
regional CMAQ applications and from global modeling applications can be bridged. 
CMAQ output, produced using state of the science techniques, can be used to benchmark 
or examine the parametric basis of process formulations in global models.  In addition, 
global model output can be used to improve or enhance the initial and boundary conditions 
for regional and urban scale CMAQ simulations. 

Modeling ecosystems  Efforts to combine environmental modeling techniques to 
encompass an entire ecosystem is needed to address issues including  (a) nutrient cycling 
through the atmosphere, water bodies, and soil and (b) acidic wet and dry deposition into 
sensitive ecosystems, including critical load analyses.  With this ecosystem modeling 
approach, air quality issues can be studied in combination with other aspects of 
environmental health. 

This is the Executive Summary of Science Algorithms of the EPA Models-3 Community 
Multiscale Air Quality (CMAQ) Modeling System, edited by D. W. Byun and J. K. S. 
Ching, 1999. 

ES-8 

Chapter 1 
==============

INTRODUCTION TO THE MODELS-3 FRAMEWORK AND 

THE COMMUNITY MULTISCALE AIR QUALITY MODEL (CMAQ) 

EP A/600/R-99/030 

Jason Ching* and Daewon Byun** 

Atmospheric Modeling Division 

National Exposure Research ]Laboratory 
U.S. Environmental Protection Agency 

Research Triangle Park, NC 27711 

ABSTRACT 

Models-3, a flexible software framework, and its Community Multiscale Air Quality (CMAQ) 
modeling system form a powerful third generation air quality modeling and assessment tool 
designed to support air quality modeling applications ranging from regulatory issues to science 
inquiries on atmospheric science processes.  The CMAQ system can address tropospheric ozone, 
acid deposition, visibility, fine particulate and other air pollutant issues in the context of "one" 
atmosphere perspective where complex interactions between atmospheric pollutants and regional 
and urban scales are confronted.  This CMAQ Science Document contains chapters that address 
specific scientific and technical issues involved in the development and application ofModels-
3/CMAQ system; collectively, it provides the scientific basis and point of reference for the state of 
the science captured in the June 1998 initial release of the CMAQ. This chapter provides an 
overview and context of each contributing chapter to the CMAQ system. 

·on assignment from the National Oceanic and Atmospheric Administration, U.S. Department of Commerce. 
Corresponding author address: Jason Ching, MD-80, Research Triangle Park, NC 27711. 
E-mail: Ching.J ason@epamail.epa.gov 

••on assignment from the National Oceanic and Atmospheric Administration, U.S. Department of Commerce. 

1.0 

INTRODUCTION TO THE MODELS-3 FRAMEWORK AND THE 
COl\fMUNITY MULTISCALE AIR QUALITY MODEL(CMAQ) 

Air quality simulation models are important tools for regulatory, policy, and environmental 
research communities.  In the United States, the Clean Air Act provides a societal mandate to 
assess and manage air pollution levels to protect human health and the environment.  The U.S. 
Environmental Protection Agency (USEPA) has established National Ambient Air Quality 
Standards (NAAQS), requiring the development of effective emissions control strategies for such 
pollutants as ozone, particulate matter, and nitrogen species.  National and regional policies are 
needed for reducing and managing the amount and type of emissions that cause acid,·nutrient and 
toxic pollutant deposition to ecosystems at risk and for enhancing the visual quality of the 
environment.  Air quality models are used to develop emission control strategies to achieve these 
objectives.  Optimal control strategies should be both environmentally protective and cost 
effective.  Up to now, air quality model paradigms typically addressed individual pollutant issues 
separately.  However, it is becoming increasingly evident that when pollutant issues are treated in 
isolation, the resulting control strategies may solve one set of problems but may lead to 
unexpected aggravation of other related pollutant issues.  Pollutants in the atmosphere are subject 
to myriad transport processes and transformation pathways that control their composition and 
levels.  Also, pollutant concentration fields are sensitive to the type and history of the atmospheric 
mixtures of different chemical compounds.  Thus, modeled abatement strategies of pollutant 
precursors, such as volatile organic compounds (VOC) and NOx, to reduce ozone levels may 
under a variety of conditions, cause an exacerbation of other air pollutants such as particulate 
matter or issues of acidic deposition. 

The development of comprehensive air quality models started in the late seventies.  The Urban 
Airshed Model (UAM) (Morris and Meyers, 1990) followed by the Regional Oxidant Model 
(ROM) (Lamb, 1983a, 1983b) provided Eulerian-based models for ozone, the former for urban 
and the latter for regional scale.  Strategies for State Implementation Plans (SIPs) used ROM to 
provide boundary conditions for UAM simulations.  Attention to acid deposition issues were 
addressed in the eighties with the development and evaluation of regional acid deposition models 
such as the Regional Acid Deposition Model (RADM) (Chang et al.,  1987; Chang et al.,  1990), 
the Acid Deposition and Oxidant Model (ADOM) (Venkatram et al.,  1988), and the Sulfur 
Transport and Emissions Model (STEM) (Carmichael and Peters,  l 984a, 1984b; Carmichael et 
al., 1991).  Other major modeling systems included the Regional Lagrangian Modeling of Air 
Pollution model (RELMAP) (Eder et al.,  i986), a Lagrangian framework system, and semi(cid:173)
empirical and statistical models.  The genre of models of this period were designed to address 
specific air pollution issues such as ozone or acid deposition and to be applied under relatively 
prescriptive implementation guidance strategies.  Thus, flexibility to deal with other issues, such 
as particulate matter or toxics, was very limited.  Further, With the passage of the Clean Air Act 
Amendments of 1990 (CAAA-90), a wide range of additional issues were identified including 
visibility, fine and coarse particles, indirect exposure to toxic pollutants such as heavy metals, 
semi-volatile organic species, and nutrient deposition to water bodies.  The direct response 
approach is to modify, adapt or extend current models to handle more complex implementations 
and issues but is both cumbersome and limiting. 

-

1-2 

Seeking a more strategic approach to handle the increased modeling requirements of the CAAA-
90,  more comprehensive modeling approaches appear to be needed. With projections for the 
increasing rapid pace of the development of computational capabilities at the start of the nineties, 
the opportunity arose for a strategic review of modeling approaches leading to design of a system 
that would both meet and keep pace with the increasing requirements on air quality modeling, of 
incorporating advances in state-of-science descriptions of atmospheric processes, as well as 
eliminate impediments of the current genre of models. The scope of such a system must be able to 
process great and diverse information from complicated emissions mixtures and complex 
distributions of sources, to modeling the complexities of atmospheric processes that transport and 
transform these mixtures in a dynamic environment that operates on a larg~ range of time scales 
~overing minutes to days and weeks.  The corresponding spatial scales are ~ommensurately large, 
ranging from local to continental scales.  On these temporal and spatial scales, emissions from 
chemical manufacturing and other industrial activities, power generation, transportation, and 
waste treatment activities contribute to a variety of air pollution issues including visibility, ozone, 
particulate matter (PM), and acid, nutrient and toxic deposition. The residence times of pollutants 
in the atmosphere can extend to multiple days, therefore transport must be considered on at least 
a regional scale.  NAAQS requirements and other goals for a cleaner environment vary over a 
range of time scales, from peak hourly to annual averages. These challenges suggest that more 
comprehensive approaches to air quality modeling are needed, and that assessments and pollution 
mitigation are achieved mqre successfully when the problems are viewed in a "one atmosphere" 
context that considers multiple pollutant issues.  Further discussion of the needs for the third(cid:173)
generation air quality modeling system can be found in Dennis et al. (1996) and Dennis (1998). 

To meet both the challenges posed by the CAAA-90 and the need to address the complex 
relationships between pollutants, the USEP A embarked upon the Models-3 project and developed 
the Community Multiscale Air Quality (CMAQ) system, an advanced air quality modeling system 
that addressed air quality from this "one atmosphere" multi-pollutant perspective.  Based on its 
conceptual design, the high performance computational Models-3 framework serves to manage 
and orchestrate air quality simulations, using the CMAQ modeling system.  The Models-3 
framework is an advanced computational platform that provides a sophisticated and powerful 
modeling environment for science and regulatory commlll1lities.  The framework provides tools 
used to develop and analyze emission control options, integrate related science components into a 
state-of-the-art quality modeling system, and apply· graphical and analytical tools for facilitating 
model applications and evaluation.  Descriptions of the Models-3 architecture are provided in 
Ch~pter 2 and in Novak et al. (1998).  CMAQ is a multi-pollutant, multiscale air quality model 
that contains state-of-science techniques for simulating all atmospheric and land processes that 
affect the transport, transformation, and deposition of atmospheric pollutants and/or their 
precursors on both regional and urban scales.  It is designed as a science-based modeling tool for 
handling all the major pollutant issues (including photochemical oxidants, particulate matter, 
acidic, and nutrient deposition) holistically. 

More than six years of investment and, commitment .from Federal staff and from scientists and 
model developers from the environmental and information communities were expended to 
develop the Models-3 framework and the CMAQ air quality modeling system.  Models-3 CMAQ 
was released to the public in June 1998.  The science and model engineering concepts and 
progress of the project have been described in two peer-reviewed A WMA Transaction papers 
(Byun et al.,  l 995a; Coats et al.,  1995) and others (Byun et al.,  l 995b, 1996, and 1998a; Ching et 
al.,  1995).  This release version of the Model-3  software is supported by the following documents 
under the overall heading "Third Generation Air Quality Modeling System": 

System Installation and Operations Manual.  EPA/600/R-98/069a, National Exposure 
Research Laboratory, EPA, Research Triangle Park, NC 

Users Manual.  EPA/600/R-98/069b, National Exposure Research Laboratory, Research 
Triangle Park, NC 

Tutorial.  EPA/600/R-98/069c, National Exposure Research Laboratory, EPA, Research 
Triangle Park, NC 

Science Concepts of the Third Generation Air Quality Models: Project Report.  In 
preparation.  Edited by D.W. Byun and.A. Hanna. National Exposure Research 
Laboratory, EPA, Research Triangle Park, NC 

. 

• 

• 

• 

• 

• 

Science Algorithms of the EPA Models-3 Community Multiscale Air Quality (CMAQ) 
Modeling System, Edited by D.W. Byun and J.K.S. Ching. National Exposure Research 
Laboratory, EPA, Research Triangle Park, NC (this document) 

The project report "Science Concepts of the Third Generation Air Quality Models" summarizes 
the basic atmospheric science concepts and mathematical principles pertinent to the development 
of the third generation air quality modeling.  This document discusses the key scientific features 
and options incorporated into the Models-3 CMAQ modeling system. 

1.1 

The Models-3 Emissions, Meteorology, and the CMAQ Modeling Systems 

The structure of the Models-3/CMAQ system is shown in Figure 1-1.  Orchestrated through the 
Models-3 system framework, the Community Multiscale Air Quality (CMAQ) modeling system 
incorporates output fields from emissions and meteorological modeling systems and several other 
data source through special interface processors into the CMAQ Chemical Transport Model 
(CCTM).  CCTM then performs.chemical transport modeling for multiple pollutants on multiple 
scales.  With this structure, CMAQ retains a flexibility to substitute other emissions processing 
systems and meteorological models. One of the main objectives of this project was to provide an 
air quality modeling system with a "one atmosphere" modeling capability based mainly on the 
"first principles" description of the atmospheric system. CMAQ contains state-of-science 
parameterizations of atmospheric processes affecting transport, transformation, and deposition of 
such pollutants as ozone, particulate matter, airborne toxics, and acidic and nutrient pollutant 
species.  With science in a continuing state of advancement and review, the modeling structure of 
CMAQ is designed to integrate and to test future formulations in an efficient manner, without 
requiring the development of a completely new modeling system.  Contents of the CMAQ in the 
June 1998  release version ofModels-3 are summarized in Ching et al ..  (1998) and Byun et al. 
(1998b). 

Currently, the Models-3 Emission Projection and Processing System (MEPPS) produces the 
emissions and the Fifth Generation Penn State University/ National Center for Atmospheric 
Research Mesoscale Model (MM5) provides the meteorological fields needed for the CCTM. 
They are considered to meet the present application needs for diverse air pollution problems in 
urban and regional scales.  However, given the CMAQ paradigm, and other considerations, the 
emissions processing and meteorological modeling systems can be replaced with alternative 
processors. 

Each of these three modeling systems are described briefly below, where associated chapters of 
this document are highlighted to provide directions to more in-depth discussions of these topics: 

• 

• 

• 

The PSU/NCAR MM5 meteorological modeling system (Grell et al.,  1994) generates  the 
meteorological fields for CMAQ.  MM5 is a complex, state-of-the-science community 
model, which is maintained by NCAR.  MM5 is well-documented by its primary 
developers in technical notes and referenced journal articles.  Chapter 3 briefly describes 
the scientific aspects ofMM5, including grid definitions, model physics, nesting and four(cid:173)
dimensional data assimilation. 

The MEPPS emission modeling system is based on the Geocoded Emission Modeling and 
Projection System (GEMAP) (Wilkinson et al., 1994) now known as the Emission 
Modeling System-95 (EMS-95).  MEPPS processes emission inventory data, performs 
future projections (including control scenarios), and pre-processes data for use in the 
CMAQ model (Chapter 4).  It provides speciated emissions consistent with CB-IV or 
RADM2 chemistry mechanisms. 

The CMAO chemical transport modeling system (CCTM) is then used to perform model 
simulations for multiple pollutants and multiple scales with these input data (Chapters 6, 
7, 8, 9, 10 and 11).  The fundamental concepts used for the one-atmosphere dynamic 
modeling is described in Chapter 5.  The techniques used for the management of 
CMAQ's source code are discussed in Chapter 18. 

The CMAQ modeling system also includes  interface processors that process input data 
for the emission and meteorological modeling systems, and other processors that calculate 
photolysis rates, and develop initial and boundary conditions (Chapters 4, 12, 13, and 
14).  CMAQ also has an internal program control processor which is disc':lssed in 
Chapter 15. 

Using the analysis routines provided in Models-3, the CMAQ output can be processed to 
provide process analysis information (Chapter 16) and/or analyzed further to provide 
aggregated statistical information (Chapter 17). 

An important design requirements for CMAQ is that it addresses multiple scales and pollutants, 
which requires that governing equati9ns and computational algorithms among the different 
systems should be consistent and compatible across the multiple scales.  However, modeling 
assumptions used in various modeling systems may not be valid across all scales.  For example, 
the atmospheric dynamics description in a meteorological model may have been optimized for 
application of certain scale or limited range of scales (e.g., global vs mesoscale vs complex terrain 
to urban).  It is incumbent upon the user community to ensure the model component formulations 
are applicable to the range of scales upon which CMAQ is applied.  The current version of MM5 
and the CCTM is designed for regional to urban scales.  Furthermore, when using nesting 
procedures to scale down  from regional to urban scales and for avoiding feedback between the 
scales, one way nesting is recommended.  In addition to the challenges of creating a multiscale air 
quality model, CMAQ's multi-pollutant capability cannot be achieved ifthe emissions modeling 
system does not provide appropriate precursor or pollutant emissions to the chemical transport 
model (CTM).  The development of Models-3 and CMAQ overcome these hurdles by providing 
the flexibility to modify specific requirements (e.g., chemical mechanisms, model inputs, etc.), a 
generic coordinate system that ensures consistency across spatial scales, and user interfaces that 
can integrate alternative emissions or meteorological modeling systems. 

1.2 

CMAQ Interface Processors 

The CMAQ modeling system includes interface processors to incorporate the outputs of the 
meteorology and emissions processors and to prepare the requisite input information for initial 
and boundary conditions and photolysis rates to the CCTM.  Figure 1-1  illustrates the relationship 
and purpose of each of the CMAQ  processors (and requisite interfaces) and their relation to the 
chemical transport modeling system.  The arrows show the flow of data through the modeling 
system.  Two additional functional features of the CMAQ system are included, one for process 
analysis, which is primarily for model diagnostic analyses, and a second one that is an aggregation 
methodology for estimating longer term averaged fields.  Each of these processors is described 
briefly below, and the associated chapter numbers are also listed to note where detailed 
discussions can be found on the topics. 

ECIP 

Emissions-Chemistry 
· Interface Processor 

(Ghapter4) 

// 

Program Control 
Processiilg 
(Chapter 1 5) 

/ 
./ 

1,( 

/---------------· 

MCIP 

Meteorology-Chemistry" 

Interface Processor 

(Chapter 12) 

Fundamentals or"·,, 

Dynamics for CMAQ 
(Chapter 5) 

··,., 

· "·," 

I 

l: 
/ 

LUPROC 

Land use Processor 

(Chapter 1 :i) 

ICON and BCON 
Initial and Boundary 
Condition Processors 

Chapter 13) 

JPROC 

Photolysis Rate 

Processor 

(Chapter 14) 

Figure 1-1.  Emissions and Meteorological modeling systems and the CMAQ 
Chemical Transport Model and Interface Processor 

• 

• 

• 

The Emission-Chemistry Interface Processor (ECIP) translates data from the MEPPS 
emission model for use in the CCTM.  ECIP generates hourly three-dimensional emission 
data for CMAQ from the separate source type files produced by MEPPS, which include 
mobile, area, and point sources (Chapter 4).  ECIP calculates the plume rise and initial 
vertical plume spread of point source emissions to determine the vertical level(s) of 
CCTM into which poinj source emissions should be introduced.  Since meteorological 
conditions affect both point source plume rise and biogenic emissions, meteorological data 
from MCIP is also used in ECIP. 

The Meteorology-Chemistry Interface Processor CMCIP) translates and processes model 
outputs from the meteorology model for the CCTM (Chapter 12).  MCIP interpolates the 
meteorological data if needed, converts between coordinate systems, computes cloud 
parameters, and computes surface and planetary boundary layer (PBL) pru_:ameters for the 
CCTM.  MCIP uses landuse information from the landuse processor (LUPROC) to 
calculate the PBL and surface parameters. 

Initial Conditions and Boundazy Conditions QCON and BCON) provide concentration 
fields for individual chemical species for the beginning of a simulation and for the grids 
surrounding the modeling domain, respectively.  The ICON and BCON processors 
(Chapter 13) use data provided from previous three-dimensional model simulations or 
from clean-troposphere vertical profiles.  Both the vertical profiles and modeled 
concentration fields have a specific chemical mechanisms associated with them, which are 
a function of how these files were originally generated. 

• 

The photolysis processor CJPROC) calculates temporally varying photolysis rates 
(Chapter 14).  JPROC requires vertical ozone profiles, temperature profiles, a profile of 
the aerosol number density, and the earth's surface albedo to produce the photolysis rates 
for the CCTM.  JPROC uses this information in radiative transfer models to calculate the 
actinic flux needed for calculating photolysis rates.  JPROC generates a lookup table of 
photo-dissociation reaction rates. 

Each of these CMAQ interface processors incorporates raw data into CMAQ and performs 
functions such as calculating parameters and interpolating or converting data.  Raw input data is 
currently specified in the source code for JPROC, LUPROC, ICON, and BCON.  However, the 
interface processors in future releases of CMAQ will be modified to handle a more generalized set 
ofraw input data, so that alternative data sets with varying resolutions or measurement units can 
be used. 

1.3 

The CMAQ Chemical Transport Model (CCTM) 

The CCTM simulates the relevant and major atmospheric chemistry, transport and deposition 
processes involved throughout the modeling domains.  The fundamental basis for CMAQ's one(cid:173)
atmosphere dynamics modeling is discussed in Chapter 5.  Governing equations and model 
structure, including definitions of CMAQ's science process modules, are discussed in Chapter 6. 
The science options available to the user include the gas phase chemistry mechanisms, RADM2 
and CB-IV, a set of numerical solvers for the mechanisms, options for horizontal and vertical 
advection schemes, algorithms for fine and coarse particulate matter predictions, photolysis rates, 
and a plume-in-grid approach.  Through the Models-3 :framework, CMAQ simulations can be 
developed using these different options without modifying source code.  A general overview of 
these science process options is provided below along with a reference to the chapter(s) of this 
document where more scientific detail can be found. 

• 

• 

Advection and Diffusion (Chapter 7): Several advection methods are implemented in the 
CMAQ; these include a scheme by Bott (1989), a piecewise parabolic method (PPM) 
(Collela and Woodward, 1984), and the Yamartino-Blackman cubic algorithm.  Options 
for computing subgrid vertical transport include eddy diffusion, and the Asymmetric 
Convective Model (ACM) (Pleim and Chang, 1992) applicable to convective conditions. 
Horizontal diffusion is modeled using a constant eddy diffusion coefficient. Numerical 
methods differ in the handling of advection of concentration fields. 

Gas Phase Chemistry (Chapter 8):  CMAQ includes both the RADM2 and CB4 gas-phase 
chemical mechanisms.  The CMAQ version of CB4 includes the most recent 
representation of isoprene chemistry and two additional variants of the RADM2 
mechanism also contain the newer isoprene chemistry at two levels of detail.  In addition, 
CMAQ provides the capability to edit these mechanisms or to import a completely new 
mechanism by means of a generalized chemical mechanism processor.  CMAQ also 
accounts for the formation of secondary aerosols and the reactions of pollutants in the 
aqueous phase, and aqueous reactions are simulated by means of the aqueous chemical 
mechanism incorporated in RADM.  All CMAQ gas-phase mechanisms are linked to these 
processes to provide the capability to simulate multi-phase interactions. 

Two chemistry solvers are available -- the Sparse Matrix Vectorized Gear (SMVGEAR) 
algorithm developed by Jacobson and Turco (1994) and the Quasi-Steady State 
Approximation (QSSA) method used in the Regional Oxidant Model.  SMVGEAR is 
generally recognized as the more accurate of the two, but it is much slower than QSSA on 
non-vector computers. 

Plume-in-Grid (PinG) Modeling (Chapter 9):  CMAQ includes algorithms to treat subgrid 
scale physical and chemical processes impacting pollutant species in plumes released from 
selected Major Elevated Point Source Emitters (TvIEPSEs).  The PinG modules simulate 
plume rise and growth, and the relevant dynamic and chemical reaction processes of 
subgrid plumes.  PinG can be used for the simulations at 36 km and 12 km resolutions, 
PinG is not invoked at 4 km resolutions and the MEPSE emissions are directly released 
into the CTM 3-D grid cells. 

Particle Modeling and Visibility (Chapter 10): One of the major advancements in CMAQ 
is the modeling of fine and coarse mode particles, with the use of the fine particle model 
described in Binkowski and Shankar (1995).  CMAQ predicts hourly gridded 
concentrations of fine particle mass whose size is equal to or foss that 2.5 microns in 
diameter (PM 25), speciated to sulfate, nitrate, ammonium, organics and aerosol water. 
Secondary sulfate is produced when hydroxyl radicals react with sulfur dioxide to produce 
sulfuric acid that either condenses to existing part1cles or nucleates to form new particles. 
CMAQ model output includes number densities for both fine and coarse modes.  The 
modeling of aerosols in CMAQ also· provides the capability to handle visibility, which is 
another CMAQ output.  In another potential application, CMAQ can provide the basis for 
modeling the atmospheric transport and deposition of semi-volatile organic compounds 
(SVOC) with parameterizations for their rates of condensation to and/or volatilization 
from the modeled particles. 

Cloud processes (Chapter 11 and 12): Proper descriptions of clouds are essential in air  · 
quality modeling due to their critical role in atmospheric pollutant transport and chemistry 
processes. Clouds have both direct and indirect effects on the pollutant concentrations: 
they directly modify concentrations via aqueous chemical reactions, vertical mixing, and 
wet deposition removal processes, and they indirectly affect concentrations by altering 
radiative transmittances which affect photolysis rates and biogenic fluxes.  CMAQ models 
deep convective clouds (Walcek and Taylor, 1986) and shallow clouds using the 
algorithms as implemented in RADM (Dennis et al.,  1993) for 36 and 12 km resolutions. 
At 4 km resolution,  the clouds are generally resolved, and explicit type cloud dominates. 

Photolysis Rates (Chapter 14): The photochemistry of air pollutants is initiated by 
photodissociation of smog precursors, which are driven by solar radiation. The amount of 
solar radiation is dependent on sun angle (time of day), season, latitude, and land surface 
characteristics, and is greatly affected by atmospheric scatterers and absorbers. 
Photolytic rates are also wavelength- and temperature-dependent.  Within CCTM, 
temporally resolved 3-D gridded photolysis rates are interpolated from a lookup table 
generated by JPROC processor and corrected for cloud coverage. 

1.4 

Analysis of CMAQ Output 

Air quality modeling simulations arise from modeling of complex atmospheric processes. It is 
important to assure and to understand the model results.  Sensitivity tests are needed to detect 
problems in model formulations and to determine if the model is credible for assessing emission 
control strategies.  A very powerful sensitivity analysis tool called process analysis is provided 
with CMAQ.  Also, an aggregation technique is provided with CMAQ.  Aggregation can be used 
to estimate seasonal or annual concentrations for pollutants from CMAQ simulations which are 
usually performed for shorter time periods due to time and computational limitations. 

1.4.1  Process Analysis (Chapter 16) 

Sensitivity analyses are needed to detect errors and uncertainties introduced into a model by the 
parameterization schemes and the input data.  Results must also be analyzed to ensure that 
realistic values are obtained for the right reasons rather than through compensating errors among 
the science processes.  Process Analysis techniques quantify the contributions of individual 
physical and chemical atmospheric processes to the overall change in a pollutant's concentration, 
revealing the relative importance of each process.  Process analysis is particularly useful for 
understanding the effects from model or input changes.  CMAQ provides the capability to 
perform process analyses using two different pieces of information: Integrated Process Rates 
(IPRs) and Integrated Reaction Rates (IRRs). 

• 

• 

The IPRs are obtained during a model simulation by computing the change in 
concentration of each species caused by physical processes (e.g., advection, diffusion, 
emissions), chemical reaction, aerosol production, and aqueous chemistry.  Values provide 
only the net effect of each process.  IPRs are particularly useful for identifying 
unexpectedly low or high process contributions which could be indicative of model errors. 

The IRR analysis involves the details of the chemical transformations.  For gas-phase 
chemistry, the CCTM has been designed to compute not only the concentration of each 
species, but also the integral of the individual chemical reaction rates.  IRR analyses have 
typically been used to understand the reasons for differences in model predictions obtained 
with different chemical mechanisms. 

1.4.2  Aggregation (Chapter 17) · 

In support of sID:dies mandated by the CAAA-90, CMAQ can be used to estimate deposition and 
air pollutant concentrations associated with specific levels of emissions. · Asse~sment studies 
require estimates of ozone, acidic deposition, particulate matter as well as visibility, on seasonal 
and annual time fr~es. A statistical procedure called the "aggregation" has been dev.eloped and 
is provided for the CMAQ to derive  the required seasonal and annual est~mates .. This· 
methodology is an efficient technique and can be used instead of executing multiple CMAQ model 
runs for the intended period of averaging. 

A typical CMAQ simulation provides hourly air quality fields for regional to urban scales for 
multi-day episodes, typically up to five days in duration.  The new PM2.5  standard includes an 
annual average value, so· utilization of CMAQ for PM2.5  will require the use aggregation 
techniques in order to estimate annual average PM25 values._ . One such technique, initially 
developed for RADM wet deposition applications, was recently modifie~ and successfully applied 
to PM2_5  by Eder and LeDuc ( 1996).  The approach utilizes visibility data as a surrogate for PM2_5, 
and it will be applied to CMAQ on a.continental scale (i.e., contiguous United States, southern 
Canada, and northern Mexico).  Future efforts will be needed to validate this approach when a 
network of PM2_5  samplers is deployed; also, aggregation approaches for me~oscale domains will 
need to be developed perhaps utilizing the method by Eder and LeDuc (1994). 

1.5  Management of CMAQ Science Information Objects and Codes in Models-3 

The CMAQ source code is managed through the Models .. 3 framework to make the CMAQ 
modeling system more efficient and ea·sier to use by applying a program control processor, 
management and integration of source code, and implementing a modularity concept.  .Thes~ 
techniques also help users customize CMAQ for their own modeling applications without so~ce 
code modifications. 

1.5.1  Program Control Processors (Chapter 15) 

Certain science information, such as grid and layer definitions and dimensions~ chemical 
mechanisms, species list, model configurations, and-episode (case) speCification, is used 
repeatedly across the several process components in Models-3 CMAQ modeling system. 
Program control processors are a set of programs embedded in the Models-3 framework to 
handle these science information components and their codes. ·Program Control Processing (PCP) 
refers to setting up internal arrays, mappings of species names in the input processors, defining 
global parameters, and establishing linkages among processors in the CMAQ system.  PCP allows 
users to define globally shared information on model components, and it uses that information to 
generate the global FORTRAN include files required for building a model in CMAQ. 

1.5.2  CMAQ Code Integration (Chapter 18) 

CMAQ's modularity facilitates efficient coordination of development work and management of 
the science codes.  Chapter 18 describes the modularity concepts, code management method, and 
integration schemes of CMAQ science code with the Models-3 framework.  Integrating the 
CMAQ code into the Models-3 framework is achieved by following a set of design, coding, and 
implementation standards that include: 

• 

• 

• 

A standard subroutine interface at the module level 

The restriction of coding practices to avoid practices that can conceal data dependencies, 
hinder maintenance and foster hidden bugs 

The Models-3 Input/Output Applications Programming Interface (1/0 API) 
(http://www.iceis.mcnc.org/EDSS/ioapi/index.html/), which contains standardized file I/O 
functions.  The 1/0 API is an interface built on top of self-describing netCDF 
(http://www.unidata.ucar.edu/packages/netcdf/) files that are portable across most Unix 
platforms. 

1.6 

Post Release Studies and Near-Future Plans 

1.6.1  CMAQ Evaluation Study 

It is important to conduct extensive evaluation of the CMAQ. Subsequent to the initial release of 
the Models-3/CMAQ, the development team is engaged in a substantial program of evaluation. 
The scope of the effort includes analyses of the  performance and veracity of each individual 
process module as well as the integrated air quality system.  Findings from this evaluation can be 
incorporated into future releases of the CMAQ modeling system.  The degree and rigor of this 
evaluation provides the basis for understanding the strengths or weaknesses of the current state(cid:173)
of-science in CMAQ. The evaluation of the initial release version of CMAQ is underway for three 
nested grids with 36, 12, and 4 km grid resolutions.  With these results, CMAQ's performance 
can be evaluated on both the regional and urban scales. This model evaluation activity for CMAQ 
will be staged with the initial efforts to show relative performance against the RADM model, 
which has undergone extensive model evaluation efforts.  Diagnostic evaluation will continue 
using databases from different regional studies such as the 1995 Southern Oxidant Study 
conducted in the vicinity ofNashville, TN and the 1995 NARSTO-NE study. 

1.6.2  Testing Operational Configurations 

CMAQ can be configured for a wide range of applications from science studies and investigations 
to regulatory applications.  While the scientific community can take advantage of the CMAQ open 
system and flexibility to create alternative applications of CMAQ for research and development 
purposes, regulatory applications depend upon a standardized, evaluated form of CMAQ.  The 
CMAQ evaluation program will provide the scientific benchmark needed for this.  As science 
advances in CMAQ, future configurations of a more operational nature can also be periodically 
re-benched as appropriate.  As understanding of atmospheric processes improves, it is a natural 
tendency for models to become more complex and have increased computational demands. 
Efforts are underway to improve model computational efficiencies to compensate for this. 

1.6.3  Extensions and Science Additions 

Two major extensions are planned for the CMAQ modeling 

• 

• 

A version of the SAPRC-97 gas phase mechanism will be incorporated into CMAQ, in 
addition to the current CB-IV and RADM2 mechanisms available.  The initial 
configuration of SAPRC will be in a fixed parameter mode, with a preset number of 
organic species.  Another possible future implementation of SAPRC will allow the user to 
select from about 100 organic surrogate species in the semi-explicit SAPRC mechanism to 
construct a user-defined, smaller SAPRC mechanism.  Another approach for representing 
gas-phase chemistry in CMAQ is also being developed.  It will use a limited number 
reactive entities termed "morphecules" to include in the chemical reactions while using a 
much larger number of chemical species (singly or lumped) called allomorphs to provide 
extra chemical detail.  This latter approach provides a means for including a much more 
detailed representation of atmospheric chemistry than conventional chemical mechanisms 
without significantly increasing computational burden, albeit at the expense of additional 
computer memory. 

A new emissions processor will be implemented which is called the ~Sparse Matrix 
Operator Kernel Emissions modeling system (SMOKE) 
(http://enypro.ncsc.org/productsD.  The linear operations used in emission processing can 
be represented as multiplications by matrices.  Since most entries in these matrices are 
zeros, the SMOKE model formulates emissions modeling in terms of sparse matrix 
operations that require considerably less time to perform than current systems.  Efficiency 
is enhanced even further when considering variations in emissions projections from base 
. case scenarios by temporally modeling once per episode, calculating gridding matrices 
only· once per grid, and calculating speciation matrices only once per chemical mechanism. 

Development and testing of several science options is underway for incorporation into future 
releases of the CMAQ.  These include an advanced surface-PBL linked system (Pleim and Xiu, 
1995), optional meteorological processors such as the Regional Atmospheric Modeling System, 
RAMS, and an advanced 4-D Photolysis Rates Processor. 

· 

1. 7 

Opportunities and Encouragement for Long Term Extensions and Science 
Community Involvement 

The Models-3/CMAQ concept is based on an open system design, we encourage the full 
participation and involvement of the scientific and modeling communities in the growth and use 
ofModels-3 CMAQ.  As described in this document, the Models-3  CMAQ system has flexibility 
for incorporating scientific and modeling advances into CMAQ processors, for testing of 
alternative modeling techniques for science processes, and for extending its current capability to  . 
handle multimedia environmental issues.  Additionally, the community of users should be vigilant 
in performing evaluations against improved databases and measurement technology to assess the 
realism of model performance and to measure the strengths and weaknesses of the current state of 
the-science as presented in the CMAQ modeling system.  Some suggestions for extensions and 
community involvement are provided below, but certainly not limited to: 

(1)  Modeling airborne and deposition of atmospheric toxic pollutants:  A key opportunity for 
CMAQ is the development of a modeling capability for toxic pollutants into the CMAQ chemical 
transport modeling system.  Models of airborne toxic pollutant provide an important tool for 
understanding the transport and chemical pathways that are concerns to human exposure 
assessments and for risk assessments and its management.  It also provides a powerful means to 
assess the exchange of toxic compounds between the atmosphere and sensitive ecosystems. 
However, developing such models is challenging.  Air toxics arise from a wide variety of sources, 
which may have a wide range of chemical lifetimes and reactivity.  Consequently, their 
toxicological impacts as well as their time-space distributions may be highly variable.  These 
complex mixtures of reactive compounds can exhibit wide range and variability in physical 
properties and exist at various gas, liquid or particulate ambient metastates.  Modeling paradigms 
might evolve from introducing gas-particulate partitioning of the semi-volatile species (Ching et 
al., 1997) to more fundamental modeling with detailed chemical mechanisms. 

(2)  Development of modeling capability to link with human exposure models:  With the ability to 
simulate toxic pollutant processes in addition to the current photochemical oxidants and 
particulates, it is planned to transport the CMAQ model to a finer than urban scale to link with 
human exposure models.  International efforts to determine and understand the etiology of 
adverse human effects of air pollutants, especially those that or associated with fine particles is 
underway.  Modeled concentrations of air pollutant constituents at neighborhood scales when 
coupled with the limited numbers of sampling provide a powerful basis for driving human 
exposure models.  With this necessary data, human exposure models provide a basis for the 
causality studies and for risk assessment research.  Models haye not yet been developed to predict 
the spatial and temporal distributions of the various causal pollutant classes under current 
consideration at the neighborhood scale.  The downscaling requirements represent a great 
challenge to the scientific basis in current meteorological processors. 

(3)  Advanced data assimilation capability:  As air quality modeling efforts extend to finer 
horizontal resolutions and time scales, it becomes increasingly important to make use of higher 
frequency asynoptic meteorological data such as satellite, radar wind profilers and NEXRAD. 
There is a need  to develop and extend data assimilation techniques to these meteorological data 
sources.  Improved methods for introducing cloud information into the CMAQ should also be 
investigated. Such fields have significant impact on chemical photolysis rates, the atmospheric and 
surface energy budgets, the stability and dispersive power of the boundary layer, and aqueous 
chemistry. 

(4)  Development of an air quality predictive mode:  With further development of the emissions 
and meteorological modeling systems, plans include developing a predictive capability in the 
CMAQ modeling system.  CMAQ is currently developed in retrospective mode for performing 
assessments and for implementation of the National Ambient Air Quality Standards (NAAQS).  In 
principle, CMAQ may be extended to a forecast mode in order to provide air quality advisories 
for pollutants such as ozone and visibility and for operational support for issues such as smoke 
and PM/haze from prescribed fires.  These capabilities will require the development and testing of 
day-specific emissions inventories and a real time data processing system for the meteorological 
mode. 

( 5)  Up and downscale links to global scale models:  New linkages with other areas of modeling, 
including scale and media, are envisioned.  It is hoped that information from the urban and 
regional CMAQ applications and from global modeling applications can be bridged.  Because 
CMAQ offers the state of science to simulate atmospheric process as realistically as possible at 
time scales commensurate with reality, CMAQ output can be used to benchmark or examine the 
parametric basis of process formulations in global models.  From a downscale perspective, global 
model output can be used to improve or enhance the initial and boundary conditions in CMAQ 
regional and urban scale simulations. 

(6)  Ecosystem modeling:  Efforts to combine environmental modeling techniques to encompass 
an entire ecosystem is needed to address issues including: (a) nutrient cycle modeling, which 
includes pathways through the atmosphere, water bodies, and soil; and (b) acidic wet and dry 
deposition into sensitive ecosystems, including critical load analyses.  With this ecosystem 
modeling approach, air quality issues can be studied in combination with other aspects of 
environmental health.  For example, nitrogen deposition can cause adverse nutrient loadings to 
ecosystems that can result in a reduction of water quality due to adverse biological responses. 
Further, toxic deposition can lead to adverse indirect hun1an exposure from bioaccumulation 
through the food chain. 

1.8 

References 

Binkowski, F.S., and U. Shankar,  1995: The Regional Particulate Model: Part I.  Models 
description and  preliminary results. J.Geophys.  Res., 100(Dl2): 26191-26209. 

Bott, A.,  1989: A positive definite advection scheme obtained by nonlinear renormalization of the 
advective fluxes, Mon.  Wea.  Rev.  117:  1006-1015. 

Byun D. W., A. Hanna, C. J.  Coats, and D. Hwang, 1995a: Models-3 air quality model prototype 
science and computational concept development.  Transactions of Air &  Waste Management 
Association Specialty Conference on Regional Photochemical Measurement and Modeling 
Studies, Nov. 8-12, San Diego, CA.  1993, 197-212. 

Byun, D. W., C. J.  Coats, D. Hwang, S. Fine, T. Odman, A. Hanna and K. J.  Galluppi,  l 995b: 
Prototyping and implementation of multiscale air quality models for high performance computing. 
Mission Earth Symposium, Phoenix, AZ, April 9-13, 1993. 527-532. 

Byun, D.W., D. Dabdub,  S. Fine,  A. F. Hanna, R.  Mathur, M. T. Odman, A. Russell, E. J. 
Segall, J. H. Seinfeld, P. Steenkiste, and J. Young, 1996:  Emerging· Air Quality Modeling 
Technologies for High Performance Computing and Communication Environments, Air Pollution 
Modeling and Its Application XI, ed. S.E. Gryr).ing and F. Schiermeier. 491-502. 

Byun, D.W., J.K.S. Ching, J. Novak, and J. Young,  1997:  Development and Implementation of 
the EPAis Models-3 Initial Operating Version: Community Multi-scale Air Quality (CMAQ) 
Model, 1998a: Twenty-Second NATO/CCMS International Technical Meeting on Air Pollution 
Modelling and Its Application, 2-6 June, 1997.  Air Pollution Modeling and Its Application XII, 
ed. S.E. Gryning and N. Chaumerliac, Plenum Publishing Coorp. 357-368. 

Byun, D.W., J. Young., G.  Gipson., J.  Godowitch., F. Binkowsk, S. Roselle, B. Benjey, J.  Pleim, 
J.K.S. Ching., J. Novak, C.  Co~ts, T. Odman, A. Hanna, K. Alapaty, R.  Mathur, J.  McHenry, U. 
Shankar, S. Fine, A. Xiu, and C. Jang,  1998b: Description of the Models-3 Community Multiscale 
Air Quality (CMAQ) model.  Proceedings of the American Meteorological Society 78th Annual 
Meeting, Phoenix, AZ, Jan.  11-16, 1998: 264-268. 

Carmichael G.R. and L.K. Peters, 1984a: An Eulerian transport/transformation/removal model for 
802 and sulfate-I. Model development, Atmos.  Environ.  18: 937-952. 

Carmichael G.R. and L.K. Peters, 1984b: An Eulerian transport/transformation/removal model for 
S02 and sulfate-II. Model calculation of SOx transport in the Eastern United States, Atmos. 
Environ.  20:  173-188. 

Carmichael G.R., L.K. Peters, and R.D. Saylor, 1991: The STEM-II regional scale acid 
deposition and photochemical oxidant model-I. An overview of model development and 
applications, Atmos. Environ.  25A: 2077-2090. 

Chang, J.S., P.B. Middleton, W.R. Stockwell, C.J. Walcek, J.E. Pleim, H.H. Landsford, S. 
Madronich, F.S. Binkowski, N.L. Seaman, and D.R. Stauffer, 1990: "The Regional Acid 
Deposition Model and Engineering Model." NAP AP SOS/T Report 4, in National Acid 
Precipitation Assessment Program: State of Science and Technology,  Volume 1.  National Acid 
Precipitation Assessment Program, 722 Jacksn Place, N.W., Washington, D.C., September 1990. 

Chang, J.S., R.A. Brost, LS.A. Isaksen, S. Madronich, P. Middleton, W.R. Stockwell, and C.J. 
Walcek, 1987: A three-dimensional Eulerian acid deposition model: Physical concepts and 
formulation." J.  Geophy.  Res.  92:  14681-14700. 

Ching, J.K.S., D.W. Byun, A. Hanna, T. Odman, R. Mathur, C. Jang, J. McHenry, K.  Galluppi, 
1995: Design requirements for multiscale air quality models. Mission Earth Symposium, Phoenix, 
AZ, April 9-13 p532-538." 

Ching, J.K.S., D.W. Byun, J.  Young, F. Binkowsk., J. Pleim, S. Roselle, J.  Godowitch, W. 
Benjey., and G. Gipson,  1998: Science features in Models-3 Community multiscale air quality 
system. Proceedings of the American Meteorological Society 78th Annual Meeting, Phoenix, AZ, 
Jan.  11-16, 1998:269-273 

Ching, J.K.S., Francis S. Binkowski, and 0. Russell Bullock, Jr., 1997: Deposition of semivolatile 
toxic air pollutants to the Great Lakes: A regional modeling approach. In " Atmospheric 
Deposition of Contaminants to the Great Lakes and Coastal Waters, Ed by Joel Baker, SET AC 
Press.  pp 293-~04. 

Coats, C.  J., A.H. Hanna, D. Hwang, and D.W. Byun, 1995:.Model engineering concepts for air 
quality models in an integrated environmental modeling system.  Transactions of Air &  Waste 
Management Association Specialty Conference on Regional Photochemical Measurement and 
Modeling Studies, Nov. 8-12, San Deigo, CA.  1993, 213·-223. 

Colella, P., and P. L. Woodward, 1984: The Piecewise Parabolic Method (PPM) for gas(cid:173)
dynamical simulations,  J  Comput.  Phys. 54:  174-201. 

Dennis, R, 1998: The Environmental Protection Agency's third generation air quality modeling 
system: An overall perspective. Proceedings of the American Meteorological Society 78th Annual 
Meeting, Phoenix, AZ, Jan.  11-16, 1998: 255-258. 

Dennis, R.L., D. W.  Byun, J.H. Novak, K.J.  Galluppi, C.J. Coats, and M.A. Vouk, 1996:  The 
next generation of integrated air quality modeling: EPA's Models-3. Atmospheric Environment, 
30, No.  12, 1925-1938. 

Eder, B.K., D.H. Coventry, C; Bollinger and T.L. Clark: RELMAP, 1986: A Regional 
Lagrangian Model of Air Pollution User's Guide.  U.S. Environmental Protection Agency Report 
EPA/600/8-86/013, Research Triangle park, NC 146 pp. 

Eder, B.K., J.M. Davis and P. Bloomfeld, 1994: An automatic classificatioJ:! scheme designed to 
better elucidate the dependence of ozone on meteorology. J  Appl. Meteor, 33: 1182-1199. 

Eder, B.K. and S. LeDuc,  1996: Can selected RADM simulations be aggregated to estimate 
annual concentrations of fine particulate matter?  Reprint from the 11th Annual  International 
Symposium on the Measurement of Toxic and  Related Pollutants, May 7-10, 199(>, RTP, NC 
732-739. 

Gillani, N.V., A. Biazar, Y. Wu, J.  Godowitch, J. Ching, R. Imhoff, 1998: The Plume-in-Grid 
treatment of major elevated point source emissions in Models-3.  10th Joint  Conference on 
Applications of Air Pollution Meteorology  with A WMA, January 11-16, 1998, Phoenix, AZ, 
Amer. Meteorol. Soc., Boston, MA. 

Grell, G.A., J. Dudhia, and D.R. Stauffer, 1993:.A description of the Fifth-Generation Penn 
State/NCAR  Mesoscale Model(MM5). NCAR Technical Note,  NCAR/TN-398+IA 

Jacobson M. and R.P. Turco, 1994:  SMVGEAR: A Sparse-Matrix, vectorized Gear code for 
atmospheric models. Atmos.  Environ.  28: 273-284. 

Jeffries, H. E. and S. Tonnesen, 1994: A comparison of two photochemi.cal reaction mechanisms 
using mass balance and process analysis, Atmos. Environ, 28(18): 2991-3003. 

Lamb, R.G., 1983a: A Regional Scale (1000 km) Model of Photochemical Air Pollution,  Part I: 
Theoretical Formulation. EPA-600/3-83-035, U.S. Environmental Protection Agency, Research 
Triangle Park, NC. 

Lamb, R.G.,  1983b: A Regional Scale (I 000 km) Model of Photochemical Air Pollution,  Part 2: 
Input Processor Network Design. EPA-600/3-84-085, U.S. Environmental Protection Agency, 
Research Triangle Park, NC. 

Morris, R.E. and T.C. Meyers, 1990:  User's Guide for the  Urban Airshed Model,  Volume  I: 
User's Manual for UAM(CB-IV).  EPA-450/4-90-007A. U.S. Environmental Protection Agency, 
Research Triangle Park, NC. 

Novak, J., J. Young, D.W. Byun, C.  Coats, G.  Walter, W. Benjey, G.  Gipson, S. LeDuc,  1998: 
Models-3: A unifying framework for environmental modeling and assessments.  Preprint Volume, 
10th Joint AMS and A&WMA Conference on the Applications of Air Pollution Meteorology, 
Phoenix, AZ, Jan 11-16, 1998: 259-263. 

Pleim J.E., and J.S. Chang, 1992: A non-local closure model in the convective boundary layer. 
Atm Environ., 26A: 965-981. 

Pleim, J.E., and A. Xiu, 1995: Development and testing of a surface flux and planetary boundary 
layer model for application in mesoscale models, J.  Appl. Meteor., 34:16-32. 

Wilkinson, J.G., C.F. Loomis, D.E. McNally, R.A. Emigh, and T.W. Tesche, 1994: Technical 
Formulation Document: SARMAPILMOS Emissions Modeling System (EMS-95), Final Report, 
Lake Michigan Air Directors Consortium and the California Air Resources Board, AG-90/TS26 
and AG-90ffS27, 120pp. 

Venkatram, A.K. and P.K. Karamchandani, 1998: The ADOM II Scavenging Module.  ENSR 
Consulting and Engineering Report 0780-004-205.  Camarillo, CA. 

This chapter is taken from Science Algorithms of the EPA Models-3 Community 
Multiscale Air Quality (CMAQ) Modeling System, edited by D. W. Byun and J. K. S. 
Ching, 1999. 

1-18 

Chapter2 
==============

MODELS-3 ARCHITECTURE: A UNIFYING FRAMEWORK FOR 

ENVIRONMENTAL MODELING AND ASSESSMENT 

EPAJ600JR-99J030 

Joan Novak• and Sharon. Leduc·· 
Atmospheric Modeling Division 

National Exposure Research Laboratory 
U.S. Environmental Protection Agency 

Research Triangle Park, NC 27711 

ABSTRACT 

The Models-3 framework and Community Multiscale Air Quality (CMAQ) model were designed 
and built to function together.  The CMAQ science is documented in the other chapters and this 
chapter is intended to provide science and technical details of the Models-3 framework which . 
integrates the CMAQ.  The Models-3 User Manual is available and useful for those who want 
operational details beyond the "big picture" provided in Chapter 2. 

This chapter present the various components of the Models-3 framework (Dataset Manager, 
Program Manager, Science Manager, Study Planner, Strategy Manager, Model Builder, Source 
Code Manager, Framework Administrator, and Tool Manager).  The Tool Manager provides 
access to third party applications for emissions processing, visualization, and analysis.  The 
Framework Administrator provides the system administrator access to system lists and 
administrative functions in Models-3. ·Each of the other components is provided for developing, 
executing, and managing CMAQ applications. 

. 

The computer architecture, the client-server design, the object-oriented data base management 
system, and the graphical user interface are also addressed in this chapter, along with the design 
features ofModels-3. 

·on assignment from the National Oceanic and Atmospheric Administration, U.S. Department of Commerce. 
Corresponding author address: Joan Novak, MD-80, Research Triangle Park, NC 27711.  Email: 
novak.joan@epamail.epa.gov 

.. On assignment from the National Oceanic and Atmospheric Administration, U.S. Department of Commerce. 

2.0  MODELS-3 ARCHITECTURE: A UNIFYING FRAMEWORK FOR 
ENVIRONMENTAL MODELING AND ASSESSMENT 

2.1 

Introduction 

Models-3 is a flexible software system designed to simplify the development and use of 
environmental assessment and decision support tools for a wide range of applications from 
regulatory and policy analysis to understanding the interactions of atmospheric chemistry and 
physics. The initfal version ofModels-3 contains a Community Multiscale Air Quality (CMAQ) 
(Byun, et al.,  1997, and other chapters of this document) modeling system with capabilities for 
urban to regional scale air quality simulation of tropospheric ozone, acid deposition, visibility and 
fine particulate.  The Models-3 framework provides an interface between the user and operational 
models, between the scientist and developing models, and between ever changing hardware and 
software platforms. 

The concept of an integrated modeling and analysis framework (Novak, et al.,  1995; Dennis, et 
al., 1996) was formulated in response to  1) problems and duplication of effort involved  in 
maintaining the separate data pre-processing and post-processing software systems required for 
each model used to analyze different air quallty pollutants or scales, 2) the difficulties States and 
industry encountered using more complex modeling systems, and 3) the large. expense required to 
modify existing models to incorporate scientific advancements or to adapt the models to new 
domains.  Based on technology advances in the National High Performance Computing and 
Communications program, Models-3 was designed to overcome these limitations and to serve as a 
community framework for continual advancement and use of environmental assessment tools. 
Capabilities and design features of the Models-3 framework provide more flexibility in data 
handling, modeling, visualization and analysis. 

2.2 

Overview of the Models-3 Framework 

The Models-3 framework contains components that assist I) the model user with air quality 
modeling studies and analysis of results, and  2)  the model developer with creating, testing, and 
performing comparative analysis of new versions of air quality models.  The major design goal is 
to simplify and integrate the development and use of complex environmental models, beginning 
with air quality and deposition models.  The function of each framework component is described 
below. 

2.2.1  Dataset  Manager 

Dataset Manager provides the user with the capability to register files for use with the modeling 
and analysis programs within the Models-3 framework. The registration process involves entering 
the location of the dataset (full path name) and metadata (information about the data such as 
spatial - temporal extent and resolution, source of data, time convention, units, etc.) into the 
Models-3 data base.  Models-3 follows the Federal Geospatial Metadata Standard for metadata 
content. The datasets may be located on any network-connected computer system  known to the  · 
Models-3 system installed at the user's site. Once a dataset is registered, the user can search for 
the dataset based on its metadata information, file type, etc. 

Dataset Manager allows the user to view the details of the selected dataset to ensure the correct 
one has been selected for use with an application. Dataset registration  eliminates the need for the 
user to type the entire path name each time the dataset is used.  Instead the user can highlight  the 
dataset  from a list of candidates that satisfy  the search criteria specified by the user. Models-3 
will automatically move selected data to the host where it is needed for a model execution. 
Dataset Manager also provides standard  capabilities such as deleting, copying, archiving, and 
restoring files and metadata. 

2.2.2  Program Manager 

Program Manager allows the user to register, update, and  search for executable programs and/or 
scripts to make them available for use in defining studies within the Study Planner component. 
During program registration, the user  enters characteristics of the program into the framework 
including descriptive information on program function, input requirements, output specifications, 
runtime environment variables, target architecture and operating system. Once the program or 
script is registered, this executable can be used in Study Planner to sequence a series of 
executions which may depend on previous executions for input data. The user can access and 
execute programs that are not registered.  However, registering programs ensures that all 
mandatory inputs have been specified and automatic naming and registration of output files is 
activated, to facilitate tracking output from numerous program executions.  Recommended model 
configurations for standard domains are preregistered in the system, eliminating the need for the 
typical user to deal with the details of program registration. 

2.2.3  Study Planner 

Study Planner allows the user to define a study and control the execution of its associated 
processes. A study is a collection of plans and properties that are necessary to describe and 
perform one or more environmental modeling analyses. A plan is a collection of information 
defining dataset and program interdependencies and the sequence of execution of one or more 
programs. Study Planner gathers much of its information from the Program Manager and Dataset 
Manager registration data. The relationship between a program (node) and its required and 
optional datasets (links) is user-defined through the process of constructing and annotating a 
graphical diagram with simple drag-arid-click mouse operations. Once a plan is constructed and its 
graphical diagram fully annotated with desired input datasets and options, the plan can be 
executed.  User specified program options are entered by editing program environment variables. 

Studies and associated plans are named entities that are saved in the system data base. Therefore, 
a typical user can start with an existing study plan provided by the model developer and simply 
change the dataset annotations by selecting, through a file browser, appropriate datasets needed 
for execution. The Study Planner provides capabilities to create new  studies, copy and modify 
existing studies, and delete existing studies. 

2.2.4  Strategy Manager 

Strategy Manager provides the capability to estimate point-, area-, and mobile-source emissions 
for future years and to determine the relative effectiveness of specified control scenarios. The user 
may adjust pollutant growth factors and emissions control factors to perform "what if' analyses 
for entire EPA regions, states, counties or for user-defined study areas.  By applying estimated 
yearly emission growth factors from the Emissions Growth and Assessment System, control 
efficiency, rule effectiveness, and rule penetration factors  to the EPA 1990 base year emissions 
inventory, the Strategy Manager provides estimates of future year (1991  - 2010) emissions for 
carbon monoxide, nitrogen oxide, particulate matter up to 10 microns, sulfur dioxide, and volatile 
organic compounds.  Strategy Manager is based on EPA's Multiple Projection System.  An input 
data processor is included to process the National Emissions Trend (NET) inventory (URL 
http://www.epa.gov/oar/oagpsD data format. 

2.2.5  Tool Manager 

Tool Manager provides access to third-party applications (tools) that are registered with the 
Models-3 framework. Third-party applications that are currently available include Models-3 
Emission Processing and Projection System (MEPPS), Vis5D, Text Editor, Package for Analysis 
and Visualization of Environmental Data (PA VE), SAS®, Arc/Info®, IBM Visualization Data 
Explorer™, DXDriver, and VisDriver. Tool Manager allows the user to add tools to the system 
that will help with the user's  work.  A file converter is included to convert between ASCII, SAS, 
and 1/0 API files. 

2.2.5.1 

Emissions Processing 

The majority of the emissions processing needed to support air quality model applications can be 
prepared through minor modifications to pre-specified emissions plans in the Study Planner. 
However, for those users who need total flexibility in specifying details for emissions preparation, 
the Models-3 Emissions and Projection System (MEPPS) (Benjey and Moghari, 1996) is available 
for interactive processing of emissions. MEPPS provides capabilities to  input and perform quality 
control on emission inventory data, and  reformat  and subset data for the user-specified modeling 
domain. The main emissions processing is performed by a significantly revised version of the 
Geocoded Emission Modeling and Projection (GEMAP) (Wilkinson and Emigh,  1994)  system 
which requires the user to have Arc/Info® and SAS® licenses for operation. This Emissions 
Processor (EMPRO)  transforms the annual county based emissions inventories into spatial and 
temporal resolutions that are  consistent with the target  model application, i.e. typically hourly 
gridded emissions for a selected domain. The processor also estimates mobile and biogenic 
emissions and performs chemical speciation consistent with the chemical mechanism in the target 
model.  Mobile emission factors are calculated using Mobile Sa; biogenic emissions are calculated 
using the Biogenic Emissions Inventory System (BEIS2).  Finally, according to a user-specified 
criteria, an output processor merges the emissions files to provide the 2-D gridded files and a 
point source stack emissions file required for the model execution. The user is offered numerous 
choices for interactively changing parameters and reviewing results in all of the emissions 
components. The global science specifications created by the user in Science Manager are 
accessible from within MEPPS to ensure consistency when desired. 

2.2.5.2 

Visualization and Analysis Tools 

Several freely available visualization tools are accessible from the Models-3 framework as well as 
commercial vis;ualization and statistics packages, such as IBM Visualization Data Explorer™ and 
the SAS®.  A graphical user interface component, VisDriver, provides an interface for finding and 
selecting Models-3 data files on local or remote hosts and launches  visualization applications with 
Vis5D or PA VE.  VisDriver performs requisite data conversions from the internal Models-3 data 
format to the data format required by these third party visualization packages. VisDriver also 
provides a data export capability  to such formats as Advanced Visualization System (A VS™), 
Flow Analysis Software Toolkit (FAST™), and an ASCII spreadsheet. On-line help is available to 
assist the user with these visualization tools 
(http ://www.epa.gov/asmdnerl/models3/vistutor/user/user-guide-OO .html). 

PAVE 

The Package for Analysis and Visualization for Environmental data (PA VE), developed at the 
North Carolina Supercomputing Center ofMCNC, allows the user to visualize 2-D multi-variate, 
gridded environmental data with smooth tile plots,3-D mesh plots, time series line and bar plots, 
vertical cross sections, wind vectors, and scatter plots.  More information can be found at 
http://www.iceis.mcnc.org/EDS Sf pave_ doc/Pave.html. 

Vis SD 

Vis5D, a public domain package developed at the University of Wisconsin Space Science and 
Engineering Center,  provides interactive visualization of large five-dimensional gridded datasets -
the data are real numbers at each point of a grid  that spans three space dimensions, one time 
dimension, and a dimension for enumerating multiple physical variables. Vis5D provides 
isosurfaces, contour line slices, colored slices, volume rendering of data in 3D, and rotation and 
animation of the 3D image in real time. There is also a feature for wind/trajectory tracing. More 
information can be found at http://www.ssec.wisc.edu/~billh/vis.html. 

IBM Visualization Data Explorer 

IBM Visualization Data Explorer™, a commercial visualization package, has been used to create 
custom visualizations to support diagnostic evaluation of the air quality models with visualization 
of multiple/nested grids, terrain following grids, grid cell time aggregate statistics such as 
maximum  ozone concentration and hours of non-compliance, comparison of measured aircraft 
data with model predictions along the path of flight, and detailed chemical analysis of the 
integrated reaction rates predicted over space and time in the air quality models. Other standard 
visualization capabilities for scalar and vector quantities, 2-D and 3-D graphs have also been 
integrated through the  DXDriver interface. 

2.2.6  Science Manager 

Critical model specifications typically found hardwired in air quality model codes, such as details 
of the horizontal coordinate system, specification of horizontal grid dimensions, vertical layers, 
chemical mechanism specification (reactions and rate constants), etc. are treated as globally 
shared information in the Models-3 framework.  Use of this global information enables more 
consistency throughout the system (i.e. emission, meteorological, and chemistry-transport 
components).  Detailed specifications for these key science components are entered by the user 
only once using Science Manager graphical user interfaces.  These specifications are saved as 
named entities in an object-oriented database accessible by all model components.  A typical user 
would access and modify previously defined Science Manager components to define a new 
modeling domain. 

The functionality of Science Manager, however, is targeted to the model developer to facilitate 
experimentation with new model components.  For example, extensive research is done on 
improving photochemical mechanism specifications.  One component of Science Manager enables 
the model developer to either edit an existing chemical mechanism  or import a new set of 
chemical reactions, specify chemical species, molecular weights, etc.  Both the Regional Acid 
Deposition Model, Version 2  (RADM-2)  and the Carbon Bond-4 mechanisms are available in 
the Models-3/CMAQ framework and the State Air Pollution Research Center (SAPRC) chemical 
mechanism is being modified to fit within this paradigm to facilitate comparative studies with 
these chemical mechanisms.  As long as the chemical species in any modified mechanisms are 
present in source emission profiles associated with Source Classification Codes (SCC), the 
chemical mechanism specification will propagate to the emission processing subsystem to enable 
generation of emission species consistent with the newly defined chemical mechanism. 

2.2. 7  Model Builder 

The Models-3 framework facilitates the interchange of science components within a model, 
customization of the  chemistry mechanism, and changes in the modeling domain, horizontal grid 
resolution, and  vertical layering without the need for reprogramming. Modifying an existing 
model or building a new model is a two-step process.  First, the model developer must use 
Science Manager to specify the horizontal coordinate system, horizontal grid dimensions, vertical 
layers, chemical mechanism, and select science modules for each class (i.e. advection, diffusion , 
cloud process, etc.) of science process to be included in the new model.  Module selections are 
contained in a named c<;mfiguration file.  After the needed science components are specified, the 
model developer uses Model Builder to select from available science ·specifications and 
configuration files to create· a single custom model executable. 

2.2.8  Source Code Manager 

CMAQ source code is distributed. with the Models-3 framework  to provide the user flexibility to 
create a model for a user specified domain  or to allow a user to build a new ·executable with a 
selected chemistry mechanism. Model Builder uses Source Code Manager to access appropriate 
source code to transform the user's selections into· a working executable. Source Code Manager 
allows a user to  retrieve aversion ofa source code file; modify it, and return it to the code 
archive after the change has been tested. Source code should only be modified by knowledgeable 
model developers.  Source· Code Manager is based on Concurrent Versions System 
(CVS)/Revision Control System (RCS) public domain software for code configuration 
management and tracks the history and version numbers for all source code changes.  These 
version numbers become part of the history information associated with each output file; 

2.2.9  Framework Administrator 

The Framework Administrator subsystem menu allows the Models-3 system administrator to 
manipulate system lists and to access administrative functions of other Models-3 subsystems. 
System lists include users, hosts, device types, site IDs, file format types, compiler names, 
operating system names, platform names, and time zone names. Through this subsystem, only the 
authorized  system administrator can set access controls for users, add or delete entries from the 
system lists, and maintain the integrity of controlled files. 

2.3  Models-3 System Architecture 

-

The Models-3 framework is designed as a three-tier client-server architecture with an object-
oriented data base management system (OODBMS) ,ObjectStore™,  to store persistent data (i.e. 
studies, horizontal grid definitions, metadata containing pointers to physical dataset locations , 
etc.). When the user brings up the Models-3 graphical user interface on user's desktop system, the 
user becomes a "client" requesting services from a "server".  Several Models-3 servers act as 
"clients" requesting services from other Models-3 "servers".  The client and server can be on the 
same machine or on separate machines giving the system scalability by either adding more client 
workstations with only slight impact on performance, or moving to faster and larger server 
machines. Each of the subsystem functions described in Section 2.2 is implemented as a server 
and can be can run on different machines;  The Models-3  servers were initially developed on a 
Sun workstation using the Solaris 2.5.1  operating system (Models-3 Version 2.1).  Models-3  is 
being ported to a Sun· Solaris 2.6 operating system (Models-3 Version 2.2).  The next server to be 
released for Models-3 will be SGI (late 1998).  ·Models.:3 Version 3 (summer 1999) will allow 
server to be a PC with a Windows NT® operating system. 

This client-server architecture in conjunction with commercial cross-platform communications 
interface - ORBIXTM by Iona Technologies, Ltd. which is compliant with the Common Object 
Request Broker Architecture (CORBA) standard - and an OODBMS containing pointers to 
datasets distributed over the network enables transparent use of multiple computing platforms and 
access to data across the network.  Figure 2-1  illustrates a possible configuration for multiple 
installations for Models-3 software.  Each independent site must have at least one server to 
support the local OODBMS and Models-3 sessions.  Each site can run autonomously.  A two(cid:173)
server configuration is recommended at each installation:  one to support emissions processing 
activities, and the second to support other client-server and model computations.  Of course, 
additional servers will improve performance for larger applications and the current version of 
Models-3 also supports batch submissions of model executions to a supercomputer with job status 
reporting back to the framework through the standard Network Queuing Service (NQS).  In the 
future, we envision maintaining a master database to foster sharing of data and to minimize 
duplication of effort. 

State Offices 

Public Access 

Federal Agencies 

Figure 2-1.  Seamless Computing and Data Management 

from PC to Scalable Parallel Computer 

To adapt to ever changing hardware and software, ·the framework uses a layered  interface design 
that isolates critical system components, thus minimizing the impact of hardware and software 
upgrades. Each layer, as seen in Figure 2, is connected to its adjacent layer(s) by a well specified 
interface thus easing the task of replacement if a more advanced component becomes available. 
Another key design choice  is the use of an input/output application programming interface (I/O  . 
API) for the data access layer. This concept is implemented by using a standard FORTRAN or C 
callable library for all input/output in the air quality model codes. Thus 1/0 efficiencies can be 
improved by replacing  this centralized library or new data types can be handled by adding new 
routines to the library. 

The 1/0 API is layered on top of the netCDF standard·data file format developed at the National 
Center for Atmospheric Research. This data format uses the underlying eXtemal Data 
Representation (XDR),  which is IEEE (Institute of Electrical and Electronics Engineers, Inc.) 
compliant and, therefore, enables cross-platform transfer of data without conversion.  The 
Models-3 implementation conforms to the netCDF specification, but sets additional conventions 
for information stored in the file header. NetCDF is a self documenting file format that contains 
complete specifications (parameter names, units, etc) for the file contents. All netCDF records can 
be accessed via direct access methods to minimize data access times.  When  registering 
conforming  programs, the Models-3 framework automatically writes execution history 
information to the file header record  of each output file and to the OODBMS metadata 
associated with the output file.  The history information, which establishes traceability of output 
datasets to the model that generates them, contains the date/time of model execution, the version 
numbers of the science process modules contained in the model executable, Science Manager 
specification names, host computing environment, and other pertinent information.  Science 
Manager's global shared data objects and the netCDF format are the key aspects of building "plug 
compatible" science modules that conform to Models-3 guidelines. 

USER 

INTERFACE 

USER 

INTERFACE 

Management Layer: 

Data  Manager 
Program  Manager 
Study  Manager 
Strategy Manager 
Tool Manaqer 

Science Manager 
Model Builder 
Source Code  Manager 
Framework Administrator 

Environment Layer: 

OS,  System  "Personality" 

Com putatlona/ Layer:  Programs:  models, analysis, visualization, ••. 

Data  Access Layer: 

110  Application Programming Interface 

Data  Structure/Representation:  netCDF, XOR 

Data  Storage: 

File systems &  databases 

Physical Device Layer:  Disks, networks, printers, machines 

Figure 2-2.  Architectural Layering: Flexibility for Future Change 

Schedule and Future Plans 

The Models-3 framework provides a unifying foUn.dation for continual con:imunity evolvement of 
environmental modeling and assessment tools with possible extensions beyond the current air 
quality implementation.  The use of the Models-3 framework for multimedia exposure and risk 
assessment is possible.  A simple integration of the Hydrologic Simulation Program FORTRAN 
(HSPF) and the Chesapeake Bay Water Quality Model (CBWQM) in the Models-3 framework 
explored multimedia model linkage capabilities.  Maintaining Models-3 framework to use 
emerging computing capabilities and transferring that capability to science researchers and 
environmental decision makers will continue to be the focus of the Models-3 effort. 

2.5 

References 

Benjey, W.G., and N.M. Moghari. Functionality of an integrated emission preprocessing system 
for air quality modeling: the Models-3 emission  processor.  In The Emissions Inventory: 
Programs &  Progress. VIP-56.  Proceedings of a Specialty Conference, Research Triangle Park, 
NC, October 11-13, 1995. US Environmental Protection Agency, Research Triangle Park, NC, 
and Air &  Waste Management Association, Pittsburgh, 463-471  (1996). 

Byun, D., J.  Young, J. Gipson, J.  Godowitch, F. Binkowski, S. Roselle, B.  Benjey, J. Pleim, J. 
Ching, J. Novak, C. Coats, T. Odman, A. Hanna, K.  Alapaty, R.  Mathur, J. McHenry, U. 
Shankar, S. Fine, A. Xiu, and C. Jang.  Description of the Models-3 Community Multiscale Air 
Quality (CMAQ) model.  Proceedings of the American Meterological Society 78th Annual 
Meeting, January 11-16, 1998, Phoenix, AZ. 

Dennis, R.L., D.W. Byun, J.H. Novak, K.L. Galluppi, C.J. Coats, M.A. Vouk. The Next 
Generation oflntegrated Air Quality Modeling: EPA's Models-3. Atmospheric Environment, Vol. 
30, No.12, pp.  1925 - 1938, (1996). 

Emission Inventory Improvement Program.  URL http://www.epa.gov/oar/oaqps/eiip/ 

Novak, J.H., R.L. Dennis, D.W. Byun, J.E. Pleim, K.J. Galluppi, C.J. Coats, S.  Chall, M.A. 
Vouk. EPA Third-generation Air Quality Modeling System, Volume 1:  Concept. EPA 
600/R95/084, National Exposure Research Laboratory, Research Triangle Park, NC, 55 pp. 
(1995). 

Wilkinson, J.G., and Emigh, R.A.  The Geocoded Emissions Modeling and Projections System 
(GEMAP):  Advanced Training Workshop.  Prepared for Environmental Protection Agency, 
Office of Research and Development, by Alpine Geophysics, Boulder, CO (1994). 

2-10 

This chapter is taken from Science Algorithms of the EPA Models-3 Community 
Multiscale Air Quality (CMAQ) Modeling System, edited by D. W. Byun and J. K. S. 
Ching, 1999. 

EPA/600/R-99/030 

2-11 

EPA/600/R-99/030 

Chapter 3 
=======================

DEVELOPING METEOROLOGICAL FIELDS 

Tanya L. Otte* 

Atmospheric Modeling Division 

National Expostlre Research Laboratory 
U. S. Environmental Protection Agency 

Research Triangle Park, NC 27711 

ABSTRACT 

Meteorological data are important in many of the processes simulated in the Community 
Multiscale Air Quality (CMAQ) model included in the first release of the Models-3 framework. 
The meteorology model that has been selected and evaluated with CMAQ is the Fifth-Generation 
Pennsylvania State University/National Center for Atmospheric Research (NCAR) Mesoscale 
Model (MM5).  All software in the Penn State/NCAR mesoscale modeling system has been 
dedicated to the public domain and is presently used for both research and operational purposes 
at many organizations worldwide.  Improvements to MMS within the meteorological community 
are ongoing, and these enhancements should be evaluated for their applicability to air quality 
modeling.  Other meteorological models are being considered for compatibility with CMAQ but 
are not provided with the initial release.  The application of MMS with CMAQ is described in 
Chapter 3. 

*on assignment from the National Oceanic and Atmospheric Administration, U.S. Department. of Commerce. 
Corresponding author address: Tanya L. Otte, MD-80, Research Triangle Park, NC 27711.  Email: 
tlotte@hpcc.epa.gov 

DEVELOPING METEOROLOGICAL FIELDS 

3.1 

Credits and Disclaimers for Use of MM5 

The Fifth-Generation Pennsylvania State University/National Center for Atmospheric Research 
(NCAR) Mesoscale Model (MM5) was developed in cooperation with Penn State and the 
University Corporation for Atmospheric Research (UCAR).  Penn State and UCAR make no 
proprietary claims, either statutory or otherwise, to this version and release of MM5, and they 
consider MM5 to be in the public domain for use by any person or entity without any fee or 
charge.  Penn State and UCAR shall be credited in any publications that result from the use of 
MM5.  The names "Penn State" and "UCAR" shall not be used or referenced in any advertising 
or publicity that endorses or promotes any products or commercial entity associated with or 
using MM5, or any derivative works thereof, without the written authorization ofUCAR and 
Penn State. 

MM5 is provided to the public by Penn State and UCAR on an "as is" basis, and any 
warranties, either express or implied, including but not limited to implied warranties of non(cid:173)
infringement, originality, merchantability, and fitness for a particular purpose, are disclaimed. 
Neither UCAR nor Penn State will be obligated to provide the user with any support, consulting, 
training, or assistance of any kind regarding the use, operation, and performance of MM5, nor 
will they be obligated to provide the user with any updates, revisions, new versions, error 
corrections, or "bug" fixes.  In no event will UCAR and Penn State be liable for any damages, 
whatsoever, whether direct, indirect, consequential, or special, which may result from an action in 
contract, negligence, or other claim that arises out of or about the access, use, or performance of 
MMS, including infringement actions. 

Data that are obtained from NCAR (e.g., global analyses and observations) are prepared and 
maintained by the Data Support Section, Scientific Computing Division, NCAR.  NCAR is 
operated by UCAR and is sponsored by the National Science Foundation.  Any published 
research that uses data from the NCAR archive shall credit the maintainers of the archive.  In 
addition, the original source(s) of data shall be acknowledged. 

3.2  Meteorology Model Pre-Processing 

Before the meteorology model can be run, several smaller ("pre-processing") programs must be 
run to set up the domain for the simulation and to generate a set of initial and boundary 
conditions for the meteorology model.  The pre-processing programs are briefly described in this 
section. 

3.2.1  Defining the Simulation Domain (TERRAIN) 

Domains for the meteorology simulations are defined by several primary parameters: number of. 
grid points in each horizontal dimension, grid spacing, center latitude, center longitude, map 
projection (Mercator, Lambert conformal, or polar stereographic), and number of "nested" 
domains and their horizontal dimensions.  (Some other user-specific parameters are also defined 
based on the primary parameters, as required.)  These parameters are processed by a program 
that is executed only when a new domain location is required.  This program, TERRAIN, makes 
use of high-resolution global terrain and land use data sets to create "static files" for the domain. 
The static files currently include values for each grid point for terrain height and land use 
specification (e.g., deciduous forest, desert, water).  Future versions of TERRAIN may include 
additional diurnal, seasonal, and location-specific information.  The TERRAIN program is 
thoroughly described by Guo and Chen (1994). 

3.2.2  Processing the Meteorological Background Fields (DATAGRID) 

After the simulation domain has been established, the program DATA GRID is run to process the 
meteorological background fields.  DATA GRID generates first-guess fields for the model 
simulation by horizontally interpolating a larger-scale data set (global or regional coverage) to the 
simulation domain.  DATA GRID interpolates the background fields to the simulation domain for 
times throughout the simulation period; these files are used ultimately to generate lateral 
boundary conditions for the coarse-domain simulations.  (Nested domains obtain lateral boundary 
conditions from the coarse domain.)  DATAGRID also processes the sea-surface tt'..mperature and 
snow files by interpolating the analyses to the simulation domain.  Lastly, DATA GRID calculates 
map-scale factors and Coriolis parameters at each grid point to be used by MM5.  The 
DATA GRID program is thoroughly described by Manning and Haagenson (1992). 

3.2.3  Objective Analysis (RA WINS) 

The program RA WINS performs an objective analysis by blending the first-guess fields generated 
by DATAGRID with upper-air and surface observations.  There are four objective analysis 
techniques available in RA WINS.  The following descriptions are taken largely from Dudhia et al. 
(1998). 

The Cressman scheme assigns a circular radius of influence to each observation.  The 
weights associated with the observations decrease radially from the observation to the 
radius of influence.  The first-guess (meteorological background) field at each grid point is 
adjusted by taking into account all observations that influence that grid point.  (See 
Cressman, 1959.) 

The Ellipse scheme alters the Cressman circles for analyses of wind and relative 
humidity by elongating the circles along the wind flow.  The eccentricity of the ellipses 
increases as wind speed increases.  This scheme reduces to the Cressman scheme under 
light wind conditions.  (See Benjamin and Seaman, 1985.) 

The Banana scheme alters the Cressman circles for analyses of ·wind and relative 
humidity by elongating the circles in the direction of the flow and curving the influence 
region along streamlines.  The resulting influence region is banana"'Shaped.  This scheme 
reduces to the ellipse scheme under straight-flow conditions,. and it further reduces to the 
Cressman scheme under light wind conditions.  (See Benjamin and Seaman, 1985.) 

The Multiquadric Interpolation scheme uses hyperboloid radial basis functions to 
perform objective analysis.  This scheme takes much more time and memory than the 
Cressman-based schemes.  This scheme must be used ·with caution in data-sparse regions 
and when more than 25% of the domain is water-covered.  (See Nuss and Titley, 1994.) 

In addition, RA WINS performs some data quality control checks and buddy checks with user(cid:173)
defined thresholds.  The objective analysis is performed for a user-defined number of pressure 
surfaces (generally mandatory levels plus some additional surfaces).  RAWINS is also used to 
prepare the analyses for the analysis nudging in the simulation model.  The RA WINS program is 
thoroughly described by Manning and Haagenson (1992). 

3.2.4  Setting the Initial and Boundary Conditions (INTERP) 

The "standard" INTERP program sets the initial and boundary conditions for the meteorology 
simulation.  The analyses from RA WINS are interpolated to MM5 's staggered grid configuration 
and from their native vertical coordinate (pressure) to MM5's vertical coordinate (a terrain(cid:173)
following, pressure-based "sigma" coordinate).  In addition, the state variables are converted as 
necessary, e.g., relative humidity to specific humidity.  The analyses from one time (generally the 
first time analyzed by RA WINS) are interpolated by INTERP to provide MM5 's initial 
conditions, while analyses from all times are interpolated to generate MM5's lateral boundary 
conditions. 

INTERP can also be used for "one-way nesting," where the MMS output from one model run is 
interpolated to provide initial and boundary conditions for the nested run.  This is a "non(cid:173)
standard" use of the INT ERP program, but it is commonly used to support air quality modeling. 

3.3 

The Meteorology Model (MMS) 

The following subsections include brief summaries of the science and options that are available in 
MM5.  Thorough descriptions of the standard MM5 options are found in Grell et al.  (1994) and 
Dudhia et al. (1998).  The source code for an early release of MM5 is documented in Haagenson 
et al. (1994).  The Models-3 package does not include NCAR's most current release ofMM5. 
MM5 user options have been tailored and expanded in the Models-3 release to support air 
quality modeling.  Some of these options have not yet been accepted into the official version that 
is maintained'by NCAR.  Caution should be exercised· when deviating.from the version ofMM5 
that is included with Models-3.  Refer to Section 3.5 for a summary of changes to MM5 for 
CMAQ. 

3.3.1  Brief History 

MM5 is the Fifth-Generation Penn State/NCAR Mesoscale Model.  It has evolved from the 
model used by Anthes in the early 1970s, described by Anthes and Warner (1978).  The 
improvements in MM5 over the previous version (MM4) include the option for non-hydrostatic 
physics, as well as more sophisticated explicit moisture, boundary layer processes, radiation, 
convective parameterization, among other improvements.  Dudhia (1993) documented the major 
changes from MM4 to MM5.  Starting with MM5 Version 2 (MM5v2), the software has been 
restructured to run on various hardware platforms in addition to the Cray, with emphasis placed 
on workstation-based MM5 simulations.  The Cray version of MM5 provided on the Models-3 
installation tape has been tested on the EPA's Cray C90.  A workstation-based version of MM5 
may be used with subsequent releases ofModels-3. 

3.3.2  Horizontal and Vertical Grid 

The coordinate system for MM5 is (x, y, sigma-p).  The x and y dimensions are a regular lattice 
of equally spaced points (delta-x = delta-y =horizontal gr.id spacing, in kilometers) forming rows 
and columns.  Sigma is a terrain-following vertical coordinate that is a :function of the pressure at 
the point on the grid (in hydrostatic runs) or the reference state pressure (in non-hydrostatic 
runs), the surface pressure at the grid point, and the pressure at the top of the model.  Sigma 
varies from  1 at the surface to 0 at the top of the model.  The influence of the terrain on the sigma 
structure diminishes with height, such that the sigma surfa.ces near the top of the model are nearly 
parallel. 

The horizontal grid in MM5· has an Arakawa..;B staggering of the velocity vectors with respect to 
the scalars (Arakawa and Lamb,  1977).  The momentum variables (u- and v-components of wind 
and the Coriolis force) are on "dot" points, while all other variables (e.g., mass and moisture 
variables) are on "cross" points.  The dot points form the regular lattice for the simulation 
domain, while the cross points are offset by 0.5 grid point in both the x and y directions.  Note 
that the interpolation of the variables to the staggered grid is done automatically within the 
INTERP program. 

3.3.3  Prognostic Equations 

MM5 is based on primitive physical equations of momentum, thermodynamics, and moisture. 
The state variables are temperature, specific humidity, grid-relative wind components, and 
pressure.  In the prognostic equations, the state variables are mass-weighted with a modified 
surface pressure.  MM5 can be run as either a hydrostatic or non-hydrostatic model.  In the 
hydrostatic model, the state variables are explicitly forecast.  In the non-hydrostatic model 
(Dudhia, 1993), pressure, temperature, and density are defined in terms of a reference state and 
perturbations from the reference state.  MM5 is not mass-conserving in the non-hydrostatic 
mode.  The vertical (sigma) coordinate is defined as a function of pressure.  The model's 
prognostic equations are thoroughly discussed in Grell et al. (1994) and Dudhia et al. (1998). 

3.3.3.1 Time  Differencing 

The hydrostatic and non~J:iydrostatic versions of MM5 use different time differencing schemes to 
filter the fast waves from the prognostic solutions in the model.  In the non-hydrostatic model, a 
semi-implicit scheme based on Klemp and Wilhelmson (1978) is used to control the acoustic 
waves in the model solution.  In the hydrostatic model, a split-explicit scheme based on Madala 
(1981) is used to control gravity waves in the model solution.  The time differencing in MMS is 
discussed at length in Grell et al. (1994) and Dudhia et al. (1998). 

3.3.3.2 Lateral Boundary Conditions 

There are five options for lateral boundary conditions in MMS: fixed, relaxation, time dependent, 
time and inflow/outflow dependent, and sponge.  The lateral boundaries in MMS  consist of 
either the outer five grid points (~elaxation and sponge options) or the outer grid point (all other 
options) on the horizontal perimeter of the sirilulation domain.  (The outer four grid points are 
used for boundary conditions for "cross" point variables for the relaxation and sponge options.) 
The lateral boundary conditions for the coarse domain are derived from the background fields 
processed in DATA GRID and INTERP.  When the one-way nest option is selected, the lateral 
boundary conditions for nested domains are interpolated from the simulation on the parent 
domain. 

3.3.4  Model Physics 

Several model physics options in MM5 are briefly noted below.  The model physics options are 
further discussed and compared in Dudhia et al. (1998).  The descriptions of the model physics 
options are largely taken from Dudhia et al (1998), and other pertinent references are noted. 

3.3.4.1 Radiation 

There are five atmospheric radiation cooling schemes available in MM5. 

• 

• 

• 

• 

• 

The "None" option applies no mean radiative tendency to the atmospheric temperature . 
This scheme is unrealistic for long-term simulations. 

The Simple Cooling scheme sets the atmospheric cooling rate strictly as a function of 
temperature.  There is no cloud interaction or diwnal cycle. 

The Surface Radiation scheme is used with the "none" and "simple cooling" schemes. 
This scheme includes a diurnally varying shortwave and longwave flux at the surface for 
use in the ground energy budget.  These fluxes are calculated based on atmospheric 
column-integrated water vapor and low/middle/high cloud fraction estimated from relative 
humidity. 

The Dudhia Longwave and Shortwave Radiation scheme is sophisticated enough to 
account for longwave and shortwave interactions with explicit cloud and clean air.  This 
scheme includes surface radiation fluxes and atmospheric temperature tendencies.  This 
scheme requires longer CPU time, but not much memory.  (See Dudhia, 1989.) 

The CCM2 Radiation scheme includes multiple spectral bands in shortwave and 
longwave, but the clouds are treated simply as functions of relative humidity.  This 
scheme is suitable for larger grid scales and probably more accurate for long time 
integration (e.g., climate modeling).  It also provid1es radiative fluxes at the surface.  (See 
Hack et al.,  1993.) 

3.3.4.2 Convective Parameterization 

There are currently six convective parameterization schemes in MM5.  There is also the option 
for no convective parameterization and an independent option for shallow convection.  The 
convective parameterization schemes have been designed for use at various simulation scales, and 
they are not entirely interchangeable.  For example, each scheme uses different assumptions for 
convective coverage on the sub-grid-scale and for the convective trigger function.  The convective 
parameterization schemes also differ greatly in CPU usage and memory requirements. 

3-7 

The Anthes-Kuo scheme is based on moisture convergence and is mostly applicable to 
larger grid scales (i.e., greater than 30 km).  This scheme tends to produce more convective 
rainfall and less resolved-scale precipitation.  This scheme uses a specified heating profile 
where moistening is dependent on relative humidity.  (See Anthes, 1977.) 

The Fritsch-Chappel scheme is based on relaxation to a profile due to updraft, 
downdraft, and subsidence region properties.  The convective mass flux removes 50% of 
the available buoyant energy in the relaxation time.  There is a fixed entrainment rate. 
This scheme is suitable for 20-30 km scales due to the single cloud assumption and local 
subsidence.  (See Fritsch and Chappel, 1980.) 

The Arakawa-Schubert scheme is a multi-cloud scheme that is otherwise similar to the 
Grell scheme (described below).  This scheme is based on a cloud population, and it 
allows for entrainment into updrafts and the existence of downdrafts.  This scheme is 
suitable for larger grid scales (i.e., greater than 30 km).  This scheme can be 
computationally expensive compared to the other available schemes.  (See Arakawa and 
Schubert,  1974.) 

The Kain-Fritsch scheme is similar to the Fritsch-Chappel scheme, but it uses a 
sophisticated cloud-mixing scheme to determine entrainment and detrainment.  This 
scheme also removes all available buoyant energy in the relaxation time.  (See Kain and 
Fritsch, 1990, 1993.) 

The Betts-Miller scheme is based on relaxation adjustment to a reference post(cid:173)
convective thermodynamic profile over a given period.  This scheme is suitable for scales 
larger than 30 km.  However, there is no explicit downdraft, so this scheme may not be 
suitable for severe convection.  (See Betts, 1986; Betts and Miller, 1986, 1993; and Janjic, 
1994.) 

The Grell scheme is based on rate of destabilization or quasi-equilibrium.  This is a 
single-cloud scheme with updraft and downdraft fluxes and compensating motion !Pat 
determines the heating and moistening profiles.  This scheme is useful for smaller grid 
scales (e.g.,  10-30 km), and it tends to allow a balance between the resolved scale rainfall 
and the convective rainfall.  (See Grell et al.,  1991; and Grell, 1993.) 

The "no convective parameterization" option (e.g., explicitly resolved convection on 
the grid scale) is also available.  This option is generally used for simulations on domains 
with horizontal grid spacing smaller than 10 km. 

3-8 

The Shallow Convection scheme is an independent option that handles non(cid:173)
precipitating clouds that are assumed to be uniform and to have strong entrainment, a 
small radius, and no downdrafts.  This scheme is based on the Grell and Arakawa(cid:173)
Schubert schemes.  There is also an equilibrium assumption between cloud strength and 
sub-grid boundary layer forcing. 

3.3.4.3 Planetary Boundary Layer Processes 

Four planetary boundary layer (PBL) parameterization schemes are available in MM5.  These 
parameterizations are most different in the turbulent closure assumptions that are used.  The 
PBL parameterization schemes also differ greatly in CPU usage. 

• 

• 

• 

• 

The Bulk Formula scheme is suitable for coarse vertical resolution in the PBL (i.e., 
greater than 250 m vertical grid sizes).  This scheme includes two stability regimes. 

The Blackadar scheme is suitable for "high-resolution" PBL (e.g., five layers in the 
lowest kilometer and a surface layer less than 100 m thick).  This scheme has four 
stability regimes; three stable and neutral regimes are handled with a first-order closure, 
while a free convective layer is treated with a non-local closure.  (See Blackadar, 1979.) 

The Burk-Thompson scheme is suitable for coarse and high-resolution PBL.  This 
scheme explicitly predicts turbulent kinetic energy for use in vertical mixing, based on a 
1.5-order closure derived from the Mellor-Yamada formulas.  (See Burk and Thompson, 
1989.) 

The Medium Range Forecast (MRF) model scheme is suitable for high-resolution 
PBL.  This scheme is computationally efficient.  It is based on a Troen-Mahrt 
representation of the counter-gradient term and a first-order eddy diffusivity (K) profile 
in the well-mixed PBL.  This scheme has been taken from the National Centers for 
Environmental Prediction's (NCEP's) MRF model.  (See Hong and Pan, 1996.) 

3.3.4.4 Surface Layer Processes 

The surface layer processes with the Blackadar and MRF PBL schemes have been parameterized 
with fluxes of momentum, sensible heat, and latent heat, following Zhang and Anthes (1982). 
The energy balance equation is used to predict the changes in ground temperature using a single 
slab and a fixed-temperature substrate.  The slab temperature is based on an energy budget, and 
the depth is assumed to represent the depth of the diurnal temperature variation ( ~ 10-20 cm). 
The 13  land use categories are used to seasonally define the physical properties at each grid point 
(e.g., albedo, available moisture, emissivity, roughness length, and thermal inertia). 

A five-layer soil temperature model (Dudhla,  1996) is also available as an option in MM5.  In 
this model, the soil temperature is predicted at layers of approximate depths of 1, 2, 4, 8, and 
16 cm, with a fixed substrate below using a vertical diffusion equation.  This scheme vertically 
resolves the diurnal temperature variation, allowing for more rapid response of surface 
temperature.  This model can only be used in conjunction with the Blackadar and MRF PBL 
schemes. 

In a subsequent release ofCMAQ, the Pleim-Xiu land-surface scheme (Pleim and Xiu, 1995) 
may be included in MM5."  The Pleim-Xiu scheme has been developed to address surface 
processes that can significantly impact air quality modeling, including evapotranspiration and soil 
moisture.  Notable in the Pleim-Xiu scheme is the more careful treatment of the surface 
characteristics (particularly vegetation parameters) that are currently assigned to grid points 
based on land use specification, as well as a more detailed land use and soil type classification 
database. 

3.3.4.5 Resolvable-Scale Microphysics Schemes 

There are six resolvable-scale (explicit grid-scale) microphysics schemes in MM5.  There is also 
an option for a "dry" model run.  The microphysics schemes have been designed with varying 
degrees of complexity for different applications of the model.  In addition, there are new 
prognostic output variables that are generated by the more sophisticated schemes.  These 
microphysics schemes also differ greatly in CPU usage and memory requirements. 

• 

• 

• 

• 

• 

The Dry scheme has no moisture prediction.  Water vapor is set to zero.  This scheme is 
generally used for sensitivity studies. 

The Stable Precipitation scheme generates non-convective precipitation.  Large-scale 
saturation is removed and rained out immediately.  There is no evaporation ofrain or 
explicit cloud prediction. 

The Warm Rain scheme uses microphysical processes for explicit predictions of cloud 
and rainwater fields.  This scheme does not consider ice phase processes.  (See Hsie and 
Anthes,  1984.) 

The Simple Ice scheme adds ice phase processes to the warm rain scheme without 
adding memory.  This scheme does not have supercooled water, and sriow is immediately 
melted below the freezing level.  (See Dudhla,  1989.) 

The Mixed-Phase scheme adds supercooled water to the simple ice scheme, and slow 
melting of snow is allowed.  Additional memory was added to accommodate the ice and 
snow.  This scheme does not include graupel or riming processes.  (See Reisner et al., 
1993, 1998.) 

The Mixed-Phase with Graupel scheme adds graupel and ice number concentration 
prediction equations to the mixed-phase scheme.  This scheme is suitable for cloud(cid:173)
resolving scales.  (See Reisner et al., 1998.) 

The NASA/Goddard Microphysics scheme explicitly predicts ice, snow, graupel, and 
hail.  This scheme is suitable for cloud-resolving scales.  (See Tao and Simpson, 1993.) 

• 

• 

3.3.5  Nesting 

MMS can simulate nested domains of finer resolutions ·within the primary simulation domain.  In 
MMS, the software is configured to enable up to nine nests (ten domains) within a particular run. 
However, due to current hardware resources, the state of the science, numerical stability, and 
practicality, the number of domains in a simulation is generally limited to four or fewer. 

Nesting can be accomplished by either a "one-way" or a "two-way" method.  In one-way 
nesting, the coarse-resolution domain simulation is run independentiy of the nest.  The coarse 
domain can then provide the initial and boundary conditions for its nest.  In one-way nesting, 
each domain can be defined with independent terrain fields, and there are no feedbacks to the 
coarse domain from its nest.  Note that the simulated meteorology at the same grid point in the 
coarse-resolution domain is likely to be different (if only slightly) from the nest in a one-way 
nest simulation. 

Two-way interactive nesting (Zhang et al., 1986; SmolarJrJewicz and Grell, 1992) allows.for 
feedback to occur between the. coarse-resolution domain and the nest throughout the simulation. 
The two domains are run simultaneously to enable this feedback, and terrain in the overlapping 
regions must be compatible to avoid mass inconsistencies and generation of numerical noise.  The 
TERRAIN program automatically defines the terrain compatibility when the user specifies the 
two-way nesting interaction.  When two-way nesting is used, the portion of the coarse-resolution 
domain that is simulated in the nest may reflect too much smaller-scale detail from the nest to be 
useful for the CMAQ simulations. 

The nesting ratio between domains in MMS is generally 3: 1.  (Some other mesoscale meteorology 
models allow for user-defined nest ratios.)  For example, if the coarse domain is a 36-km 
resolution domain, its nest will be a 12-km resolution domain.  This is strictly true for a two-way 
nest, but is largely held as a standard for the one-way nests in MMS.  The nest ratio restricts the 
number of grid points in each dimension of the nest domains to a multiple of 3, plus 1. 

3.3.6  Four-Dimensional Data Assimilation 

The four-dimensional data assimilation (FDDA) scheme included in MMS iis based on 
Newtonian relaxation or "nudging".  Nudging is a continuous form of FDDA where artificial 
(non-physical) forcing functions are added to the model's prognostic equations to nudge the 
solutions toward either a verifying analysis or toward observations.  The artificial forcing terms 
are scaled by a nudging coefficient that is selected so that the nudging term will not dominate the 
prognostic equations.  The nudging terms tend to be one order of magnitude smaller than the 
dominant terms in the prognostic equations and represent the inverse of thee-folding time of the 
phenomena captured by the observations. 

There are two types of nudging in MMS: analysis nudging and observation nudging ("obs 
nudging").  Analysis nudging gently forces the model solution toward gridded fields.  Analysis 
nudging can make use of three-dimensional analyses and some surface analyses.  Analysis 
nudging is generally used for scales where synoptic and mesoalpha forcing are dominant.  Obs 
nudging gently forces the model solution toward individual observations, with the influence of the 
observations spread in space and time.  Obs nudging is better suited for assimilating high 
frequency, asynoptic data that may not otherwise be included in an analysis. 

Nudging in MMS is extensively discussed in Stauffer and Seaman (1990, 1994) and Stauffer et al. 
(1991).  The data assimilation is generally used throughout the MMS simulation period for air 
quality simulations.  Three-dimensional analyses of wind, temperature, and moisture are 
assimilated, and only surface analyses of wind are assimilated, following Stauffer et al. (1991 ). 

3.4  Meteorology Model Post-Processing 

Since the output variables that are generated by an MMS simulation are not always useful in 
their raw form, those variables must be converted into fields that are required by the chemistry 
and emission models.  The conversion of MMS output to useful fields for the other Models-3 
programs is accomplished in the Meteorology Chemistry Interface Processor (MCIP), which is 
discussed in Chapter 12.  MCIP computes variables that are useful to the subsequent models in 
Models-3, and it creates an output file written with the 1/0 API libraries in netCDF format that 
is standard in the Models-3/CMAQ modeling system. 

3.5 

Changes to the MMS System's Software for Models-3 

The version ofMMS included with the initial release ofModels-3 is MMS Version 2, Release 6. 
The system is complete with "bug fixes" included through October 1997.  Only selected "bug 
fixes" and upgrades have been included beyond October 1997.  (Including all of the changes to 
MMS would have jeopardized testing and evaluation of CMAQ, which uses the MMS output.) 

The version of MMS in the Models-3 release includes most-of the science options in NCAR's· 
current version.  The omission of upgrades should not result in substandard or corrupted 
meteorological simulations. 

The following is a summary of EPA-initiated changes that were made to the NCARrelease of · 
MMS  and its supporting software to support air quality modeling with CMAQ: 

All Programs:  . 

• 

Standardized the radius of the earth as 6370.997 kill to be consistent with chemistry and 
emission models. 

TERRAIN: 

• 

• 

Set terrain height over ocean to zero when using the I -minute terrain database. 

Improved representation of urban areas along coasts. 

INT ERP: 

• 

Increased loop indices and parameter sizes to accommodate 120-hour simulation. 

MM5: 

• 

Modified script and source code to enable analysis nudging on a one-way nested 
simulation. 

3.6 

References 

Anthes, R. A.,  1977: A cumulus parameterization schem~ utilizing a one-dimensional cloud 
model.  Mon.  Wea.  Rev._,  106, 270-286. 

Anthes, R. A., and T. T.  Warner, 1978: Development of hydrodynamic models suitable-for air 
pollution and other mesometeorological studies.  Mon.  Wea.  Rev., 106, I 045-1078. 

Arakawa, A., and V.  R.  Lamb, 1977: Computational design of the basic dynamical process of the 
UCLA general circulation model.  Methods in Computational Physics, 17, 173-265. 

,. 

-

Arakawa, A., and W. H. Schubert, _1974:  Interaction of_a 1~~ulus cloud ensemble with the_large 
scale environment.  Part I.· J..Atmos.  Sci., 31, 674-701. 

Benjamin, S. G., and N. L. Seaman, 1985:-A simple scheme for objective analysis in curved flow. 
Mon.  Wea.  Rev., 113, 1184-1198. 

Betts, A. K.,  1986: A new convective adjustment scheme:  Part I:  Observational and theoretical 
basis.  Quart. J.  Roy.  Meteor.  Soc., 112, 677-692. 

Betts, A. K., and M. J. Miller, 1986: A new convective adjustment scheme.  Part II:  Single 
column tests using GATE wave, BOMEX, ATEX and Arctic air-mass data sets.  Quart.  J.  Roy. 
Meteor.  Soc., 112, 693-709. 

Betts, A. K., and M. J. Miller, 1993: The Betts-Miller scheme.  The representation of cumulus 
convection in numerical models.  K. A. Emanuel and D. J.  Raymond, Eds., Amer. Meteor. Soc., 
246 pp. 

Blackadar, A. K., 1979: High resolution models of the planetary boundary layer.  Advances in 
Environmental Science and Engineering, 1, No. 1, Pfafflin and Ziegler, Eds., Gordon and Briech 
Sci. Publ., New York, 50-85. 

Burk, S. D., and W. T. Thompson, 1989: A vertically nested regional numerical prediction model 
with second-order closure physics.  Mon.  Wea.  Rev., 117, 2305-2324. 

Cressman, G. P., 1959: An operational objective analysis system.  Mon.  Wea.  Rev., 87, 
367-374. 

Dudhia, J.,  1989: Numerical study of convection observed during the winter monsoon experiment 
using a mesoscale two-dimensional model.  J.  Atmos. Sci., 46, 3077-3107. 

Dudhia, J., 1993: A nonhydrostatic version of the Penn State/NCAR mesoscale model: 
Validation tests and simulation of an Atlantic cyclone and cold front.  Mon.  Wea.  Rev., 121, 
1493-1513. 

Dudhia, J.,  1996: A multi-layer soil temperature model for MM5.  Preprints, The Sixth 
PSUINCAR Mesoscale Model Users' Workshop, Boulder, CO, Natl. Ctr. Atmos. Res. 

Dudhia, J., D. Gill, Y.-R. Guo, D. Hansen, K. Manning, and W.  Wang,  1998: PSU/NCAR 
mesoscale modeling system tutorial class notes (MM5 modeling system version 2).  [Available 
from the National Center for Atmospheric Research, P. 0. Box 3000, Boulder, CO  80307.] 

Fritsch, J.M., and C. F. Chappel, 1980: Numerical prediction of convectively driven mesoscale 
pressure systems.  Part I: Convective parameterization.  J.  Atmos.  Sci., 37, 1722-1733. 

Grell, G. A., Y.-H. Kuo, and R. Pasch, 1991: Semi-prognostic tests of cumulus parameterization 
schemes in the middle latitudes.  Mon.  Wea.  Rev., 119, 5-31. 

Grell, G. A., 1993: Prognostic evaluation of assumptions used by cumulus parameterizations. 
Mon.  Wea.  Rev., 121, 764-787. 

Grell, G. A., J. Dudhia, and D.R. Stauffer, 1994: A description of the fifth-generation Penn 
State/NCAR mesoscale model (MM5).  NCAR Tech. Note NCAR/TN-398+STR,  117 pp. 
[Available from the National Center for Atmospheric Research, P. 0. Box 3000, Boulder, CO 
80307.] 

Guo, Y.-R., and S.  Chen, 1994: Terrain and land use for the fifth-generation Penn State/NCAR 
mesoscale modeling system (MM5):  Program TERRATI"l.  NCAR Tech. Note, NCAR/TN-
397+IA, 119 pp.  [Available from the National Center for Atmospheric Research, P. 0. Box 
3000, Boulder, CO  80307.] 

Haagenson, P., J. Dudhia, D. Stauffer, and G. Grell,  1994: The Penn State/NCAR mesoscale 
model (MM5) source code documentation.  NCAR Tech. Note, NCAR/TN-392+STR, 200 pp. 
[Available from the National Center for Atmospheric Research, P. 0. Box 3000, Boulder, CO 
80307.] 

Hack, J.  J., B. A. Boville, B. P. Briegleb, J. T. Kiehl, P. J.  Rasch, and D. L. Williamson, 1993: 
Description of the NCAR community climate model (CCM2).  NCAR Tech. Note, NCAR/TN-
382+STR, 120 pp.  [Available from the National Center for Atmospheric Research, P. 0. Box 
3000, Boulder, CO  80307.] 

Hong, S.-Y., and H.-L. Pan, 1996: Nonlocal boundary layer vertical diffusion in a medium-range 
forecast model.  Mon.  Wea.  Rev., 124, 2322-2339. 

Hsie, E.-Y., and R.  A. Anthes, 1984: Simulations offrontogenesis in a moist atmosphere using 
alternative parameterizations of condensation and precipitation.  J.  Atmos. Sci., 41, 2701-2716. 

Janjic, Z. I.,  1994: The step-mountain eta coordinate model:  Further development of the 
convection, viscous sublayer, and tl:rrbulent closure schemes.  Mon.  Wea.  Rev., 122, 927-945. 

Kain, J.  S., and J.M. Fritsch, 1990: A one-dimensional entraining/detraining plume model. 
J.  Atmos. Sci., 47, 2784-2802. 

Kain, J.  S., and J.M. Fritsch, 1993: Convective parameterization for mesoscale models:  The 
Kain-Fritsch scheme.  The representation of cumulus in mesoscale models.  K. A. Emanuel and 
D. J.  Raymond, Eds.,  Amer. Meteor. Soc., 246 pp. 

Klemp, J.B., and R. B. Wilhelmson, 1978: Simulations of three-dimensional convective storm 
dynamics.  J.  Atmos. Sci., 35, 1070-1096 

Madala, R. V.,  1981: Finite-difference techniques for vectorized fluid dynamics calculations. 
Edited by D. L. Book, Springer Verlag, New York. 

Manning, K., and P. Haagenson, 1992: Data ingest and objective analysis for the PSU/NCAR 
modeling system:  Programs DATAGRID and RA WINS.  NCAR Tech. Note, 
NCAR!IN-396+IA, 209 pp.  [Available from the National Center for Atmospheric Research, P. 
0. Box 3000, Boulder, CO  80307.] 

Nuss, W. A., and.D. W. Titley, 1994: Use ofmultiquadric interpolation in meteorological 
objective analysis.  Mon.  Wea.  Rev., 122, 1611-1631. 

Pleim, J.E., and A. Xiu, 1995: Development and testing of a surface flux and planetary boundary 
layer model for application in mesoscale models.  J.  Appl. Meteor., 34, 16-32. 

Reisner, J., R. T. Bruintjes, and R. J. Rasmussen,  1993: Preliminary comparisons between MM5 
NCAR/Penn State model generated icing forecasts and observations.  Preprints, Fifth Intl.  Conf 
on Aviation Weather Systems, Vienna, VA, Amer. Meteor. Soc., 65-69. 

Reisner, J., R. J. Rasmussen, and R. T. Bruintjes, 1998: Explicit forecasting of supercooled liquid 
water in winter storms using the MM5 mesoscale model.  Quart. J.  Roy. Meteor.  Soc., 124B, 
1071-1107. 

Smolarkiewicz, P. K., and G. A. Grell,  1992: A class of monotone interpolation schemes. 
J.  Comp.  Phys., 101, 431-440. 

Stauffer, D.R., and N. L. Seaman, 1990: Use of four-dimensional data assimilation in a limited(cid:173)
area mesoscale model.  Part I:  Experiments with synoptic-scale data.  Mon.  Wea.  Rev., 118, 
1250-1277. 

Stauffer, D.R., N. L. Seaman, and F. S. Binkowski, 1991: Use of four-dimensional data 
assimilation in a limited-area mesoscale model.  Part II: Effects of data assimilation within the 
planetary boundary layer.  Mon.  Wea.  Rev., 119, 734-754. 

Stauffer, D. R., and N. L. Seaman, 1994: Multiscale four-dimensional data assimilation.  J.  Appl. 
Meteor., 33, 416-434. 

Tao, W.-K., and J.  Simpson, 1993: Goddard cumulus ensemble model.  Part I:  Model 
description.  Terr.,  Atmos., and Oc.  Sci., 4, 35-72. 

Zhang, D.-L., and R. A. Anthes, 1982: A high-resolution model of the planetary boundary layer -
- Sensitivity tests and comparisons with SESAME-79 data.  J.  Appl. Meteor., 21,  1594-1609. 

Zhang, D.-L., H.-R. Chang, N. L.  Seaman, T. T. Warner, and J.  M; Fritsch, 1986: A two-way 
interactive nesting procedure with variable terrain resolution.  Mon.  Wea.  Rev., 114, 1330-1339. 


Chapter4 
=============

EMISSION SUBSYSTEM 

William G. Benjey* and James i\'1.  Godowitch** 

Atmospheric Modeling Division 

National Exposure Research Laboratory 
U.S. Environmental Protection Agency 

Research Triangle Park, NC 27711 

Human Exposure and Atmospheric Sciences Division 

Gerald L. Gipson 

National Exposure Research Laboratory 
U.S. Environmental Protection Agency 

Research Triangle Park, NC 27711 

ABSTRACT 

Chapter 4 provides a description of the Models-3 Emission Processing and Projection System 
(MEPPS) structure, scientific approach and the assumptions used in modeling and processing 
emission data in the Models-3 framework.  The description includes emission data entry through 
the Inventory Data Analyzer (IDA) import and quality control checks; and the data flow and 
quality control used in loading emission inventory and meteorology data in the MEPPS Input 
Processor.  The description of the main Emission Processor addresses the basis of spatial and 
temporal allocation procedures.  The scientific models and assumptions used in modeling hourly 
mobile source and biogenic emissions are explained (Biogenic Emission Inventory System 2 and 
Mobile Sa, respectively).  The rationale and assumptions are described which are used in the 
allocation and grouping of individual chemical species into "lumped species" in preparation for the 
lumped species chemical transformation mechanisms contained in the Community Multiscale Air 
Quality (CMAQ) model.  The chapter also describes the procedures used by the Models-3 
Emission Projection Processor to estimate emission data for use in modeling future air quality 
scenarios.  Finally, the quality control report and output file options contained in the Output 
Processor are described. 

*on assignment from the National Oceanic and Atmospheric Administration, U.S. Department of Commerce. 
Corresponding author address: Bill Benjey, MD-80. Research Triangle Park, NC 27711.  E-mail: 
benjey@hpcc.epa.gov 

••on assignment from the National Oceanic and Atmospheric Administration, U.S. Department of Commerce. 


4.0 

EMISSION SUBSYSTEM 

The rationale for the Models-3 air quality emission processor is rooted in the need to estimate, 
organize, and process emission inventory data for regulatory and scientific analysis and modeling. 
Historically, air quality emission processing methods have been developed. in an ad hoc manner, 
with each procedure specifically tuned to meet the need at hand, reflecting the various data 
information sources and estimation methodologies, as well as the uses of the data.  The Models-3 
air quality emission processor consolidates and simplifies the estimation, data handling, and 
linkage of the resulting data to air quality models.  This section describes the purpose, origins, and 
scientific bases of the Models-3 Emission Projection and Processing System (MEPPS).  Material 
is presented in the general sequence of emission processing.  System requirements, system design 
,and detailed user information for emission data processing are not addressed in this Volume. 
These items are described in Volume 7, Volume 8, and Volume 9B, respectively of the Models-3 
documentation set.  For example, processor names, environment variables, and flow diagrams are 
given in Chapter 6 of the Models-3  Volume 9B:  User Manual. 

4.1 

Emission Inventory Processors 

In the Models-3 framework, MEPPS imports, quality controls, and processes emission inventory 
data for either direct regulatory analysis or input to a chemical transport model.  The MEPPS also 
models  hourly biogenic emissions and mobile source emissions.  The MEPPS is non-conforming 
within the framework because it is not an object-oriented component, and because it does not use 
the NetCDF Input/Output Applications Program Interface (I/O API) format internally. 
Processing is accomplished using a combination of FORTRAN, SAS®, and ARC/INFO® 
programs. The emission processor results are translated into the NetCDF I/O API format by the 
MEPPS Output Processor. 

4.1.1  Discussion 

The MEPPS builds on lessons from and functionalities of previous software developed for 
processing emission inventories.  The capabilities and design decisions in MEPPS are placed in the 
context of emission inventory developments. 

4.1.1.1 

The Role of Emission Inventory Processing for Chemical Transport Modeling 

Historically, there have been many air quality emission data bases which were compiled and used 
for the purposes of regulatory or scientific assessment of emissions, including spatial and temporal 
patterns and trends.  As air quality chemical transport models (CTMs) were developed, each had 
its own specific  format for input data, based either on the data structure used in the model and/or 
the format of the available data.  Initially, CTMs were relatively simple and applied to one or a 
few point sources, such as emissions from an industrial stack.  As CTMs for urban and regional 
scales - such as the Urban Airshed Model (Morris et al., 1992) - became more sophisticated, the 
level of detail needed for input emission data became increasingly more comprehensive and 
detailed.  It became necessary to include as complete an inventory as possible for the area of 
interest, including emissions from all diffuse as well as point sources at as great a degree of spatial 
and temporal resolution as possible.  As the spatial and temporal resolution of the models has 
increased, so has the demand for detailed emission input data.  Because of resource limitations on 
data gathering, the emission inventory information needed often substantially exceed the reported 
or observed emission data available.  The result is development of a wide range of emission 
estimation and modeling techniques. 

Emission inventory data are available from various sources, often state and local air pollution 
control agencies.  The data are commonly compiled into annual emission inventories for specific 
areas to be analyzed and/or modeled.  The spatial extent of an emission inventory may vary from 
plant-specific emission data to data for an entire country or more.  Recent regional exampl~s 
include the National Acid Precipitation Assessment Program 1985 National inventory (Saeger et 
al.,1989), the 1990 EPA Interim National Emission Inventory (U.S. EPA, 1993; U.S. EPA, 
1994), and the 1990 Ozone Transport Assessment Group inventory (Ozone Transport 
Assessment Group, 1997). Most emission inventories are organized into four traditional general 
groups of emission types: 

• 

• 

• 

• 

Point sources, which are emission sources attributable to discrete emission points, usually 
a stack.  The data include pollutant, source category code, stack parameters (height, 
diameter, exit velocity, temperature, flow rate), emissions, location coordinates, fuel, etc. 

Area sources, which are emission sources attributable to diffuse sources or areas, such as 
agricultural fields, large open mining operations, forests, or a combination of many point 
sources which are too small and numerous to account for individually (e.g., .residences). 
Area somce inventories are typically by county and include pollutant, source category 
code, emissions, location, coordinates, etc. 

Biogenic sources, which are often natural emissions from vegetation, soils, and lightning. 
Biogenic emissions are dependent on temperature, solar radiation, and land cover type. 
They are usually modeled hourly for specific days and locations. 

Mobile sources, which are emissions from vehicular traffic on roadways, aircraft, trains, 
shipping, and off-road mobile equipment.  Mobile source emissions are dependent on the 
ambient temperature, road type, vehicle type and age, miles traveled, etc.  These emissions 
are generally modeled for specific day and meteorology scenarios either by county or road 
segment (link-node data). 

The techniques used to estimate emissions in compiling an emission inventory are based on 
extrapolation of limited direct measurements for point sources, and application of limited 
measurements or estimates to spatial surrogate data for area sources.  Emissions which are 
dependent on environmental conditions (e.g., biogenic and mobile source emissions) are modeled 
to generate either portions of emission inventories or hourly data for direct use in air quality 
modeling.  The procedures used to process emission inventory data and to model and process 
mobile and biogenic source emission data are described in more detail in the following sections. 

Point source and area source emission inventory data are usually included in annual emission 
inventories.  Annual mobile and biogenic emissions are included ifthe inventory was intended for 
assessing annual totals or trends of emissions.  If the inventory was prepared for modeling, only 
the annual "Vehicle Miles Traveled" by county or road segment and vegetation land cover may be 
provided.  In order to accomplish episodic air quality modeling, it is necessary to model the hourly 
mobile and biogenic emissions for the episode-specific meteorological conditions. 

The typical procedures used to prepare annual emission inventories for use in a CTM require 
temporal, spatial, and pollutant species allocation of the data.  This is accomplished in a sequential 
manner.  For regional modeling, initial "raw" emission inventory data files are very large, often 
several megabytes in size.  The data files are subjected to a variety of data quality checks, 
depending upon the methodological sophistication and computing and time resources available. 
Typically, visual inspections of mapped locations, value range checks, cross-checks of sums, and 
routine computer checks for blank fields and valid data types are performed. 

In order to reduce the size of emission data files, the data are often speciated first, depending 
upon the pollutants involved, then temporally allocated to hourly data, and then spatially allocated 
or "gridded" to a spatial domain with gridded cells of the resolution required by the CTM. At each 
step some of the detailed information, such as source category code and geographic coordinates, 
are dropped to reduce the file size.  Hourly mobile source and biogenic emission data are modeled 
using the appropriate hourly meteorological data, and merged with point and area source data 
prior to speciation. 

It is necessary to rerun the processing sequence in the event of an error, or for each new 
meteorological or day-specific scenario.  Projections to future years require application of source(cid:173)
category-specific economic growth  factors to a base year inventory to produce a projected 
annual inventory.  The projected inventory is then processed through the entire emission 
processing sequence.  Preparation of detailed regional emission inventory data for regional 
modeling using this traditional approach may take weeks or month. 

4.1.l.2 

Function and Place of the Emission Processor in the Models-3 Framework 

The Models-3 framework is designed to contain conforming object-oriented modules that pass 
data in the NetCDF I/O API format, although non-conforming modules are accommodated at the 
cost ofreduced functionality.  The emission processing system is intended to  ultimately be 
conforming.  The initial version ofMEPPS was derived from existing software and consequently 
is not a conforming object-oriented program in Models-3.  However, it is integrated into the 
Models-3 framework and does take instructions and information from the system and provides 
emission data output in NetCDF IO/API format.  Figure 4-1  provides a functional view of the 
Models-3 system.  Processing of emission data is often a part of iterative air quality strategy 
building, directly or indirectly, though the effect of emissions on air quality modeling results. 
Figure 4-2 is a simplified illustration of the location ofMEPPS and other non-conforming 
components within the Models-3 framework.  The main aspects of a study (including the principal 
emission processing options) are graphically defined in the high-level Models-3  Study Planner, 
and the resulting information is automatically passed to MEPPS as well as other portions of the 
system.  Specifically, a study name is defined by the user by copying, modifying, and renaming an 
existing "template" emission study.  For example, a tutorial emission study could be used as a 
template to define a new study.  The new study is associated with input data sources, MEPPS 
processing and modeling modules and their primary options by annotating links and nodes in the 
specified emission study and plans.  The pollutants of interest, the geographic domain, map 
projection, grid spatial resolution, chemical speciation mechanism, temporal resolution, and dates 
of interest (referred to as the "case") are defined in the Models-3 Science Manager and passed to 
the rest of the system including MEPPS.  This approach allows the user to make primary 
specifications once, rather than separately to each of the system components and thus ensures 
consistency.  Study Planner and Science Manager also aid in using the system to run multiple 
emission, projected emission, and emission control scenarios without frequent respecification of 
parameters.  From a functional view, MEPPS generates emission data that reflect user-defined 
studies and cases, whether for regulatory analysis of emission data and/or for input to CTM runs 
and comparison with CTM results. 

Main Control Subsystem 

(Study Planner) 

Control 

Model 
Building 

I 
~Litalysis 
I 

Functionality 

(  Models 

] 

~ 

Building 
Blocks 

Figure 4-1  Functional View of the Models-3 System 

I 

Strategy 
Building 

I 

I 

(  Data  ] 

Meteorology 

(MMS) 

E~$.i~~~~b.1~1: 
~:l?f~essbt!:1: 
:::™·:·:··EE·: 
.. :·p·:S 
... ) .. :::: 
.  .... . 
. . . 
... 
.... . 
. 
. .  . . . . . . .  . . 
························ 

Data Flow 

Models-3 Interfaces 

System Instructions 

Analysis ToD 

Figure 4-2  The location ofMEPPS within the Models-3 Framework 

The emission processing function ofMEPPS requires that it be linked to the Models-3 
framework, anci to other processing, modeling, and analysis tools through the framework. 
MEPPS outputs data in the NetCDF I/O API format in order to link MEPPS to the Models-3 
framework and other processing, modeling, and analysis modules.  Figure 4-3 illustrates that 
information (grid, chemical mechanism, and case) user-specified in Models-3  Science Manager for 
a study is passed to other modules, including MEPPS.  However, it is necessary to access the 
Parameter Window ofMEPPS through the Tools Manager, to specific study name, grid, source 
(data source name), and case, and then return to the Study Planner to run the emission study. 
Direct access to MEPPS is through the Tools Manager and the emission projection and control 
functions are in Strategy Manager.  New emission inventory data are imported and quality 
controlled through the Models-3 File Converter and its subsidiary Inventory Data Analyzer 
(IDA).  The data are then imported directly into MEPPS through its internal Input Processor 
(INPRO). Meteorological information needed to estimate biogenic and mobile source emissions 
are provided to MEPPS from a meteorological model or dataset in the Models-3 system through 
the Meteorology-Chemistry Interface Processor (MCIP).  For regional-scale modeling, the 
current default meteorological model is Mesoscale Model 5 (MM5).  The MEPPS processes 
emission data into speciated, spatially and temporally allocated hourly emission data for use in a 
Models-3 conforming CTM.  The data are output as NetCDF I/O API files to the Emission(cid:173)
Chemistry Interface Processor (ECIP) which adjusts the format to that needed by the CTM. 
Emission data for large elevated point sources (large stack emissions) are also provided as I/O 
API files to the Plume Dynamics Module, and the plume rise algorithm. 

Tools Manager 

·Study Planner 

MMS 

CM:AQ 

MCIP  1--------~ 

Science 
Manager 

.I 

(1~A*) 

ECIP 

Where: 

:Ml.v.1:5  is Mesoscale Model 5 
C11AQ is  Community Multi scale Air Quality Model 
l:v.IBPPS is Models-3 Emission Processing and Projection System 
MCIP is  Meteorology-Chemistry Interface Processor 
ECIP is Emissions-Chemistry Interface Process or 
*ID Ai s Inventory Data Analyzer 
*File Converter is  generic to the Models-3 system 
*IDA and File Converter are optional  (used for new data) 

Figure 4-3 Relationship of Principal Models-3 Framework Components 

4.1.1.3 

Rationale for the Basis of the Initial Version of MEPPS 

In order to assure that an acceptable and functional emission inventory processor would be 
present in the initial release of Models-3  given time and resources available, it was decided that 
the emission processing module for the initial version would be based on software and 
methodologies available as of 1994.  More advanced approaches being researched and developed 
then and now will be incorporated as soon as possible.  The decision factors used in selecting 
from existing emission pro.cessors were availability, cost, features (capabilities), hardware and 
software requirements, and operating characteristics.  Table 4-1  lists the emission processing 
systems considered with respect to the principal evaluation factors. 

Based on the evaluation, the Geocoded Emission Modeling and Projection. System (GEMAP; 
Wilkinson et al.,1994), now known as the Emission Modeling System-95 r(EMS-95), was selected 
as the basis of the initial emission processing system, although it is non-conforming (not in I/O 
API Net CDF) in the Models-3 system.  The GEMAP was selected because it was readily 
available in the public domain; it was state-of-the-art at the time; there wa'3 no licensing cost 
(exclusive ofGEMAP's internal use of SAS® and Arc/Info®); its code was modular and flexible; 
and it contained a geographic information system to perform spatial allocation of emission 
inventory data. 

Other systems considered included the Emission Processing System (EPS), The Flexible Regional 
Emission Data System (FREDS), and the Sparse Matrix Operator Kernel Emission System 
(SMOKE).  The EPS is used to process emission inventory data for the Urban Airshed Model 
(UAM; U.S. EPA, 1992).  A recent adaptation ofEPS by Environment Canada for regional use is 
called the Canadian Emission Processing System Version 1 (CEPS 1.0) (Moran et al.,  1998).  Like 
GEMAP, EPS would be non-conforming code in the Models-3 framework, and would require 
design and development of interfaces with the Models-3 system and the addition of many features. 
However, EPS does not include flexible GIS-based gridding capability of GEMAP and was 
originally  designed for urban scale air quality modeling as opposed to the multiscale (local to 
regional and national) air quality modeling capabilities ofModels-3. 

The FREDS has been used for regional air quality modeling during the past ten years in 
conjunction with the Regional Oxidant Model and Regional Acid Deposition Model (Modica et 
al.,  1989).  The FREDS code is run on a main-frame computer, and is "hard-wired" and difficult 
to change for different scenarios or grids. Consequently it lacks the modulmity and flexibility 
needed to operate in the Model-3 framework. 

Design and prototyping of SMOKE was just beginning when the design of the initial version of 
Models-3 was determined (Coats,  1995).  The SMOKE, which is now being used in conjunction 
with UAM, could be modified to be fully compliant with the object-oriented Models-3 system. 
Additional analysis and quality control tools are being designed for SMOKE, and initial work has 
begun to adapt it to the Models-3 framework. 

4-8 

Table 4-1.  Emission Processor Selection Factors for the Initial Public Release ofModels-3 

EP N6001R-99/030 

·· ...... ·  ·: 

·. 

Facfors···· 

II'  ••..•. · .•···  . .  •:: 

• • ..  ••  • 

•  :·  < •. 

.•. 
E@$$ioll J>ro~~ssh1g.. 
Systeni ~P~) •' •·. ·· ·,:· ····  ·  \ 
· 

· · · 

· 

·.  : .•.... · ..••.••  ••.:·• ••.••.  :: 
:.·.· .•  : .... 
· Fl~xibfo R~gfoijaJ 
~~~sioJ)J\.1.)~d~lin.g . 
· 

•·  $Yst~m(F~t)sj •· 

,· 

:;::::.;·: 

Acquisition Cost of Source 
Code1 

II  None 

(G"./ :.'/d·:<a· :E•·. •· 
•:.  · eoco  e  .  Jlllss1on 

.;·.  \.:. 

. / .... 

s'··  .  ).:M··::· •.:·t···}::•.•::··< 
·  parse  a rix·<  . 

i~i!~fj~·~teni.  . · ~!~~:~~i~l ... ··· ·· 

·  o::·> 

· ·· 

·  · 

~yst~m<  · · 
·I NIA 

I None 

I None 

Availability 

Public domain 

Degree of Development 

Completed and in use 

Public domain 
I ~ompleted and in use 

Public qomain 
I Initial version being tested 

I NIA 
I Design and prototype· 
beginning 

Relative Flexibility for 
Modification to Models-3 

Hardware Requirements 

History (Operating 
Experience) 

II  Changes required recoding of 
modules to allow revised 
interfac(!s and external control 
- spatial allocation would be 
added. 

Changes required substantial 
recoding - many patches -
relatively inflexible -spatial 
allocation would be added 

II  Work station with UNIX 

operating system 
II  Established system used by_ 
EPA, state, and local agencies·  U.S. EPA m regional 

I IBM Mainframe system 
I Establishe~ syst~m used by 
modeling program·s 

Changes required recoding of  NIA 
modules to allow revised 
interfaces and external control  · 
- spatial allocation already 
present 

Work station with UNIX 
operation system 

I New system, used only with 

test data in California 

Unix-based m~chines, 
specifics not established 

I NIA 

Software Requirements 

II  FORTRAN and SAS® 

. I FORTRAN and SAS® 

Spatial Allocation Capability 

II  Spatial allocation grids must 
be manually coded for each 
allocation scenario. 

Spatial allocation grids must 
be manually coded for each 
allocation scenario. 

SAS® and ARC/INFO® 
licenses. 

Unix-based, specifics.not well 
established 

ARC/INFO® allows flexible 
user-defined grid domains, 
spatial resolution and data 
overlays 

Unknown 

Since its selection, GEMAP/EMS-95 has been substantially modified and incorporated into 
MEPPS.  Because of the changes, the GEMAP portion ofMEPPS has been renamed the 
Emission Processor (EMPRO) module.  Revisions were made to allow the software to be more 
generic and efficient in its operation, and new features were added.  In general, new capabilities 
·were written in FORTRAN and placed in modules outside ofGEMAP.  This was done to 
minimize rewriting of code in future when the GEMAP-based portion of the system is replaced. 

MEPPS must include several basic functions.  There are also many enhancements, detailed 
descriptions for which may be found in Volumes 7, 8, and 9 (System Requirements, System 
Design, and User Manual, respectively) of the Models-3 documentation set.  The experience and 
design suggestions of personnel familiar with processing large emission inventories were used as 
important guidance in deciding which features to include in MEPPS.  The design and 
implementation ofMEPPS emphasized ease of use and efficiency within the overall design of the 
Models-3 system.  The following paragraphs present a brief description o:fthe principal functions 
included in MEPPS. 

• 

• 

• 

• 

• 

• 

Annual point and area source emission data from inventories are subset to the spatial 
domain of interest, spatially allocated to a grid, and temporally allocated.  Area source 
emissions are spatially allocated using surrogate spatial coverages. 

Spatial allocation of each general type of air quality data (point, etc.) to grid cells is done 
by the GIS using a grid defined by the Science Manager module ofModels-3. 

Modeled estimates of mobile source emissions are prepared on an hourly basis for periods 
of interest, usually several days.  These estimates account for meteorological conditions 
using data from a meteorology model (such as MM5) that has been passed through the 
Models-3 meteorology-chemistry interface processor (MCIP).  Hourly, grid-cell specific 
emission factors for different vehicle and roadway classifications are prepared with MM5 
using vehicle miles traveled (VMT) data from an emission inventory. 

Modeled hourly estimates ofbiogenic source emissions are prepared on an hourly basis for 
periods of interest, using the Biogenic Emission Inventory System Version 2 (BEIS-2) and 
meteorology data from MCIP and land use coverages (see Section 4.2.4.1). 

Temporal allocation of emission data to hourly data for the period of interest is 
accomplished using source-type specific defaults or user-selected temporal allocation 
profiles. 

Disaggregation of gridded, temporally-allocated emission data of groups of chemical 
species to specific species (chemical speciation) is completed according to the users choice 
of chemical speciation mechanism (currently Carbon Bond 4 (CB-4) and RADM 2.0). 

Projection of emission inventory data to future years from a base-year inventory (1990) 
and application of controls is performed by the Models-3 Emission Projection Processor 
(MEPRO).  Projected emission inventories are used to iteratively evaluate different 
emission scenarios caused by economic or emission control changes. Projected emission 
inventories are each processed by MEPPS for air quality modeling in the same way as the 
original, or "base" inventory; 

Merging of spatially and temporally-allocated, speciated files for point, area, mobile, and 
bjogenic emission data into one emission data output file, and translation into NetCDF 
1/0 API format are performed for use in the Models-3 system, including the chemical(cid:173)
transport model.  Summary and quality control reports on the output data are also 
produced. 

User-defined point-source emission data are extracted and prepared for use in vertically(cid:173)
layered (three-dimensional) emission files to be used with the plume dynamics module of 
the Models-3 system. 

4.1.2  General MEPPS Structure 

The MEPPS is normally used as an integral part of the Models-3 framework from high-level 
menu-driven screens and pick-lists. 

MEPPS in the Models-3 Framework 

A user may define a study using the Study Planner within Models-3.  The Study Planner  specifies 
the name and description of a study, and defines data sources, models, and the relationship 
between them using a graphical interface.  If a study includes processing of emission data, the 
sequence of processing operations, source file addresses and many options for processing are 
defined by the Study Planner and passed to MEPPS annotated to the study name.  Specifications 
for spatial allocation grids, and definition of specific temporal cases are defined in the Science 
Manager.  Existing studies, grids, work space directories, speciation mechanisms, source 
directories, and computer hosts must be selected from the MEPPS parameter window located 
through the MEPPS icon in the Tools Manager prior to running under the Study Planner.  The 
MEPPS may also be directly accessed through the Tools Manager and run interactively via its 
SAS® interface windows.  During direct access interactive operation, some features may be run 
individually in the background using an· "interactive" batch mode selection, or a series of 
processes may be run together as a concatenated batch run. 

The MEPPS shares an import File Converter with the rest of the Models-3 framework.  The File 
Converter will import any ASCII, SAS®, or NetCDF 1/0 API file of format known to the user. 
SAS® data sets are used within EMPRO. The data are imported, converted, and subjected to basic 
quality control checks, including missing or out-of-range values.  The data are then put through 
the Inventory Data Analyzer (IDA) for quality control and analysis specific to emission files, 
including inventories (in one of four EPA formats), temporal allocation factors, control factors, 
vehicle miles traveled, and continuous emission monitoring (CEM) data.  The data then go to the 
MEPPS Input Processor (INPRO) for final quality contr.ol and loading into EMPRO. 

The Internal Components ofMEPPS 

The emission processor (MEPPS) includes several basic components (Figure 4-4):  an em1ss1on 
data Input Processor (INPRO), a main Emission Processor (EMPRO), an Output Processor 
(OUTPRO), and a Models-3 Emission Projection Processor (MEPRO). The File Converter and 
IDA are not intrinsic parts of MEPPS.  They are used to import, quality control, and convert the 
formats and units of data files of known format to the formats that are used in the Models-3 
system, including emission inventories and related emission data files.  The INPRO imports 
emission inventory data from IDA and meteorology files from MCIP, and prepares them for use in 
EMPRO. The EMPRO spatially and temporally allocates point and area source emission data to· 
hourly gridded data.  It is also used to model biogenic and mobile-source emission data using 
meteorological data generated by MMS and processed by MCIP, as well as spatially and 
temporally allocates the data.  The EMPRO then allocates (groups) the chemical species from the 
gridded temporally allocated emission files according to the user's selection of a chemical 
speciation mechanism.  The speciated files then go to OUTPRO where they are merged (a two(cid:173)
dimensional file).  Quality control is performed and summary reports are prepared in accordance 
with the user's choices.  The user also may divide point sources into categories to separate very 
large sources (major-elevated point sources or MEPSE) and large sources (major sources) into 
separate output files, which may be placed in a three-dimensional emission output files to be 
allocated to vertical layers for CMAQ.  The user defines what is MEPSE or major using a 
combination of pollutant-specific emission values and/or stack parameters (see Section 4.2.6). 
Remaining point sources are merged into the two-dimensional emission output file along with 
area, mobile, and biogenic source emission data.  Output files are in NetCDF I/O API format.  The 
MEPRO module projects emission inventory data to future years while applying controls.  The 
projected emission data can be read by EMPRO for further processing if modeling of a projected 
case is desired 

4.2 

The MEPPS Emission ,Processing System 

Although MEPPS is a significant advance in emission inventory data processing, it is continually 
being improved.  The following sections describe the scientific rationale for the 1998 (first public 
release) version of the system. 

· 

This section describes the basis for emission processing procedures in MEPPS.  For models 
developed independently of the Models-3 framework and incorporated into MEPPS, 
documentation for those models is referenced.  MEPPS was developed to meet emission 
processing needs specified in Models-3  Volume  7:  Design Requirements of the Models-3 
docun1entation set, as amended.  The design requirements for emission inventory processing are 
based on the emission data input requirements of chemical transport models, and on the needs of 

4-12 

MCIP 

I 

[ 

Session 

Jl  ( 

Session 

Speciate 

INPRO  ~I  Point Sources 

II 

II 

Visualize 

(  Ar01 s~ces  J ~ 

Mcx:lels 

(Mobile Source Da3 

( 

Grid 

INPRO 

I 

I  I 

)~ 

t-' 
I  n 

RADM-2 

CB-IV 

Generic 

Point 

Area. 

Bi(f;eniC 

) 
(  EpiscxieFile  J 
) 
( 
) 
I ho.I  OUTPRO  M  (  sec Reports  ) 
) 

Stack Files 

( 

Reports 

f 

......._ 

_..,,. 

~ 

I -w 

l(  Mobile  J 

I 

I 

EMPRO 

(remporalized Files) 

(  Speciated Files  ) 

OUTPRO 

(  Point Sources  JI  rl  Proiected 

EmimonData 

MEPRO  ~( Area Sources 

I  >I 

Reports 

)1 

(Mobile SourceDa31  ~ Graphs 

MEPRO 

Figure 4-4  Functional Components of MEPPS 

~ 0 

0 

\0 

~· 
~ w 

0 

those who will use MEPPS to process emission data for both regulatory and scientific emission 
analysis as well as CMAQ data input.  Two guiding principles were followed in the design and 
implementation of MEPPS.  First, substantive changes to the existing GEMAP system were 
minimized because of a long-term goal to replace GEMAP with a more flexible, less costly (in 
terms of software licenses), and faster processor.  Changes focused on improving the processing 
efficiency and correcting basic inadequacies of GEMAP.  The second principle was to place new 
features and new emission processing developments outside of GEMAP to the extent possible, but 
within MEPPS.  The resulting structure will make it easier to replace the GEMAP-based portion 
of MEPPS in the future. 

MEPPS is usually run from the Models-3  Study Planner, although it can be run independently in 
interactive mode.  Consequently, MEPPS is configured to run in a "batch" mode (from Study 
Planner for multi-day cases), and to accept Study Planner specifications for emission data 
processing and location of data sources.  Some MEPPS processors that may be run when 
accessing MEPPS through the Tools Manager (such as file,  grid, and case creation, deletion, or 
editing), will not function when MEPPS is accessed through the Study Planner.  This provision 
avoids conflicts when these processes are specified from the Models-3 framework under Science 
Manager.  The main components of MEPPS are each discussed in the following sections. 

4.2.1  The Inventory Data Analyzer (IDA) 

The IDA is an important enhancement to Models-3.  It operates as an adjunct to the generic File 
Converter, which is described in Section 10.8 of the Models-3 User Manual (Volume 9b of the 
Models-3 documentation set).  The File Converter is fully-compliant component ofModels-3, 
applicable to the entire system, and provides file format and unit conversion for files imported into 
or exported from Models-3, including emission related files.  The formats  currently used in 
Models-3 and supported by the File Converter are NetCDF I/O API (gridded data), ASCII, and 
SAS®. 

The IDA imports files from the File Converter and provides quality control ·and analysis tools 
specialized for reading, comparing, editing, and analyses of emission data .  Quality control reports 
are generated including the results of the checks.  Emission inventories that are in terms of annual, 
daily, or hourly emissions can be imported.  The functionality ofIDA is fully described in Section 
6.2 of the User Manual.  Specific quality control functions include the following: 

• 

Range checks.  Ranges accepted by IDA were taken from the range of values known to be 
correct in inventories currently in the system (1985,  1990, 1995).  English units are used 
because most U.S. inventories are submitted with those units.  Values outside of the 
validity ranges are considered incorrect.  The validity ranges currently used in IDA for 
point-source stacks are: 

4-14 

Diameter 
Diameter 
Height 
Temperature 
Velocity 
Flow rate 
Flow rate must not be more than 10 percent different from flow 

>0.5 and < 50 ft. 
< 0.2 *Height 
>1.0 and <1,250 ft. 
>50 and <2,000°F 
> 1 and <1000 ft/sec 
> 1 and < 30,000,000 :ft3 /sec and/or 

rate calculated from Velocity and Diameter. 

• 

• 

• 

• 

• 

• 

Sign checks.  The system reports suspect signs based on the knowledge that particular 
parameters are always of a given sign (e.g., stack height are positive). 

Missing data checks. The system automatically fills missing data with Source Category 
Code-specific default data generated from the inventory being processed. 

Incorrect data checks.  Data are corrected automatically when they can be computed 
based on specific mathematical relations between data elements (such as exit velocity for 
stack parameters). 

Completeness cross-checks are performed between the plant, stack, process, and emission 
hierarchy levels of point source inventories.  Each level should be associated with data at 
the next lower and higher level.  For example process data should be subsidiary to 
corresponding stack information, and superior to associated emission data.  Specific 
quality control checks are provided for each level of point, area, and mobile source 
inventories. 

Location checks, which are applied to determine that the specified political unit (e.g., 
county) is valid in each case, and that latitude and longitude coordinates (for point  . 
sources) are not reversed or missing.  Political unit identifiers are checked against a list 
within IDA.  When point-source latitude and longitude coordinates are missing, they are 
currently assigned to the pseudo-center of the appropriate county.  The missing values are 
usually associated with smaller point sources.  This assignment procedure can result in 
over-representation at the county center.  Work is planned to better distribute point 
sources reported without geographic 'coordinates. 

Some emission inventories do not include sulfate (S04)  emission data, which are important 
in modeling of particulate matter.  The IDA can approximate S04  emission data by 
multiplying the source-category specific ratios of S04 to sulfur dioxide (S02)  taken from 
the 1985 National Acid Precipitation Assessment Program (NAPAP)  inventory, with S02 
values in another inventory.  The NAPAP inventory is considered to contain the best 
separate national modeling estimates of both 802  and S04  emissions at this time.  If an 
inventory contains 804  data, this approximation feature is not used.  The S04  estimator is 
optional in IDA.  However, it is applied automatically in INPRO if no S04  values are 
present.  With this method, S04  estimates were supplied forthe 1990 and 1995 U.S. 
inventories included with the initial Models-3 release. 

Occasionally an emission inventory contains an error in particulate matter emission values 
such that the fine fraction (PM25)  emissions exceed the value of the coarser fraction 
emissions (PM10)  of which they are a part.  In the absence of more specific data, or 
information that the coarser particulate emission (PM 10)  are in error,  IDA automatically 
computes a new PM2.5 value using the 1990 national inventory ratio of PM25 to PM 10 , 
which is expressed as PM2.5 = .2411  PM10• 

Point source stack emission parameters are essential to plume rise calculations in 
modeling.  However, the stack parameters often have erroneous or missing values in 
emission inventories.  In addition to range checks,  IDA addresses the problem in two 
ways: 

(1) IDA examines point source files for consistency between stack flow rate, 
velocity, and diameter.  The following relationship is used to correct erroneous 
velocity and flow  values: 

F =  V * 0.785398 * D2 

where: 
F is flow (cubic feet/second) 
Vis velocity (feet/second) 
D is stack diameter (feet) 

(4-1) 

(2) In the event that all or most stack parameters are missing for a given point 
source, IDA supplies default values which are computed by SCC from other point 
sources in the same emission inventory. 

4.2.2  The MEPPS Input Processor (INPRO) 

The INPRO includes the MEPPS processors used to establish an emission study, the grid 
directory structure, and time-specific cases.  These items are usually defined using the Models-3 
Science Manager, specified through the Study Planner in the Models-3 framework, and passed to 
INPRO, unless MEPPS is being operated through the Tools Manager. 

Import and Processing of Emission Inventories 

The INPRO serves as the principal data access point for MEPPS.  Two primary sets of data 
manipulations are accomplished in INPRO to prepare the data for further study-specific 
processing in MEPPS: 

The emission inventory data are subsetted and imported for the grid specified in the main 
MEPPS window and (if necessary) created in Science Manager.  The emission data are 
subset from the user-selected emission inventory for the kinds of emission sources (point, 
area, mobile) specified by the user.  The INPRO accepts inventories from IDA in the NET 
or IDA inventory formats (see Section 10.8 of the User Manual).  The user must be sure 
that any aggregated (not hourly) data in the inventory for biogenic and mobile source 
emissions (other than vehicle miles traveled) are deleted from the inventory before use. 
Otherwise, MEPPS will double-count these emissions because hourly biogenic and mobile 
source emissions are modeled during processing. 

The INPRO imports meteorological data specific to the spatial domain and temporal case 
defined in Science Manager and selected in the MEPPS main window, provided that the 
meteorological data have been previously generated.  The data come from the Mesoscale 
· Meteorology Model 5 (MM5), via MCIP.  The MCIP converts MM5 output to NetCDF 

IO/API files containing information needed by the rest of the Models-3 system (see 
Section 7.3  ofthis volume and Section 2.3.1  of the User Manual).  In MEPPS, 
meteorology data are needed to model hourly biogenic and mobile source emissions 
(Sections 4.2.4.1  and 4.2.4.2).  The MEPPS uses four of the files provided by MCIP, 
named MET_CR0_2D_ xx, MET_CR0_3D_ xx, GRID_DOT_2D_ xx, and 
MET_DOT_3D_ xx.  The terms "CRO" and "DOT" refer to the cross and dot points of 
grids, respectively, and the suffixes "xx" are study specific identifiers.  Refer to Chapter 12 
for the details of the grid system definitions. 

ROG-to-TOG Adiustment 

Emission inventories may reflect different assumptions or methodologies with respect to volatile 
organic compound (VOC) gases.  They may be reported as VOC, reactive organic gases (ROG) 
or total organic gases (TOG).  It is typical to require TOG for air quality modeling, whereas the 
VOCs comprising organic gases in many regional inventories are reported as ROG.  This occurs 
because some emission measurement techniques do not capture all of the discrete hydrocarbon 
compounds in the emission stream.  Since the hydrocarbon speciation profiles are based on total 
organic compounds, the measured value of the hydrocarbon must be adjusted to account for the 
missing hydrocarbon components for the emission measurements that fail to capture the total 
organic emission stream.  This adjustment is included as an option when importing an inventory 
using INPRO.  The default is "yes" - perform the adjustment.  More details are given in the 
speciation discussion in Section 4.2.5. 

4.2.3  Processing Procedure 

A detailed description of the processing procedure is given in Chapter 6 of the Models-3  Volume 
9B:  User Manual.  Briefly, EMPRO receives point- and area-source emission data from INPRO 
for use in biogenic- and mobile-source emission modeling.  The general sequence of processing 
for all of the emission data is (1) spatial allocation, (2) temporal allocation, and (3) chemical 
speciation.  There are some variations in processing between the general types (point, area, 
biogenic, mobile) of emission data because of the spatial and temporal resolution available and 
method of estimation.  The gridded, temporally allocated and speciated data are passed to 
OUTPRO where they are merged into output files in the NetCDF VO API format. 

4.2.3.1 

Spatial Allocation of Emission Data 

The emission inventory data are usually provided by discrete point sources or by political units 
(typically counties in the United States).  In order to prepare the  data for use in air quality models 
and for analysis by grid-oriented visualization tools such as PA VE, the data must be spatially 
allocated (gridded) on a map projection and rectangular grid.  The map coordinate system, grid 
position and spatial resolution are defined from windows in the Models-3 :framework Science 
Manager (Sections 7.1  and 7.2 of the Models-3  Volume 9B:  User Manual), although the actual 
grid creation is performed by the ARC/Info program.  The MEPPS is capable of using Lambert 
Conformal, Mercator, Albers, and Universal Transverse Mercator (UTM) map projections; and 
several datums including perfect sphere, NAD83, and Clarke.  However, in order to maintain 
consistency with gridded MM5 meteorology data, a spherical datum must be used.  The radius 
used for Models-3 applications is 6370.997 kilometers. 

Aside from the spherical datum restriction, the gridding processor allows development of a variety 
of emission grid systems which are used in different aspects of air quality modeling studies, 
including emission processing and in CMAQ.  The gridding processor is written in the ARC® 
Macro Language (AML®) of the Arc/Info® geographic information system (GIS).  Grids are used 
in MEPPS to spatially disaggregate or aggregate emission estimates, using land use/land cover 
data, and area source spatial surrogate data.  Surrogate data are needed to spatially distribute 
emission data because the exact location of emission sources totaled for a county, for example, 
are seldom known.  For example, census tract population data are of higher spatial resolution than 
county boundaries, and therefore population distribution could be assumed to be directly 
proportional to the spatial distribution of dry cleaning establishments.  Land use cover data, 
detailed road network maps, and many other kinds of spatial data may be used as spatial 
surrogates to locate different source types of emissions, if GIS coverages of these data are 
available.  At this time MEPPS is provided with GIS coverages for political boundaries and land 
cover for North America, and detailed population data and road networks for the United States. 

The primary input to the gridding processor consists of user-supplied data that are entered into 
windows or chosen from a pick-list in the Coordinate System and Grid windows of the Models-3 
Science Manager. These data define the grid projection system, the origin of the grid, cell size, 
etc., which is then generated by Arc/Info® through MEPPS.  The primary output of the gridding 
processor for MEPPS is an ARC® coverage which consists of the intersection of the political 
boundaries and the fixed grid. 

Use of the Arc/Info® GIS as the key component in the gridding processor allows substantial 
flexibility in the definition and use of grids and surrogate data. It also allows MEPPS to 

incorporate visualization methods for quality control and for managing and querying of the spatial 
emission data. 

To generate the emission modeling grid structure, a political boundaries (state and county 
boundaries) Arc/Info® coverage named "counties" must already exist in the exact map projection 
that is intended for the emission modeling grid structure.  Accordingly the counties  coverage 
provided with MEPPS is in the Lambert Conformal projection.  If inconsistent projections are 
used, the gridding processor produces unpredictable results. The processor produces three files 
that are used elsewhere in EMPRO: 

A running history of emission modeling grid structure changes. 
A list of the geographic location of each grid cell in the emissions modeling grid structure. 
The Arc/Info® coverage of the emission modeling grid structure. 

The gridding processor supports the following subset of Arc/Info® map projections: 

• 
• 
• 
• 
• 

UTM (Universal Transverse Mercator) 
Lambert (Lambert Conformal Conic) 
Albers (Albers Conic Equal Area) 
Geographic (actual latitude and longitude coordinates rather than a projection) 
State (State Plane Coordinate System) 

For more information about the Arc/Info® map projections, refer to the following: 

• 

• 

ARC/INFO~ User's Guide: Map Projections &  Coordinate Management,  Concepts and 
Procedures. 
ARC/INFO® Command References: ARCD Command References,  Commands J-Z 

The UTM map projection is a specialized application of the Transverse Mercator projection.  It is 
limited to use between the latitudes of 84 ° North and 80° South, and divides the earth into 60 
longitudinally-defined zones (UTM zones 1-60) with each zone spanning 6 ° of longitude.  UTM 
zone 1 starts at 180 ° West longitude and ends at 17 4 ° West longitude.  UTM zone 2 starts at 
17 4 ° West longitude .and ends at 168 ° Westlongitude, and so on around the globe.  Shape, area, 
direction, and distance errors are all minimized if a study area is within a single zone; however, 
error increases rapidly as study areas cross UTM zone boundaries. 

The Lambert map projection is a projection of the earth onto a cone intersecting the_ earth along 
two parallels called standard parallels (for example 30° North and 60° North).  The projection is 
good for large scale (continental or smaller), middle latitude (between 45 ° North and '45 ° South) 
study areas.  Shapes are maintained on a small scale (state or smaller), and large shapes 
(countries, continents) are minimally distorted.  Area and distance are maintained near the 
standard parallels, but area is reduced between the standard parallels and increased beyond the 
standard parallels; that is, the study area is accurately represented between the standard parallels. 

Direction is accurate within the entire study area.  CMAQ is currently tested and used with a 
Lambert conformal projection. 

The Albers map projection is suitable for study domains where the east-west extent is greater than 
the north-south extent.  Shape is minimally distorted near the standard parallels as long as the 
study domain's east-west extent is greater than the study domain's north-south extent.  Area is 
accurate within the study domain.  Direction is accurate only at the standard parallels and 
minimally distorted between the standard parallels.  If the study area is in the middle latitudes ( 45 ° 
North to 45 ° South), distances are minimally distorted at and between the standard parallels.  If 
the study area falls outside of the middle latitudes, distance error increases rapidly as the poles are 
approached. 

The Geographic system is not a true map projection; instead it is a global reference system.  It is 
supported as a map projection because geographic positioning (latitude and longitude) is the most 
widely used method of map location.  The origin of the geographic global reference system is at 
0° longitude (Meridian of Greenwich) and 0° latitude (equator).  Directions in the northeast 
quadrant are measured in positive longitude degrees by positive latitude degrees.  Directions in 
the northwest quadrant are measured in negative longitude degrees by positive latitude degrees. 
Directions in the southwest quadrant are measured in negative longitude degrees by negative 
latitude degrees.  Directions in the southeast quadrant are measured in positive longitude degrees 
by negative latitude degrees. 

The State system is also not a true map projection; instead it is a specialized coordinate system for 
the United States, Puerto Rico, and the United States Virgin Islands.  The State system divides 
the aforementioned areas into a total of 120 zones of varying sizes.  The map projection is 
inherent in each zone.  The three map projections that are used ill the State system are the 
Lambert Conic Conformal (for zones with where the east-west extent is greater than the north(cid:173)
south extent), Transverse Mercator (for zones where the north-south extent is greater than the 
east-west extent), and Oblique Mercator (used only for the Alaska Panhandle).  Direction, 
distance, area, and shape errors vary with the map projection inherent in each zone; however, the 
zones have been designed so that error is reduced or eliminated as long as the study area falls 
entirely within a state plan zone. 

The spatial allocation process grid description file ($EMS_ G RD/grd _ desc. in) references 
numerous data items that are used by the Grid Definition Model to prepar1~ the emissions 
modeling grid structure.  Table 4-2 lists the run description file data items that affect processing in 
the Grid Definition Model. 

Table 4-2.  Data Items That Affect the Gridding Processor 

EPA/600/R-991030 

rid  a 

Tutorial 36km 

Resolution 

descriptive text for the emissions 
modeling grid 

Grid 

SOUTHWEST 

10 

-108000 

location on/in the grid cell from 
which to make measurements 
(NORTH, NORTHEAST, EAST, 
SOUTHEAST, SOUTH, 
SOUTHWEST, WEST, 
NORTHWEST, CENTER) 

UTM zones for which the 
emissions modeling grid exists 
(1-60) 

southwest x comer origin 
(measured from the origin of the 
projection) of the emissions 
modelin  domain  meters) 

southwest y comer origin 
(measured from the origin of the 
projection) of the emissions 
modelin  domain (meters) 

.· ..... . 

<</  M~iiri.•·•·•i•·•·•·•······ 
··••··•···•··• id~riti.fi~t············· 

Grid Id: 

Description: 

Cell Location: 

(S,E) 

UTMzone: 

(S,E) 

Origin X 

direction: (S,E) 

c 
c 

c 

N 

N 

idid 

griddesc 

cell  loc 

utmzn 

utmxorig 

utmyorig 

Origin Y 

direction: (S,E) 

N 

-1080000 

cellsizx 

cellsizy 

xcells 

ycells 

zcells 

projectn 

Cell size X 

direction: (S,E) 

Cell size Y 

direction: (S,E) 

Number of 

cells X 

direction: (S,E) · 

Number of 

cells Y 

direction (S,E 

Number of 

cells Z 

direction: (S 

Name: (S,E) 

.N 

36000 

x grid cell size (meters) 

N 

N 

N 

N 

c 

36000 

y grid cell size (meters) 

21 

21 

10 

LAMBERT 

4-21 

number of grid cells in the x 
direction 

number of grid cells in the y 
direction 

number of grid cells in the z 
direction (currently not used by 
ARC/INFO) 

projection name (LAMBERT, 
UTM, ALBERS, STATE, 
GEOGRAPHIC 

Table 4-2.  Data Items That Affect the Gridding Processor 

Variable Name 

... ·.·.·.•,·.• .. ·.

.••. dMe····neti?fiu1 .... e\r .. ·.· 

1 

·.  ··.·.·. 
·.. 

·•  }~~~·!·  .,: 

~ial\1p1e  < •  (.•·.•·.·•·.·············· ..... ·.•·.•.·.•· .. ···.·.·.D····.· 

. .. -::..:.-.::::::::::~::=::~=r)==(~\:;:~:;:;:;:i 

.. ········.····.e··••.·.•.~.•ffi~tfo~  • ......... · 

·>  :-;-:::::::. .. .-- -

.·. 

-. 

....................... . 

.·.•.·.· .-.;.-

.:.:.:::::::;  ::::.: .. :;:.:.::  .. •.·.•,•,···:.· .. ·.·.··.·.:.:····· 

· .. · 

..... ·.· .. ;· 

.... <·  ··. 

: 

·. 

. ... ·.· .. ·· 

projunit 

Units: (S,E) 

xshift 

X-shift: (E) 

yshift 

Y-shift: (E) 

projzone 

UTMzone: 

(S,E) 

c 

N 

N 

N 

METERS 

0.0 

0.0 

16 

fipszone 

FIPS zone for 

state plane 

projection: (E) 

N 

3701 

datum 

p_lsp_dd 

p_lsp_mm 

p_lsp_ss 

Datum 

conversion 
name for 
projection: 

(S,E) 

1st standard 
parallel DD: 

(S,E) 

1st standard 
parallel MM: 

(S,E) 

1st standard 
parallel SS: 

(S.E) 

c 

N 

N 

N 

MM5 
(Perfect 
sphere) 

30 

0 

0.00 

units used to make measurements 
in the selected projection 
(METERS, FEET, DD [decimal 
degrees]) 

constant value to add to x input 
coordinates (value in projunit(cid:173)
typically 0.0) 

constant value to add to y input 
coordinates (value in projunit -
typically 0.0) 

State Plane or UTM zone (used 
only when projectn is  ST A TE or 
UTM -- see ARC™ Command 
References,  Commands J-Z; 
Table PROJECT-3 and Table 
PROJECT-4 for valid values) 

FIPS code for State Plane zone 
(used only when projectn is 
ST ATE -- see ARC™ Command 
References,  Commands J-Z; 
Table PROJECT-5 for valid 
values) 

datum upon which input 
coordinates are based (used only 
when projectn is ST A TE -(cid:173)
NAD27, NAD83, UNKNOWN) 

degree of first standard parallel 
(only for projectn ALBERS or 
LAMBERT) 

minutes of first standard parallel 
(only for projectn ALBERS or 
LAMBERT) 

seconds of first standard parallel 
(only for projectn ALBERS or 
LAMBERT) 

4-22 

Table 4-2.  Data Items That Affect the Gridding Processor 

···· 

1::::r  0:  . ·... 
,:•::·::  :\~i~!:~~~r·ame······ ... ······ 
. / .· 
\.)\:11·.·  .'. :\ 
········· 

:::.:·~ 

· · }\ <::>::(:·:·:::·· 

::::: ::::·~~~!\  ·•·  ""  •). :' '.}/ ······ 

::::.Fff 

:::: 

········· 

.·:-::::. 

.. · ....•. 

: .. :. 
:....=.:. 

.····:  (:  )· 

• .........  ·.·.· 
·:.n · jg.· ;jii:~~s00: .:.::. 

·::::·:·:;  ····~:/•••<:::. 

·.·~ 

• ·· :; .: 
······  •.  •/•/ 

: 

······ .·.  · .· . 

.f) 

p_2sp_dd 

p_2sp_mm 

p_2sp_ss 

p_cen_dd 

p_cen_mm 

p_cen_ss 

p_lpo_dd 

p_lpo_mm 

p_lpo_ss 

Menn 

: 1<l~litiri¢r : 
2nd standard 
parallel DD: 

(S,E) 

2nd standard 
parallel MM: 

(S,E) 

2nd standard 
parallel SS: 

(S,E) 

Central 

meridiart DD: 

(S,E) 

Central 

meridian MM: 

(S,E) 

Central 

meridian SS: 

{S,E) 

Latitude of 
projection 
origin DD: 

(S,E) 

Latitude of 
projection 
origin MM: 

(S,E) 

Latitude of 
projection 
origin SS: 

(S,E) 

N 

N 

N 

N 

N 

N 

N 

N 

N 

60 

0 

0.00 

-90 

0 

0.00 

40 

0 

0.00 

0.0 

0.0 

degrees of second standard 
parallel (only for projectn 
ALBERS or LAMBERT) 

minutes of second standard 
parallel (only for projectn 
ALBERS or LAMBERT) 

seconds of second standard 
parallel (only for projectn 
ALBERS or LAMBERT) 

degrees of central meridian of 
projection (only for projectn 
ALBERS or LAMBERT) 

minutes of central meridian of 
projection (only for projectn 
ALBERS or LAMBERT) 

seconds of central meridian of 
projection ( c:inly for projectn 
ALBERS or LAMBERT) 

degrees of latitude from 
projection origin (only for 
projectn ALBERS or LAMBERT) 

minutes of latitude from 
projection origin (only for 
projectn ALBERS or LAMBERT) 

seconds of latitude from 
projection origin (only for 
projectn ALBERS or LAMBERT) 

false easting (only for projectn 
ALBERS or LAMBERT --
meters) 

false northing (only for projectn 
ALBERS or LAMBERT --
meters) 

p_f_east 

False easting: 

N 

(E) 

p_fnorth 

False northing: 

N 

(E) 


Variable Name refers to the name as it is found in the SAS® data set run  desc.ssdOJ  which can be 
found in the directory referenced by the UNIX environment variable EMS_RUN (see Models-3 
Volume 9B:  User Manual, Chapter 6).  Menu Identifier refers to the descriptive text found on 
the grid definition window in Science Manager (S) or the EMPRO Grid Processor window (E) 
within MEPPS.  Type refers to the variable type -- N is a numeric variable, and C is a character 
variable.  Example gives an example of what might be entered for each data item.  Description 
provides descriptive text about the data item, supported units, and a list of valid values that each 
data item recognizes -- valid values and units are listed in parentheses. 

4.2.3.2 

Temporal Allocation of Emission Data 

Emission data that are based on annual, seasonal, weekly, or daily values must be temporally 
allocated (usually disaggregated) to hourly data for compatibility with the time scale of episodic 
air quality modeling.  Generally, this procedure applies to regional inventories of point- and area-· 
source emission data.  Modeled emission data, such as biogenic- and mobile-source emissions are 
generated as hourly data for the time period of interest.  Allocation of emission data from time 
periods greater than hourly (e.g., annual total, monthly total, weekly total), to hourly data is 
accomplished by use of seasonal, monthly, weekly, and daily diurnal temporal allocation factors to 
translate the data to daily total emission values.  The daily values are then transformed into 
emission values for each hour of a typical day by using user-supplied or default temporal 
allocation profiles.  The profiles assign proportions of the total daily emissions to each of the 24 
hours of a typical day.  Profiles are ideally source or source-category specific, but often are used 
for a range of similar source categories because of limited data on source category temporal 
variability.  The majority of diurnal temporal source profiles have been developed for point 
sources, since more detailed reporting and monitoring exist for point sources, particularly large 
point sources, than for area sources which are spatially diverse and variable.  Consequently are 
area source temporal allocation profiles tend to be less detailed and specific that point source 
temporal allocation profiles.  Most of the temporal profiles used as defaults in MEPPS, were 
developed for the National Acid Rain Precipitation Assessment Program (l'..f APAP) (Pratt et al., 
1990) and used in FREDS, with some more recent supplements (Moody et al.,  1995). 

. 

In the EMPRO module ofMEPPS, temporal allocation of point and area source category 
emission data is performed after spatial allocation of data in each main processor (point, area, 
biogenic, and mobile) and prior to speciation (see Chapter 6 of the Models·-3 User Manual).  This 
is transparent when running from Study Planner.  If running in MEPPS under Tools Manager, the 
user may enter source category or source-specific daily or diurnal hourly temporal allocation data, 
or elect to use profiles computed by EMPRO (procedure described in the following sections) or 
use temporal allocation profiles based on those developed for use in the FR.EDS processors as 
supplemented.  If a combination of emission inventory data at different temporal resolutions is 
used, EMPRO uses the most time-resolved (specific) data first, filling in with less time-specific 
data and applying temporal profiles as needed.  If hourly, daily, and annuall emission data are 
selected, EMPRO will provide hourly emission values taken from available data in the following 
order: 

Loading of hourly diurnal emission inventory (including Continuous Emission Monitoring 
(CEM) data); 
Loading and gridding of day-specific (daily) emission inventory data; 
Computing hourly emission data from annual or other longer-term emission inventory 
data. 

Further details concerning temporal allocatipn are discussed as part of the following descriptions 
of the basis for processing each basic type of emission source. 

4.2.3.3 

Point Source Emission Data Processing 

The point-source emission processor prepares gridded, temporally allocated point-source 
emission estimates suitable for speciation and reformatting for input to Models-3 framework for 
air quality modeling (e.g., CMAQ) (see Chapter 6 of the Models-3 User Manual).  As previously 
indicated, the point-source emission processor does not compute basic emission estimates using 
emission factors and source-specific information.  Instead, it reduces annual, point-source 
emission estimates to hourly, point source emissions estimates, unless the user is able to provide 
hourly emission data. 

The point-source emission processor begins by establishing study-specific foundation emission 
estimates taken by INPRO from an user-specified emission inventory database.  Foundation 
estimates (referred to as Foundation Files in MEPPS) are the basic annual emission inventory files 
imported to a processor (point, area, or mobile source) after quality control corrections have been 
applied and the data have been reduced to cover the study area only.  After a point-source 
foundation file has been created, the processor spatially allocates the emission data into the spatial 
allocation grid structure, temporally allocates the emission estimates, and updates the hourly 
emission estimates derived from the foundation annual inventory with day-specific hourly 
emission estimates or hourly CEM data (if available).  Usually, the point source-specific emission 
data are processed to files corresponding to the major hierarchical point-source data elements 
(i.e.,  Facility, Stack, Device, and  Process), and translated to SAS® data sets. 

Hourly emission estimates are computed using data from one of the following: 

• 

• 
• 

Gridded emission estimates derived from annual emission inventory data by applying 
factors :from source category-specific temporal allocation profiles 
Day and source-specific hourly emission data provided by the user 
Source-specific hourly CEM data. 

Typically, the primary inputs to the point-source processor are the foundation emission annual 
estimates which are supplemented by available day-specific emission estimates.  The primary 
output of the processor is the spatially and temporally allocated emission estimates. 

Computation of Point Source Emission Estimates 

The point-source emission processor treats emission estimates that have be:en prepared on one of 
the following bases: annual average; average day; or day-specific. 

Day-Specific Emissions Estimates 

Day-specific emission estimates are not computed by the MEPPS EMPRO point source 
processor.  The user must supply any available day-specific emission estimates to the processor. 
Because day-specific emission estimates are more representative of actual conditions, they replace 
the hourly emission estimates derived from disaggregated annual emission data, when available. 
Day-specific emission data formats are made consistent with the internal formats of the SAS® data 
sets derived from other (e.g., annual) point-source emission data when imported through IDA. 

CEM Hourly Emission Data 

The CEM data are a subset of hourly emission data derived from continuous air pollutant 
concentration monitors attached to components of specific facilities, usuaHy boilers or stacks of 
large point sources such as electric utilities.  The data elements included are hourly emission rates 
for Carbon Monoxide (CO), nitrogen oxide, (NOx), and sulfur dioxide (S02).  The CEM emission 
data are treated as hourly data imported to MEPPS via IDA.  Electric utility CEM data are 
identified by specific source using their ORIS (Office of Regulatory Information Systems) 
identification number and are mapped to the corresponding point source identification number 
from an emission inventory.  The CEM data are read in for a specified grid domain and day from a 
CEM dataset and substituted for hourly emission data derived from annual data.  The CEM 
emission data are used in the format of data available for electric utility emissions provided by the 
U.S. EPA Acid Rain Division.  The Acid Rain Division has electric utility CEM data for the 
United States for 1995 and 1996. 

Spatial Allocation 

Point sources are spatially allocated to an emission modeling grid by the geographic (latitude and 
longitude, UTM position) coordinates of a stack or by the geographic coordinates of the facility. 
The point-source emission data processor prepares an ASCII file of point-source identifiers and 
point-source geographic coordinate locations.  The processor reads the ASCII file that was 
generated by the location processor, generates the appropriate ARC/INFOO!> coverages, and 
prepares two ASCII files: 

• 
• 

A file which contains point source identifiers and grid cell location; and 
A file which contains point-source identifiers and latitude/longitude coordinates.  The 
process of assigning grid coordinates to point sources is an ARCffi..if 0® function; 
therefore, the underlying procedure follows the user documentation and proprietary code 
for the ARC/INFO® software. 

Temporal Allocation 

The EMPRO temporally allocates (produces hour-by-hour) foundation file emission estimates 
within each main emission processor (point, area, biogenic, ~d mobile emissions) based on 
operating schedule data that are provided in one of two ways. The operating schedule data may 
be passed into the MEPPS EMPRO module via an ASCII foundation file, which corresponds with 
the segment (process) level of point source inventory information.  For point sources, the 
temporal factors may be assigned by the user at the segment (process) level of the EMPRO point 
source hierarchy.  The hierarchy is closely aligned with tlhat of regional emission inventories. 
Temporal allocation factors may be also be applied at the device level in the facility, stack, device 
hierarchy.  Alternatively, default source-category-specific temporal allocation factors may be 
selected:  These factors were used in a MEPPS predecessor, FREDS, and are referred to as 
FREDS temporal allocation factors. The point source hierarchy for temporal allocation factors in 
FREDS is:  plant, point, temporal factors.  Source-specific temporal allocation factors are 
typically not available for large regional modeling domains.  Consequently, the default temporal 
allocation factors are commonly used in regional modeling, perhaps more than 90 percent of the 
time.  Note that EMPRO temporally allocates foundation file emission estimates, but not day(cid:173)
specific emissions estimates since the latter are entered on an hour-by-hour basis. 

EMPRO provides a variety of methods for identifying operating schedule data: 

• 

• 
• 
• 
• 
• 

Seasonal throughput fractions (winter [Dec, Jan, Feb], spring [Mar, Apr, May], summer  · 
[Jun, Jul, Aug], and fall [Sep, Oct,. Nov]) 
Hours per year in operation 
Days per year in operation; 
Weeks per year in operation; 
Days per week in operation; and 
Hours per day in operation. 

Any, none, or all of the operating schedule data can be supplied. If no operating schedule data are 
supplied, EMPRO uses a default continuous operating schedule of 24 hours per day, 7 days per 
week, and 52 weeks per year; otherwise, EMPRO filters 1through a hierarchy of the· operating 
schedule data to determine how to compute the temporal factors: 

• 
• 
• 

Weekly temporal factor; 
Daily temporal factor; and 
24 hourly temporal factors. 

To determine the weekly temporal factor, EMPRO determines the number of days in the year of 
interest and divides that value by 7 days per week.  For example, in a leap year, there are 29 days 
in February; therefore, the weekly temporal factor is 366 days/year+ 7 days/week). 

:  . 

EMPRO computes a daily temporal factor through a lookup table based on the value of average 
8-hour work days (days per week in operation) which is passed into MEPPS through the ASCII 
foundation files.  To determine the daily temporal factor, EMPRO examines the values for days, 
hours per year (houryear), days per year (dayyear), and weeks respecti:vely.  If days has a valid 
value, EMPRO takes no further action to determine the days per week in operation for the 
source.  If days does not have a valid value, EMPRO attempts to assign an operation code value 
to days by examining houryear, dayyear, and weeks respectively: 

• 

houryear (hours per year in operation) 

if houryear > 0 and houryear <= 850 then days = 2, 
ifhouryear > 850 and houryear <= 1250 then days= 3, 
ifhouryear >  1250 and houryear <= 1670 then days= 4, 
if houryear >  1670 and houryear <= 2100 then days= 5, 
ifhouryear > 2100 and houryear <= 2500 then days= 6, 
ifhouryear > 2500 then days= 7; 

• 

dayyear (days per year in operation) 

if dayyear > 0 and dayyear <= 110 then days = 2, 
if dayyear >  110 and dayyear <= 160 then days = 3, 
if dayyear > 160 and dayyear <= 210 then days = 4, 
if dayyear > 210 and dayyear <= 260 then days= 5, 
if dayyear > 260 and dayyear <= 315 then days = 6, 
if dayyear > 315 then days = 7; 

• 

weeks (weeks per year in operation) 

if weeks > 0 and weeks <= 7 then days = 1, 
if weeks > 7 and weeks <= 13 then days = 2, 
if weeks >  13  and weeks <= 19 then days = 3, 
if weeks >  19 and weeks <= 26 then days = 4, 
if weeks> 26 and weeks<= 33 then days= 5, 
if weeks> 33  and weeks<= 39 then d;:tys = 6, 
if weeks> 39 then days= 7. 

EMPRO computes an hourly temporal factor through a lookup table based on the value of hours 
(hours per day in operation) which is passed into EMPRO through the ASCII foundation files.  If 
hours has a valid value, the value is used and no further action is taken to determine the hours per 
day in operation for the source.  If hours does not have a valid value, EMPRO attempts to assign 
a value to hours by examining houryear, dayyear, and weeks respectively, using the above tables. 
If houryear, dayyear, or weeks has a valid value, then hours is assigned a value of 8, again based 
on an average work day of 8 hours.  If hours or days cannot be assigned through the method 
described above, operation is assumed to be continuous and hours is assigned a value of 24, and 
days is assigned a value of 7.  The following calculations are performed. 

4-28 

week_ fac = daysinyear I 7 
day_sumd =I, dy_act1, i =  1, ... 7 
day_faci = dy_act1Iday_sumd,i=1, ... 7 
hour_sumh =I, hr_act?, i =  1, ... 24 
hrpro~ = hr_act? I hour_sumh, i =  1, ... 24 

where  week_fac is the weekly temporal factor 

EPA/600/R-991030 

(4-2) 
(4-3) 
(4-4) 
(4-5) 
(4-6) 

daysinyear is the number of days in the year (365 or 366) 
day_ sum is the total relative activity for the week 
dy _act is an array that contains relative daily activities 
day _fac is the day of week temporal factor 
· hour_ sum is the total relative activity for the day 
hrprof  is an array of hourly temporal factors 
hr_ act  is an array that contains relative hourly activities 
d is an index indicating which days per week in operation code (days) to use 
h is an index indicating which hours per day in operation code (days) to use 
i is the integer count that applies (e.g., 7 days or 24 hours) 

EMPRO uses the temporal factors to allocate emission estimates to hourly values.  Application of 
the temporal factors depends on the temporal basis (annual average, day-specific, average day) 
that emissions estimates were input to EMPRO. 

• 

ifthe temporal basis code estt ="AA" (annual average) then 

hremisi = aceekg/( week_fac* day_fac * hrpro~), i =  1, ... 24 

(4-7) 

where  hremis is the array of gridded, hourly emissions estimates CNOx, TOG, CO, 

etc) (mass) 
aceekg is the emission estimates (mass) 
week_fac, day _fac, and hrprof are the weekly, daily and hourly temporal 

factors, respectively, computed by EMPRO 

if the temporal basis code estt ="AD" (average day) and (week_fac = 0 or day _fac 
= 0) then 

hremisi = 0.0, i =  1, ... 24 

(4-8) 

if the temporal basis code estt ="AD" (average day) and not (week_fac = 0 or 
day_fac = 0) then 

• 

• 

. hremisi = aceekg * hrpro~, i =  1, ... 24 

(4-9) 

• 

if the temporal basis code estt = "DS" (day-specific) then 

hremisi = aceekg * prot:, i = 1, ... 24 

(4-10) 

where  prof is an array of day-specific, hourly temporal factors 

4.2.3.4 

Area Source Emission Data Processing 

The area-source ·emission data processor prepares area-source emission estimates for speciation 
(lumped-model or discrete speciation) and reformatting for input to CMAQ or other Models-3 
framework components.  The area-source processor does not compute emission estimates from 
fundamental emission data.  It reduces annual, county-wide emission estimates to emissions on an 
hourly, grid cell-by-grid cell basis.  Most of the area source emission data processor is written in 
the SAS® programming language.  The area-source spatial surrogates allocation component of the 
processor is written in the ARC® Macro Language (AML ®).  The primary inputs to the processor 
are the area-source emission estimates for the spatial domain of interest, and day-specific emission 
estimates (if available).  The primary outputs are the spatially allocated, temporally resolved, 
emission estimates. 

The processor begins with an area-source emission data base, extracted by INPRO from an 
emission inventory as an ASCII file and automatically converted to a SAS<l!l file.  The area-source 
processor updates the estimates with any available day-specific estimates, spatially allocates the 
emissions into the emission modeling grid, and temporally allocates the criteria emissions. 

Emission Data Processing 

This section discusses how area-source emission estimates are read into, manipulated by, and 
quality-assured by the area-source emission data processor.  References are made to MEPPS 
source code where necessary to provide further details concerning area source emission 
allocation. 
The processor uses county-wide area-source emission estimates, that have been prepared 
externally as part of an emission inventory, to produce spatially allocated, temporally resolved, 
pollutant emission estimates.  To the extent that the inventory used includes small point sources in 
area source estimates, they are treated as area sources.  All data provided as point sources, 
regardless of magnitude, are processed as point sources in EMPRO.  The area-source emission 
data processor accommodates area-source emission estimates that have been prepared on the 
following bases: annual average; average day; or day-specific. 

Day-specific emission data enter the area-source emission data processor during the temporal 
allocation step.  Day-specific emission data  are not computed by EMPRO.  Like the foundation 
file emissions estimates, day-specific emission estimates are supplied from an external source to 
the emissions modeler.  The day-specific emissions estimates replace the area-source emission 
estimates derived from annual inventory data because day-specific emission data are more 
representative of actual conditions. 

Day-specific area-source emission estimates are summed to a daily total so that they are 
consistent with the internal formats of the SAS® data sets that maintain the other (e.g., derived 
from annual emission inventories) area-source emissions estimates,  which are passed to EMS-95 
on an hourly basis. 

Spatial Allocation 

Area-source emission estimates are allocated to a modeling domain through the application of 
spatial surrogates.  In general, surrogates approximate the value of unknown quantities.  For 
example, population can be used to estimate the number of gasoline service stations.  A spatial 
surrogate not only helps estimate the value of an unknown quantity, but a spatial surrogate also 
helps locate the unknown quantity. 

For each spatial surrogate, it is necessary to specify what data (categories ofland use/land cover, 
population counts, housing counts, etc.) contribute to the surrogate.  In EMPRO, county area, 
land cover, population (census), Federal Highway Administration major roadway, and 
TIGER/LINE roadway data for the United States are provided as ARC® coverages for use as 
surrogates. Others may be added by providing ARC® coverages generated external to MEPPS. 
County area, and less detailed population and land cover coverages are provided for Canada and 
Mexico.  Each area source category must be assigned a unique spatial surrogate value by grid cell. 
After the appropriate files have been populated, EMPRO grids the necessary data sets according 
to  the requirements of the user-defined spatial surrogates.  Each area source category (asct) 
which has been assigned to a spatial surrogate (k) can be allocated to grid cells (1,  m) through the 
application of Equation 4-11. 
* 
ratloij,k,I,m 

aceeij,k',I,m - aceeij,k' 

(4-11) 

-

. 

where  i is the index on states 

j  is the index on counties within the states 
k is the spatial surrogate index 
k' is the area source category index (directly related to k) 
1 is the x cell index 
m is the y cell index 
acee is the county-wide area source emissions estimate (mass) 
ratio is the gridded surrogate ratio by state/county/surrogate/cell 

Each surrogate is computed through the application of Equations 4-12 and 4-13. 

surtotij,k = ~1  ~m attributeij,k,I,m 

ratioij,k,I,m =  attributeij,k,I,m I surtotij,k 

where: 

i is the index on states 
j is the index on counties within the states 

4-31 

(4-12) 

(4-13) 

k is the spatial surrogate index 
1 is the x cell index 
m is the y cell index 
surtot is the total value of a surrogate within specified (inde:xed) states and 
counties 
attribute is the gridded value of the surrogate attribute by 

state/county/surrogate/cell 

ratio is the gridded surrogate ratio for specified (indexed) states/counties/ 

surrogates/cells 

In the case of census data or other area-based or length-based surrogate information, it is 
necessary to area-apportion or length-apportion the surrogate (such as population or housing) 
information prior to aggregation to the cell level.  This is because the locale of interest crosses cell 
boundaries.  The assumption is that the surrogate information (such as population or housing) has 
a constant density across the locale (in the case of population or housing data, a constant density 
across the census tract).  Therefore, in some cases, it is necessary to apply Equations 4-14 
through 4-16 prior to the application of Equations 4-12 and 4-13. 

arlg_tot;j,k =  :E1:Em arealengij,k,l,m 

ap_ratio;j,k,J,m =  arealengij,k,l,m I arlg_totij,k 
attribute;j,l,m =  attribute;j,k * ap_ratioij,k,l,m 

where  i is the index on states 

(4-14) 

(4-15) 

(4-16) 

j  is the index on counties within the states 
k is the locale of interest index (such as census tract or roadway) 
1 is the x cell index 
m is the y cell index 
arlg_tot is the total area or length of a locale of interest within specified (indexed) 

states and counties 

arealeng is the gridded value of the specified (indexed) locale of interest by  state/ 
county /surrogate/cell 
ap _ratio is the gridded ratio of the locale of interest specifa:d (by indices) states/ 

counties/locales/cell 

attribute is the surrogate data (population, road length, etc.) for the area specified 

by indices. 

As a check for Equations 4-14 through 4-16, the following must be true: 

(4-17) 

Temporal Allocation 

4-32 

Temporal allocation of area source emission data is performed in an identical.manner as described 
for point source processing in Section 4.2.3.3, although it is almost always necessary to use 
default temporal allocation profiles.  Please refer to that section for a discussion of temporal 
allocation of area sources. 

4.2.4  Modeled Emission Data 

Emission data from available emission inventories are spatially and temporally allocated as 
described in the preceding paragraphs.  Many anthropogenic area and point sources of emissions 
vary little or predictably with time, and can reasonably be disaggregated for regional modeling. 
However, some emission data are highly variable, diurnally and.seasonally, because they are 
dependent on environmental variables, such as temperature, humidity, and solar insolation.  It is 
more accurate to model these kinds of emissions on an hourly basis for direct use in episodic air 
quality modeling.  The two principal kinds of sources for which hourly emission data are normally 
modeled are mobile sources and biogenic sources.  In both cases, MEPPS takes hourly 
meteorological data from  MCIP output derived from MM5. 

4.2.4.1 

Biogenic Emissions 

Hourly biogenic emission rates for biogenic VOC compounds (including  isoprenes, 
monoterpenes, and soil NO) for each grid cell are estimated using the Biogenic Emission 
Inventory System, Version 2 (BEIS-2) within MEPPS.  In order to estimate biogenic emissions 
for modeling, it is necessary to apply biogenic emission and biomass factors to a geographic 
distribution of land cover.  The BEIS-2 was developed to fill this need separately from Models-3 
as an improvement on BEIS-1  (Pierce et al.,  1990; Geron et al.,  1994), and has been used in 
conjunction with different air quality modeling systems, i.ncluding the Regional Acid Deposition 
Model (RADM) (Pierce et al., in press), the Regional Oxidant Model (ROM), and now Models-3 
CMAQ.  Additional information concerning BEIS-2 can be found in the Emission Inventory 
Improvement Program report on Biogenic Sources Preferred Methods (EIIP, 1996) and Pierce et 
al.  (1998).  The BEIS-2 model applies emission flux factors specific to tree genera and 
agricultural crop types by geographic area for biogenic emission species in accordance with 
equation 4-18. 

ER;= Lj [Aj * EF * Fu(S,T)] 

(4-18) 

where: ER is the emission rate (in grams/sec/model cell) 

i is the chemical species (e.g., isoprene, monoterpene) 
j is the vegetation type 
A is the vegetation area (meter) in a grid cell 
EF is the emission factor (micrograms/gram of leaf biomass/hour), and 
Fi/S,T) is an environment factor to account for solar radiation Sand leaf temperature T 

4-33 

Vegetation emission flux factors were adapted from those compiled by Geron et al. (1994) for 77 
tree genera.  Emission flux factors for 16 agricultural crops were taken.primarily from Lamb et al 
(1993), and the emission factors applied to 34 land cover types are from the work of Guenther et 
al. (1994).  Emission flux factors by land cover type are used principally for Canada and the 
western United States where genus-level forest cover and agricultural crop data were not 
available.  Biogenic emission flux factors for summer and winter conditions are given in Table 4-3 
and Table 4-4, respectively.  The vegetation classes are taken from the Biogenic Emission Land 
Use Database (BELD) (Kinnee et al., 1997), which in tum is drawn from other land cover data 
sets, with an emphasis on forest and agricultural land cover.  ·Spatial resolution of the raw 
(original) land cover data is at the county-level for the United States and sub-province level for 
Canada.  Emission flux factors are based on full leaf summer conditions normalized to leaf or soil 
temperatures of 30°C and photosynthetically active radiation (PAR) of 1000 micromoles/m2/sec. 
For use in regional modeling, the mass ofbiogenic emissions are converted to moles by dividing 
the mass (grams-compound) by the molecular weight of the compound.  The emission factors for 
tree genus and agricultural vegetation, and used in the Models-3 application ofBEIS-2 are 
compiled  by Pierce et al. (1998). 

Table 4-3.  Summer Biogenic Emission Flux Factors (µg-compound m·2hr- 1
Biogenic Compounds by Vegetation Category 

)  for Principal 

Vegetation or 
Land Cover 

lsoprene 

.  } 
.· .. Terpe,p~. 'fiii,i'i 

... · .. · .;::  }  ········· 

.. ·.·.·. 

Code 

Abie 

Acac 

Acer 

Aesc 

Aila 

Aleu 

Alfa 

Ainu 

Amel 

Asirn 

Avie 

Barl 

No. 
.• .. ··.· 

LeafAr.e~ ·• 
"  1riaex{m2 
. -: 
· 
:-·· ... ·· 
. .  Jri~2r 
. 

... 

:···· 

.. 
. ·. ·•·. 

:Qescription > · ' , ' ,  
::: -: : :.: ·::)?(~; :::·::::::::::'.:;·< ; . 

·.·. 

.. 
... 

........... 
.. 
.  .. · 
-:--:<·.·.;··· 
. ............... 

..... · .......... 

170.0 

79.3 

42.5 

42.5 

42.5 

42.5 

19.0 

42.5 

42.5 

42.5 

42.5 

7.6 

5100.0 

2380.0 

680.0 

42.5 

42.5 

42.5 

7.6 

42.5 

42.5 

42.5 

42.5 

19.0 

2775.0 

1295.0 

693.7 

693.7 

693.7 

693.7 

11.4 

693.7 

693.7 

693.7 

693.7 

4.5 

4.5 

4.5 

4.5 

4.5 

4.5 

12.8 

4.5 

4.5 

4.5 

4.5 

11.4 

256.7 

4-34 

7 

5 

5 

5 

5 

5 

0 

5 

5 

5 

5 

0 

Abies (fir) 

Acacia 

Acer (maple) 

Aesculus (buckeye) 

Ailanthus 

Aleurites (tung-oil tree) 

Alfalfa 

Alnus (European alder) 

Amelanchier ( serviceberry) 

Asimina (pawpaw) 

A vicennia (black mangrove) 

Barley 

Table 4-3.  Summer Biogenic Emission Flux Factors (µg-compound m-2hr- 1
Biogenic Compounds by Vegetation Category 

)  for Principal 

EP Af 600/R-99/03Q 

Barr 

Betu 

Borf 

Burne 

Carp 

Cary 

Casp 

Cast 

Casu 

Cata 

Cedr 

Celt 

Cerc 

0.0 

42.5 

910.0 

42.5 

42.5 

42.5 

42.5 

42.5 

29750.0 

42.5 

79.3 

42.5 

42.5 

0.0 

85.0 

713.0 

42.5 

680.0 

680.0 

42.5 

42.5 

42.5 

42.5 

0.0 

693.7 

755.0 

693.7 

693.7 

693.7 

693.7 

693.7 

693.7 

693.7 

1269.3 

1295.0 

85.0 

42.5 

693.7 

693.7 

Cham 

170.0 

340.0 

2775.0 

42.5 

745.4 

1550.0 

0.5 

42.5 

42.5 

7.6 

42.5 

680.0 

1366.6 

1564.0 

0.0 

680.0 

42.5 

19.0 

42.5 

1050.0 

660.0 

Citr 

Cnif 

Conf 

Corn 

Coru 

Co ti 

Cott 

Crat 

Cs wt 

Desh 

65.0 

94.5 

56.7 

57.8 

4-35 

0.0 

4.5 

4.5 

4.5 

4.5 

4.5 

4.5 

4.5 

4.5 

4.5 

4.5 

4.5 

4.5 

4.5 

4.5 

4.5 

4.5 

693.7 

993.9 

1036.0 

0.0 

577.6 

693.7 

693.7 

4.5 

4.5 

11.4 

256.7 

693.7 

770.0 

4.5 

0.2 

0 

5 

5 

5 

5 

5 

5 

5 

7 

5 

7 

5 

5 

7 

5 

9 

6 

0 

5 

5 

0 

5 

2 

0 

Barren 

Betula (birch) 

Boreal forest (Guenther*) 

Bumelia (gum bumelia) 

Carpinus (hornbean) 

Carya (hickory) 

Castanopsis ( chinkapin) 

Castanea (chestnut) 

Casuarina (Austl pine) 

Catalpa 

Cedrus (Deodar cedar) 

Celtis (hackberry) 

. Cercis (redbud) 

Chamaecyparis (prt-orford 

cedar) 

Citrus (orange) 

BEIS conifer forest 

Conifer forest (Guenther) 

Com 

Comus (dogwood)  . 

Cotinus (smoke tree) 

Cotton 

Crataegus (hawthorn) 

Herbaceous Wetlands 

(Guenther) 

Desert shrub (Guenther) 

Table 4-3.  Summer Biogenic Emission Flux Factors (µg-compound m-2hr-1
Biogenic Compounds by Vegetation Category 

)  for Principal 

Vegetation or 
Land Cover 

Isoprene 

Terpene•·• 

·.:···:····:·.·.·····.·  ··.·.· 

...... . .... 

••··•·.·•·•Other 
..........  voes  •t·? 

.•:···:·:·· 

..  . 

693.7 

·······:.··········~~············  · t~~t:x;:g~;: 

rri4~~ tiii:t  .... :::;::.:;:;;.(::>/(/.:·.:··. 
... .  irt~)\ .  . /: .. ::··:::-:-:···.·· 

............. : ....... :.: ... : ....... 
... 

:·:; . 

...· 

.. 

· .·. · ... · • .. ·.·.···.·. Descfrjptfon 

' , .  

···•>> 
. .  ····•· 
·.·<  > 

Diospyros (persimmon) 

Eucalyptus 

Fagus (american beech) 

Fraxinus (ash) 

Gleditsia (honey locust) 

Gordonia (loblolly-bay) 

Grass 

Gymnocladus (KY 

coffeetree) 

Halesia (silverbell) 

Hardwood forest (Guenther) 

Hay 

Ilex (holly) 

Juglans (black walnut) 

Juniperus (east. red cedar) 

Laguncularia (white 

mangrove) 

Larix (larch) 

Liquidambar (sweetgum) 

Liriodendron (yellow poplar) 

Maclura ( osage-orange) 

Magnolia 

Malus (apple) 

Melia (chinaberry) 

Mixed forest (Guenther) 

Morns (mulberry) 

Code 

Dios 

Eu ca 

Fagu 

Frax 

Gled 

Gord 

Gras 

Gymn 

Hale 

Harf 

Hay 

Hex 

Jugl 

Juni 

Lagu 

Lari 

Liqu 

Liri 

Macl 

Magn 

Malu 

Meli 

Mixf 

Moru 

42.5 

.. 

42.5 

29750.0 

1275.0 

42.5 

42.5 

42.5 

42.5 

56.2 

42.5 

42.5 

8730.0 

37.8 

42.5 

42.5 

79.3 

42.5 

255.0 

42.5 

42.5 

42.5 

140.5 

42.5 

42.5 

436.0 

94.5 

85.0 

1275.0 

476.0 

42.5 

693.7 

693.7 

693.7 

693.7 

693.7 

84.3 

693.7 

693.7 

882.0 

56.7 

693.7 

693.7 

1295.0 

693.7 

42.5 

42.5 

693.7 

29750.0 

1275.0 

42.5 

42.5 

42.5 

42.5 

42.5 

85.0 

42.5 

1275.0 

42.5 

42.5 

693.7 

693.7 

693.7 

693.7 

693.7 

693.7 

11450.0 

1134.0 

1140.0 

42.5 

85.0 

693.7 

4-36 

4.5 

5 

4.5 

4.5 

4.5 

4.5 

4.5 

57.8 

4.5 

4.5 

4.5 

12.8 

4.5 

4.5 

4.5 

4.5 

4.5 

4.5 

A.5 

4.5 

4.5 

4.5 

4.5 

4.5 

4.5 

5 

5 

5 

5 

5 

0 

5 

5 

5 

0 

5 

5 

7 

5 

5 

5 

5 

5 

5 

5 

5 

5 

5 

Table 4-3.  Summer Biogenic Emission Flux Factors (µg-compound m-2hr- 1
Biogenic Compounds by Vegetation Category 

)  for Principal 

EP A/600/R-99/030 

Mscp 

Nmxf 

Nyss 

Oak 

Oats 

Oded 

Ofor 

Oksv 

Ostr 

Othe 

Oxyd 

Pacp 

Past 

Paul 

Pean 

Pers 

Pice 

Pinu 

Plan 

Plat 

Popu 

Po ta 

Pros 

Prun 

7.6 

19.0 

10150.0 

1100.0 

5950.0 

3108.3 

7.6 

2112.4 

56.2 

7350.0 

42.5 

56.2 

42.5 

55.0 

56.2 

42.5 

102.0 

42.5 

255.0 

255.5 

19.0 

368.8 

140.5 

100.0 

42.5 

140.5 

255.0 

79.8 

140.5 

42.5 

255.0 

255.0 

I 1.4 

850.0 

693.7 

894.2 

12.3 

4.5 

4.5 

4.5 

I 1.4 

256.7 

871.8 

84.3 

600.0 

693.7 

4.5 

4.5 

4.5 

4.5 

84.3 

57.8 

693.7 

47.9 

84.3 

693.7 

153.0 

693.7 

4.5 

35.3 

57.8 

4.5 

12.8 

4.5 

23800.0 

5100.0 

2775.0 

79.3 

42.5 

14875.0 

29750.0 

9.6 

42.5 

42.5 

2380.0 

1295.0 

4.5 

42.5 

42.5 

42.5 

24.0 

42.5 

42.5 

693.7 

693.7 

693.7 

4 " • .J 
,. 
• .J 
,. 
• .J 

4 

4 

14.4 

192.5 

,. 
• .J 
,. 
.:> 

4 

4 

693.7 

693.7 

4-37 

0 

5 

5 

6 

0 

6 

0 

2 

5 

0 

5 

0 

0 

5 

0 

5 

7 

3 

5 

5 

5 

0 

5 

5 

Misc crops 

Northern Mixed Forest 

(Guenther) 

Nyssa (blackgum) 

BEIS oak forest 

Oats 

BEIS other deciduous forest 

Open forest 

Oak Savannah (Guenther) 

Ostrya(hophornbeam) 

Other (unknown, assume 

grass) 

Oxydendrum (sourwood) 

Pasture crop land (Guenther) 

Pasture 

Paulownia 

Peanuts 

Persea (redbay) 

Picea (spruce) 

Pinus (pine) 

Planera (water elm) 

Platanus (sycamore) 

Populus (aspen) 

Potato 

Prosopis (mesquite) 

Prunus (cherry) 

Table 4-3.  Summer Biogenic Emission Flux Factors (µg-compound m-2hr- 1
Biogenic Compounds by Vegetation Category 

)  for Principal 

Leaf Are.a••· 

NO. 
):.  i  .••  lli~~~<ili= . 

.·  fr('l) . •.. 

Vegetation or 
Land Cover 

Code 

Pseu 

Quer 

Rang 

Rhiz 

Rice 

Ro bi 

Rye 

Sabi 

Sali 

Sa pi 

Sass 

Scru 

Scwd 

Sere 

Shrf 

Smxf 

Snow 

Sor 

Sorg 

Soyb 

Spin 

Swie 

Taxo 

Thuj 

Isoprene 

Terpene 

.. 

•.·  .·.Other 
voes···· 

170.0 

2720.0 

2775.0 

29750.0 

37.8 

42.5 

102.0 

5950.0 

7.6 

5950.0 

14875.0 

42 .. 5 

42.5 

37.8 

2700.0 

14875.0 

10750.0 

85.0 

94.5 

42.5 

255.0 

85.0 

19.0 

42.5 

42.5 

42.5 

42.5 

94.5 

349.0 

42.5 

530.0 

693.7 

56.7 

693.7 

153.0 

693.7 

11.4 

693.7 

693.7 

693.7 

693.7 

56.7 

651.0 

693.7 

910.0 

17000.0 

1500.0 

1250.0 

0.0 

42.5 

7.8 

22.0 

0.0 

42.5 

19.5 

0.0 

1460.0 

1983.0 

42.5 

42.5 

42.5 

170.0 

1275.0 

1020.0 

0.0 

693.7 

11.7 

0.0 

1252.0 

693.7 

693.7 

2775.0 

4-38 

4.5 

4.5 

57.8 

4.5 

0.2 

4.5 

12.8 

4.5 

4.5 

4.5 

4.5 

57.8 

31.2 

4.5 

4.5 

4.5 

0.0 

4.5 

577.6 

12.8 

4.5 

4.5 

4.5 

4.5 

7 

5 

0 

5 

0 

5 

0 

5 

5 

5 

5 

0 

2 

5 

5 

4 

0 

5 

0 

0 

3 

5 

5 

7 

. 

Descriptfon 

· 

· . . .  · 

·. 

Pseudotsuga (douglas fir) 

Quercus (oak) 

Range 

Rhizophora (red mangrove) 

Rice 

Robinia (black locust) 

Rye 

Sabal (cabbage palmetto) 

Salix (willow) 

Sapium (chinese tallow tree) 

Sassafras 

Scrub 

Scrub woodland (Guenther) 

Serenoa (saw palmetto) 

Southeast/Western 
Deciduous Forest 

Southeast Mixed Forest 

Snow 

Sorbus (mountain ash) 

Sorghum 

Soybean 

Southern pine (Guenther) 

Swietenia (W.  Indies 

mahogany) 

Taxodium (cypress) 

Thuja (W. red cedar) 

Table 4-3.  Summer Biogenic Emission Flux Factors (µg-compound m·2hr- 1
Biogenic Compounds by Vegetation Category 

)  for Principal 

EPA/600/R-991030 

•··  V¢g~t~tf~ hf ·:.·::  .... ······:·· 
. Latj<l.•9?Y~i-•·.· 
•.".··•··· .. ··•Code• ........ 

.. 
~:;:;> 

:. 

.. 

. 

,:.~~:]'~''G ...•. · ••..  lt:r~\11(  .) . •· 
/ • ... ·  <·.·· > ..... 
42.5 

42.5 

'·. 

. ....  ...  .. •<.:.:::.;  ...... 
1/. 
l_./[~et":) 
:.:::"  ..... .;.·.•."·.· . 
. 
.·· 
··.:-::..  C•< 
•·.• 
... 

••• 

.··. 

·.· 

693.7 

4.5 

•<\ 
···:••: .. 
" 
.. .... 

: 

.·LeafArea··  .. 
rn4ei(iU~ 

·················tP":~)···· .. f. 

5 

. 

< 

·.· ::.• 
I 
.. .. "f':::,·· 

" 

./  <( 
: · .. 

: 

..

·.  \  :; 
. :::: 
.:" ... :.. 

:m  \ 

....... •.•.•.· ..• 
.-.·••:( 
·.·  c•>·  ··•···· 
.:.:·•··········· 

0 

7 

0 

0 

0 

5 

0 

0 

5 

5 

5 

0 

5 

3 

5 

0 

4 

3 

Tilia (basswood) 

Tobacco 

Tsuga (Eastern hemlock) 

Tundra 

BEIS urban forest 

BEIS urban grass 

Ulmus (American elm) 

BEIS other urban (barren) 

BEIS urban (.2 grass/.2 

forest) 

Urban trees (.5 Harf/.5 Cont) 

Vaccinium (blueberry) 

Washingtonia (fan palm) 

Water 

W Coniferous Forest 

(Guenther) 

Woodland/crop land 

(Guenther) 

Wetland forest (Guenther) 

Wheat 

Western Mixed Forest 

(Guenther) 

Western Woodlands 

(Guenther) 

Tili 

Toba 

Tsug 

Tund 

Ufor 

Ugra 

Ulmu 

Uoth 

Urba 

Utre 

Vacc 

Wash 

Wate 

Wcnf 

0.0 

79.3 

2411.7 

1988.7 

56.2 

42.5 

0.0 

58.8 

158.7 

120.6 

663.7 

140.5 

42.5 

0.0 

235.2 

256.7 

1295.0 

150.7 

920.0 

84.3 

693.7 

0.0 

4.5 

0.2 

4.5 

57.8 

4.5 

0.0 

408.6 

161.9 

200.5 

12.5 

5140.0 

1000.0 

42.5 

5950.0 

0.0 

42.5 

42.5 

0.0 

959.0 

693.7 

693.7 

0.0 

4270.0 

1120.0 

1320.0 

4.5 

4.5 

4.5 

0.0 

4.5 

Wdcp 

2550.0 

663.0 

2053.0 

8.7 

Wetf 

Whea 

Wmxf 

3820.0 

15.0 

5720.0 

923.0 

6.0 

620.0 

1232.0 

0.2 

9.0 

192.5 

530.0 

4.5 

Wwdl 

525.0 

250.0 

360.0 

4.5 

*Guenther references biogenic emission factors taken from  Guenther et al. (I 994) using A VHRR (Advanced Very 
High Resolution Radiometer) satellite imagery. 

4-39 

Table 4-4.  Winter Biogenic Emission Flux Factors  (µg-compound m-2hr"1
Biogenic Compounds by Vegetation Category 

)  for Principal 

Vegetation or 
Land Cover 

Code 

Abie 

Acac 

Acer 

Aesc 

Aila 

Aleu 

Alfa 

Ainu 

Amel 

Asim 

Avie 

Bari 

Barr 

Betu 

Borf 

Isoprerie 

' 

:·: .. ::T 

........ ,.,."'' 
"' lJ".ll". ·:·  . 

...... 
•  '"'~'  'V\.  .~S.::: 

1:-::.:  ..  _.::'.· 

..., ...  :., 
. 
....... ·.·: 

.....  : \  1:.: 

· ... ·. 

:  }· 

170.0 

5100.0 

2775.0 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

42.5 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

42.5 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

693.7 

0.0 

0.0 

0.0 

640.0 

706.0 

634.0 

Burne 

42.5 

42.5 

693.7 

Carp 

Cary 

Casp 

Cast 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

4-40 

•.. 

i~~·t~i~ :: ~¢.~{At~i~·  • .. ·.·.·.-···  :··:·:·:·"':···. 
::~~~1~~f-'•  .·:·:._.·.:.· ... ··:-::--· 

;:::'  .··  : 

.. ... -.::::.,, 
:.·":./··· 

···... 

:::-

;.· 

,. 

:· 

C\<>.,., :·, ... · . '  .... :::.: .. , 

,.,:,~.·,~· 

....... ·. 

....  -· 

.... ,:·:·:::.:·./ 
.· 
:  .. ·  ·· ... · 
::-
.. · :)  : ,:-.:.·: 

.· 

.... ·:-.:-· . .  · 

4.5 

4.5 

4.5 

4.5 

4.5 

4.5 

12.8 

4.5 

4.5 

4.5 

4.5 

256.7 

0.0 

4.5 

4.5 

4.5 

4.5 

4.5 

4.5 

4.5 

7 

5 

5 

5 

5 

5 

0 

5 

5 

5 

5 

0 

0 

5 

6 

5 

5 

5 

5 

5 

Abies (fir) 

Acacia 

Acer (maple) 

Aesculus (buckeye) 

Ailanthus 

Aleurites (tung-oil 

tree) 

Alfalfa 

Alnus (European 

alder) 

Amelanchier 
(service berry) 

Asiminia (pawpaw) 

A vicennia (black 

mangrove) 

Barley 

Barren 

Betula (birch) 

Boreal forest 
(A VHRR/G. *) 

Bumelia (gum 

bumelia) 

Carpinus (hornbean) 

Carya (hickory) 

Castano psis 
(chinkapin) 

Castanea (chestnut) 

Table 4-4.  Winter Bicigenic Emission Flux Factors  (µg-compound m-2hr-1
Biogenic Compounds by Vegetation Category 

}  for Principal 

EP A/600/R-99/030 

Casu 

29750.0 

42.5 

693.7 

Cata 

Cedr 

Celt 

Cerc 

Cham 

Ci tr 

Cnif 

Conf 

Corn 

Coru 

Co ti 

Cott 

Crat 

0.0 

79.3 

0.0 

0.0 

0.0 

0.0 

1269.3 

1295.0 

0.0 

0.0 

0.0 

0.0 

170.0 

340.0 

2775.0 

42.5 

0.0 

680.0 

1353.0 

1400.0 

1548.0 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

693.7 

835.0 

870.0 

0.0 

0.0 

0.0 

0.0 

0.0 

Cs wt 

1050.0 

660.0 

770.0 

De sh 

Dios 

Eu ca 

Fagu 

Frax 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

29750.0 

1275.0 

693.7 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

4-41 

4.5 

4.5 

4.5 

4.5 

4.5 

4.5 

4.5 

4.5 

4.5 

577.6 

4.5 

4.5 

256.7 

4.5 

0.2 

57.8 

4.5 

4.5 

4.5 

4.5 

7 

5 

7 

5 

5 

7 

5 

9 

6 

0 

5 

5 

0 

5 

0 

5 

5 

5 

5 

Casuarina (Austl 

pine) 

Catalpa 

Cedrus (Deodar 

cedar) 

Celtis (hackberry) 

Cercis (redbud) 

Chamaecyparis 
(prt-orford cedar) 

Citrus (orange) 

BEIS conifer forest 

Conifer forest 
(AVHRR,G.) 

Corn 

Cornus (dogwood) 

Cotinus (smoke tree) 

Cotton 

Crataegus (hawthorn) 

Herbaceous Wetlands 

(AVHRR, G.) 

Desert shrub 
(AVHRR, G.) 

Diospyros 
(persimmon) 

Eucalyptus 

Fagus (american 

beech) 

Fraxinus (ash) 

Table 4-4.  Winter Biogenic Emission Flux Factors  (µg-compound m·2hr- 1
Biogenic Compounds by Vegetation Category 

)  for Principal 

Vegetation or 
Land Cover 

Code 

Gled 

Gord 

Gras 

Gymn 

Hale 

Harf 

Hay 

Ilex 

Jug! 

Juni 

Lagu 

Lari 

Liqu 

Liri 

Mac! 

Magn 

Malu 

Meli 

Isoprene •. 

.·. •. · 1'etp6tje  L ·' 

··.· 

.  "'''<::" 
"""  > 

. 

, .... ·:·  :: 

:,.:,,,o;:,.;:.:::;;.:;; 

,.:./'.. Ix•·, .. ,·:  ·:•<t··•  . :..'::· 

\•'(: .. : ,:,:.:; 

. ;;.;;;.,., ...  ,.,, 

... , .... 

~!AfQ liiiilii: t~~t'Al'ea  , ... 
i~'~i~~~~: 

··> 

,·.: •. 

·: 

:  <i  7 
:·>  : ... , 

· · .:,<:.:ri,;;, ',::·:·:" .. ,., ... ,; .. ,: .. , "";': :/'•/': :::: 
,  ..•  ,;.,.,;.,;.; 

.;:·:•::.:'::/ . 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

42.5 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

371.0 

185.0 

0.0 

85.0 

0.0 

0.0 

693.7 

0.0 

79.3 

476.0 

1295.0 

42.5 

42.5 

693.7 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

42.5 

1275.0 

693.7 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

4-42 

4.5 

4.5 

57.8 

4.5 

4.5 

4.5 

12.8 

4.5 

4.5 

4.5 

4.5 

4.5 

4.5 

4.5 

4.5 

4.5 

4.5 

4.5 

5 

5 

0 

5 

5 

3 

0 

5 

5 

7 

5 

5 

5 

5 

5 

5 

5 

5 

Gleditsia 

(honey locust) 

Gordonia 

(lob lolly-bay) 

Grass 

Gymnocladus (KY 

coffeetree) 

Halesia (silverbell) 

Hardwood forest 

(AVHRR, G.) 

Hay 

Ilex (holly) 

Juglans (black 

walnut) 

Juniperus (east. red 

cedar) 

Laguncularia (white 

mangrove) 

Larix (larch) 

Liquidambar 
(sweetgum) 

Liriodendron (yellow 

poplar) 

Maclura 

( osage-orange) 

Magnolia 

Malus (apple) 

Melia (chinaberry) 

Table 4-4.  Winter Biogenk Emission Flux Factors  (µg-compound m·2br-1
Biogenic Compounds by Vegetation Category 

)  for Principal 

EP A/600/R-99/030 

·~····  X.,~(i~~je(::  ·:•• 

Mixf 

:<:.••········  ;::: 

·\··········<\:;.•?·••·•··•·1····· 

0.0 

1077.0 

·.. 
.... 
581.0 

·•  ··.•.:: :~~f~~~0~!.::: 

4 

.··. 

•··;:.•·::•. 

4.5 

Moru 

Mscp 

Nmxf 

Nyss 

Oak 

Oats 

Ocdf 

Ofor 

Oksv 

Os tr 

Othe 

Oxyd 

Pacp 

Past 

Paul 

Pean 

Pers 

Pice 

Pinu 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

175.0 

1100.0 

850.0 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

217.0 

0.0 

313.0 

0.0 

100.0 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

188.0 

0.0 

183.0 

0.0 

200.0 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

42.5 

255.0 

693.7 

23800.0 

5100.0 

2775.0 

79.3 

2380.0 

1295.0 

4-43 

4.5 

12.8 

4.5 

4.5 

4.5 

256.7 

4.5 

4.5  . 

4.5 

4.5 

57.8 

4.5 

35.3 

57.8 

4.5 

12.8 

4.5 

4.5 

4.5 

5 

0 

1 

5 

6 

0 

6 

0 

5 

0 

5 

0 

0 

5 

0 

5 

7 

3 

•···· 

.·······••·••/}}·····•······························ 

Mixed forest 
(AVHRR, G.) 

Morus (mulberry) 

Misc crops 

Northern Mixed 

Forest (AVHRR, G.) 

Nyssa (blackgum) 

BEIS oak forest 

Oats 

BEIS other deciduous 

forest 

Open forest 

Oak Savannah 
(A VHRR, Guen) 

Ostrya 

(hophombeam) 

·  Other (unknown, 

assume grass) 

Oxydendrum 
(sourwood) 

Pasture cropland 
(AVHRR, G.) 

Pasture 

Paulownia 

Peanuts 

Persea (redbay) 

Picea (spruce) 

Pinus (pine) 

Table 4-4.  Winter Biogenic Emission Flux Factors  (µg-compound m·2hr·1
Biogenic Compounds by Vegetation Category 

)  for Principal 

Vegetation or 
Land Cover 

Cade 

Isaprene 

··. 

. 

Terpene  •· 
.. : Lx 
·:\: 
.. 
.................  ······· 
... 

····· 

~~~~: 

·•·.  ·.·.····.·.·. 

.··. 
;<::::.:. 

;Nb 

· L:eafAi:ea 
i~ciexcrh• 

..;":'::--:  ... : . .•.• : t  trf2)  . 

: 

Plan 

Plat 

Popu 

Po ta 

Pros 

Prun 

Pseu 

Quer 

Rang 

Rhiz 

Rice 

Ro bi 

Rye 

Sabi 

Sali 

Sa pi 

Sass 

Scru 

Scwd 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

170.0 

2720.0 

2775.0 

0.0 

0.0 

42.5 

0.0 

0.0 

0.0 

0.0 

0.0 

42.5 

0.0 

0.0 

0.0 

0.0 

0.0 

693.7 

0.0 

0.0 

0.0 

5950.0 

42.5 

693.7 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

o.o 

0.0 

0.0 

0.0 

332.0 

332.0 

Sere 

14875.0 

42.5 

693.7 

Shrf 

0.0 

0.0 

0.0 

4-44 

4.5 

4.5 

4.5 

92.15 

4.5 

4.5 

4.5 

4.5 

57.8 

4.5 

0.2 

4.5 

12.8 

4.5 

4.5 

4.5 

4.5 

57.8 

31.2 

4.5 

4.5 

5 

5 

5 

0 

5 

5 

7 

5 

0 

5 

0 

5 

0 

5. 

5 

5 

5 

0 

2 

5 

0 

· · ·: ... ·  )Jes'?J,iption 

:.  :"": 

Planera (water elm) 

Platanus (sycamore) 

Populus (aspen) 

Potato 

Prosopis (mesquite) 

Prunus (cherry) 

Pseudotsuga (douglas 

fir) 

Quercus (oak) 

Range 

Rhizophora (red 

mangrove) 

Rice 

Robinia (black locust) 

Rye 

Sabal (cabbage 

palmetto) 

Salix (willow) 

Sapium (chinese 

tallow tree) 

Sassafras 

Scrub 

Scrub woodland 
(AVHRR,G.) 

Serenoa (saw 

palmetto) 

SE/W Deciduous 

Forest (A VHRR, G.) 

Table 4-4.  Winter Biogenic Emission Flux Factors  (µg-compound m·2hr- 1
Biogenic Compounds by Vegetation Category 

)  for Principal 

EPA/600/R-99/030 

••  >·yeg~~tip$ ~~ "){ t  f~hrii~I  •· 
···.· 

·.=:::.:.=::: 

':f,@4 .. ¢0.yer.•··  =:=::==:: 
(;Cid~>·  ('.I~~~~ 
Smxf 

:;: 

.............. : ........ 

,, 

:.••• 

:r>  ::•::::::.:  !  :::  ;:··:·.·:·: 

I  '':•'(':(.:  J\ 

1:: .. :.·.:: 

~:>\ /~L  ¥9£~;· 1:::1~i~-j~i!~~  ·:t~itrAi&~r I! ;}!~!,r ) ' "'·'' T L 

: ~ro~i~~f :1:: 

., .......  .:;:.\•·•.•:·.  ···"" 

1•·•··•·•)  · .. •··'········ >:: .. ···>·:••.\ .. :>  i• 

,,,.-::..;"',. ::.'···:.: .. 

: 

ii<y,;.::;: 

. 

.'•.' 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

1500.0 

500.0 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

1963.0 

1052.0 

Snow 

Sorb 

Sorg 

Soyb 

Spin 

Swie 

42.5 

42.5 

693.7 

Taxo 

Thuj 

Tili 

Toba 

Tsug 

Tund 

Ufor 

Ugra 

Ulmu 

Uoth 

Urba 

Utre 

42.5 

170.0 

0.0 

0.0 

79.3 

0.0 

0.0 

0.0 

0.0 

0.0 

0.0 

1275.0 

1020.0 

0.0 

0.0 

693.7 

2775.0 

0.0 

0.0 

158.7 

1295.0 

0.0 

631.0 

0.0 

0.0 

0.0 

0.0 

469.0 

0.0 

0.0 

0.0 

154.0 

102.0 

700.0 

960.0 

528.0 

4-45 

4.5 

0.0 

4.5 

577.6 

12.8 

4.5 

4.5 

4.5 

4.5 

4.5 

256.7 

4.5 

0.2 

4.5 

57.8 

4-.5 

0.0 

12.5 

4.5 

2 

0 

5 

0 

0 

3 

5 

5 

7 

5 

0 

7 

0 

0 

0 

5 

0 

0 

6 

SE Mixed Forest 

(AVHRR, G.) 

Snow 

Sorbus (mountain 

ash). 

Sorghum 

Soybean 

Southern pine 
(AVHRR, G.) 

Swietenia (W. Indies 

mahogany) 

Taxodium (cypress) 

Thuja (W. red cedar) 

Tilia (basswood) 

Tobacco 

Tsuga (Eastern 

hemlock) 

Tundra 

BEIS urban forest 

BEIS urban grass 

Ulmus (American 

elm) 

BEIS other urban 

(barren) 

BEIS urban (.2 
grass/.2 forest) 

Urban tree (.5 Harf/.5 

Cont) 

Table 4-4.  Winter Biogenic Emission Flux Factors  (µg-compound m-2hr- 1
Biogenic Compounds by Vegetation Category 

)  for Principal 

Vegetation or 
Land Cover 

Code 

Yacc 

Isoprene 

Terpene 

OtherVOCs 

0.0 

0.0 

0.0 

Wash 

5950.0 

42.5 

693.7 

Wate 

Wcnf 

Wdcp 

Wetf 

Whea 

Wmxf 

0.0 

0.0 

0.0 

3500.0 

1120.0 

1200.0 

0.0 

0.0 

0.0 

0.0 

630.0 

1047.0 

877.0 

628.0 

0.0 

620.0 

0.0 

330.0 

Wwdl 

0.0 

250.0 

360.0 

··No 

. . .  ·: ..........•... 

4.5 

4.5 

0.0 

4.5 

8.7 

0.2 

192.5 

4.5 

4.5 

· ...  ··.Leaf Area~ 
···•1ndex(mi··· 
m·~) ··•·· :·:  . 
5 

•·. 

5 

0 

5 

2 

3 

0 

3 

3 

Description 

......... 

Vaccinium 
(blueberry) 

Washingtonia (fan 

palm) 

Water 

Western Coniferous 
Forest (A VHRR, G.  ) 

Woodland/cropland 

(AVHRR, G.) 

Wetland forest 
(AVHRR, G.) 

Wheat 

Western Mixed Forest 

(AVHRR, G.) 

Western Woodlands 

* A VHRR/G. references biogenic emission factors from Guenther et al (1994) which used land use classifications 
from Advanced Very High Resolution Radiometer (AVHRR) satellite imagery. 

(AVHRR, G.) 

The BEIS-2 applies environmental correction factors to account for the effect of leaf temperature 
and visible solar radiation on isoprene (Pierce et al., 1998).  Specifically: 

(4-19) 

where: I is the adjusted isoprene emission flux, 

Is is the isoprene emission flux standardized to leaf temperature 30°C and PAR of 1000 

micromoles/m2/sec. 

The light adjustment factor CL  is estimated by: 

cL =  co:er.,PAR) /  Vo +0:2PAR2) 

(4-20) 

where: o: =  0.0027, and CLI= 1.066 are empirically derived coefficients.  The leaf temperature 
adjustment factor CT is derived from laboratory data and is computed using the following formula: 

(4-21) 

where:  Cn = 95,000 J mo1-1 

T5  is the standardized temperature (303°K), 
R is the ideal gas constant (8.314 °K mol- 1
), 
Cn = 230,000 J mo1- 1
Tm= 314°K. 

,  and 

PAR is computed as a function of height by: 

P ~ = P ~ ( exp[-0.42LAizD 

(4-22) 

During March 1998, the factor used in BEIS-2 within Models-3 to convert solar radiation values 
from watts per square meter (W/m2
)  to micromoles per square meter-second (µm/m 2-sec)  was 
changed from 2.2982 to 2, based on Alados et al. (1996).  This had the effect of reducing PAR 
by ~ 15 percent and isoprene emissions by ~ 5 percent based on limited simulation tests for the 
July 1995 ozone maximum period. 

Emissions for VOCs other that isoprene are assumed to vary only as a function of leaf 
temperature in accordance with the following: 

E =Es* exp[0.09 (T-Ts)] 

(4-23) 

where: Es is the standardized emission flux for monoterpenes and other VOCs, 

T is the leaf temperature in degrees Kelvin, and 
Ts is the standardized temperature (303°K). 

The soil NO emission flux factors used in BEIS-2 were adapted from Williams et al. (1992).  For 
temperatures greater than 0°C, soil NO temperature corrections follow the formulation of 
Williams et al. As follows: 

NO =N00  * exp[0.071(T-Ts)] 

(4-24) 

where  NO is the adjusted soil NO emission flux, 

N00  is the emission flux standardized to a soil temperature T5 of30°C, and 
T is the soil temperature. 

NO emissions at temperatures less than 0° C are set to zero.  During March 1998, it was decided 
to cap the exponential increase of soil NO emissions with tempe!atures above 30°C, based on the 
findings of Yienger and Levy (1995). 

The inclusion ofBEIS-2 into MEPPS biogenic emission modeling required creating an efficient 
connection such that BEIS-2 is easy to use from within MEPPS, and also so that the input and 
output data related to BEIS-2 can take advantage ofMEPPS and Models-3 data handling and 
analysis features.  The changes included: 

• 

• 

• 

• 

• 

BEIS-2 is now automatically invoked from MEPPS ·or the Study Planner when the user 
requests that biogenic emission factors be calculated.  It is not necessary to work directly 
with the BEIS-2 software. 

Solar radiation and temperature input files are not directly supplied by the user when 
BEIS-2 is run.  These meteorological data are supplied automaticall.y from MCIP files for 
the case (time period) specified, presuming that MMS and MCIP have been run for that 
period. 

Within MEPPS, BEIS-2 can now use ARC-INFO® generated grids and use gridded 
surrogate data to disaggregate county-level data to grid cells. 

BEIS-2 results are in terms of hourly emissions per grid cell within Models-3. 

Biogenic emission data are subject to the extended quality control and reporting features 
in MEPPS, and visualization using the ARC-INFO® based GIS-View feature. 

The MEPPS uses BEIS-2 by allowing the user to assume summer, winter seasons, or access frost 
data in order to allow for the seasonal ch~ge in vegetative biomass.  For summer and winter 
conditions, vegetation genus and emission factors for isoprene, monoterpene, other biogenic voe 
emissions, emission factors for NO, and the leaf area index (LAI) are provided based on the work 
of Geren et al. (1994).  Frost data include the federal identification protocol (FIPS) codes by state 
and county along with the biomass of the first and last day of summer.  The MEPPS  draws 
hourly temperature and solar radiation from MCIP for use in the biogenic processor.  Land cover 
and vegetation are provided in gridded ARC/INFO coverage.  The biogenic modeling input data 
are then provided to BEIS-2 and output as hourly gridded emission values of the VOCs isoprene, 
monoterpene, and "other" (unspecified); along with NO to the EMPRO speciation processor, 
where they are grouped with chemical species from other source types dep1::nding upon the 
conventions of either the CB4 or RADM2 speciation split factors (Section 4.2.5). 

4.2.4.2 

Mobile Source Emissions 

Emissions from mobile sources to the air are established as one of the primary contributors to 
pollution problems in many localities.  Unlike many anthropogenic emissions, mobile source 
emissions are strongly affected by the rapid variations of atmospheric temperature and 
anthropogenically-influenced, geographically-varying factors.  Consequently, it is necessary to 
model hourly mobile emissions, rather than to temporally disaggregate annual totals.  The 
capability to do this is in the MEPPS mobile-source emission processor.  For gaseous emissions 
the mobile source processor estimates hourly emissions ofVOC total organic gases (TOG), 
carbon monoxide (CO), and oxides of nitrogen (NOx) from on-road mobile sources (vehicles). 
The processor, which is located in the EMPRO module of MEPPS, uses a combination of air 
temperature data at l .S  m above the surface (provided by MMS through MCIP), mobile source 
emission factors (computed by the EPA regulatory model Mobile Sa for gaseous emissions from 
on-road mobile sources), fleet vehicle type composition, road type, and traffic data in the form of 
vehicle miles traveled (VMT) to generate emission estimates.  Vehicle emission controls, and 
Inspection and Maintenance programs may be accounted  for in the user-defined input settings for 
Mobile Sa (U.S. EPA,  1991; U.S. EPA, 1996).  The VMT data are usually available by county, or 
occasionally by specific road segments.  The resulting county or road segment-specific hourly 
emissions are spatially allocated to the cells of a user-defined study grid.  The gridded emission 
data are combined with corresponding species output from the mobile source particulate emission 
model, and allocated to different groups of lumped species for processing by the Speciation 
Processor (Section 4.2.S). 

Emissions of particulate species (particulate matter less that 10 micrometer and 2.S micrometers 
in diameter - PM10  and PM25,  respectively) from mobile sources are modeled analogously to 
gaseous emissions, using vehicle fleet composition, road ~ype (urban or rural), and VMT data. 
The mobile particulate emission factors are modeled with PARTS (U.S. EPA, 199S), the 
particulate companion of Mobile Sa.  Vehicle emission controls, Inspection and Maintenance 
programs, and use of reformulated fuel may be accounted for with the input settings of PARTS. 
In addition input information for road silt content and precipitation is required.  The particulate 
species modeled include lead, direct and indirect  particulate sulfate (any remaining sulfur in fuel is 
assumed to be exhausted as gaseous 802), total exhaust particulate (sum of lead, direct sulfate, 
and carbon including soluble organic material and other remaining carbon), and (separately) 
soluble organic fraction (SOF) and a remainder carbon portion (RCP), which are added to the 
mobile source emission output file. 

INPUT DATA 

Vehicle Fleet Information 

PARTICULATE  GASEOUS 
EMISSIONS 

EMISSIONS 
Silt Loa.ding 
Roe.d Type 

Controls 
Fuel Type 

v 

PARTS 
Mobile 
Emission 
Factors 
t 

v 

Mobile5a 
Mobile 
Emission 
Factors 
~ 

-
-

Compute Gridded Hourly 
Mobile Source Emissions 

[ Gridded VMT Data  ] 

" 

ME'IEOROLOGY] 

(MM5) 

MC;J 

Temperature 

. 
:  ~ SPECIA TION] 

OUIPUT 

- PROCESSOR 

Figure 4-5  General Flow of Mobile Source Emission Modeling 

The procedure by which mobile source emission data are estimated in MEPPS and flow diagrams 
for  the process are given in Section 6.5.3.4 of the Models-3  Volume  9B:  User Manual.  Briefly, 
the sequence is as follows: 

• 

• 

• 

VMT vehicle fleet data files are established for the study area (gridded spatial domain) of 
interest by either extracting county-level annual aggregate VMT data from the annual 
emission input files previously established by INPRO, or by loading "link-node" VMT data 
that are available for specific road segments (links) between nodes with geographic 
coordinates .  The link-node data are generally available only for selected urban areas and 
dates in conjunction with special studies.  The process is similar for VMT data which are 
occasionally available by quarter section (1/4 square mile) areas. 

ARC/INFO® spatial coverage files of surrogate data (Federal Highway Administration 
major highways, or United States Census Tiger Line road coverages are provided) are 
used  to spatially allocate county-level aggregate VMT data to the cells of the gridded 
domain being used with a particular study.  County area may also be used as a coarse 
surrogate coverage. 

Spatial allocation ratios are computed for use in assigning county-Kevel VMT data to the 
surrogate coverages.  The EMPRO calculates the proportion of roa.d links or county area 
in the spatial domain attributable to each grid cell overlain by the road link (FHA or 
TIGER/LINE) or county. 

Mobile source emission factors are computed using Mobile Sa and/or PART S- U.S. EPA 
regulatory models.  Mobile Sa requires user-defined information on driving operations, 
vehicle fleet and fuel use, and hourly ambient.temperature data.  PARTS requires user(cid:173)
defined information on vehicle fleet and fuel use, emission controls, non-attainment, road 
dust silt content, moisture, and percent of unpaved roads by geographic area (usually 
county).  Temperature and moisture data are from ithe MMS model as processed by 
MCIP. 

Hourly mobile emissions are computed for each grid cell, with adjustments applied to 
VMT to indirectly reflect the effect of temperature on gaseous emissions, and moisture on 
re-entrained- dust for particulate emissions. 

For mobile emissions ofVOC, hourly gridded mobile emissions are speciated using either 
RADM 2.0 or CB-4 emission profile splits. Speciation is not needed for particulate 
emission data. 

The hourly, gridded, speciated mobile emission data are merged with gridded, speciated 
hourly area-source emission data in OUTPRO, and converted to NetCDF 1/0 API format, 
to provide a two dimensional emission data set acceptable to the chemical-transport model 
and other Models-3 framework application_s. 

The Mobile 5a Model 

Detailed descriptions·of Mobile Sa are available from EPA publications (US EPA 1991, US EPA 
1996).  An optional Mobile 5b has also been adopted (US EPA 1996) to accommodate slight 
modifications in Inspection and Modification credits for hybrid fuels.  Both Mobile Sa and Sb are 
improvements in the Mobile 4.1  model (US EPA, July 1991).  Mobile 6 is in development and is 
tentatively expected in late 1999.  A new off-road mobile emission model is also due in late 1998. 
Portions of the  following description of Mobile are adapted from Wilkinson et al (1994).  The 
incorporation of Mobile 5a into MEPPS was extensively r•~vised from its treatment in GEMAP, 
including: 

• 

The application of Mobile Sa factors was revised to substantially reduce redundancy and 
computational space required.  The application of Mobile Sa in GEMAP computed 
specific emission factors for individual state/counties by area type/road type and hour. 
The combinations of hour and road type were derived by mapping operating modes 
(percent of hot and cold starts) to the hours and road types that used them, causing a 
duplication of Mobile Sa runs and factors.  It was necessary to recompute factors ifthere 
was a change in how the emission factors were used by hours or road type.  The computed 
mobile emission factors were merged into permanent (f~~the processing run) emission 
factor tables without regard to calendar year.  In MEPPS, Mobile 5a emission factors are 
computed and stored by calendar year, state/county, and operating mode.  Also, the 
system now has separate user-specified tables that allocate emission factors by hour and 
road type, using operating mode.  The tables are used directly in the emission estimate 
calculation.  In addition start and end times may now be specified for mobile emission runs 
rather than number of complete hours.  This has also shortened the processing time for 
county-level mobile emission processing. 

Calculations were separated into county-level, link-node level, and land-survey level 
options, depending upon the spatial detail ofVMT information available to the user. 

The ability to assign alias identification by state or county was added.  This allows the user 
to assign the values in a Mobile input file for a given area to a similar area which lacks 
specific input data. 

Geographic coverages of major highways (from the Federal Highway Administration) and 
all roads (TIGER-Line data) were made available as surrogate data to allow better spatial 
allocation of mobile emissions. 

Mobile emission data are now subject to the additional quality control and ARC-INFO® 
based visualization capabilities in MEPPS. 

• 

• 

• 

• 

Mobile Sa is an ANSI FORTRAN 77 computer program designed to estimate hydrocarbon (HC), 
carbon monoxide (CO), and oxides of nitrogen (NOx) emission factors for gasoline-fueled and 
diesel-fueled highway motor vehicles.  The computation methods that are 1~mbedded in Mobile Sa 
are based on the procedures that are presented in the Compilation of Air Pollutant Emission 
Factors -- Volume XX: Highway Mobile Sources (US EPA,  l 99S).  Mobile Sa computes 
emissions factors for eight vehicle categories in two regions of the country  (high-altitude and low(cid:173)
altitude ).  The eight vehicle categories include the following: 

• 
• 
• 
• 
• 
• 
• 
• 

LDGV - light-duty gasoline vehicles; 
LDGTl -- light-duty gasoline trucks (up to 6000 pounds); 
LDGT2 -- light-duty gasoline trucks (6001  to 8SOO pounds); 
HDGV -heavy-duty gasoline vehicles (over 8SOO  pounds); 
LDDV - light-duty diesel vehicles; 
LDDT-light-duty diesel trucks (0 to 8SOO  pounds); 
HDDV -heavy-duty diesel vehicles (over 8SOO pounds); and 
MC -- motorcycles. 

The Mobile Sa emission factors depend on various conditions including, but not limited to, 
ambient temperature, vehicle speed, operating modes, and vehicle mileagt:: accrual rates.  Much of 
the data required by Mobile Sa may be specified by the user through the Mobile input file.  Mobile 
computes emissions factors for any year from 1960 to 2020.  This date range is important for 
mobile-source emission estimated projections, and for the;: application of regulatory control 
factors.  Mobile version 5a.01  (which was modified for use in GEMAP/EMS-95 and later for 
MEPPS) is currently implemented in the EMPRO module ofMEPPS.  Consult the User's Guide 
to MOBILE 5,  EPA-AA-TEB-92-01 for further details on Mobile 5a.  Mobile model 
documentation may be obtained from the EPA Office of Mobile Sources World Wide Web home 
page located at:  http://www.epa.gov/OMSWWW/models.htm. 

A comprehensive discussion of the technical formulation of Mobile 5a is found in the above 
references.  This section contaiµs a description of modifications to Mobile 5a for use in GEMAP 
and later in MEPPS.  Mobile 5a was modified for use in EMS-95 to compute and report diurnal 
evaporative emissions factors (grams/mile) separately.  The unmodified Mobile 5a model 
computes and reports diurnal evaporative emission factors as part of a composite evaporative 
emission factor.  Also, Mobile 5a was modified to report a total non-diurnal evaporative emission 
factor.  The total non-diurnal evaporative emission factor includes hot soak, crankcase blow-by, 
running losses, and resting losses.  In the MEPPS EMPRO module, the Mobile SAS® table 
generators have been rewritten and segmented for greater computational efficiency, as have be~n 
the VMT and surrogate coverage grid processors and mobile source emission calculation 
procedures.  The technical procedure and rationale are the same, but processing time is shortened 
by at least a factor of two for regional modeling of spatial domains. 

The mobile-source emission processor relies on a SAS® lookup table to find appropriate emissions 
factors to compute the motor vehicle emission estimates.  The SAS® lookup table is generated 
through iterative runs of Mobile 5a.  The necessary number of runs of Mobile 5a is ,performed 
automatically, and is based on the standard Mobile ASCII input file supplied by the user.  For 
urban scale modeling, an input file for one state may suffice.  However, for regional modeling, 
multiple Mobile 5a ASCII input files can be concatenated to one file and run through the 
processor.  This capability is necessary to handle study domains where motor vehicle activity 
differs spatially and temporally.  For example, in a multiple-state study domain, it is unlikely that 
adjoining states have the same inspection and maintenance (I/M) program or the same vehicle 
fleet distribution (to name just two inputs to Mobile 5a).  Differences in regional inputs to Mobile 
5a such as JIM programs and vehicle fleet distributions result in different motor vehicle emissions 
factors.  A concatenated input file template (based on exarnple values used for the OTAG project) 
is provided which may be copied and edited.  In MEPPS, the Mobile input file (m5a.mv) is 
located in the directory structure at: 

$EMS_ HOME!project/$EMS _PROJECT/raw_ data/$EMS~ DOMAIN/common!. 

The only difference in the concatenated input file from the original input file is that the state title 
lines contain state (and where needed, county) FIPS identifier codes to identify the area for which 
each section of the Mobile 5a input file is applicable: 

• 
• 

FIPS state code -- Mobile input file applies to a state; or 
FIPS state code and FIPS county code -- Mobile input file applies to a particular county. 

The mobile-source emission processor varies the vehicle speed and ambient temperature records 
of the user-supplied input file and runs Mobile for each variation.  The Mobile source processor 
varies the vehicle speeds from 4 miles per hour to  64 miles per hour in increments of 2 miles per 
hour, although the user may adjust the increment (Mobile supports computation of emission 
factors for speeds between 2.S  MPH and 6S  MPH).  The mobile-source processor varies the 
minimum ambient temperature from S0° F to  110° Fin increments of 2 ° F, and the mobile source 
processor varies the maximum ambient temperature from 50 ° F to  110 ° F in increments of 2 ° F 
(Mobile Sa supports computation of exhaust emissions factors for temperatures between 0° F and 
110° F and evaporative emissions factors for temperatures between 40° F and 110° F).  The 
vehicle speed and ambient temperature values can be set interactively in EMPRO under the mobile 
source model, using the "Generate Mobile Emission Factors" screen. 

In MEPPS, the mobile-source processor generates two emission factor SAS® lookup tables. 
These are compact tables that contain the information held in seven generated SAS lookup tables 
in EMS-95.  They are: 

• 

• 

State/area type/facility type ..Q.iurnal emissions factors (I/M and non-I/M HC diurnal 
evaporative emissions factors for eight vehicle categories by state, minimum ambient 
temperature, maximum ambient temperature, and calendar year).  The  user specifies 
whether the operating mode varies by the hour of the day in the Temporal Allocation 
screen of the mobile emission model ofEMPRO); 

State/area-type/facility-type non-diurnal emissions factors (I/M and non-I/M HC 
[evaporative and exhaust], CO [exhaust only], and NOx [exhaust only] emissions factors 
for eight vehicle categories by state, area type [urban or rural], facility type [eg. interstate, 
collector, arterial, local], vehicle speed, ambient temperature, and calendar year.  The user 
can interactively specify whether the operating mode varies by hour of the day when 
establishing temporal profiles in the Temporal Allocation screen of the mobile emission 
model ofEMPRO. 

Operating mode is an important variable in the computation of motor vehicle emissions factors. 
Attention is specifically called to operating mode because the mobile source processor uses up to 
four different operating mode mixes to compute emissions factors for the Mobile Sa lookup tables 
(refer to the Mobile Sa user's guide for further discussion of operating modes). 

If area type/facility type records are to be used in the Mobile-generated lookup tables, the user 
must specify the mix of operating modes. The following example of operating mode mixes  was 
used for the Lake Michigan Ozone Study:  S% PCCN, 12.1 % PCHC, and 10.9% PCCC, where 
PCCN is percent VMT generated by non-catalyst vehicles in cold-start mode, PCHC is percent 
VMT generated by catalyst vehicles in hot-start mode, and PCCC is percent VMT generated by 
catalyst vehicles in cold-start mode.  If hourly records are used in the Mobile-generated lookup 
tables, the user must define the operating mode mixes by time of day, consistent with Mobile Sa 
guidance.  The following is an example of the use of four operating mode mixes: 

0000 to 0700 operating mode is 12.9% PCCN, 7% PCHC, and 17% PCCC; 
0700 to 0900 operating mode is 15% PCCN, 10% PCHC, and 15.4% PCCC; 
0900 to 1600 operating mode is 5% PCCN,  12.1 % PCHC, and 10.9% PCCC; 
1600 to  1800 operating mode is  10.1% PCCN, 9.1% PCHC, and 13.9% PCCC; 
1800 to 2200 operating mode is 5% PCCN, 12.1% PCHC, and 10.9% PCCC; 
2200 to 0000 operating mode is 12.9% PCCN, 7% PCHC, and 17% PCCC. 

As with the vehicle speeds and ambient temperatures, the operating mode mixes can be changed 
interactively on the Operating mode screen in THE MEPPS EMPRO module under Models, 
Mobile, Mobile Source. 

The mobile source processor generates emission factors for the following area type (urban or 
rural) and facility type (interstate, local, etc.) combinations: 

• 
• 
• 
• 
• 
• 
• 
• 
• 
• 
• 
• 

rural/principal arterial - interstate 
urban/principal arterial - interstate 
rural/principal arterial - other 
urban/principal arterial - free/express-ways 
rural/minor arterial 
urban/principal arterial - other 
rural/major collector 
urban/collector 
rural/minor collector 
urban/minor arterial 
rural/local 
urban/local 

As with vehicle speeds, ambient temperatures, and operating modes; area type/facility type 
combinations can be changed interactively using the "Generate Mobile Emission Factors" screen 
under EMPRO, Models, Mobile, Mobile Source to edit the ASCII input file . When changes are 
made, the same changes are automatically made to the SAS® data sets. 

User Input Data 

The mobile source emission processor requires user-defined specifications using interactive 
screens and an input file.  While some of the specifications are required, some are not required.  In 
each case, there is provision to import the data file through IDA or in the mobile source processor 
ofMEPPS. 

The principal input data ASCII files to the mobile source model include the following 
(environment variables are defined in Chapter 6 of the Models 3 Volume 9B:  User Manual): 

• 

On-network link-specific area type/facility type ($EMS/onnet.mv) 

On-network link-specific percentage of vehicles that fall under an JIM program 
($EMS!onnetim. mv) 
On-network link-specific daily or hourly VMT ($EMS/onnetvmt.mv); 
Hourly or daily, link-specific or area type/facility type-specific vehicle mix 
Off-network, area type/ facility type average speed ($EMS_LOC/ojfnetspdmv) 
Off-network, ·area type/facility type VMT ($EMS/offnvmt.mv); 
Off-network, area type/facility type-specific vehicle mix profile ($EMS_LOC/offvmix.mv) 
Public land survey quarter sections area type/ facility type hourly or daily VMT, hourly 
speeds, and daily vehicle mix profile ($EMS/ofnvmtp.mv); 
Area type/facility type seasonal and daily adjustment factors ($EMS/adjstvmt.mv) 
Area type/facility type hourly average speed profile ($EMS_ CAT/spdadju. mv) 
On-network, link-specific hourly or daily average speed ($EMS_GRD!onnetspdmv) 
Area type/facility type hourly VMT fractional profile ($EMS/fracvmtu.mv) 

If off-network VMT is to be used to compute emissions estimates (typical when county VMT 
data are taken from regional emission inventories), the mobile emission processor can assign 
VMT to grid cells using ARC/INFO® coverage files for either county area, Federal Highway 
Administration (FHA) major highways, or TIGER/LINE road data.  These coverages for the 
contiguous United States are provided with MEPPS.  Subsets of the coverages  for the spatial 
domain of interest are extracted either when a grid is established or during mobile source 
processing. 

If Public Land Survey Quarter Section-based VMT is to be used to compute emissions estimates, 
the mobile source emission processor requires an ARC/Info® export data s1~t of the polygon(cid:173)
network system. 

Gridding VMT 

After the ASCII user input (foundation) data files have been read and checked, the user directs 
the mobile source emission processor to prepare the necessary network coverages (unless they 
were prepared when the grid was established).  The on-network system is prepared from the user(cid:173)
provided ASCII input files.  The off-network system is prepared via coun~v boundary, FHA, or 
TIGER/LINE data file extracts.  The polygon system is prepared from an ARC/INFO® export 
coverage.  The networks are gridded by overlaying the emission modeling grid on the network 
coverages in much the same manner that the area source spatial surrogates are gridded.  Each link 
in the networks (or area type/facility type polygon) are length (or area) apportioned to a grid cell 
in the emissions modeling domain.  Once the networks have been gridded, the corresponding 
VMT can also be gridded.  Equations 4-25 through 4-30 show how the on··network, off-network, 
and polygon VMT are gridded respectively. 

lenratioij,k,l,m = lengridij,k,l,m I lenparij,k 
VMTiJ,k,l,m =  vmtorigij,k * lenratioij,k,l,m 
cellpc~j.a,f,l,m = cellsumij,a,r,l,m I ctysumij,a,f 

4-56 

(4-25) 
(4-26) 
(4-27) 

VMTij,a,f,l,m =  vmtorigij,a,f * cellpctij,a,f,l,m 
areapctij,p,a.f.l,m = areagrdij,p,a.f,l,m I areaparij,p 
VMTij,p,a,r,i,m =  vmtorigij,p,a,r * areapctij,p,a,r,i,m 

where  lenratio is the percentage of a link in a given grid cell 

EP A/600/R-991030 

(4-28) 
(4-29) 
(4-30) 

lengrid is the length of a link in a given grid cell 
lenpar is the total length of the link 
VMT is the gridded VMT value 
vmtorig is the original VMT 
cellpct is the percent of the FHA or TIGER/Line~based area type/facility type 

roadway in a given cell 

cellsum is the total length of FHA or TIGER/Line-based area type/facility type 

roadway in a given cell 

ctysum is the total length of the FHA or TIGER/Line-based area type/facility type 

roadway in a county 

areapct is the percent of the polygon-based area type/facility type roadway in a 

given cell 

areagrd is the total length of the polygon-based area type/facility type roadway in a 

given cell 

areapar is the total length of the polygon-based area type/facility type roadway in 

a county 

i is the state index 
j  is the county index 
k is the link index for on-network systems 
1 is the east-west grid cell index 
m is the north-south grid cell index 
a is the area type index for off-network systems 
f is the facility type index for off-network systems 
p is the polygon index for Public Land Survey Quarter Sections network systems. 

For on-network and polygon VMT, the indices may also include an identifier for hour since 
polygon and on-network VMT can also be supplied on an hourly basis. 

Apply Default Information . 

If the user supplies limited data to the mobile-source emission processor, it can apply a variety of 
default values to compute motor vehicle emissions estimates.  These defaults include vehicle mix, 
speeds, VMT fractional profiles, and I/M vehicle percentages.  If the user supplies limited data, 
the mobile-source emission processor applies the following defaults: 

Default Vehicle Mix Profile 
Vehicle Class  Percentage 
LDGV 

0.618 

LDGTl 
LDGT2 
HDGV 

0.177 
0.077 
0.035 

LDDV 
LDDT 
HDDV 
MC 

0.008 
0.002 
0.077 
0.008 

Default Hourly VMT Fractional Profile 

Default Speed Profile 
Area Type· 

Facility~ 

0 
0 
0 
·o 
0 
0 
1 
1 
1 
1 
1 
1 

1 
4 
6 
7 
8 
9 
1 
2 
4 
5 
6 
9 

Speed 
60 
56 
56 
54 
40 
35 
60 
59 
55 
30 
55 
30 

Emission Hour  1 
Diurnal 
Other 

2 

3 

4 

5 

6 

7 

8 

9 

IO 

11 

12 

0.000  0.000 0.000  0.000  0.000  0.129 0.021  0.100  0.095  0.095 0.166 0.199 
0.016  0.010 0.003  0.006  0.010  0.026 0.053  0.064  0.055  0.048 0.050 0.052 

Diurnal 
Other 

13 

14 

15 

16 

17 

18 

19 

20 

21 

. 22 

23 

24 

0.079  0.116  0.000 0.000 0.000  0.000  0.000 0.000  0.000 0.000 0.000 0.000 
0.054  0.055  0.059 0.070 0.074  0.070  0.058 0.046  0.037 0.033 0.028 0.022 

If the user does not specify what the percentage of vehicles are under an I/M program, the mobile 
source emission processor assumes that no vehicles are under an I/M program.  The result is 
higher emission estimates. 

The mobile source emission processor does not override user-supplied data.  Default information 
are applied only when data are missing from the ASCII user input files. 

Add Temperatures and Adjust VMT 

Prior to computing the motor vehicle emission estimates, the mobile-source emission processor 
adds the gridded, hourly temperatures and adjusts the VMT to the specific modeling day.  The 
temperature data are used to obtain the correct emission factor from the Mobile emission factors 
lookup tables.  Through the application of Equations 4-31  through 4-34, the day-specific, diurnal 
and nondiurnal (other than full days), hourly VMT are computed, respectively. 

dvm~j.t,h,m,n =  ddayvmtij,t,m,n * adjday * adjmonth * dvmt_profij.l,h 
ovm~j.t,h,m,n = odayvmtij,l,m,n * adjday * adjmonth * ovmt_profij.l,h 
dvm~j.a.f.h,m,n = ddayvm~j.a.f.m.n * adjday * adjmonth * dvmt_profij,a,f,h 
ovm~j.a,f,h,m,n = odayvm~j,a,f,m,n * adjday * adjmonth * ovmt_profij.a,f,h 

(4-31) 
(4-32) 
(4-33) 
(4-34) 

where 

dvmt is the diurnal VMT; 
dayvmt is the total day diurnal VMT; 
adjday is the day-specific VMT adjustment factor supplied through an ASCII input 
· 
adjmonth is the month-specific VMT adjustment factor supplied through an ASCII 

file; 

input file; 

dvmt_prof is the hour-specific, diurnal VMT fractional profile factor; 
ovmt is the nondiurnal VMT; 
odayvmt is the total day nondiumal VMT; 
ovmt_prof is the hour-specific, nondiurnal VMT fractional profile factor; 
i is the state index; 
j  is the county index; 
h is the hour index; 
1 is the link identifier index; 
a is the area type index; 
f is the facility type index; 
m is the east-west grid cell index; and 
n is the north-south grid cell index. 

Compute Motor Vehicle Emissions Estimates 

The mobile source emission processor computes day-specific, gridded, hourly motor,vehicle 
emissions estimates ofVOC total organic gases (TOG), carbon monoxide (CO), and oxides of 
nitrogen (NOx)·  The actual emission estimate computations performed and maintained in the 
MEPPS data base are as follows: 

• 
• 
• 
• 
• 
• 
• 
• 

TOG for gasoline (noricatalyst/catalyst composit<:::) evaporative diurnal processes; 
TOG for gasoline (noncatalyst/catalyst composite) evaporative.nondiurn~ processes; •. 
TOG for gasoline (noncatalyst/catalyst composit<:::) exhaust operations; 
NOx for gasoline (noncatalyst/catalyst composite) exhaust operations; 
CO for gasoline (noncatalyst/catalyst composite) exhaust operations; 
TOG for diesel (noncatalyst/catalyst composite) exhaust operations; 
NOx for diesel (noncatalyst/catalyst composite) exhaust operations; and 
CO for diesel (noncaWyst/catalyst composite) exhaust operations. 

The mobile emission processor computes motor vehicle emissions estimates based on three types 
of VMT files: 

. 

. 

• 
• 
• 

On-network VMT; 
Off-network VMT; and 
Public land survey quarter sections VMT. 

The differences in the VMT types are: 

• 
• 
• 

On-network VMT are network link-specific; 
Off-network VMT are county/area type/facility type-specific; and 
Public land survey quarter sections VMT are county/polygon/area type/facility type(cid:173)
specific. 

The mobile-emission processor estimates motor vehicle emissions for all combinations ofVMT. 
Regardless of the VMT type that is used to generate motor vehicle emission estimates, all motor(cid:173)
vehicle emission estimates have some degree of uncertainty.  However, the most desirable motor(cid:173)
vehicle emissions estimates usually are generated from on-network, link-specific data, followed by 
public land survey quarter sections data, and finally off-network data.  Motor vehicle emission 
estimates that are generated from on-network data are not more certain, but that they are more 
spatially representative. 

Before the mobile-source emission processor computes the motor vehicle emission estimates, it 
computes a fleet composite emission factor.  Equations 4-44 through 4-67 show how the 
processor computes the fleet composite emission factors.  In all cases, the emission factors are 
extracted from the Mobile lookup tables based on the appropriate indices.  Please refer to the 
section on generating the Mobile emission factors lookup tables earlier in this section for 
additional information. 

If the user has provided non-I/M-specific VMT, the mobile source emission processor computes 
the fleet composite emission factors by vehicle classification for temperature and speeds 
combinations through the application of Equations 4-35 through 4-42. 

* 
* 

hcdifs.t  =  :Ejhcdij,s,t * vmixj 
hcexf;;,t =  :Ej hcexj,s,t * vmixj 
. 
xf  -~ 
no 
s.t  - .ujnOXXj,s,t  VIIllXj 
. 
f  -~ 
coex s,t  - ~j coexj,s,t  vm1xj 
hcevfs.1  =  :Ej hcevj,s,t * vmixj 
dhcexfs,t = :Ej  dhcexj,s,t * vmixj 
dno~.t =  :Ej  dnoxxj,s,t * vmixj 
dcoe~.t =  :Ej  dcoexj,s,t * vmixj 

(4-35) 
(4-36) 
(4-37) 
(4-38) 
(4-39) 
(4-40) 
(4-41) 
(4-42) 

where: 

j  is the vehicle classification index 
s is the speed index 
t is the temperature index 
hcdif is the hydrocarbon diurnal fleet composite emission factor for all vehicle types 

(grams/mile) 

hcdi is the non-I/M hydrocarbon diurnal emission factor (grams/mile) 
vmix is the vehicle mix profile 


hcexf is the hydrocarbon exhaust nondiurnal fleet composite emission factor for . 

gasoline vehicles (grams/mile) 

hcex is the non-1/M hydrocarbon exhaust nondiurnal emission factor for gasoline 

vehicles (grams/mile) 

noxf is the oxides of nitrogen exhaust nondiurnal fleet composite emission factor for 

gasoline vehicles (grams/mile) 

noxx is the non-1/M oxides of nitrogen exhaust nondiurnal emission factor for 

gasoline vehicles (grams/mile) 

coexf is the carbon monoxide exhaust nondiurnal fleet composite emission factor for 

gasoline vehicles (grams/mile) 

coex is the non-1/M carbon monoxide exhaust nondiurnal emission factor for gasoline 

vehicles (grams/mile) 

hcevf is the hydrocarbon evaporative nondiurnal fleet composite emission factor for 

gasoline vehicles (grams/mile) 

· 

hcev is the non-I/M hydrocarbon evaporative nondiurnal emission factor for gasoline 

vehicles (grams/mile) 

dhcexf is the hydrocarbon exhaust nondiurnal fleet composite emission factor for 

diesel vehicles (grams/mile) 

· 

dhcex is the non-1/M hydrocarbon exhaust nondiurnal emission factor for diesel 

vehicles (grams/mile) 

dnoxf is the oxides of nitrogen exhaust nondiurnal fleet composite emission factor for 

diesel vehicles (grams/mile) 

dnoxx is the non-1/M oxides of nitrogen exhaust nondiurnal emission factor for diesel 

vehicles (grams/mile) 

dcoexf is the carbon monoxide exhaust nondi.urnal fleet composite emission factor for 

diesel vehicles (grams/mile) 

dcoex is the non-1/M carbon monoxide exhaust nondiurnal emission factor for diesel 

vehicles (grams/mile) 

If the user has provided I/M-specific VMT data, the processor computes the fleet composite 
emission factors by vehicle category for temperature and speed combinations through the 
application of Equations 4-43 through 4-50. 

hcdifs,t  =  .I:j  ihcdij,s,t * vmixj 
hcexfs,t  =  I:j ihcexj,s,t * vmixj 
noxfs,t  =  .I:j  inoxxj,s,t * vmixj 
coexfs,t  = .I:j  icoexj,s,t * vmixj 
hcevfs,t  = .I:i  ihcevj,s,t * vmixi 
· dhcexfs,t =  .I:j  idhcexj,s,t * vmixj 
dnox~.t =  I:j idnoxxj,s,t * vmixj 
dcoexfs,t = .I:j  idcoexj,s,t * vmixi 

(4-43) 
(4-44) 
(4-45) 
(4-46) 
(4-47) 
(4-48) 
(4-49) 
(4-50) 

where: 

ihcdi is the I/M hydrocarbon diurnal emission factor (grams/mile) 

ihcex is the I/M hydrocarbon exhaust nondiurnal emission factor for gasoline vehicles 

(grams/mile) 

inoxx is the I/M oxides of nitrogen exhaust nondiurnal emission factor for gasoline 

vehicles (grams/mile) 

icoex is the I/M carbon monoxide exhaust nondiurnal emission factor for gasoline 

vehicles (grams/mile) 

ihcev is the I/M hydrocarbon evaporative nondiurnal emission factor for gasoline 

vehicles (grams/~ile) 

idhcex is the I/M hydrocarbon exhaust nondiurnal emission factor for diesel vehicles 

(grams/mile) 

idnoxx is the I/M oxides of nitrogen exhaust nondiurnal emission factor for diesel 

vehicles (grams/mile) 

idcoex is the I/M carbon monoxide exhaust nondiurnal emission factor for diesel 

vehicles (grams/mile) 

If the user has provided both I/Mand non-I/M VMT data, the mobile source emission processor 
computes the fleet composite emission factors by vehicle category for temperature and speed 
combinations through the application of Equations 4-51through4-58 This set of equations can be 
applied only to on-network VMT data because the I/M percentages are input to the mobile source 
emission processor on a link-specific basis. 

hcdifs,t  =  ~j ((ihcdij,s,t * imvmt1)  + (hcdij,s,t * (1  - imvmt1)))  *  vmixj 
hcexfs,t  =  ~j ((ihcexj,s,t * imvmt1)  + (hcexj,s,t * (1  - imvmt1))) * vmixj 
nox.fs,t  = ~j ((inoxxj,s,t * imvmt1)  + (noxxj,s,t * (1  - imvmt1))) * vmixj 
coex.fs.t  =  ~i ((icoexj,s,t * imvmt1)  + (coexj,s,t * (1  - imvmt1))) * vmixj 
hcevfs,t  =  ~i ((ihcevj,s,t * imvmt1)  + (hcevj,s,t * (1  - imvmt1))) ~ vmixj 
dhcex.fs.t  =  ~i ((idhcexj,s,t * imvmt1)  + (dhcexj,s,t * (1  - imvmt1))) * vmixj 
dnoxfs,t  = ~i ((idnoxxj,s,t * imvmt1)  + (dnoxxj,s,t * (1  - imvmt1))) * vmixj 
dcoex.fs,t  =  ~i ((idcoexj,s,t * imvmt1)  + (dcoexj,s,t * (1  - imvmt1))) * vmixj 

(4-51) 

(4-52) 
(4-53) 
(4-54) 
(4-55) 
(4-56) 
(4-57) 
(4-
58) 

where: 

imvmt is the fraction of vehicles that are under an I/M program; and 
I is the link identifier index. 

Many indices have been left out of Equations 4-35 through 4-58.  The composite emission factors 
that are generated are gridded, hourly values.  Because temperature is a gridded, hourly value, the 
temperature index tin Equations 4-31  through 4-54 implies that the composite emissions factor 
are gridded, hourly values. 

Once the fleet composite emission factors have been computed, the mobile source emission 
processor computes the motor vehicle emission estimates through the application of Equations 4-
59 through 4-66. 

4-62 

dhc  vee =  hcdif * divmt * 10**-3 
he  xee =  hcexf * ovmt * 10**-3 
noxxee =  noxf * ovmt * 10**-3 
co  xee =  coexf * ovmt * 10**-3 
he  vee = hcevf * ovmt * 10**-3 
dhc  xee = dhcexf * ovmt * 10**-3 
dnoxxee =  dnoxf * ovmt * 10**-3 
dco  xee = dcof * ovmt * 10**-3 

EPA/600/R-991030 

(4-59) 
(4-60) 
(4-61) 
(4-62) 
(4-63) 
(4-64) 
(4-65) 
(4-66) 

where: 

dhc _ vee is the gridded, hourly diurnal hydrocarbon emission estimate (kilograms) 
divmt is the gridded, hourly diurnal VMT (miles) 
he_ xee is the gridded, hourly exhaust hydrocarbon nondiurnal emission estimate for 

gasoline vehicles (kilograms) 

ovmt is the gridded, hourly nondiurnal VMT (miles) 
noxxee is the gridded, hourly exhaust oxides of nitrogen nondiurnal emission estimate 

for gasoline vehicles (kilograms) 

co_ xee is the gridded, hourly exhaust carbon monoxide nondiurnal emission estimate 

for gasoline vehicles (kilograms) 

he_ vee is the gridded, hourly evaporative hydrocarbon nondiurnal emission estimate 

for gasoline vehicles (kilograms) 

dhc _ xee is the gridded, hourly exhaust hydrocarbon nondiurnal emission estimate for 

diesel vehicles (kilograms) 

dnoxxee is the gridded, hourly exhaust oxides of nitrogen nondiurnal emission 

estimate for diesel vehicles (kilograms) 

dco_xee is (the gridded, hourly exhaust carbon monoxide nondiurnal emission 

estimate for diesel vehicles (kilograms) 

The mobile-source emission processor computes the final motor vehicle emission estimates file by 
summing the emission estimates computed by Equations 4-59 through 4-66 over each state 
identifier, county identifier, east-west grid cell identifier, north-south grid cell identifier, process 
type (EV for evaporative, EX for exhaust), technology type (1  for gasoline, 2 for diesel), and 
pollutant identifier (HC for hydrocarbon, CO for carbon monoxide, NOx for oxides of nitrogen). 

The PARTS Model 

The current version of PARTS was released in 199S by the U.S. EPA Office of Mobile Sources. 
The description given here is taken principally from the user's guide, A Draft User's Guide to 
PART5: A Program for Calculating Particle Emissions from Motor Vehicles  (U.S. EPA, 
199Sb ), which provides information in addition to that gi.ven in this section.  The guide is available 
from the Office of Mobile Sources Internet web site at hlttp:www.epa.gov/omsw/models.htm 
The PARTS is a FORTRAN program used to model emission factors needed to. estimate 
emissions from gasoline and diesel powered on-road vehicles.  It calculates particle emission 
factors in grams per mile for particle sizes 1 to 10 micrometers.  The emission factors include 
exhaust particulate matter and components, brake wear, tire wear, and re-entrained road dust. 
The program includes default data for most inputs, but allows user-supplied data for most items. 
The interactive aspects of running PARTS, as it is  provided by the Office of Mobile Sources, 
have been subsumed into MEPPS to allow the user to enter and edit data, specify program control 
flags, and run the model via a series of windows within the EMPRO mobile source processor. 

Controls specified within PARTS may vary spatially and temporally.  PARTS output report flags 
are not germane within MEPPS because the outputs are automatically processed with emissions 
from other emission sources in MEPPS internal format.  They flags used include the following 
items: 

• 

Vehicle fleet mix.  The user may specify of whether default or user··supplied VMT vehicle 
fleet mixes are used.  The VMT mix is the fraction of total VMT for all vehicles 
contributed to by each vehicle class.  The default VMT is based on national averages and 
trends over the years.  The trends reflect the sales shift from automobiles to light-duty 
trucks, and the increasing use of diesel engines in both light and heavy-duty trucks. VMT 
mix may vary spatially.  The following are the descriptions of the vehicle classes and 
corresponding Federal Highway Administration (FHA) and gross vehicle weight (GVW) 
used in PARTS. 

Vehicle Class 

FHA Class 

GVW (lbs) 

1 = LDGV (light-duty gasoline vehicle) 
2 =  LDGTl (light-duty gasoline truck, I) 
3 = LDGT2 (light-duty gasoline truck II) 
4 = HDGV (heavy-duty gasoline truck) 
5 = MC (motor cycle) 
6 = LDDV (light-duty diesel vehicle) 
7 = LDDT (light-duty diesel truck) 
8 = 2BHDDV (class 2B heavy duty diesel vehicle) 
9 = LHDDV (light heavy-duty diesel vehicle) 

10 =  MHDDV (medium heavy-duty diesel vehicle) 

1 

2B 

2A 

3,4,5 

6,7,8A 

1 
2A 
2B-8B 

<6000 
6001-8SOO 
>8500 

<6000 

6001-8500 

8501-10000 
10001-
19500 
19S01-
33000 
33000+ 

11  = IDIDDV (heavy heavy-duty diesel vehicle) 
12 =BUSES (buses) 

8B 

• 

Mileage accumulation rates.  The user may supply or use default mileage accumulation 
rates and vehicle registration distributions.  The mileage accumulation rate is the expected 
number of miles that a typical vehicle (for each class) is expected to travel in a year, 
divided by 100,000.  The rates must be provided for each vehicle type for each of 25 years 
(12 years for motor cycles). 

Inspection and maintenance.  The user specifies whether an inspection and maintenance 
program is assumed for gasoline vehicle vehicles only. 

Reformulated gasoline.  The specifies whether th1~ use and effects of reformulated gasoline 
on particulate emissions ~e assumed.  The effects are partially, based on the sulfur content 
of gasoline used.  An average sulfur weight percent of 0.034 is used for any gasoline used 
in all years prior to 2000.  If reformulated gasoline is used.for the year 2000 or later, the 
sulfur weight percent is assumed to be 0.0138. 

The purpose of MEPPS is to estimate temporally and spatially-varying emission data on a gridded 
basis.  This is consistent with some additional input data which PARTS requires be entered on 
spatial basis, which are defined as PARTS scenarios.  In EMPRO mobile source processing the 
user is prompted to edit existing or new scenario data.  The information includes: 

• 

• 

• 

• 

• 

• 

Region, calendar year, speed cycle (type of driving, ie. cruise), and average speed. 

Percent of unpaved road silt, paved road silt loading in gm /m2
number of wheels per vehicle. Modeled dust emission factor are highly sensitive to the 
unpaved road silt percentage which is extremely variable.  Consequently, measured data 
are advised when possible. 

,  and optionally, the average 

The number of days each year with greater than 0.01  inches of precipitation for use in 
modeling re-entrained dust.  This is  climatological average data.  In the future, the 
emission processing system may be modified to use  more spatially and temporally 
accurate modeled precipitation data by grid cell taken from MM5 and MCIP for the 
PARTS calculations. 

A scenario name may be applied.  In MEPPS a FIPS code a geographic identifier is 
entered which is used to apply PARTS emission factors computed for the comity level to 
the appropriate modeling grid cells. 

PARTS expects the user to define a maximum particle size cutoff (maximum allowed is 10 
micrometers).  In MEPPS the maximum size is defaulted to 10 micrometers to ensure that 
the full range of particle sizes are represented in the regional emission estimates. 

Average vehicle weight (lbs) 

PARTS Emission Factors 

The emission factors calculated by PARTS include the particulate pollutant compounds of lead, 
sulfate, soluble organic fraction particulate matter, remaining carbon portion particulate matter, 
and total exhausted particulate.  The lead and sulfate are formed from the lead and sulfur 
contained in the fuel.  The soluble organic fraction consists primarily of hydrocarbons coming 
from unburned or partially burned fuel and lubricating oil.  The remaining carbon portion consists 
of soot-like carbon (elemental carbon) and trace amounts of other compom~nts from the fuel and 
lubricating oil.  The total exhaust particulate is the sum of these four categories.  In addition to 
these categories of exhaust emissions, idle exhaust emissions (for heavy diesel vehicles only), 
brake wear, tire wear, fugitive dust, indirect sulfate, and gaseous sulfur dioxide are calculated by 
PARTS. 

The model calculates the emission factors for the 12 vehicle classes previously described and a 
fleet-wide average (estimated by VMT weighting of the emission factors for each of the 12 
vehicle classes.  The factors are composites of the emission factors for the 25+ years prior to the 
year of interest, in order to allow for the effects of older vehicles.  The composite emission factor 
for each vehicle class is calculated by weighting the emission factor calculated for each model year 
by the travel fraction for that model year, and then summing the 25 weighted factors.  The travel 
fraction of a model year is the fraction of VMT by a vehicle of that model year out of the total 
number of miles traveled by all model years' vehicles in that vehicle class. 

• 

. 
EFCOMPv =  EF mv  * TF mv 

. 

25 

m=l 

(4-67) 

where: 

EFCOMPv is the composite emission factor for vehicle class v~ 
is the emission factor for vehicle class v, model year m, 
EF m,v 
TF m,v 
is the travel fraction for vehicle class v, model year m. 

The overall travel fraction of a vehicle class represents the fraction of the total number of VMT of 
that class of the total highway VMT by all 12 classes.  The VMT fractions for each vehicle class 
are multiplied by the corresponding composite emission factors (EFCOMP v),  and the sum of the 
adjusted emission factors is reported as the emission factor for all vehicles. 

EF ALL =  :E EFCOMP v * TFCLASSv 

(4-68) 

where: 

EF ALL is the weighted emission factor for all vehicles, 
TFCLASSv is the VMT of vehicle class v. 

The emission factor for all vehicles, EF ALL, represents the grams/mile of ·~missions 

Lead Emission Factors for gasoline-fueled vehicles 

Lead particulate emission factors for. gasoline-fueled vehicles assume that almost all lead in the 
fuel is exhausted.  Therefore, the emission factors (grams/mile) depend on the lead content of fuel 
and fuel economy of the vehicle (miles/gallon).  The factors allow for the fact that the lead content 
of leaded fuel is much greater than for unleaded fuel.  The assumption is made that because diesel 
fuel has negligible lead content,  the lead emissions from diesel vehicles will be negligible.  The 
following formulae are used to compute lead emission factors for all gasoline-fueled automobiles 
and motorcycles, respectively. 

LEADm,Y =  PLNOCTm,Y * VLNOCTm.Y + PUNOCTm,Y * VUNOCTm,Y + 

PL YSCT m,Y  * VL YSCT m,Y  + PUYSCT m,Y,  * VUYSCT m,Y 

(4-69) 

where: 

m denotes a specified model year 
v denotes a specified vehicle class 
LEADm,Y is the lead particulate emissions for any given vehicle (grams/mile) 
PLNOCT m,Y  is the emissions for a non-catalyst, leaded fuel vehicle (grams/mile) 
PUN OCT m,Y  is the emissions for a non-catalyst, unleaded fuel vehicle (grams/mile) 
PL YSCT m,Y  is the emissions for a catalyst, leaded fuel vehicle (grams/mile) 
PUYSCTm,Y is the emissions for a catalyst, unleaded fuel vehicle (grams/mile) 
VLNOCTm,Y is the emissions for a non-catalyst, leaded fuel vehicle (grams/mile) 
VUNOCT m,Y  is the emissions for a non-catalyst, unleaded fuel vehicle (grams/mile) 
VL YSCT m,Y  is the fraction of catalyst leaded fuel vehicles 
VUYSCT my  is the fraction of catalyst, unleaded fuel vehicles 

The emission rate is adjusted for speed by the factor FEC such that: 

CLEADm,Y = FEC * LEADm,Y 

(4-70) 

where: 

CLEADmY is the lead emissions for a vehicle of model year m and vehicle class v, 
which has been adjusted for the effect of speed (grams/mile) 

FEC is 

l/SCF c 

(4-71) 

SCFc is the speed correction factor, based either transient driving cycle (c=l) or 
steady cruise driving cycle (c=2) 

SCF1 = 0.17930 + (0.038561  *SPEEDY)- (0.00041067 *SPEED/) 

SCF2 = 0.26929 + (0.054607 * SPEEDJ - (0.00069818 *SPEED/) 

(4-72) 

(4-73) 

SPEEDY is the average speed for vehicle class v (mph) - user input 

Motorcycles do not have catalytic emission controls, therefore organic emission factors are not 
calculated and sulfate emission factors are deemed negligible.  PAR TS  emission factors for 
motorcycles are almost entirely for lead particulate matter.  The lead particulate emission factor 
for 2-stroke engines is 0.33 g/mi and for 4-stoke engines 0.046 grams/mile.  For model years 
before 1978 there were 51percent4-stroke engines and 49 percent.2-stroke engines, computed as 
follows: 

LEADm,motorcycle =  [(0.49 * 0.33) + (0.51  * 0.046)] * PSL 

(4-74) 

For model years 1978 and later motorcycles are assumed to consist entirely of 4-stroke engines: 

LEADm,motorcycle = 0.046 * PSL 

(4-75) 

where: 

PSL is the fraction of all particles that are emitted based on a specified upper particle 
size cutoff (10 micrometers running in MEPPS) 

The specific derivations of the lead particulate emission formulae are given in Appendix 1 of the 
PART 5 user's guide (U.S. EPA, 1995b). 

Sulfate Emission Factors for Gasoline-Fueled Vehicles 

Particulate sulfate emission factors consist of direct and indirect sulfate material.  The direct 
sulfate is exhausted as sulfuric acid, and the indirect sulfate is formed later in the atmosphere from 
exhausted 802•  The indirect sulfate in the model is calculated based on the assumption that it 
consists entirely of ammonium sulfate and ammonium bisulfate.  The direct sulfate, indirect 
sulfate, and gaseous sulfate emission factors are computed in PARTS, and the emission factors 
reported as grams/mile traveled. 

The direct sulfate from non-catalyst vehicles using leaded fuel (includes ca.talyst-equipped vehicles 
which are misfueled, making the catalyst ineffective) is calculated as: 

DSULFN =  .002, for speeds equal to or less than 19.6 mph 

DSULFN =  .001, for speeds equal to or greater than 34.8 mph 

The direct sulfate from catalyst vehicles is calculated as : 

DSULFCm,v =  [FRACcat/noair (.005) + FRACcat/air (.016)] 
for speeds equal to or less than 19.6 mph 

DSULFCm,v = [FRACox/noair (.005) + FRAC3w/noair (.001) + FRACox/air (.020) 

+FRAC3w/air (.025)] 

for speeds equal to or greater than 34.8 mph 

(4-76) 

(4-77) 

(4-78) 

(4-79) 

For speeds between 19.6 and 34.8 mph, DSULFN and DSULFC are interpolated between 
Equations 4-76 and 4-77 and 4-78 and 4-79, respectively. 

where: 

m denotes a specified model year 
v denotes a specified vehicle class 
FRACcatlnoair is the fraction of vehicles which are catalyst equipped with no air pump 

FRACcat/air is the fraction of vehicles which are catalyst equipped with an air pump 
FRAC0x1noair  is the fraction of vehicles which are oxyg~m catalyst equipped with no air 

pump 

FRAC3wtnoair  is the fraction of vehicles which are 3-way catalyst equipped with no air 

pump 

FRAC0x1air  is the fraction of vehicles which are oxidation catalyst equipped with an air 

pump 

FRAC3wtair  is the fraction ofvehi~les which are 3-way catalyst equipped with air pump 

The direct sulfate from all gasoline-fueled vehicles is computed as: 

DSULF m,v  = CTLFRCm,v * DSULFCm,v + (1.0 -CTLFRCm) * DSULFN 

where: 

CTLFRCm v = CATFCT m v  (1-RMISm v) 
, 
the fraction of the vehicle class that has an effective catalyst 

,  . 

, 

(4-80) 

(4-81) 

The PAR T5 assumes that all sulfur in fuel is exhausted as either sulfate or gaseous sulfur dioxide 
(802).  Therefore when the direct sulfate emission factor is calculated, the remaining sulfur in the 
fuel is considered to be exhausted as 802•  The amount of sulfur remaining in the fuel after the 
direct sulfate emission factor has been determined must be calculated to find the amount of sulfur 
exhausted as 802 (grams/mile). 

The following equation is used to determine the fraction of sulfur in the fuel that has been directly 
converted to sulfate (DSULF m v  calculated in Equation 4-80 above).  The equation calculates 
direct sulfate as a function of the fuel sulfur content, DCNVRT (the fraction of sulfur in the fuel 
that is converted to direct sulfate), and the fuel economy. 

DSULFm,v = 13.6078 * (1.0 +WATER)* FDNSTY * SWGHT * DCNVRT 

I FEm,v 

(4-82) 

where: 

m denotes a given model year 
v denotes a given vehicle class 
DSULF m,v  is the direct sulfate emission factor (grams/mile) 
WATER is the weight ratio of seven water molecules to sulfate, 1.2857, based the 
estimate that at 50 percent humidity, seven water molecules bond with each 
sulfuric acid molecule 

FDNSTY is the fuel density in lb/gal (6.09 pounds/gallon) 
FEm v is the fuel economy 
SWGHT is the weight percent of sulfur content in fuel (.034, except for reformulated 

fuel phase II, for year 2000 and later . 013 8) 

DNVRT is the percent of sulfur in the fuel that is directly converted into sulfate (2 

percent) 

13.6078 is a unit conversion factor equal to (453.592 * 3.0)/100, where 453. 592 is 
equal to the number of gram in a pound, 3.0 is the weight ratio of sulfate to 
sulfur, and division by 100 corrects for the weight percent of sulfur, SWGHT 

IfDSULFCm,v and DSULFN (from Equations 4-76 through 4-79) are substituted in Equation 4-
82, one can solve for the :fractions of sulfur in the fuel that are converted to sulfate separately for 
catalyst and noncatalyst vehicles: 

FCNVRCm,.v = DSULFCm,v * FEm,v 

I (13.6078 * (1.0 +WATER)* 

FDNSTY* SWGHT) 

. 
FCNVRNmv = DSULFN * FEmv 

. 

FDNSTY * SWGHT) 

I (13.6078 * (1.0 +WATER)* 

(4-83) 

(4-84) 

where: 

FCNVRCm v is the fraction of the percent of fuel that is directly converted into sulfate 

FCNVRNmv is the fraction of the percent of fuel that is directly converted into sulfate 

for catalyst equipped vehicles 

. 

. 
for non-catalyst vehicles 

The gaseous sulfur emission factors, which are dependent on the above fractions, are calculated 
from the following equation: 

where: 

S02mv =  9.072 * FDNSTY * SWGHT * (1.0 -DCNVRT) I FEmv 
. 

. 
S02m,v is the gaseous ·sulfur emission factor of a vehicle 
9.072 is a unit conversion factor equal to (453.592 *2)/100, where 453.592 is the 
number of grams in a pound, 2 is the weight ratio of S02  to sulfur, and the 
division by 100 corrects for the weight percent of sulfur, SWGHT 

(4-85) 

Additional details concerning the calculation of gaseous sulfur emission factors are given in the 
PARTS user's guide (U.S. EPA,  1995b).  In addition to direct sulfate and gaseous sulfate 
emission factors, PAR T5 estimates an indirect sulfate emission factor by assuming that a fraction 
of the gaseous sulfur dioxide emissions is later converted in the atmosphere to sulfate material. 
Based on ambient sulfur and sulfate measurements in 11  cities, it is estimated that 12 percent of 
all gaseous sulfur is converted to sulfate.  Additional information on the cal~culation of indirect 
sulfate is given in the PAR T5 user's guide. 

· 

Sulfate Emission Factors for Diesel-Fueled Vehicles 

For diesel-fueled vehicles, PART5 calculates sulfate emission fact.ors again assuming that all 
sulfur in the fuel is exhausted as either sulfuric acid or gaseous sulfur dioxide.  The direct sulfate 
emission factor (grams/mile) is calculated using the following equation: 

DSULFm,v = 13.6078 * (1.0 +WATER)* FDNSTY * SWGHTD * 

DCNVRT I FEm,v 

(4-86) 

where: 

m is a specified model year 
y is a specified vehicle class 
DSULF m v is the direct sulfate emission factor for a vehicle (grams/mile) 
DCNVRT is the fraction of sulfur in the fuel that is converted directly to sulfate (2.0 

percent 

FDNSTY is the density of diesel fuel (7.11  pounds/gallon) 
FEm,v  is the fuel economy for a vehicle (miles/gallon) 
SWGHTD is the weight percent of sulfur in diesel fuel (0.25 for high sulfur fuel, 0.05 

for low sulfur fuel used in 1993  and later) 

WATER  is the weight ratio of seven water molecules to sulfate ( 1.2857) 
13.6078 

is a unit conversion factor equal to 493.592 * 3/100, where 493.592 is the 
number of grams in a pound, 3 is the weight ratio of sulfate to sulfur, and the 
division by 100 corrects for the weight percent of sulfur SWGHTD 

The gaseous sulfur emission factor is calculated by the following equation: 

S02m,v =  9.072 * FDNSTY * SWGHTD * (1.0 - DCNVRT) I FEm,v 

(Eq.4-

87) 

where: 

S02m v is the sulfur emission factor (grams/mile) of a vehicle 
9.072 is a unit conversion factor equal to (453.592 * 2/100) where 453.592 is the 
number of grams in a pound, 2 is the weight ratio of S02 to sulfur, and the 
division by 100 corrects for the weight percent of sulfur, SWGHTD 

The indirect sulfate emission factor, consisting mainly of ammonium sulfate and ammonium 
bisulfate is calculated using the following equation: 

ISULFmv = ICNVRT * S02mv * (3/2) * AMNWGT 

' 

' 

(4-88) 

where: 

ISULF m v is the indirect sulfate emission factor of a vehicle (grams/mile) 
ICNVRT is the fraction of S02  converted to sulfate in the atmosphere (12 percent) 
3/2  is the weight ratio of S02 to sulfate 
AMNWGT is the estimated weight ratio of the combination of ammonium bisulfate 

and ammonium sulfate in the atmosphere to sulfate (1.6) 

Total Exhaust Particulate Emission Factors for Gasoline-Fueled Vehicles 

The total exhaust particulate emission factors for light~duty gasoline fueled vehicles are calculated 
by summing lead, direct sulfate, and a carbon emission factor which includes soluble organic 
material and other remaining carbon.  Table 4-5 presents a summary of th1~ carbon emission 
factors by vehicle model year and type of technology. 

Table 4-5.  Carbon Emission Factors for Gasoline-Fueled Vehicles (grams/mile) 

Vehicle Type/ 
Model Year 

Light-Duty 

Gasoline Vehicles 

pre-1970 

1970-1974 

1975-1980 

1981  + 

Light-Duty 

Gasoline Trucks I 

pre-1970 

1970-1974 

1975-1986 

1987+ 

Light-Duty 

Gasoline Trucks II 

pre-1979 

1979-1986 

1987 + 

Heavy-Duty 

Gasoline Vehicles 

pre-1987 

1987 + 

Leaded Fuel··  · ... 

···  UQI#~9~9/.C.~~1y~t 
• • •.  · ·.• • ?CiP}~p~q Qi9 f:l}t  .••• 
..  ·/ :•p~~p)·  <•·.·· 

p~1¢~d,~d/.gat~l~·sf ·· 
. .  ·.·.·• . .  ••.<.•P.·'!'.•)•• ... ·.1.·· .•.. •.t .. h.·.•.•.• .. • .. •.~.-.·1·ir· 
····•.·.  E.··.•.·.·.•.q.•••.u.•.•.•.•.i.•.PP.:.•.•.•.•P·•.·.•.•.¢u•.• 

.pM~~4~a/No~S < 
•.'·.·· <  • ~i#alysteql11J>ped .•. ·•· 

.. • .. • .d . •m ·  

.193 

.068 

.030 

.017 

.193 

.068 

.030 

.017 

.370 

.068 

.030 

.370 

.163 

NA 

.0060 

.0060 

.0043 

NA 

.0060 

.0060 

.0043 

NA 

.0060 

.0043 

.054 

.054 

NA 

.0250 

.0250 

.0043 

NA 

.0250 

.0250 

.0043 

NA 

.0250 

.0043 

.054 

.054 

.030 

.030 

.030 

.017 

.030 

.030 

.030 

.017 

.054 

.030 

.017 

.054 

.054 

Total Exhaust Particulate Emission Factors for Diesel-Fueled Vehicles 

The total exhaust particulate emission factors are for diesel-fueled vehicle categories and model 
years (EFDPMmv)·  The emission factors· for heavy-duty vehicles are in units of grams/brake-
horsepower hour (g/BHP-hr), which are converted to grams/mile by PARTS.  The conversion 
factors and emission factors vary by model year.  The emission factors for light-duty diesel 
vehicles are in units of grams/mile.  The total exhaust emission factors given in Table 4-6 are 
based on high-sulfur fuel.  TI:ie sulfur content in diesel fuel was reduced in 1993 by EPA 
regulatory requirements.  Consequently, when a the specified calendar year is  1993 or later, 
PARTS will adjust the exhaust emission factors for lower sulfur fuel.  Particulate emission factors 
for diesel-fueled vehicles are not adjusted for speed. 

Table 4-6.  Exhaust Particulate Emission Factors for Diesel-Fueled Vehicles 

· ..  <: ,,,_,:.:::'  -<:::':'_.•·.· .. ·•• .. •.v.•·.•·.···-~-h. ·_fo_._1_._e_·.··.·•_'.T_•· 
...•.. Y ' .  

·  .. ·.·P'_e_._.f.· .•. M_.·_·_·. o_ 

:_  a_·_ .. _.e_'.'_·.t 

.... '_·•.·.Y.'.•··'.:.e_'_.••.a 

...•. r_.·.·_ .... •.•.o_·.• 

__ .. __ .. u_·.·_.P· 

.. ··. ·_.·_,.,_.·_:· '_:·.·········• 

:_·._-.r_._o 

Light-Duty Diesel Vehicles (grams/mile)-

pre-1981 

1981 

1982-1984 

1985-1986 

1987 

1988-1990 

1991-1993 

1994-1995 

1996 + 

Light-Duty Diesel Trucks (grams/mile) 

pre-1981 

..  1981 

1982-1984 

1985-1986 

1987 

1988-1990 

1991-1993 

1994-1996 

1997 + 

(t"E:'ib~J~£Pirii2m~f ~:Eiriis~fori:f'~@tcif, ·o \i .::.::::, ..•. 

·.· .. ·.·.· .. ·  ....... · .. ·.··.·.·:<·.··<······:-:..·· .. ···:····.· .. ·.· .. ·.·.··.·.· .. · .... ·.· .. ·.·.· .. ·.·.·.· .. · .. ·.·.· ......... 

. 

·.··.·. 

.700 

.259 

.256 

.255 

.134 

.132 

.131 

.128 

.100 

~700 

.309 

.354 

.358 

.334 

.291 

.294 

.130 

.109 

'  • ''  :,. ,,_: 

•': 

•• 

. 

Table 4-6.  Exhaust Particulate Emission Factors for Diesel-Fueled Vehicles 

Class 2B Heavy-Duty Diesel Vehicles (grams/brake 

horsepower-hour) 

pre-1988 

1988-1990 

1991-1993 

1994+ 

Light Heavy-Duty Diesel Vehicles (grams/brake 

horsepower-hour) 

pre-1988 

1988-1990 

1991-1993 

1994+ 

Medium Heavy-Duty Diesel Vehicles (grams/brake 

horsepower-hour) 

pre-1987 

1988-1990 

1991-1993 

1994 + 

Heavy Heavy-Duty Diesel Vehicles (grams/brake 

horsepower-hour) 

pre-1987 

1988-1990 

1991-1993 

1994+ 

Buses (grams/brake horsepower-hour) 

pre-1987 

1988-1990 

1991 

4-74 

.5156 

.5140 

.2873 

.1011 

.5156 

.5140 

.2873 

.1011 

.6946 

.4790 

.2747 

.0948 

.6444 

.4360 

.2709 

.0836 

.6931 

.4790 

.2772 

Table 4-6.  Exhaust Particulate Emission Factors for Diesel-Fueled Vehicles 

EP A/600/R-99/030 

1992 without traps 

1992 with traps 

1993 without traps 

1998 with traps 

1994 + 

.1716 

.0257 

.1457 

.0240 

.0591 

. Soluble Organic Fraction and Remaining Carbon Portion Emission Factors for Diesel-Fueled 
Vehicles 

The PARTS model calculates the Soluble Organic Fraction (SOF) emission factor as a fraction of 
the remaining ~ass, using the following equation: 

SOF m,v,  =  [EF m,v- DSULF m,v  ] * (fractionsoF,J 

The Remaining Carbon Portion (RCP) is defined the remainder (everything else): 

RCP m,v  = Efm,v - DSULF m:v  - SOF m,v 

(4-89) 

(4-

90) 

where: 

m is the model year of a selected vehicle 
v is the class of a selected vehicle 
SOF m vis the Soluble Organic Fraction of the exhaust particulate emission factor 

· 

· (grams/mile) 

· 

· · 

· 

, · 

RCP m,v  is the remaining carbon portion (elemental 'carbon) of the exhaust particulate 

emission factor (grams/mile) 

EF m,v  is EFDPMm,v * CF m,v  , the exhaust particulate emission factor for a vehicle 

(grams/mile) 

EFDPMm v is the exhaust particulate emission factor for a vehicle (grams/Brake 

Horsepower-hour) 

CF m v  is the conversion factor from grams/Brake Horsepower-hour to grams/mile 

(Brake Horsepower-hour/mile) 

fractionsoF.v is the fraction of the non-sulfate portion (ie. the carbon portion) of the 

diesel exhaust particulate emission factor which is organic carbon for a vehicle 
(Brake Horsepower-hours/mile) 

The Soluble Organic Fractions (fraction80F,v)  for different vehicle classes are as follows (U.S. 
EPA, 1990): 

0.18 for LDDVs (Light-Duty Diesel Vehicles) 
0.50 for LDDTls (Class 1 Light-Duty Diesel Trucks) 
0.48 for LDDT2s (Class 2 Light-Duty Diesel Trucks) 
0.51  for LHDDVs (Light Heavy-Duty Diesel Vehicles) and 2BHDDVs (Class 2B Heavy(cid:173)
Duty Diesel Vehicles) 
0.44 for MHDDVs (Medium Heavy-Duty Diesel Vehicles) and BUSES 
0.24 for HHDDVs (Heavy Heavy-Duty Diesel Vehicles) 

Idle Emission Factors for Heavy Diesel-Fueled Vehicles 

Idle emission factor data in grams/hour were collected from manufacturers for heavy-duty diesel 
vehicle classes only.  Consequently, the idle emission factors are not included into the "all 
vehicles'' emission category.  The vehicle class emission factors are calculated by averaging 
together model-year-specific emission data, where the model-year-specific: emission data are 
weighted by the estimated travel fraction of that model year within the vehicle class. 

The idle emission factors are model-year-specific but the model year emission rates do not vary by 
vehicle class.  Consequently, the same model year emission factors are used for all the heavy-duty 
diesel classes, and the differences between idle emission factors between classes reflects only the 
differing travel fractions between model years for a class.  As a result, the emission factors 
reported for the smaller of the heavy-duty vehicle classes, such as 2BHDDV and LHDDV, may 
be over estimated.  The base idle emission factor~ in PARTS for all heavy·'duty diesel vehicles are 
as follows: 

• 
• 
• 
• 

5.370 grams/hour for models prior to  1988 
3.174 grams/hour for model years 1988-1990 
1.860 grams/hour for model years  1991-1993 
1.004 grams/hour for model year 1994 + 

Re-entrained Dust from Unpaved Roads 

Re-entrained road dust emission factors for PM10  (particulate matter less than 10 micrometers in 
size)  in PARTS are estimated using an equation (4-91) based on ambient measurements.  Because 
these measurements include particulate matter from brake wear, tailpipe exhaust, tire wear, and 
ambient background particulate matter concentrations, these factors must be subtracted from the 
unpaved road particulate emission factors before the latter factors can be applied.  It is necessary 
to obtain a data base of unpaved and paved road types by county for regional modeling purposes. 
The MEPPS contains procedures and estimates for 1995 developed for EPA  by calculating re(cid:173)
entrained emissions by the month at the state road-type level for the average vehicle fleet, and 
then allocated to the county road type by population for unpaved roads and by total VMT for 
paved roads.  These procedures should be consulted for more details, such as the means of 
estimating unpaved and paved VMT data.  The equation used to calculate PM10  from unpaved 
roads is as follows: 

UNPVD = PSDUNP * 5.9 * (UNSILT/12.0) * (SPD/30.0) * (WEIGHT/3.0)0

(VWHEEL/4.0)0

·

5 * (365-IPDAYS)/365 * 453.592 

7 * 

·

(4-91) 

where: 

UNPVD is the fleet average unpaved road dust emission factor (grams/mile) 
PSDUNP is the fraction of particles less than or equal to the particle size cutoff (the 

cutoff is 10 micrometers in MEPPS) 

UNSILT is the percent silt content of the surface material (user input) 
SPD is the average vehicle speed in miles/hour (user input) 
WEIGHT is the fleet average vehicle weight (user input in pounds) 
VWHEEL is the fleet average number of wheels (user input, default is 4) 
IPDAYS is the average number of precipitation days per year with greater than 0.01 

inches of rain (user input - MEPPS contains climatological default data for 
1995) 

453.592 is the number of grams in a pound 

Emission factors for brake and tire wear (in addition to exhaust emissions) must be calculated so 
that they may be subtracted from the unpaved road emission factors.  The brake wear emission 
:factor is assumed to be the same for all vehicle classes.  It is set equal to: 

BRAKE= 0.0128 * PSBRK 

(4-92) 

where: 

PSBRK is the fraction of particles less than or equal to the particle size cutoff.  The 
emission factor 0.0128 grams/mile is taken from U.S. EPA, 1985c. 

The tire wear emission factor is calculated using the following equation: 

EFTIREV = 0.002 * PSTIRE * IVEHWLV 

(4-93) 

where: 

v is a selected vehicle class 
EFTIREv is the tire wear emission factor 
0.002 is the emission rate of airborne particulate matter from tire wear for light-duty 

vehicles (U.S. EPA, 1985) 

PS TIRE is the fraction of particles less than or equal to the particle size cutoff 
IVEHWLv is the average number of wheels on a vehicle of a given class, where 

LDGV=4, LDGTl,2=4, HDGV=6, MC=2, LDDV=4, LDDT=4, 2BHDDV=4, 
LHDDV=6, MHDDV=6,HHDDV=l8, BUSES=4 

Re-entrained Dust from Paved Roads 

The PM10  emission factor for paved roads is estimated similarly to that for unpaved roads.  The 
VMT data for paved roads may be developed following the procedures described in U.S. EPA, 
1998.  The equation used to estimated paved road re-entrained dust emission factors again is 
based on ambient measurements, and tailpipe, brake wear, and tire wear emission factors must be 
subtracted prior to use of the paved road dust emission.factor.  The paved road emission factors 
are calculated by: 

PAVED= PSDPVD * (PVSILT/2.0)0

65  * (WEIGHT/3.0)u 

·

(4-94) 

where: 

PAVED is the fleet average paved road dust emission factor (grams/mile) 
PSDPVD is the base emission factor for the particle size cutoff (10 micrometers in 

MEPPS) 

PVSILT is the road surface silt loading (grams/square meter) (user input) 
WEIGHT  is the fleet average vehicle weight (input by the user in pounds) 

Application in MEPPS 

The PARTS model is a companion ofMobileSa in MEPPS.  When running MEPPS interactively 
through the Tools Manager, the user is prompted to specify input data and options under 
EMPRO, Mobile Source Model.  Standard lookup data files can be found in the Models-3 
directory structure at /home/models3/datasets/nostudies/partS/.  Default/example input data sets 
are included for the 199S calendar year.  When a study is created, the study input data are located 
at SEMS_HOME/project/$EMS_PROJECT/raw_data/$EMS_DOMAIN/commonl. 
If the user is processing mobile emission data using the Study Planner, it is necessary to ensure 
that the appropriate PARTS input data sets are in place first.  This may be accomplished when 
using MEPPS interactively to establish MEPPS directory structure prior to  running through Study 
Planner.  If the data are in place, Study Planner will automatically process them. 

When processing mobile particulate emission data, the input and output data of PARTS are 
assigned to and summed within each grid cell in the same fashion given in detail under the 
Gridding VMT discussion of the implementation of the Mobile Sa model (above). 

4.2.5  Chemical Speciation of Emission Data 

Chemical transport models, such as CMAQ, require that emission data be provided for either 
individual species or specific species groups or "lumped" species.  This is necessary so that the 
atmospheric chemistry of pollutants may be more accurately modeled.  However, an initial 
processing step is required because emission data are often reported for pollutants that are 
aggregates of many species, such as VOC.  These aggregate pollutants must be split into their 
component species, or "speciated". 

The speciation takes two forms, discrete and lumped-model. 

In discrete speciation, a pollutant is split into the individual components which comprise the 
pollutant.  For the organic pollutant TOG (total organic gas), the individual components which 
comprise the pollutant are dependent on a variety of factors including the process, fuel type, and 
device from which the emissions occurred.  For example, TOG from the exhaust of automobile 
may contain approximately fifty discrete organic compounds (benzene, methane, toluene, hexane, 
etc.), while TOG from degreasers may contain approximately seventy discrete organic 
compounds.  NOx (nitrogen oxides), which is related to combustion processes, is speciated 
(discrete) into NO and N02  (and sometimes HONO). 

The discrete components in an emission stream are determined by a number of methods including 
source testing, surrogate application, and engineering kno~ledge of the process.  Many sources 
have been inventoried and a compendium of species profiles has been assembled by the US EPA 
in the Air Emissions Species Manual (US EPA, 1988).  The Air Emissions Species Manual 
contains a list of TOG and particulate matter (PM) species profiles to which a substantial number 
of emission sources have been assigned.  A compendium of species profiles currently available is 
compiled in the US EPA Speciate database.  The database is available on the Air Chief CD ROM, 
which is updated annually (US EPA, 1997).  Each of the species profiles identifies the mass 
percent of the discrete compounds that comprise TOG and PM.  Note that NOx, SOx(sulfur 
oxides), and CO (carbon monoxide) do not have source-specific speciation profiles.  For all 
sources, NOx  is discretely speciated into NO and N02 (and sometimes HONO), and CO is 
treated explicitly.  The speciation processor currently assumes that NOx is speciated to 95 percent 
NO and 5 percent N02,  based on average observed values. 

The MEPPS EMPRO speciation processor  provides chemical speciation of hydrocarbons,  oxides 
of nitrogen, and sulfur oxides.  For example, aggregations of hydrocarbon species such as TOG 
are disaggregated to their component individual chemical species.  The processor speciates the 
spatially and temporally allocated emission estimates that are prepared by the emission estimation 
processors and models (e.g., point source processor, mobile emission model).  The speciation is 
accomplished using look-up tables of profiles containing source-category specific and specie(cid:173)
specific chemical split factors (percent of mass of source emissions attributable to each specie for 
a given source category).  The general components of emission speciation processing are 
illustrated in Figure 4-6. 
It is computationally prohibitive to model the chemistry of all discrete voe compounds in the 
emissions stream in photochemical grid models.  Therefore, individual organic species comprising 
Total Organic Gas are assigned to one or more model species (groups of species) according to the 
chemical mechanism that is being used.  Thus, instead of modeling with a larger number of 
discrete compounds, the discrete compounds are lumped into a much smaller number of 
mechanism species.  The rules for assigning the discrete compounds to the mechanism species are 
mechanism dependent and typically involve lumping in one of two ways:  1) lumping compounds 
with similar reactivity characteristics into a single mechanism species (the lumped molecule 
approach) or 2) assigning molecular fragments of an individual compound to one or more 
mechanism species on the basis of molecular structure (lumped structure approach).  In Models-3, 
the lumping of discrete compounds to form mechanism species is carried out using tables of split 
factors that assign the discrete compounds to mechanism species.  Currently, two mechanisms, the 
Regional Acid Deposition Model 2.0 (RADM2) and Carbon Bond 4 (CB-4) are available in 
Models-3.  The user may also define  lumping procedures for an alternative mechanism ifthe 
assignment methods for that mechanism are known, or the user may create a modified version of 
the lumping procedure for one of the two mechanisms in Models-3. 

In the eB-4 mechanism, discrete compounds are assigned to mechanism species on the basis of 
the compound's carbon bond structure (Gery et al.,1989).  For instance, single carbon-carbon 
hydrocarbon bonds are assigned to a paraffin group (PAR), and carbon-carbon double bonds are 
assigned to an olefinic group (OLE).  Thus, an individual discrete voe could be dis-aggregated 
into more than one mechanism species depending on its structure.  Descriptions of the eB-4 
mechanism species are given in Table 4-8. 

The RADM2 mechanism lumps discrete compounds on the basis of their prevalence in the 
atmosphere, common reactivity, and/or molecular weight (Stockwell et al., 1990).  For RADM2, 
individual voe compounds are first assigned to one of 32 lumped groups.  The 32 lumped 
groups are then further reduced to  15 groups for increased computational efficiency.  The 
relationship between the 32 and 15 lumped groups is shown in Table 4-9.  The EMPRO does not 
include chemical or size fractionation of particulate matter, although size fractionation of 
particulate matter is planned in the future. 

Point 
Source 
Data 

Area 
Source 
Data 

Mobile 
Source 
Data 

Biogenic 
Source 
:Data 

Application of Speciation Split Factors 
o Chemical Mechanism Dependent 

(e .. g~ NOx~ SOx) 

(e.g.~ RADM2~ CB4) 

o ROG- to TOG- Adjustment 
o Non-VOC Split Factors 

, 

Output Processor 

Figure 4-6  General Components of Emission Speciation Processing 

Table 4-8.  Carbon Bond-4 Lumped Species 

CB4 Lumped Species 

Number 

CB4 Lu~d~sp.7:i; ;:.  ... 

1.; 
I·•·. 
·.·· .. 

.·  ·•· .·.. 
. . 
.·  .. :  .... ·.· / 

" /  •· 

Lum.,., 

. ... 

·.·.·····  ·~c .. 
'"  . . • Df f }'.'.~!tJ~s:i!;:)·. · 

.r 

.... 

•·•···  \  ... .<.: ........... ·. 

.:·:::. 

.:.;:\i;:;;t.i 
· 
. ···•· 
)'/.::;;;: 

1 

2 

3 

4 

5 

6 

7 

8 

9 

10 

11 

12 

13 

14 

15 

16 

OLE 

PAR 

TOL 

XYL 

FORM 

ALD2 

ETH 

MEOH 

ETOH 

ISOP 

NR 

NO 

N02 
co 

S02 

AERO 

Olefinic carbon bond (C=C) 

Paraffin carbon bond (C-C) 

. 

Toluene (C6H5-CH3) 

Xylene (C6H4-(CH3)2) 

Formaldehyde (CH2=0) 

High MW aldehydes (RCHO, R>H) 

Ethene (CH2=CH2) 

Methanol (CH30H) 

Ethanol (C2H50H) 

Isoprene 

Non Reactives as methane 

Nitric Oxide 

Nitrogen Dioxide 

Carbon Monoxide 

Sulfur Dioxide 

Aerosols (PM) 

4-82 

Table 4-9.  RADM 2.0 Lumped Species Descriptions 

EPJ\/600/R-991030 

.. ·•.•.·,·.•.z,'_.,· ..• ,o, .3.'2i ·•·  R.Ab-Miid .16. 

•. RA: 
.• : ... ·.·,•.·,b_.··••.M 
. ::A1f8¢iiiQiiC .,. 
•••.-.:?wni>¢.ct: ··>  ,~ti1ni>e4§p~¢1~s.Y  }  F.abt0f'·•:. 
·  · 
..•..• ,, •..•.. '.•,.: •. _.·,.· .. 00_•·,·_,.'~,-·.•.~.e.o_ 
> : §p:cws .·:·:.: ..•. ··•••  .••. > :,  : < •.. /_ ...••. _,_/.,' ... •·.•.•.••.•.•• ... •.-,•.•·, ... ·.,•, .• -,., .• 
·_:·,•·.•·., .• ·.•·.•.••.·.••·,r_fhi 

· · .... 

•.•.. i,'.,•·.9.•.•••',.r .• _; 

•..• ,_ .• )•·.n, 

1 

'·.•··. 
·::.  !.: 

""p·'":···.L·ec·.· 

.;:.;Ei;u; ··.  ,;;;:;~L::  , •. ,:· 11eseri~ti~··,···ofthe s2·1:i ·~oil,,i·•::·:.·., 
· ..•. '.',,·.:.,'.·C.2/\:zY'· .. q.~~:~J.  t 
<  ......  ,, 
.• '.':','g'.'.·.·,·.· •. ·.·.,•.',.t··,.·.•.,,'o·_·_·,· 
.. ·.,, ... ·_· •. ·.•.· .. ,·'_· 
,  .:  ':I; 

.. _'.·.~.-.. ~.··_·"'P 
.. ·.·.·.u·.·1~.bl'.e'·'.·.·s·.·.·.P 
"',,  _ 
.. ,· .. ·.'a.·.e·····de· 
, >  •.:.:::..-:·::::.:.-. 

:~~]tJoi_-'i,  ·,_.,, .. 
: 
(_.·  i' •?• , ·: 

/·•:·:::},_:.,:\  ................. : .. ::: .. :·:-.  :·.= .. ::: .. :.::::::  ................... ,.,., .. ,, .... ,, ....  ::;::::  :::::::{:::}:;::':::: .. . 

... ·.·.p'.·,·,··1._n 

.. 1·.~_.e'r''.·~·.'.·._u 
,,,,,,,  .... ,,~ ...  ,,,,,, < 

.... · ..• •_·p•· .. ·,.·e.'·.· .. d·: ... '··l'•s·.
6

, . , .· .... ·.· 

•,·L'' 
.. '.,.'•u··.·.·_.'.m' 

... ·e·.ec'·.'.•.'.·G·.· 

2 

3 

4 

5 

6 

7 

8 

8 

9 

10 

II 

12 

13 

13 

14 

15 

16 

17 

18 

18 

19 

20 

21 

22 

CH4 

ETH 

HC3 

HC3 

HC5 

HC8 

HC8 

HC8 

XYL 

OL2 

OLT 

OLT 

OLI 

OLT 

OLI 

TOL 

TOL 

XYL 

CSL 

OLT 

TOL 

HCHO 

ALD 

KET 

KET 

I 

0.91 

0.09 

0.5 

0.5 

0.5 

0.5 

0.519 

0.964 

0.956 

0.945 

1.141 

I.IOI 

Methane 

Ethane 

Propane 

Alkanes (0.25-0.50) 

Alkanes (0.50-1.00) 

Alkanes (1.00-2.00) 

Alkanes (>2.00) 

Alkane/ Aromatic Mix 

Alkane/ Aromatic Mix 

Ethene 

Propene 

Alkenes (Primary) 

Alkenes (Internal) 

Alkenes (Prim/Int Mix) 

Alkenes (Prim/Int Mix) 

0.293 

Benzene/Halobenzenes 

Aromatics ( <2 react) 

Aromatics (>2 react) 

Phenols and Cresols 

Styrenes 

Styrenes 

Formaldehyde 

Higher Aldehydes 

Acetone 

Ketones 

0.253 

Table 4-9.  RADM 2.0 Lumped Species Descriptions 

RADM2.032 

Lumped 
Species 

23 

24 

25 

26 

27 

28 

29 

30 

31 

32 

LRAumDpeMd 82p.Oe .. c1
.·e·6
1

0

5< · ········~··· lFloa· ccat····
oner. 

... ·.ti~.· 0 
•..•• ).~.a·c··· t •  o. r · '  .·.  b~scriptiorr of the· 32 RAbM  · ·.····•· 
t.ir·.o. n .. · •. · .. <  · .. ··.·.··.·.R .. ~a~ti.•(···rvi.•·.a· 
Lumped Specie$ 13etC>re Groupillgto 
·. ···.•<••··i,L,··  ····•··•••··••16l:~umpedSp~C.i~~  • . )}  ..•... 
. ...... ·:: ...  :,::··  ········ 

(fractionof 

. 

. .· 

.• 

·. 

ORA2 

HC3 

HC3 

HC3 

HC3 

HC5 

HC8 

1 

1 

1 

0.343 

0.078 

0.404 

1.215 

1.075 

1.011 

Organic Acids 

Acetylene 

Haloalkenes 

Unreactive 

Others (<0.25 react) 

Others (0.25-0.5 react) 

Others (0.5-1.0 react) 

Others (> 1.00 react) 

Unidentified 

Unassigned 

In Models-3, the user initiates speciation by selecting the chemical mechanism to be used  for a 
study  in the Study Manager under the Models-3 framework, and within the MEPPS main 
window under Tools Manager.  The procedure is explained in detail in Chapter 6 of Models-3 
Volume 9B:  User Man~al. The speCiation processor is written primarily in SAS®; however, it 
includes some FORTRAN programs.  ARC/INFO®  is not used in the speciation processor. 

Speciation Processing in MEPPS 

In MEPPS, speciated gaseous emissions can be calculated in either of two units - moles/hour or 
Kg/hour. (Particle emissions are always calculated as Kg/hr.)  Emissions in moles are required by 
the Models-3 CMAQ, but some analyses require that emissions be expressed in mass per unit 
time.  Emissions in mole and mass units are calculated using the following two generic equations: 

chemestij  = 'EP  'Em  hrimp  *  1000  *  rogtotogmp  *  factorjmp  I  divisorjmp 

(4-95) 

where: 

chemestij is the gridded emissions estimate for hour i and mechanism species j 

(moles/hour) 

hrimp is the gridded hourly emission estimate of pollutant p (NOx, SOx, CO, PM, 

NH3, or ROG) for houri and source category m (Kg /hr).  The factor of 1000 
is used to convert kilograms to grams. 

rogtotogmp  is· a ROG to TOG conversion factor (discussed below) 
factorjmp  is  a mole-based split factor to allocate total emissions of pollutant p from 

source category m to mechanism species j 

divisorjmp is a second conversion factor to allocate total emissions of pollutant p from 

source category m to mechanism species j 

and 

(4-96) 

where: 

estKgij is the gridded emissions estimate for houri and mechanism species j  (Kg/hour) 
hrimp is  the gridded hourly emission estimate of pollutant p (NOx, Sox, CO, PM, 

NH3, or ROG) for houri and source category m (Kg /hr) 

rogtotogmp is a ROG to TOG conversion factor (discussed below) 
xmassjmp is a mass-based split factor to allocate total emissions of pollutant p from 

source category m to mechanism species j 

These equations show that emissions for mechanism species are computed by summing the 
contributions of pollutants from the different source categories that emit that pollutant. As 
indicated previously, the assignment of a pollutant to a specific mechanism species usually 
mechanism dependent, although some assignments may be handled  the same way in different 
mechanisms.  In Equations 4-95 and 4-96, the terms factorjmp•  divisorjmp• and xmassjmp are 
mechanism specific apportioning factors that will be defined further below.  Note that, in some 
cases a pollutant will contribute to only one mechanism species, but in other cases a pollutant will 
contribute to more than on species.  For example, emissiollls of ammonia are always assigned to a 
model species named NH3, but NOx is allocated between 1wo mechanism species NO and N02. 
The details of the allocation procedure for both the RADM2 and CB4 mechanisms will be 
described further below.  First, however, the derivation and use of the rogtotogmp  conversion  . 
factor is described. 

ROG-to-TOG Adjustment 

The ROG (Reactive organic gas) to TOG conversion portion of the speciation process is 
selected when the emission inventory is loaded by INPRO (see section 4.2.2).  VOC substances 
deemed non-reactive (e.g., methane and ethane) are often excluded from inventories, and some 
emission measurement techniques do not capture all discre1te compounds in an emission stream 
( e.g, formaldehyde).  The ROG-to-TOG adjustment factor is used to account for those missing 
components.  It is calculated using Equations 4-97 and 4-98: 

(4-97) 

rogtotogm  = 1.0  I  rnistogm 

(4-98) 

where: 

mistogi is the sum of mass fractions of the discrete voe compounds deemed non(cid:173)

reactive or not included in an emission inventory for source category m (grams 
of missing compound per gram of TOG) 

ntsrdk,m is the mass fraction of the missing or non-reactive compound k in the 

emission stream for source category m 

rogtotogm is the ROG to TOG conversion factor 

Note that the rogtotogm,p adjustment factor applies only to anthropogenic emissions ofVOC, and 
thus the p subscript used in Equation 4-95 and 4-96 has been dropped here.  In equations 4-95 
and 4-96,  rogtotogm,p is set to  1.0 for all pollutants other than ROG and also set to  1.0 when 
voe emissions ofbiogenic origin are being computed. 

Carbon Bond 4 (CB4) Speciation Factors 

The CB-4 chemical mechanism is widely used in air quality model simulations of ozone 
concentrations at urban and regional spatial scales.  As described in the introductory part of this 
section, the basis of the CB-4 mechanism is that reactivity of organic compounds in the 
atmosphere can reasonably be simulated by mechanism species that represent different carbon 
bond types. A detailed description of the CB-4 mechanism is contained in Section 8.2.1.  The 
focus of the discussion here is on how the CB-4 apportioning factors used fin  Equations 4-95 and 
4-96 are calculated.  Since speciation of anthropogenic VOC emissions is done differently than for 
other pollutants, the discussion is divided into two subsections. 

Anthropogenic VOC speciation.  For the CB4 mechanism, the apportioning factor  divisorjmp in 
equation 4-95 is set to 1.0 for all anthropogenic VOC emission calculations(i.e., it is essentially 
not used).  The  factorjmp term for anthropogenic voe is set equal to a split factor term sjl  that is 
computed for a specified VOC emission profile l, which in turn is assigned to a source category m 
(i.e., an SCC or ASC). The split factor for each profile and mechanism species is computed as 
follows: 

sfJ. 1  =  Ek  xmfk 1 I  mwk  * xnum. k 

J, 

, 

, 

(4-99) 

where: 

s~.1  is a molar split factor for CB4 species j  and  VOC profile 1 (moles of CB4 

species/gram of TOG) 

xmfk,I  is a mass fraction Of discrete VOC compound kin VOC profile 1 (grams Of 

mwk 

discrete VOC/grams of TOG) 
is the molecular weight of discrete voe compound k (grams of discrete 
VOC/mole of discrete VOC) 

xnumj,k is the moles of discrete VOC compound k assigned to CB4 species j  (moles of 

CB4 species/mole of discrete VOC) 

In Equation 4-96, the  xmassjmp term apportions mass emissions to CB4 species for a given 
pollutant and  source category.  Analogous to the CB4 molar split factor defined above, the 
xmassjmp term is set equal to a mass split factor that appmtions the mass of a discrete VOC 
compound according to the fraction of carbon atoms that is assigned to a mechanism species: 

where: 

xmassj,l is the  mass_ split factor for CB4 species j  and VOC profile 1 (moles of CB4 

(4-100) 

species/gram of TOG) 

xmfk,I  is the mass fraction of discrete voe compound kin voe profile 1 (grams of 

discrete VOC/grams of TOG) 

cnj is the  number of carbon atoms in CB4 species j 
cnk is the number of carbon atoms in discrete voe compound k 

Again, one VOC profile is assigned to each source category, and thus split factors are generated 
for each source category/mechanism species combination. 

Other speciation.  For pollutants and source categories other than anthropogenic VOC, the terms 
factorjmp•  divisorjmp• and xmassjmp are simply assigned numeric values that determine the allocation 
of pollutant emissions.  These are summarized in Table 4-10. 

For all pollutants (except particles) in Table 4-10, the divisor  corresponds to the molecular 
weight of the pollutant and is used in equation 4-76 to convert mass emissions of the pollutant to 
moles of pollutant.  The two split factors factorjmp•  and xmassjmp are used to apportion the 
pollutant emissions to the mechanism species.  A factor of 1.0 indicates a  1: 1 correspondence. 
Factors different from one indicate a disaggregation or lumping of pollutant emissions into 
individual species. 

CO and NH3 are treated explicitly in many air quality models, and therefore emissions of these 
compounds are not split into other components.  Similarly, particle emissions are treated explicitly 
so no lumping or dis-aggregation is necessary for them either. 

When SOx emissions are speciated, 97% of the SOx mass is treated as S02.  The remaining 3% 
of the SOx mass corresponds to 804 (or SULF), but is dropped from further consideration.  S02 
and S04 emissions are treated as explicit species. 

Table 4-10.  CB4 Split Factors for Pollutants Other Than Anthropogenic VOC 

.... '" • .:-.,.~·'·'.·:;;::.:;~:~~:.;;::i~~;:(~:~:=::.::::;;~: 

'"·~~~~·: .-~"~:.·;~;:_::?~:~~~~~~~~rf:r~~~~~: ii[l~ll;~tll~~l;~; :;;;;;:;;;;:;;,£1il:'::::t 
::!:§Ufc~ G!¥.8#bi:07 

All 

All 

All 

All 

All 

All except BIO 

All except BIO 

All 

All 

All 

BIO 

BIO 

BIO 

BIO 

BIO 

BIO 

BIO 

BIO 

BIO 

co 

NH3 

AERO 

PMlO 

PM2  5 

NOX 

NOX 

802 

SOX 

804 

NO 

lsoprene 
ovoc 
ovoc 
ovoc 
TERP 

TERP 

TERP 

TERP 

co 

NH3 

AERO 

PMlO 

PM2  5 

-

NO 

N02 

802 

802 

SULF 

NO 

ISOP 

NR 

OLE 

PAR 

ALD2 

OLE 

PAR 

TERPB 

1.0 

1.0 

1.0 

1.0 

1.0 

0.62 

0.05 

1.0 

0.97 

1.0 

1.0 

1.0 

0.5 

0.5 

8.0 

1.5 

0.5 

6.0 

1.0 

28.0 

17.0 

1.0 

1.0 

1.0 

30.0 

46.0 

64.0 

64.0 

96.0 

30.0 

68.12 

148.0 

148.0 

148.0 

136.23 

136.23 

136.23 

136.23 

1.0 

1.0 

1.0 

1.0 

1.0 

0.62 

0.05 

1.0 

0.97 

1.0 

1.0 

1.0 

0.05 

0.10 

0.85 

0.3 

0.1 

0.6 

1.0 

In MEPPS, it is assumed that NOx is composed of95% NO and 5% N02 (by mass).  However, 
actual NOX composition can vary from 89%/11 % to 95%/5%.  In a few cases, a small percentage 
(<2%) ofNOX emissions is assumed to be nitrous acid (HONO).  Since NOx emissions are 
typically reported as N02 mass, it is necessary to normalize the NOx emissions by the molecular 
weight of N02.  Hence, the molar split factors (factorjmp) for NO and N02 are calculated as 
follows: 

(4-101) 

(4-102) 

With a NOx composition of 95% NO (as N02) and 5% N02 by mass, the split factors for NO 
and N02 become 0.62 and 0.05, respectively.  The mass split factors are calculated in the same 
manner, and thus have the same values as for the molar split factors. 

The speciation of biogenic emissions in CB4 is the same as used in the Regional Oxidant Model 
(EPA,  1989).  Isoprene is treated as an explicit species and terpene emissions are speciated into 
1.0 mole of OLE, 6.0 moles of PAR, and 3.0 moles of ALD2.  Terpenes are also assigned to the 
model species TERPB for special processing in the aerosol module of the CMAQ.  The apparent 
double counting ofterpene emissions is accounted for in the CMAQ processing however.  Finally, 
the category OVOC (other VOCs from biogenic sources) is apportioned to  1.0 mole of OLE, 8.5 
moles of PAR, and 0.5 mole ofNR.  Here it assumed that number of carbon atoms in a OVOC 
molecule is  10. 

RADM2 Speciation Factors 

The RADM2 chemical mechanism was developed for and has been used principally in regional air 
quality simulations of sulfur dioxide (S02) and oxides of nitrogen for ~cid rain assessment 
(Walters and Saegar, 1990).  A detailed description of the RADM2 mechanism is given in section 
8.2.2.  The speciation procedure used for RADM2 is fully described in Walters and Saeger 
(1990), and will only be summarized here.  This section focuses on how the RADM2 apportioning 
factors used in Equations 4-95 and 4-96 are calculated. Again, the discussion is divided into two 
subsections, one dealing with the speciation of anthropogenic voe emissions and one with all 
other speciation. 

Anthropogenic VOC speciation. The RADM2 mechanism requires that discrete organic VOC 
compounds be lumped into  15 mechanism species based on common reactivity and reaction 
products.  As with the CB4 mechanism, the apportioning factor  divisorjmp in Equation 4-95 is set 
to 1.0 for all anthropogenic VOC emission calculations, and thus is not used.  Also as with the 
CB4 mechanism, The factorjmp term for anthropogenic VOC is set equal to a split factor term sj1 
that is computed for a specified VOC emission profile 1,  which in turn is assigned to a source 
category m (i.e., an SCC or ASC).  However, the RADM2 split factors are calculated using the 
following equation: 

sf. 1  = :Ek  xmfk 1  * afac. k  * rfacJ. k  I  mw k 

J, 

, 

J, 

, 

(4-103) 

where: 

s~,I is the molar split factor for RADM2 species j  and  voe profile 1 (moles of 

RADM2 species/gram of TOG) 

4-89 

xmfk,l is the  mass fraction of discrete voe compound kin voe profile 1 (grams of 

discrete voe/grams of TOG) 

afacj,k is the allocation factor listed iri' Table 4-6 for RADM2 species j  and discrete 

voe compound k 

rfacj,k is the  reactivity factor listed in Table 4-6 for RADM2 species j  and discrete 

voe compound k 

. 

mwk is the molecular weight of discrete voe compound k (grams of discrete 

voe/mole of discrete voe) 

In the RADM2 speciation process, each discrete Voe compound is assigned to one of the 32 
lumped species categories, and that assignment is used to further lumped to one of the 15  species 
in the condensed group.  See Middleton et al. (1990) for information on how the allocation and 
reactivity factors are derived. 

In Equation 4-96, the term  xmassjmp apportions mass emissions to RADM2 species for a given 
pollutant and  source category.  Analogous to the RADM2 molar split factor defined above, the 
term xmassjmp is set equal to a mass split factor that apportions the mass of a discrete voe 
compound according to the mass fraction of the discrete voe compoiind in the emission stream 
and the mechanism specific allocation factor:  · 

(4-104) 

where: 

xmassj,l is the mass split factor for RADM2 species j  and and VOe profile 1 (moles of 

eB4 species/gram of TOG) 

xnifk,l is the mass fraction of discre~e voe compound kin voe profile l (grams of 

discrete voe/grams of TOG) 

afacj,k is the allocation factor listed in Table 4-6 for RADM2 species j  and discrete 

voe compound k 

Other speciation.  For pollutants and source categories other than anthropogenic voe, the terms 
factorjmp•  divisorjmp•  and xmassjmp are simply assigned numeric variables that control the allocation 
of emissions, similar to what is done for the eB4 mechanism.  The factors for RADM2  are 
summarized in Table 4-11. 

Except for the biogenic categories, the contents of Table 4-11  are identical to those in Table 4-10 
for the eB4 mechanism.  Thus, the reader is referred to the corresponding CB4 section for 
information on those source category/pollutant combinations.  The biogenic portions of the two 
tables are similar in that isoprene is treated as an explicit species in RADM2, and terpenes and 
other voes (OVOe) of biogenic origin are apportioned to mechanism species.  In RADM2, 
terpenes are apportioned entirely to OLI (Middleton et al.,  1990).  As with the eB4 mechanism 
,terpenes are also assigned to the model species TERPB for special processing in the aerosol 
module of the eMAQ, but the apparent double counting ofterpene ~missions is accounted for in 
the eMAQ processing however.  Finally, the assignment of other Vbe species to RADM2 
species is carried out in a manner analogous to that for CB4:  85% is ~ssumed to correspond to 
slow reacting alkanes, 15% to fast reacting olefins, and 5% is assumed to be non-reactive.  Thus, 
in RADM2 85% of the OVOe mass is assigned to the category containing the slowest reacting 
alkanes (category 27 in Table 4-6).  The split factor is obtained :by multiplying the mass fraction 
(.85) by the reactivity factor (0.404) to give a molar split factor of 0.343.  The 10% of the mass of 
OVOe assumed to be reactive olefins is assigned to the OLI category.  Both the mass and molar 
split factors for this compound are simply 0.1. 

lit Factors for Pollutants Other'fhan Anthro  ogenic VOe 

All 

All 

All 

All 

All 

All except BIO 

All except BIO 

All 

All 

All 

BIO 

BIO 

BIO 

BIO 

BIO 

BIO 

co 
NH3 

AERO 

PMIO 

co 
NH3 

AERO 

PMIO 

PM2  5 

PM2  5 

NOX 

NOX 

S02 

SOX 

S04 

NO 

lsoprene 
ovoc 
ovoc 
TERP 

NO 

N02 

S02 

S02 

SULF 

NO 

ISO 

HC3 

OLI 

OLI 

TERP 

TERPB 

l.O 

1.0 

1.0 

1.0 

1.0 

0.62 

0.05 

1.0 

0.97 

1.0 

1.0 

1.0 

0.343 

0.1 

1.0 

1.0 

28.0 

17.0 

1.0 

1.0 

1.0 

30.0 

46.0 

64.0 

64.0 

96.0 

30.0 

68.12 

148.0 

148.0 

136.23 

136.23 

1.0 

1.0 

1.0 

1.0 

1.0 

0.62 

0.05 

1.0 

0.97 

1.0 

1.0 

1.0 

0.85 

0.1 

1.0 

1.0 

4.2.6  Output Processor (OUTPRO) 

The results ofMEPPS processing must be in a form that is useful to the Models-3 framework and 
readily evaluated for the substantive content and quality of the data.  The OUTPRO proce~ses 
spatially and temporally allocated, speciated emission data files to prepare them for use by the 

Models-3 framework and its components, including CMAQ.  In addition, OUTPRO prepares 
many standard and user-defined emission summary reports.  The processing includes the following 
items: 

• 

• 

• 

• 

• 

• 

Merging of temporally allocated point, area, biogenic, and mobile source emission data 
files. 

Merging of speciated point, area, biogenic, and mobile source emission data files . 

Merging of point, area, biogenic, and mobile source files into a consolidated two(cid:173)
dimensional emission file.  Merging is optional; and data type files may be maintained and 
output separately. 

Preparation of three-dimensional point source emission files for use by the plume rise and 
Plume-in-Grid models available in CMAQ.  The user may define groups of similar stacks 
by specifying percentage tolerance differences in different physical stack properties.  In 
addition, the user may categorize minor, major, and major elevated point source emission 
(MEPSE) stacks by their emission rates and/or stack properties.  The classification 
criteria are not pre-specified, but are set by the user.  Specifically, any combination of 
emissions of specified pollutants in tons/day and/or physical stack parameters including 
height, diameter, flow rate, or exhaust velocity may be used to define a major or MEPSE 
point source.  Generally, MEPSE stacks are the largest of point sources, such as electric 
utility stacks.  Major point sources are usually somewhat smaller, but significant point 
sources.  Source-specific information is necessary to classify MEPSE or major point 
sources.  Smaller sources not classified as MEPSE or major point sources or without 
source-specific information are referred to as minor point sources, and are usually 
included with the surface area sources by OUTPRO, unless specifa:d otherwise by the 
user. 

Conversion of output file format to  NetCDF I/O API format.  This allows other 
components of the Models-3 framework,  including the CMAQ and. visualization tools, to 
use the emission files.  The CMAQ accepts the emission files and processes them for input 
to CMAQ using the Emission Chemical Input Processor (ECIP).  The ECIP is described in 
Section 7. 

Preparation of summary reports of the processed emission files, including summaries by 
primary emission type (point, area, biogenic, mobile), by geographic area (grid area, grid 
cell, state, county, etc.), by source category code and groups of codes (tiers, or 
combinations of these items. In addition, the reports rank emission values by amount, type, 
geographic area, etc. 

4.3  Models-3 Emission Projection Processor (MEPRO) 

It is often necessary to iteratively project emissions and emission control combinations to future 
years in order to model future year ambient pollutant concentrations relative to regulatory 
standards.  Consequently the Models-3 system includes a projection and control system, the 
Models-3 Emission Projection (MEPRO) processor to perform the necessary work.  The MEPRO 
was developed from the Multiple Projection System (MPS).  The MPS was originally designed as 
a stand-alone software tool to assist the EPA in projecting and tracking the "reasonable further 
progress" of regulatory emission reduction programs for criteria pollutants (Monroe et al.,  1994). 
It may be invoked from Strategy Manager from the Moclels-3  framework or run separately. 
Because MPS was designed as a PC application using the Superbase® programming language, 
MEPRO must be run under an emulator (SoftWindows®) ifit used in an UNIX operating system. 
Currently, MEPRO is more efficiently run on a PC workstation with a Windows NT® operating 
system.  Figure 4-7 illustrates the relationship ofMEPRO with the rest ofMEPPS. 

Using MEPRO, the user may edit regulatory control factors, control efficiency, rule penetration, 
rule effectiveness,  as well as "across-the-board" emission adjustments and source 9ategory code(cid:173)
specific emission projections .  Projected emission inventory data, and/or inventory data with 
revised emission controls and efficiencies are passed to EMPRO (in the 
!raw_ data/$EMS _DOMAIN!common/ directory) for processing to the NetCDF I/O API format 
required for air quality modeling by CMAQ.  Mobile source emissions are not projected in 
MEPRO. Instead, VMT is projected, and the projected mobile sources emissions are computed in 
the mobile source model ofEMPRO. 

The MEPRO will project emissions ofNOx, VOC, and CO for each year from  1991  through 
2010, using the 1990 EPA inventory for the base year.  The capability to project S02 and PM 
emission data may be provided in the future.  Projections are by source category code of 
emissions for any area in the United States.  The base year and the annual projection factors will 
be updated as new data become available.  The annual growth factors for voe, NOX,  and co are 
taken from look-up tables containing economic growth factors by county for the United States. 
The growth  factors are based on economic  forecasts applied to specific source category codes 
by the Economic Growth Analysis System (EGAS) (US  EPA,  1995a). 

The EGAS system is a PC-based tool which uses a hierarchical three-tiered approach to generate 
growth factors.  Tier 1 is the National Economic Tier.  It includes an economic  model by 
Regional Economic Models, Inc (REM!) (Treyz et al.,  1994) which is primarily based on the 
Bureau of Labor Statistics (BLS) American Workforce  J.992-2005 projections.  After 2005, the 
BLS moderate growth labor force participation rates and the Census Bureau's middle population 
projections for the United States are used to forecast the labor force.  The second tier is the 
Regional Economic Tier, the results of which are overlain on the Tier 1 results.  The Regional 
Economic Tier contains separate economic models developed by REMI for each non-attainment 
area and attainment area of each state.  The largest area addressed by one model is a state.  The 
third tier is the Growth Factor Tier, which contains commercial, residential, industrial, and electric 
utility models, and a VMT growth module.  The commercial, residential, and industrial energy 
models were developed by the Argonne National Laboratory and were used in the National Acid 
Precipitation Assessment Program (Boyd et al., 1990).  Electrical Utilities projection was 
accomplished using the Neural Network Electric Utility Model (EUMOD).  The default economic 
projection tables from EGAS are based on U.S. Bureau of Labor Statistics forecasts.  Projection 
factor tables based on forecasts by the Wharton School of Economics are provided as an option. 

Unprocessed emission 

invent 

da1a 

MEPR 0  Output Files  ) 

Gridded, temporally 
1....e1:-----t allomted, speciated 
emission data files 

Figure 4-7 MEPRO Relationship to Other MEPPS Components 

The method of applying regulatory and growth projection factors to point and area source 
emission data to obtain future year daily controlled emission data is summarized by Equation 4-
105.  Because MEPRO projects only the VMT data for mobile source emissions, the projection 
method is slightly different (Equation 4-106).  The projected VMT data arc~ passed to the 
EMPRO mobile-source emission model to be converted into projection mobile source emission 
data. 

PCONE = DCONE * PGF * (1  + AF/100) * 

[1-(PCE *PRE* PRP)]/[1-(CE *RE* RP)] 

(4-105) 

where: 

PCONE is the point or area source future-year daily controlled emissions 
DCONE is the base year daily-controlled emissions 
PGF is the projected year growth factor (percent) 
AF is the projected year emission adjustment factor (percent) 
PCE is the projected year control efficiency 
PRE is the projected year rule effectiveness 
PRP is the projected year rule penetration 
CE is the (adjusted) base year control efficiency 
RE is the (adjusted) base year rule effectiveness 
RP is the (adjusted) base year rule penetration 

For mobile source data: 

FPE = BVMT * EF * PGF * (1  + AF/100) 

(4-106) 

where: 

FPE is the future projected emissions (on-road mobile) 
BVMT is the base VMT by vehicle class by facility class by year 
EF is the emission factor 
PGF is the projected year growth factor 
AF is the projected year emission adjustment factor 

Additional details for EGAS and MPS are given the references cited above. 

4.4 

Emission Processing Interface 

An accurate characterization of the spatial and temporal variability of emissions at the surface and 
aloft is vital for realistic air quality grid modeling.  The ivIBPPS creates separate emission files for 
surface area and elevated point sources for a particular domain and time period to be modeled. 
Consequently, an interface processor program was needed to efficiently consolidate these various 
emissions types into a single, hourly gridded data file for use in grid model simulations. 

4.4.1  Overview of Key Features of ECIP 

The Emission-Chemistry· Interface Processor (ECIP) serves as the key link between the MEPPS 
system and the CMAQ Chemistry Transport Model (CCTM).  The primary function ofECIP is to 
generate an hourly 3-dimensional (3-D) emission data file for the CCTM from the individual  . 
emission file types produced by the MEPPS. 

The schematic diagram in Figure 4-8 shows the principal input files used to drive ECIP. 
The notable elevated point sources were likely separated into major and MEPSE (Major Elevated 
Point Source Emissions) source groups, based on a user-specified emission rate criterion during 
MEPPS processing.  The MEPSE group contains the largest point source emissions and is 
intended to be specially simulated by the CCTM Plume-in-Grid (PING) treatment.  However, the 
PING treatment is an optional capability of the CCTM and when it is not exercised, the MEPSE 
emission file must be processed by ECIP for the modeling scenario so that the significant 
emissions from these point sources are included in the 3-D emission data file with the other major 
point source emissions.  Thus, this capability to include or omit the MEPSE emissions in ECIP 
allows for CCTM runs to be performed without PING or with the PING tn:atment, respectively, 
while not requiring separate runs of the MEPPS emissions system.  A companion stack parameter 
file for each point source emission file is needed by ECIP for plume rise calculations.  In addition, 
meteorological data files generated by MCIP are also required to run ECIP in order to simulate 
point source plume processes.  The ECIP 3-D emission file displayed in Figure 4.6 contains the 
surface area anthropogenic and biogenic emissions, and the elevated emissions from major point 
sources and the MEPSEs, if appropriate.  The 3-D emissions output file from ECIP is ready for 
direct input into the CCTM. 

ARE 

A 

EM IS 

MEPSE 
PS EMIS 

(opt) 

MAJOR PS 

EMIS 

STACK 
PARMS 

MCIP 
MET 
DATA 

ECIP 

3-D EMIS 

CCTM 

Figure 4-8  Schematic Flow Diagram of the Input Files and 3-D Emission Data File for 

CCTM generated by ECIP 

A specific set of tasks is performed by ECIP for preparation of the 3-D emission file.  The 2-D 
gridded area emissions are incorporated into the first model layer since th(;:y represent near(cid:173)
surface releases.  In contrast, each elevated point source plume must be subjected to plume rise 
and initial vertical spread 'processes prior to the allocation of the plume emissions  into the proper 
grid cells.aloft.  Another capability ofECIP can be applied in case the CCTM domain is smaller 
than the emission domain.  ECIP can perform "spatial windowing" of the emissions needed for a 
particular CCTM domain from a larger MEPPS emissions domain. 

The methods used in ECIP to treat the processes impacting point source plumes are described in 
subsequent sections.  While these approaches employ existing scientific techniques, it is 
recognized that other formulations exist.  However, the modular design of the Models-3 coding 
structure allows for the implementation and application of alternative algorithms to treat a 
particular process. 

4.4.2  Plume Rise of Point Source Emissions 

The rise of a buoyant plume above stack height is strongly dependent upon the initial stack 
parameters and atmospheric vertical structure at the time of release.  A realistic determination of 
the height of final plume rise is important to incorporating the plume emissions into the proper 
vertical layer(s) of the model.  The initial buoyancy flux (Fh), which is a key parameter in plume 
rise formulas, is given by 

g(Ts -Ta) (Vsd 2) 
Fb  = - - - - - -

4Ts 

(4-107) 

where T5  and Ta  are the stack exit temperature and ambient temperature at stack top, 
respectively.  Other notable stack parameters in Equation 4-107 include the plume exit velocity 
(V5)  and stack diameter (d), while g is gravity.  Clearly, the magnitude of Fb is greatly influenced 
by these stack exit parameters.  For buoyant plumes, which exist for the vast majority of point 
sources, Fb  is greater than zero since Ts> Ta.  However, if Ts< Ta, then Fb is set to zero. 

The vertical profile of wind and temperature also greatly impact plume rise.  In particular, 
advances in the accuracy of plume rise estimates have resulted from taking into consideration the 
vertical variations in the thermal stability and wind structure which frequently display a strong 
height dependency in the atmosphere.  A key atmospheric stability parameter (s) used to 
distinguish the different stability regimes aloft is defined by 

S  = (g/Ta)(d8/dz) 

(4-108) 

where d8/dz is the vertical potential temperature gradient.  The value of s is employed as a 
criterion to apply the appropriate stability-dependent plume rise formula.  However, for the initial 
calculation of plume rise, the convective velocity scale (H.) is used as an indicator variable to 
identify the particular stability regime and it is defined by 

(4-109) 

where Ts  is the l .Sm air temperature, and wT is the surface heat flux covar:iance.  Unstable 
conditions are defined for H.  > 0.03H•min, while stable conditions exit when H. < -0.03H.min. 
Neutral conditions occur for the range of values between these criteria.  The default value of 
H•mln  has been set to 104  m2/s3

• 

The layer-by-layer approach described by Turner (1985), as originally suggested by Briggs 
(1975), has been applied in ECIP for the determination of final plume rise (Ah) based on the 
stability of each vertical layer.  This practical scheme takes advantage of the vertical resolution of 
the hourly, temperature and wind profiles and other 2-D meteorological parameters provided by 
the MMS dynamic mesoscale meteorological model outputs as postprocessed through MCIP. 
The method, as outlined by Turner (1985), is an iterative approach which computes plume rise 
through each layer.  An initial plume rise calculation is performed using meteorological variables 
derived at the stack top height with a stability-dependent plume rise formula at this level.  Two 
methods, linear interpolation or a surface similarity scheme by Byun (1990), are available for 
deriving temperature and wind at stack height from the modeled profile values.  For tall stacks, 
negligible differences were found in the derived values between these methods.  If the projected 
effective plume rise height Che = 1\ + Ah) exceeds the top of the layer containing the stack top, the 
amount of rise is limited to the height of the current layer top.  Then residual buoyancy flux (FJ 
is determined with an inverted form of the plume rise equation just applied.  Using FR, the 
procedure is repeated to determine the plume rise using the profile parameters for the next higher 
layer.  This method is applied over successive layers until the buoyancy flux is completely 
exhausted.  The plume rise ceases at the level where Fb = 0. 

A  set of analytical plume rise equations presented by Briggs (1984) for different atmospheric 
stabilities have been utilized in ECIP for all point sources.  The various plume rise equations are 
provided below.  The final effective plume centerline height Che)  is found by adding the computed 
plume rise (Ah) to 1\. 

4.4.2.1 

Plume Rise Treatment for Stable Conditions 

For stable atmospheric conditions, plume rise is taken from Briggs (1984) equation for bent-over 
plumes. 

113 

. 
[ F  ]
Ah  =  2.6  u: 

(4-110) 

where u is the wind speed for the layer.  Equation 4-88 is applied when H. < -0.03H. for the 
initial plume rise computation at the stack, and when s > 10·5  for subsequent layers in the current 
approach. 

4.4.2.2 

Plume Rise Treatment for Unstable Conditions 

The plume rise formula proposed by Briggs (1984) during unstable conditions is given by 

Ah  =  3[Fb/u]315H.-215 

(4-111) 

However, Briggs (1983) suggested a reasonable approximation for H.  which permits Equation 4-
111  to be applied in the following form. 

Ah  = 30 [F/u]315 

(4-112) 

The rationale for the simplification is due to the lack of data for evaluation to justify a more 
complicated form.  Equation 4-112 is applied with H.  > 0.03Hmin for the first plume rise 
computation at the stack and for higher layers for s < 10·5 

• 

4.4.2.3 

Plume Rise Treatment for Neutral Conditions 

.. , 

The neutral formula developed by Briggs (1984) plume rise equation has been modified into the 
following expression. 

Ah 

=  1.2[F/(uu.)]  [h5  + 1.3F/(uu.)] 

2  315 

'2  215 

(4-11~) 

where u.  is the surface friction velocity.  Equation 4'." 113 introduces minor differences from the 
other form.  Equation 4-113  is a more computationally efficient form suggested by Briggs (1983, 
communication) since his original neutral formula requires iteration to solve.  In the plume rise 
algorithm of ECIP,  the neutral plume rise equation is also solved during other stability conditions 
in the layers aloft.  A comparison between the two plume rise estimates is made and the lower 
value is selected before proceeding. 

4.4.2.4 

Special Conditions 

For the cases when Fb =  0,  plume rise can occur due to momentum provided by the exit velocity 
of the plume out of the stack.  Therefore, a momentum rise formula (Turner, 1985) has also been 
implemented to consider these situations and is given by 

Ahm  =  3d  v/u 

(4-114) 

If Equation 4-114 is selected, no further plume rise computations are performed. 

Another situation occurs when the stack is below the PBL height (zJ under unstable conditions 
and the condition Chs - zi)  < 200 m applies.  A treatment for limited plume penetration above the 
PBL  is determined when this situation is triggered.  This condition most often occurs during the 
morning period.  Since zi is generally growing rapidly, this period is generally brief.  To consider 
plume penetration of the overlying stable layer, a practical algorithm employed previously by 
Byun and Binkowski (1991) has been implemented based on Briggs (1984).  Ifh5  is less than 200 
m below Zj, then the following equation is solved. 

~ = 3.9[F/us] 113 

(4-115) 

If Zj  is greater than zb,  , then the plume top height (zj is set to zi  and he is defined to be 2/3Zi_. 
However, plume penetration is permitted when zi  < zb in Equation  4-115.  For this case, the 
plume top height is defined to be the height of the top of the next higher layer and the effective 
plume height is again computed as 2/3hi. 

4.4.3  Method for the Treatment of Initial Vertical Plume Spread 

Buoyancy-induced turbulence promotes plume expansion during the rise phase.  A widely-used 
method from Briggs (1975) designates the vertical thickness of a plume to be equivalent to the 
amount of plume rise.  With this method, the heights of the top and bottom  of the plume are 
determined by 

ht  =  h5  +  1.5.!lh 
hb  = h5 
- 0.5.!lh 

(4-116) 

where hi  and hb are the heights of the plume top and bottom, respectively.  Since the plume 
thickness is directly related to the amount of plume rise, this approach leads to rather thick plumes 
during the nocturnal period.  Experimental plume dimension data suggest more limited vertical 
thickness for plumes during the nighttime hours.  As an alternative,  an empirical form has also 
been included.  It is based on analyses of observed plume dimensions and vertical temperature 
gradients (Gillani, 1996 communication).  He found the best-fit empirical result is given by 

a  =  Ae (-BdT/dz) 
z 

(4-117) 

where the standard deviation of plume depth ( az ) is a function of the vertical temperature 
gradient (dT/dz) at he.  Values for A and Bare given by 10 and 117, respectively.  A minimum 
value specified for az is 3 m.  With this method,  hi  and hb are determined to be ±2. l 5az above 
and below I\ , respectively.  This approach provides for smaller plume thicknesses during the 
nocturnal period. 

4.4.4  Vertical Allocation of Plume Emissions 

Rather than dumping the entire emissions of a plume into a single layer, an approach has been 
developed to allow for the allocation of plume emissions into multiple layers since a plume can 
often span more than one layer.  This situation occurs often as more vertical layers are used in the 
model since model layers are thinner. 

· 

Once h1  and hh have been computed for each plume, these values, along with the heights of the 
model layer interfaces (Zz) are employed to determine the fractional amount of plume overlap 
across each layer.  The method uses the fractional amount of the plume depth residing within a 
layer in order to weight the amount of plume emissions incorporated into a particular layer.  If 
both hi  and hh  are contained within a particular layer, all the plume's emissions are allocated into 
one layer.  As noted above, the number oflayers receiving plume emissions is also dependent on 
the number of vertical layers in the model.  A model configuration with fewer vertical layers 
generally implies greater layer thicknesses .. 

4.4.5  Generation of 3-D Emissions 

Once the plume rise and plume partitioning functions have been performed, the emissions from 
each point source plume are transferred to the 3-D emission array which also contains the surface 
area emissions in the first layer.  The 3-D emission array is written at an hourly interval for the 
entire simulation period to a data file in a format compatible for use in CCTM simulations. 

4.5 

Data Requirements 

The following items are the data input requirements for operation ofMEPPS.  Those items that 
must be supplied by the user are marked (U).  Those items that are fixed internal lookup tables, 
provided with Models-3, or that may be generated in MEPPS are marked (I). 

• 

Complete annual (point, area, and mobile-source data by source category code) Regional, 
National, or international emission inventories are necessary for regional modeling.  The 
inventories preferably should be in the ASCII format of the EPA National Emission 
Trends (NET) inventories.  However, IDA allows import and conversion of any inventory 
with known fields formats in ASCII, SAS, or NetCDF format.  Currently, the 1985 
NAPAP, 1988 National Inventory, 1990 National Interim Inventory, and 1990 National 
Emission Trends (NET) inventories for criteria pollutants are included.  Limited data for 
southern Canada· are available as a part of these inventories (I).  Emission inventories for 
other areas, years, or pollutants must be supplied by the user (U). 

Existing hourly emission data, such as CEM data, may be used directly or substituted for 
hourly emission data derived by temporal disaggregation from annual emission inventories. 
The hourly data may be imported through the File Converter and IDA.  The Models-3 
system is includes 1995 CEM data in the SAS data set format provided by the US EPA 
Office of Acid Rain (I).  Other hourly data must be supplied by the user if desired (U). 

Hourly meteorological data for surface temperature and solar radiation, in  NetCDF  I/O 
API  format, (from MM5 processed via MCIP) must be available for modeling biogenic or 
mobile source emission data.  If data files for the appropriate case area available, the user 
may select them in MEPPS or when running Study Planner.  Otherwise, it is necessary to 
first run MM5 and output the meteorology files through MCIP (I). 

Chemical speciation profiles matched to source category codes are necessary for the 
speciation processor (I).  These may be updated with new information. 

Temporal allocation profiles, by source category code, must be available to accomplish 
temporal allocation of emission data to hourly emission data (I).  These may be updated 
with new information 

Geographic coverages for surrogate spatial allocation (gridding) of emission data.  The 
user may supply additional coverages:  Those supplied with MEPPS include (I): 

Political boundaries at the county level for North America 
Land-water boundaries and features for North America 
County-level population information for North 

America (with a gridded surrogate for Canada) 

Federal Highway Administration major highway 

coverage for the United States 

TIGER-LINE detail road coverage for the United 

States 

Land cover for North America.  Currently  is at 

county-scale for the United States and gridded 
at coarser resolution for Canada and Mexico. 
Land cover for the United States at one 
kilometer resolution is anticipated in 1999 

Species emission factors for biogenic emission modeling (I) 

Standard Mobile 5a model input information by political area (usually state and/or 
county), including vehicle fleet composition data, fuel type use by geographic area, 
inspection and maintenance program information, etc, (U).  A template with examples is 
provided for the user to edit. 

Road silt loading, geographic distribution of paved and unpaved roads, vehicle fleet 
composition data, fuel use data, and inspection and maintenance data are necessary as 
input to the PARTS mobile particulate model. 

Geographic, source category code-specific growth projection factors.  These are provided 
for use with MEPRO (I). 

Source category and/or geographically specific emission control data, and regulatory 
factors including control efficiency, rule effectiveness, and rule penetration for use in 
MEPRO.  These must be supplied by the user because controls are not standard, and in 
fact are a key variable in examining different emission scenarios (U). 

4.6 

Plans for Improvement 

Plans for improvement ofMEPPS may be divided into long and short-term improvements.  The 
short-term improvements are those that are anticipated to be in the Models-3 release scheduled 
for the summer of 1999. 

Short-term Improvements 

• 

• 

The IDA  will be improved to consolidate and further automate much of the quality 
control processing, format and unit conversion, and data file manipulation. In particular, 
format templates of internal formats will be added to assist  importing of emission data 
files into the system, and quality control for the CEM data will be enhanced. 

Although SAS® has proved to be a useful tool to date, increasing data handling 
requirements will likely overwhelm the data handling capabilities of SAS®.  Therefore, it is 
necessary to convert MEPPS to a fully Models-3 framework compliant system in order to 
take full advantage of the or object-oriented data base architecture of the system (eg., 
Orb ix®) to more efficiently manage very large amounts of data.  The use of the Sparse 
Matrix Operator Kernel Emission (SMOKE) system,  in conjunction with the Models-3 
object-oriented architecture and expansion of existing functionality should substantially 
improve performance because relatively inefficient processing sequences will not be 
necessary, and it will not be necessary to manipulate all elements of large files for each 
operation. More information about SMOKE can be found in Coats et al. (1995).  An 
initial (but not complete) version of SMOKE is planned for installation by summer 1999. 

Long-term Improvements 

New mobile source emission estimation models are being developed by the U.S. EPA 
Office of Mobile Sources.  They are scheduled for completion late summer of 1999. 
Mobile. 6 will replace Mobile Sa and Mobile Sb, and an Off-road Mobile Source Model 
will be intr.oduced.  These models will be installed in MEPPS when they are available and 
resources allow. 

The MEPPS contains the split factor assignments for two common chemical speciation 
mechanisms, CB-4 and RADM 2, that may be selected by users.  These speciation 
mechanisms will also be in SMOKE.  There are plans to also install the split factor 
information and computational mechanisms necessary to use for the Statewide Air 
Pollution Research Center (SAPRC) (Carter,  1988), and eventually, code necessary to 
support the more complex Morphecule mechanism being developed at the University of 
North Carolina. 

Additional quality control and reporting capabilities will be added to SMOKE, equaling or 
surpassing those capabilities in currently in MEPPS. 

The emission data processing system could be enhanced to support nested grid structures. 
Currently, there is only limited support for nested grid structures and no support for 
multiscale grid structures.  Under the current formulation, EMPRO (including the gridding 
processor) must be run consecutively for each grid structure that exists within the nested 
grid structure.  Repetitive runs are inefficient, and computer resour1~es are poorly utilized 
because certain areas in the modeling domain will be processed more than once.  In 
addition, the gridding processor cannot generate rotated grids, which may be a limitation 
for some applications.  If an air quality modeling study requires a rotated emission 
modeling grid, a knowledgeable ARC/INFO® user must prepare the~ grid independently 
from menu options provided in Model-3 and MEPPS. 

Tools such as NetCDF and the 1/0 API will evolve to directly accommodate geographic 
data references in their structure.  This will allow manipulation of geographic data 
(gridding, for example) to be accomplished without the use of non-conforming 
commercial software tools now in Models-3 system. 

4. 7 

References 

Alados, I., I.  Foyo-Moreno, and L. Alados-Arboledas, 1996: Photosynthetically Active 
Radiation: Measurements and Modeling, Agri.  and Forest Meteor., 78, pp.  121-131. 

Beck, L., L.A .. Bravo, B.L. Peer, M.L. Saeger, and Y.  Yan,  1994:  A Data Attributes Rating 
System, Presented at the International Conference on the Emission Inventory:  Applications and 
Improvement, Raleigh, NC., November 1-3, 1994, 12 pp. 

Boyd, G.A., E.C. Kokkelenberg, and M.H. Ross,  1990:·Sectoral Electricity and Fossil Fuel 
Demand in U.S. Manufacturing:.Developnient of the Industrial Regional Activity and Energy 
Demand (INRAD) Model; Argonne National Laboratory, Argonne, IL. 

Briggs, G.A., 1975: Plume Rise Predictions. In: Lectures on Air Pollution and Environmental 
Impact Analyses, Workshop, Proceedings, Boston, MA, 1975, pp 59-111. 

Briggs, G.A., 1983 communication: Plume rise equations used in EPA models.  Meteorology 
Division, Environmental Sciences Research Lab.; Research Triangle Park, NC. 

Briggs, G.A., 1984:. Plume Rise and Buoyancy Effects. In: Atmospheric Science and Power 
Production, D.R. Anderson, Ed., DOEITIC-27601  (DE84005177),Technical Information 
Center, U.S. DOE, Oak Ridge, TN, 850 pp. 

Byun, D.W., 1990: On the.Analytical Solutions of Flux-profile Relationships for the 
Atmospheric Surface Layer.  J.  of Appl. Meteorol., 29, No. 7, 652-657 

Byun, D.W. and F.S. Binkowski, 1991: Sensitivity ofRA.DM to Point Source Emissions 
Processing. Seventh AMS/A WMA Joint Conf. on Applications of Air Poll. Meteorol., New 
Orleans, LA, Jan.  14-18, 1991, Preprints, Amer. Meteorol. Soc., Boston, MA., 1991, pp. 70-73 . 

. :: 

Carter, W.P.L., 1988:  Documentation.for the SAPRC Atmospheric Photochemical Mechanism 
Preparation and Emissions Processing Programs for Implementation in Airshed Models, Prepared 
for the California Air Resources Board, Report AS-122-32. 

Coats, C.J., Jr.,  1995:  High Performance Algorithms in the Sparse Matrix Operator Kernel 
Emissions (SMOKE) Modeling System, Microelectronics Center of North Carolina, 
Environmental Systems Division, Research Triangle Park, NC,  6 pp. 

E.H. Pechan and Asso.ciates,  1994:  Industrial SO~ andNO,c Tracking System, EPA Contract No. 
68-Dl-0146, 38 pp. 

Emission Inventory Improvement Program (EIIP), 1996: Biogenic Sources Preferred Methods, 
Volume V, prepared for the EIIP Area Sources Committ<::e by the Radian Corporation, Research 
Triangle Park, NC, 104 pp. 

Fratt, D.B., D.F. Mudgett, and R.A. Walters, 1990: The 1985 NAPAP Emissions Inventory: 
Development of Temporal Allocation Factors, EP A-60017-89-01 Od,  U.S. Environmental 
Protection Agency, Office of Research and Development, Washington, D.C., 209 pp. 

Geron, C.D., A.B. Guenther, and T.E. Pierce,  1994: An Improved Model for Estimating 
Emissions of Volatile Organic Compounds from Forests in the Eastern United States, J.  Geophys. 
Res., 99, D6, pp.  12773-12791. 

Gery, M.W., G.Z. Whitt~n, J.P. Killus, and M.C. Dodge, M.C., 1989:  A Photochemical Kinetics 
Mechanism for Urban and Regional Scale Computer Models, J.  Geophys.  Res., 94, DlO, 12295-
12956. 

Gillani, N.V., 1996:  personal commUnication: Analyses results of plume data. 

Guenther, A.B., P. Zimmermann, and M.  Wildemuth, 1994: Natural Volatile Organic Compound 
Emission Rate Estimates for U.S. Woodland Laridscapes, Atmos.  Environ., 28, 1197-1210. 

Kinnee, E., C. Geron, and T. Pierce, 1997: United States Land Use Inventory for Estimating 
Ozone Precursor Emissions? Ecol.  Appl., 7, 46-58. 

Middleton, P., W.R. Stockwell, and W.P.L. Carter, 1990: Aggregation and. Analysis of Volatile 
Organic Compound Emissions for Regional Modeling, Atmos. Environ., 24A, pp.  1107-1133. 

Modica, L.G., D.R. Dulleba, R.A. Walters, and J.E. Langstaff, 1989:  Flexible Regional Emissions 
Data System (FREDS) Documentation for the 1985 NAP AP Emissions Inventory, EP A-60019-
89-047, U.S. Environmental Protection Agency, Research Triangle Park, NC, 574 pp. 

Monroe, C.C., T.A. Dean, and W.R. Barnard, 1994:  Multiple Projections System:  Version 1.0 
User's Manual, EPA-600/R-94-085, 70 pp. 

Moody, T., J.D. Winkler, T. Wilson, and S. Kersteter, 1995:  The Development and Improvement 
of Temporal Allocation Factor Files, EPA-600/R-95-004, 457 pp. 

Moran, M.D., M.T. Scholtz, C.F. Slama, A. Dorkalam, A. Taylor, N.S. Ting, D. Davies, C. 
Sobkowicz, P.A. Makar, and S.  Venkatesh,  1998: An Overview of CEPSl.O: Version 1.0 of the 
Canadian Emissions Processing System for Regional-Scale Air Quality Models, in the Proceedings 
of a Specialty Conference on Emission Inventory: Planning for the Future, Air and Waste 
Management Association, Pittsburgh, VIP-77, Volume I, 95-106. 

Morris R.E., M.A. Yocke, T.C. Myers and V. Mirabella, 1992:  Overview of the Variable-Grid 
Urban Airshed Model (UAM-V), Paper presented to the Air and Waste Mangement Association, 
85th Annual Meeting, Kansas City, MO, June 21-26,  1992,  13 pp. 

Ozone Transport Assessment Group,  1997:  Emission Inventory Development Report (Draft), 3 
Volumes. 

· 

Pierce, T.E., B.K. Lamb, and A.R. V anMeter, 1990: Development of a Biogenic Emissions 
Inventory System for Regional Scale Air Pollution Models,  Paper presented to the Air and 
Waste Management Association, 83rd Annual Meeting, Pittsburgh, PA, June 24-29, 1990, 16 pp. 

Pierce, T., C. Heron, L. Bender, R.  Dennis, G. Tennyson, and A.  Guenther, 1998: The Influence 
of Increased Isoprene Emissions on Regional Ozone Modeling, J.  Geo phys.  Res., in press. 

Saeger, M., J.  Langstaff, R.  Walters, L. Modica, D. Zimmerman, D. Pratt, D. Dulleba, R. Ryan, J. 
Demmy, W.  Tax., D. Sprague, D. Mudgett, and A.S. Werner,  1989:  The 1985 NAPAP 
Emissions Inventory (Version 2):  Development of the Annual Data and Modelers' Tapes, U.S. 
Environmental Protection Agency, Office of Research and Development, EPA-600/7-89-012a,' 
692 pp. 

Stockwell, W.R., P. Middleton, and J.S.  Chang, 1990: The Second Generation Regional Acid 
Deposition Model Chemical Mechanism for Regional Air Quality Modeling, J.  Geophys.  Res., 95 
(DlO), pp.  16,343-16367. 

Treyz, G. et al.:  1994: Model Documentation for the REMI EDFS-14 Forecasting and Simulation 
Model, Regional Economic Models, Inc., Amherst, MA. 

Turner, D.B.,  1985: Proposed Pragmatic Methods for Estimating Plume Rise and Plume 
Penetration through Atmospheric Layers. Atmos.  Environ., 19, 1215-1218. 

U.S. EPA, Office of Mobile Sources, 1985: Size Specific Total Particulate Emission Factors for 
Mobile Sources, EPA-46013-85-005, 294 pp. 

U.S. EPA, Office of Air Quality Planning and Standards, 1988:  Air Species Manual:  Volume 1, 
Volatile Organic Compound Species Profiles, EPA-450/2-88-003a, 492 pp. 

U.S. EPA, Office of Research and Development, 1989: Development of the Regional Oxidant 
Model Version 2.1, U.S.  EPA  Technical Report. 

U.S. EPA, Office of Mobile Sources, 1991:  User's Guide to MOBILE 4.1  (Mobile Source 
Emission Factor Model), EPA-AA-TEB-91-01, 354 pp. 

· 

U.S. EPA, Office of Air Quality Planning and Standards, 1992:  User's Guide forthe Urban 
Airshed Model, Volume IV:  User's Manual for the Emissions Preprocessor System 2.0, EPA-
450/4-90-007D(R), 497 pp. 

U.S. EPA, Office of Air Quality Planning and Standards,  J.993:  Regional Interim Emission 
Inventories 1987-1991), EPA-454/R-93-0212, 54 pp. 

U.S. EPA, Office of Air Qaulity Planning and Standards, 1994:  Emissions Inventory for the 
National Particulate Matter Study, Final Draft, Prepared by E.H. Pechan, Inc., EPA Contract No. 
68-D3005,  WA  No.  0-10, 83  pp. 

U.S. EPA, Office of Air Quality Planrung and Standards, 199S:  Compilation of Air Pollutant 
Emission Factors:  Volume II:  Mobile Solirces, AP-42, Fifth Edition, 2931)p.  · 

• 

• 

•  ) 

, 

• 

• t  • ' 

• 

' 

. 

• 

• 

• 

• 

• 

·, 

~. 

U.S. EPA, Office of Research and Development, 199Sa:  Econo,mic ~owth Analysis System: 
User's Guide Version 3.0, EPA-600/R-95-132b, 89 pp. 

U.S. EPA, Office of Mobile Sources, 199Sb: Draft User's Guide to PARTS: A Program for 
Calculating Particle Emissions from Motor Vehicles, EPA-AA-AQAB-94-2, 67 pp. 

U.S. EPA, Office of Mobile Sources, 1996:  User's Guide for MOBILE Sa (Mobile Source 
Emission Factor Model), EPA-AA-TEB-92-01,  176 pp. 

U.S. EPA, Office of Air Quality Planning and Standards, 1997: Air CHIEF, Version S (Compact 
Disk containing air quality speciation profiles, emission factors, and other ~~mission-related data), 
Research Triangle Park, NC. 

U.S. EPA, Office of Air Quality Planning and Standards, 1998: National Air Pollutant Emission 
Trends Procedures Document, 1900-1996 Projections 1999-2010,  EPA-454/R-98-008, 712 pp. 

U.S. EPA, Office of Research and Development,  199S:  Models-3:  Volume 7,  System 
Requirements (Draft) . 

U.S. EPA, Office of Research and Development, 199S:  Models-3:  System Design (Draft). 

Walters, R.A. and M.L. Saeger, 1990:  The 1985 NAP AP Emissions Inventory:  Development of 
Species Allocation Factors, EPA-60017-89-0JOJ, 470 pp. 

Wilkinson, J.G., C.F. Loomis, D.E. McNally, R.A. Emigh, and T.W. Tesche, 1994:  Technical 
Formulation Document:  SARMAP/LMOS Emissions Modeling System (EMS-95), Final Report, 
Lake Michigan Air Directors Consortium and the California Air Resources Board, AG-90/TS26 
and AG-90!TS27, 120 pp. 

Williams, E., A. Guenther, and F. Fehsenfeld, 1992: An Inventory of Nitric: Oxide Emissions from 
Soils in the United States, J.  Gaffes.  Res., 97, 7511-7519. 

Yienger, J.J. and  H. Levy II, 1995: Empirical Model of Global Soil-Biogenic Nox Emissions, J. 
Gaffes.  Res., 100, No. D6, 11447-11464. 


Chapter 5
================

FUNDAMENTALS OF ONE-ATMOSPHERE DYNAMICS 

FOR MULTISCALE AIR QUALITY MODELING 

Daewon W. Byun* 

Atmospheric Modeling Division 

National Exposure Research Laboratory 
U.S. Envitonmental Protection Agency 

Research Triangle Park, NC 27711 

ABSTRACT 

y 

This chapter provides essential information needed for the proper use of meteorological data in 
air quality modeling systems.  Sources of meteorological data are diverse and many difficulties 
can arise while linking these with air quality models.  To provide an integral view of atmospheric 
modeling, a robust and fully compressible governing set of equations for the atmosphere is 
introduced.  Limitations of several simplifying assumptions on atmospheric dynamics are 
presented.  Also, concepts of on-line and off-line coupling of meteorological and air quality 
models are discussed . 

. When the input meteorological data are recast with the proposed set of governing equations, 
chemical transport models can follow the dynamic and thermodynamic descriptions of the 
meteorological data closely.  In addition, this chapter introduces a procedure to conserve mixing 
ratio of trace species even in the case meteorological data. are not mass consistent.  In summary, 
it attempts to bridge the information gap between dynamic meteorologists and air quality 
modelers by highlighting the implication of using different meteorological coordinates and 
dynamic assumptions for air quality simulations. 

·On assignment from the National Oceanic and Atmospheric Administration, U.S. Department of Commerce. 
Corresponding author address: Daewon W. Byun, MD-80, Research Triangle Park, NC 27711. E-mail: 
bdx@hpcc.epa.gov 

FUNDAMENTALS FOR ONE-ATMOSPHERE MODELING I~OR MULTISCALE 

5.0 
AIR QUALITY MODELING 

To simulate weather and air quality phenomena realistically, adaptation of a one-atmosphere 
perspective based mainly on "first principles" description of the atmospheric system (Dennis, 
1998) is necessary.  The perspective emphasizes that the influence of interactions at different 
dynamic scales and among multi-pollutants cannot be ignored.  For example, descriptions of 
processes critical to producing oxidants, acid and nutrient depositions, and fine particles are too 
closely related to treat separately.  Proper modeling of these air pollutants requires that the broad 
range of temporal and spatial scales of multi-pollutant interactions be considered simultaneously. 
Several chapters (Chapters 4, 8, 9, 11and16) of this document present the one-atmosphere 
modeling perspective related with the multi-pollutant chemical interactions.  Another key aspect 
of the one-atmosphere perspective is the dynamic description of the atmosphere.  This is the 
focus of the present chapter. 

Air quality modeling should be viewed as an integral part of atmospheric modeling and the 
governing equations and computational algorithms should be consistent and compatible. 
Previously, many atmospheric models have been built with limited atmospheric dynamics 
assumptions.  To simplify the model development process, the governing equations were first 
simplified to match with the target problems, then computer codes were implemented.  This 
approach enabled rapid development of models.  However, we believe that dynamic assumptions 
and choice of coordinates should not precede the computational structure of the modeling 
system.  To provide the scalability in describing dynamics, a fully compressible governing set of 
equations in a generalized coordinate system is preferable.  Once the system is based on the fully 
compressible governing equations, simpler models can be built readily.  The characteristics of 
the vertical coordinates and other simplifying assumptions need to be considered as well.  For 
successful one-atmosphere simulations, it is imperative to have consistent algorithmic linkage 
between meteorological and chemical transport models (CTMs). 

The present chapter addresses the issue of consistent description of physical processes across 
scales in meteorological and air quality modeling systems.  It intends to provide appropriate 
background information to properly link air quality and meteorological models at a fundamental 
level.  It deals with dynamic scalability issues, such as hydrostatic and nonhydrostatic modeling 
covering wide range of both temporal and spatial scales.  Some of the contents are extracts from 
Byun (1999a and b) and others are complementary information to them.  It includes mass 
correction methods, mass conservative temporal interpolation method, and the coupling 
paradigm for meteorology and chemical transport models. 

5.1 

Governing Equations and Approximations for the Atmosphere 

In most weather prediction models, temperature and pressure, as well as moisture variables, are 
used to represent thermodynamics of the system.  Often these thermodynamic parameters are 
represented with the advective form equations in meteorological models.  Most of tin1e, the 
density is diagnosed as a byproduct of the simulation, usually through the ideal gas law.  For 
multiscale air quality applications where the strict mass conservation is required, prognostic 
equations for the thermodynamic variables are preferably expressed in a conservative form 
similar to the continuity equation.  Recently, Ooyama (1990) has proposed the use of prognostic 
equations for entropy and air density in atmospheric simUtlations by highlighting the 
thermodynamic nature of pressure.  Entropy is a well-defined state function of the 
thermodynamic variables such as pressure, temperature, and density.  Therefore, entropy is a 
field variable that depends only on the state of the fluid.  The principle he uses is the separation 
of dynamic and thermodynamic parameters into their primary roles.  An inevitable interaction 
between dynamics and thermodynamics occurs in the fonn of the pressure gradient force. 

In this section, a set of governing equations for fully comipressible atmosphere is presented. 
Here, density and entropy are used as the primary thermodynamic variables.  For simplicity, a 
dry adiabatic atmosphere is considered.  Most of the discussions in this section should be 
extensible for moist atmosphere if Ooyama's approach is followed. 

5.1.1  Governing Equations in a Generalized CurviliEtear Coordinate System 

Using tensor notation, the governing set of equations for the dry atmosphere in a generalized 
curvilinear coordinate system can be written as: 

(5-1) 

(5-2) 

(5-3) 

(5-4) 

where vi  and v k  are contra variant and covariant wind components, respectively,  v;{  represents 
the covariant derivative of contravariant vector,  £ikl is the Levi-Cevita symbol,  Qk is the angular 
velocity of earth's rotation,  fr!  represents frictional forcing terms, .fY is the Jacobian of 
coordinate transformation,  cI>  is geopotential height, p is air density, and  gik  represents 
components of gravity vector in tensor form.  Refer to Appendix 5A for the tensor primer and the 
derivation of the continuity equation in a generalized curvilinear coordinate system.  <fJ; 
represents trace species concentration, ands is (dry air) entropy per unit volume (entropy 
density), given as 

s = pCwi In( I._) - pRd In( _E__) 
Poo 

T,,o 

(5-5) 

where T  is temperature,  T,,0  and p 00  are temperature and density of the reforence atmosphere, 
respectively, at pressure  p 00  = 1000 mb = 105 Pascal,  Cvd  is the specific he:at capacity  at 
constant volume, and Rd is the gas constant for dry air.  The Q-terms represent sources and sinks 
of each conservative property.  Although the source term for air density ( QP ) should be zero in 
an ideal case, it is retained here to capture the possible density error originating from numerical 
procedures in meteorological models.  It is important to linderstand how this error term 
influences computations of other parameters such as vertical velocity component.  Effects of the 
error term on trace gas simulation are discussed later. 

To close the system we need to utilize the ideal gas law and the thermodynamic relations for 
temperature, entropy, pressure gradients, and density.  Here, atmospheric pressure is treated as a 
thermodynamic variable that is fully defined by the density and entropy of the atmosphere. 
Then, pressure gradient terms can be computed using the thermodynamic relations with the 
density and entropy (e.g., Batchelor, 1967; Ooyama, 1990; DeMaria, 1995) in terms of the 
general vertical coordinate  s = .£3

,  as: 

p= pRJT 

V,p=(t )v,p+(~JVJ 
( ap J ap  ( ap J as 
ap 
as  =  ap  as  +  a,  as 
()p =(c  _fJRdT 
pd  p  cwl 
ap 

(5-6a) 

(5-6b) 

(5-6c) 

(5-6d) 

(5-6e) 

where  Cpd  is the specific heat capacity at constant pressure for dry air, andl 
v $  = ia I ax1 l..=const  + ja I ax2L=const.  For a conformal map projection, we can relate generalized 
meteorological curvilinear coordinates  (.£1 ,.£2 ,.£3 J) to the reference rotated earth-tangential 
coordinates  (x,y,z,t) as 

5-4 

x1 =mx 
x2 =my 
x3  =s 
t=t 

x=m-1x1 
y=m-1.x2 

h( "I  "2  "3  ")  h 

"I  "2) 
x  ,x  ,x ,t  =  AGL  x  ,x  ,x ,t  +z.ifc(x  ,x 

("I  "2  ,..3  ") 

z = 
t=t 

BP.A/600/R.-991030 

(5-7a, b) 

where mis the map scale factor,  z.ifc  is the topographic height, and his the geometric height, and 
hAGL represents height above the ground (AGL).  In the derivation of Equations 5-7a,b, we 
neglected the first-order variations of the map scale factor in x- and y-directions.  The 
approximation establishes a quasi-orthogonality of the vertical coordinate to the horizontal plane 
on the confomal map.  The covariant metric tensor, for example, and its determinant are given as 

(5-7c) 

(5-7d) 

With above relations, one can rewrite the governing momentum equation, Equation 5-1,into the 
horizontal and vertical components of the curvilinear cooirdinates as (Byun, 1999a): 

av 
_ s  +(V  •V )V +v3
at  SS S  

A .  

A 

av 
- s  + fi xV 
as 

3 

S 

A 

" 
+m  (-V p+V <P)-m  - (--+-)V h=F 
. 
s 

2(as)  1 tip 
dz  pas 

2  1 
p 

a<P 
as 

s 

s 

s 

-m  -(-V p+V  <P)•V  h+ 

s 

s 

2as  1 
()z  p 

~  12lttp 
pas 

" 
s  (--+-)= R 
z 
3 

a<P 
as 

s 

(5-8) 

(5-9) 

where V:,  = v1i  + 112 j, <P(x 1
forcing vector,  i 3  is the vertical tangential basis vector andfi;  is the forcing term in the 
momenhun equation for  x3  direction. 

, x 3 ,i) = gz represents the geopotential height,  :Fs  is the horizontal 

, .x2

An alternative equation for the Cartesian vertical velocity component is given as: 

d(plsw) 

dt  +m  vs 

2u  • (pf5wV4 ) 

d(pJ5wv3

) 

m 

+ 

as 
wQP J 
( 
3  p 
+pl  - -+ - - =pl  R + -

m ()p  d<PJ(as) 
spas 
dz 

as 

(

s 

(5-9') 

where Vz: = Vi + Vj = (v1 I m)i + (v2 
Cartesian coordinate system, w is the vertical velocity component,  J_.  is the Jacobian for vertical 

/  m)j is the horizontal wind vector represented in the 

coordinate transformation (ls= l~~I =  ~ 1::1 =  m 2 .fY ), and F;  is forcing term for thew(cid:173)

component.  Note that the contravariant vertical velocity component is related to the Cartesian 
vertical velocity as: 

... 3 
v  =-=-+V •V s+w  - =-+(--V •V <P+w)  -

(5-10) 

as 
dt 

ds 
dt 
' 

z; 

z; 

(as)  as 
dz 
dt 

1 ... 
s 
g 

s 

. 

(as) 
dz 

, 

where v z;  = ia I ax1z;=C01L<t  + ja I dy'z;=const. 

The conservation equations for air density, entropy density, and tracer concentrations are found 
to be: 

d(pls) 

dt  + m 

2v  • (pJ.,V:, J d(pJ.,v
ds 

m2  + 

" 

3

)  = 1 Q 

s  P 

(5-11) 

(5-12) 

(5-13) 

5.1.2  Assumptions of Atmospheric Dynamics 

In this subsection, several popular assumptions used in meteorological models are reviewed. 
Here, the dynamic and thermodynamic assumptions are discussed separately because they have 
been applied as independent approximations in many atmospheric models.  However, readers 
should be aware of the inseparable nature of the dynamics and thermodynamics of the 
atmosphere.  This study focuses on the impact of basic assumptions of the mass conservation 
issues and limits ()f applications in air quality applications. 

5.1.2.1 Boussinesq Approximation 

The crux of the Boussinesq approximation is that variation in density is important only when it is 
combined as a factor with the acceleration of gravity. Originally, it was applied for studying 
shallow convection or boundary layer dynamics.  Descriptions of the Boussinesq approximation 
can be found in the literature (e.g., Arya, 1988; Pielke, 1984; Stull, 1988; and Thunis and 
Bornstein, 1996).  Although the Boussinesq approximation was originally developed for 
incompressible fluid, Dutton and Fichtl (1969) expanded the concept for anelastic deep 
convection applications.  The results of the approximation lead to the following simplifici:itions 
of the equations of motions in the planetary boundary layer (PBL): 

(1) 

(2) 

(3) 

Flows can be treated essentially as solenoidal either in velocity field (incompressible) or 
in momentum field (anelastic). 

The equation of state for the fluctuating component is simplified because the ratio of 
fluctuating density to total density can be approximated by the ratio of temperature 
fluctuation to the reference temperature. 

Molecular properties including diffusivity are constant.  These approximations are often 
used in air quality modeling to simplify the equations of motions and trace gas 
conservation equations.  The effect of the Boussinesq approximation on mass continuity 
is in the limitation of the flow characteristics, such as incompressible or anelastic.  For 
multiscale atmospheric studies, this approximation may be used only in the 
parameterization of the surface fluxes where the density can be treated essentially 
independent of height. 

5.1.2.2 Nondivergent Flow Field Assumption 

Essentially, this is an assumption about flow characteristics.  The basis of this assumption is 
purely dynamic although an incompressible assumption leads to the nondivergent flow 
approximation.  A priori, there is no connection with atmospheric thermodynamics.  Therefore 
this assumption does not provide any information about the state variables, such as density, 
temperature, and pressure fields.  For atmospheric applications, this approximation should be 
viewed as a result of the incompressible atmosphere assumption linked through the continuity 
equation of air.  Because of the characteristics that the nondivergent velocity field can be 
expressed as the curl of a vector stream function, the field is also called solenoidal.  Implications 
of this assumption on mass conservation of trace species are presented below in the description 
of the incompressible atmosphere assumption.  In the generalized coordinate system, the 
nondivergent flow field is represented with following equation 

This is somewhat different from the meteorological nondivergent flow field assumption in the 
Cartesian coordinate system,  V • V = 0.  In the generalized meteorological coordinate system, 
Equation 14 can be rewritten as 

(5-14)  . 

(5-14') 

The two additional terms represent essentially the effects of the map projection and the gradient 
of the vertical Jacobian on the divergence of wind.  For a small domain and for a coordinate 
whose vertical Jacobian is constant with respect to height (e.g.,  <J',-coordinate), Equation 14' 
becomes identical to the nondivergent wind flow assumption used in a meteorological model. 
When the vertical Jacobian is a function of air density, the dependency of the wind on the density 
distribution cannot be ignored. 

5.1.2.3 Incompressible Atmosphere Assumption 

This is an assumption about the thermodynamic characteristics of air.  The equation of state 
describes how density is affected by the changes in pressure and temperature fields. The 
incompressibility of air can be assumed (Batchelor, 1967) if: 

l_dp\<<u 
p  dt 
\

L' 

(5-15) 

where U and L are the velocity and length scales, respectively, of the atmospheric motion. 

As proposed in Byun (l 999a), one can choose the density and the entropy as the two independent 
parameters of state.  The total derivative of pressure with respect to time can be expressed as: 

Then, Equation 5-15 becomes the relation: 

(5-16) 

(5-17) 

where  csound  is the speed of sound in the atmosphere, i.e.,  c.Mund  =~lap I apj.  Batchelor (1967) 
stated that for Equation 5-17 to be satisfied, not only the difference between the two terms in the 
left hand side of Equation 5-17, but also the magnitude of each term should be small.  When the 
condition 

1  dp 
---<<(cid:173)
pc;_  dt 

u 
L 

(5-18) 

is satisfied, the change in the density of a material element due to pressure variations are 
negligible, that is, the fluid is behaving as if it were incompressible.  By expanding the term  dp 
dt 

in an Eulerian expression one can show that in order for the atmosphere to be treated as 
incompressible, the following conditions must be satisfied: 

u2 
-2-<<l; 
c,.und 

u2 
_P_<<l• 
' 
2 

csound 

gL. 
-2-<<l, 
c .. und 

(5-i 9) 

where UP  is the phase speed of dominant atmospheric waves.  The first condition states that the 
movement of air should have a Mach number much smaller than one, say 10%; the second 
condition states that energy-carrying waves should not propagate as fast as 10% of the speed of 
sound; and the last condition limits the vertical extent of motion to less than about one kilometer. 
Similarly, Dutton and Ficht! (1969) showed that the nondivergent wind relation is generally 
applicable up to half a kilometer above ground level through a scale analysis of the continuity 
equation.  Because of these limitations, a meteorological model with incompressible flow 
approximation may not be suitable for multiscale air quality simulations that' require descriptions 
of atmospheric motions over a wide range of temporal and spatial scales.  The second condition: 

1  (dpJd' 
u 
pc;und  ds  dt <<  L 

(5-20) 

means that variation of entropy due to internal heating or due to molecular conduction of heat 
into the element must be small.  For adiabatic or pseudo-adiabatic atmosphere, Equation 5-20 is 
usually satisfied. 

Basically, an incompressible atmosphere assumption is a shallow-water approximation for an 
adiabatic atmosphere.  With the incompressibility assumption, the distinction between the 
continuity equation and its advective form becomes blurred.  Consequently, concentrations in the 
form of either density or mixing ratio are often used indiscriminately in atmospheric diffusion 
equations.  As presented above, the incompressible atmosphere assumption is a very restrictive 
approximation that disassociates linkage between the thermodynamics and dynamics of 
atmospheric motions.  The incompressible atmosphere approximation simplifies the continuity 
equation of the air to the nondivergent wind component relation regardless of the type of vertical 
coordinates used. Compared with this, the atmosphere described with the hydrostatic pressure 
coordinate is not necessarily incompressible even for the hydrostatic atmosphere.  Because the 
vertical layer is defined by the pressure surface, the hydrostatic approximation applied with the 
hydrostatic pressure coordinate system limits only the vertical propagation of sound waves and 
the atmosphere is not totally incompressible. 

One might expect that as long as the wind field satisfies the nondivergent flow approximation, an 
air quality model would satisfy the pollutant species mass conservation.  In the following, it is 
shown that this expectation is correct only when the air density field is perfectly mass consistent. 
As will be shown later in Equation ·5-24, the trace species mass conservation is affected by the 
air density error term  QP  irrespective of whether or not the wind field is solenoidal.  The 
implication is that a nondivergent wind field does not guarantee the mass conservation of 
pollutant species as long as there is inconsistency in air density and wind fields.  It is not a 
surprising statement, but in general this fact has not been actively addressed in air quality 
modeling studies.  Because the nondivergent relation simply disassociates density and wind 
fields, it cannot be used to estimate the mass consistency error in the meteorological data set.  On 
the other hand, the diagnostic relations applicable for the famHy of hydrostatic pressure 
coordinates based on total air density maintain the consistency in wind and air density fields. 

5.1.2.4 Anelastic Atmosphere Assumption 

Another popular limiting approximation applied in meteorological modeling is the anelastic 
assumption.  It simplifies the continuity equation as a diagnostic relation for the momentum 
(p0V, where  p0  is density ofreference atmosphere) components as follows: 

v S  e  ( .fY po VS) + ~ ( .fY p D V3

)  = 0 

(5-21) 

Ogura and Phillips (1962) and Dutton and Fitchl (1969) found that for deep atmospheric 
convection, if the characteristic vertical scale of motions is smaller than th~: atmospheric scale 
height, the anelastic assumption is satisfied.  For shallow convection, the Boussinesq 
approximation allows us to treat the fluid as incompressible; for deep convection, the 
approximate continuity equation requires the momentum field to be solenoidal, and the 
expansion or contraction of parcels moving in the vertical is taken into account.  Lipps and 
Hemler (1982) also performed a scale analysis to propose a set of approximate equations of 
motion which are anelastic when the time scale is larger than the inverse ofBrunt-Vaisala 
frequency.  The anelastic approximation leads to a divergent wind field, i.e.: 

(5-22) 

Usually, the right hand side of Equation 5-22 does not vanish.  Like the nondivergent wind field 
approximation, this assumption provides a diagnostic relation among wind components although 
it cannot be used to estimate the inconsistency in the total air density, p, and wind field data 
provided by a meteorological model.  However, unlike the incompressible atmosphere 
assumption, the pressure, temperature and wind fields are not completely independent with the 
anelastic assumption.  The distribution of pressure must be such that the wind fields predicted by 
the momentum equations continue to satisfy the anelastic relation (Gal-Chen and Somerville, 
1975).  For this reason, most anelastic meteorological models solve for the elliptic equation for 
the pressure that is derived from Equation 5-22.  Refer to Nance and Durran (1994) for a recent 
review on the accuracy of anelastic meteorological modeling systems. 

For air quality application, the anelastic approximation still requires use of a full continuity 
equation for the perturbation density component.  However, most anelastic meteorological 
models do not solve for the perturbation air density directly.  Therefore, one needs to infer it 
from other thermodynamic fields.  Also, because the trace gas concentration depends on the total 
density of air, not on just the reference density, it does not simplify the pollutant continuity 
equation and the concentration distribution represented in density units cannot be interchanged 
with trace species mixing ratio. 

5.1.2.5 Hydrostatic Atmosphere Approximation 

Perhaps one of the most popular assumptions of atmospheric dynamics used in meteorological 
models is the hydrostatic approximation.  In the case of a hydrostatic atmosphere, the 
acceleration and the frictional force terms in the z-direction of the earth-tangential Cartesian 
coordinates are considered negligible.  In earlier days of atmospheric modeling, the hydrostatic 
approximation was usually applied with the pressure coordinate.  It is well known that the 
hydrostatic pressure coordinate applied to a hydrostatic atmosphere has a special property that 
simplifies the continuity equation into a solenoidal form and provides a diagnostic equation for 
the vertical velocity component.  On the other hand, the geometric height coordinate was not 
used extensively for studying a hydrostatic atmosphere.  Recently, Ooyama (1990) and DeMaria 
(1995) have presented a diagnostic vertical velocity equation.  Extending this, a general 
diagnostic equation for the vertical velocity component can be obtained with the hydrostatic 
approximation for a coordinate whose Jacobian is independent of time (Byun, 1999a): 

a  (- 2 
as  pcsound  as  = -sign  ()z  g  m 

iN

3 J 

.  (as)  [  zv  ( JsfJVs )  1 Q J 

s  •  ~ -

s  p 

(5-23) 

The diagnostic Equation 5-23 can be used to maintain mass consistency in meteorological data 
for air quality simulations. 

It is worthwhile to note that the hydrostatic or nonhydrostatic atmospheric description, which is a 
characterization of the vertical motion, is rather independent from either the 
compressible/incompressible atmosphere or the anelastic atmosphere assumption, which is an 
approximation of the mass continuity equation.  Choices of the assumptions from the two distinct 
groups have been used to simplify atmospheric motions, although some of the combinations, 
such as compressible but hydrostatic atmosphere, are rarely used in atmospheric studies. 

5.2 

Choice of Vertical Coordinate System for Air Quality Modeling 

Figure 5-1  provides a pedigree of vertical coordinates used in many atmospheric models. 
Definitions of the coordinates are provided in Tables 5-1, 5-2 and 5-3.  The hierarchy of 
classification is: (1) temporal dependency of coordinates, (2) base physical characteristic of 
coordinate variables, and (3) method of topography treatments.  Application assumptions, such 
as hydrostatic or nonhydrostatic atmosphere approximations, are not part of the classification 
criteria.  Isentropic coordinates are not included here because they are not suitable for the 
regional and urban scale air quality simulation due to their inherent difficulties representing 
planetary boundary layer (PBL) structure.  For larger-scale simulations, an isentropic coordinate 
system can serve as an interesting alternative (Arakawa et al., 1992).  Also, there are new 
developments of hybrid coordinates that combine isentropic coordinates with other coordinates 
to mitigate the problem. 

Many different types of vertical coordinates have been used for various meteorological 
simulations.  !"or example, the geometric height is used to study boundary layer phenomenon 
because of its obvious advantage of relating near surface measurements with modeled results. 
Pressure coordinates are natural choices for atmospheric studies because many upper 
atmospheric measurements are made on pressure surfaces.  Because most radiosonde 
measurements are based on hydrostatic pressure, one may prefer use of the pressure coordinate 
to study cloud dynamics.  This idea of using the most appropriate vertical coordinate for 
describing a physical process is referred to as a generic coordinate concept (Byun et al.,  1995). 
Several different generic coordinates can be used in a CTM for describing different atmospheric 
processes while the underlying model structure should be based on a specific coordinate 
consistent with the preprocessor meteorological model.  The Models-3 Community Multiscale 
Air Quality (CMAQ) modeling system allows users to choose a specific coordinate without 
having to exchange science process modules (i.e., subroutines with physica1 parameterizations 
for describing atmospheric processes) which are written in their generic coordinates.  The 
coordinate transformation is performed implicitly through the use of Jacobian within CMAQ. 

Byun (1999a) discusses key science issues related to using a particular vertical coordinate for air 
quality simulations.  They include a governing set of equations for atmospheric dynamics and 
thermodynamics, the vertical component of the Jacobian, the form of continuity equation for air, 
the height of a model layer (expressed in terms of geopotential height), and other special 
characteristics of a vertical coordinate for either hydrostatic or nonhydrostatic atmosphere 
applications.  Tables 5-1, 5-2 and 5-3 summarize properties of the popular time-independent 
vertical coordinates (e.g., terrain-influenced height and the reference hydrostatic pressure 
coordinate systems) and the time-dependent terrain-influenced coordinate systems, respectively. 

Not only the assumptions on atmospheric dynamics, but also the choice of coordinate can affect 
the characteristics of atmospheric simulations.  For the time-independent vertical coordinates (z, 
p"' sigma-z, sigma-p0 ), the vertical Jacobians are also time-independent.  Especially with the 
hydrostatic assumption, one can obtain a diagnostic equation for the vertical velocity component 
, which includes soundwaves together with meteorological signals.  Further assumptions on flow 
characteristics, such as anelastic approximation, provide a simpler diagnostic equation for the 
nonsolenoidal air flow.  For such cases, with or without the anelastic approximation, one can 
maintain trace species mass conservation in a CTM by using the vertical velocity field estimated 
from the diagnostic relation.  The scheme works whether the horizontal wind components, 
temperature, and density field data are directly provided from a meteorological model or 
interpolated from hourly data at the transport time step.  This suggests that the mass error can be 
estimated with the diagnostic relations that originate from one of the goveming equations of the 
preprocessor meteorological models.  For a nonhydrostatic atmosphere, which does not have a 
special diagnostic relation for time ind~pendent coordinates, one should rely on the methods . 
described below to account for the mass consistency errors. 

For time dependent coordinates, the vertical Jacobians are also time dependent.  In general, this 
makes it more difficult to derive a diagnostic relation from the continuity equation.  However, 
for a coordinate with the Jacobian-weighted air density independent of.height, a diagnostic 
equation for the vertical velocity is available when appropriate top and bottom boundary 
conditions are used.  Vertical layers defined with this type of vertical ~oordinate are considered 
as material surfaces because mass continuity can be satisfied in a diagnostic fashion.  Air 
particles are not expected to cross material surfaces during the advection process.  An 
atmospheric model based on this type of coordinate may not h.ave a mass consistency problem 
except for numerical reasons.  The dynamic pressure coordinates based on true air density belong 
to this category, which includes such coordinates as  ~-coordinate, O'ir·coordinate, and the 1J  -
coordinate defined in conjunction with  air (See Table 5-3).  A meteorological model using one 
of these coordinates will conserve mass within the liinit'3 of numerical errors expected from finite 
differencing and computer precision.  For these coordinates, one can apply the same mass 
conservation procedure for both hydrostatic and nonhydrostatic cases.  Note that the diagnostic 
relations obtained by appropriate choices of coordinates and assumptions on atmospheric 
dynamics allow estimation of the density error term in the continuity equation.  This information 
can be used to reconstruct mass-consistent air density and wind fields that ensure mass 
conservation of pollutant species in air quality models. 


.. -.. 
, 
' 
,;;,  ~  ,' 
\ 
>-
, __ , 

I 

/ 

.......... 

.. -.. 
, 
' 
' 
' 
>-
:r 
I 
I 
\  z 
, 
./1'--" 

/ 

....... 

'\. 
.,., 

....... ...._).I .. - .. 
' 
C 
'?£:. 

\ 
I 
', 
,' 
jt.,.-' 
I 
I 

/ 

\ 

.. -.. 
. ~  ' 
, 

, 
7"--' 

C 

\ 

I 

\ 

.. ....__ 

.. -~ 
' 
\ 
'?i:_ 
, __ , 
, 
' 
z 

I 
l 
\ 

~, 

Figure 5-1.  Pedigree of meteorological vertical coordinates.  The encircled T symbol  represents 
that the associated coordinates are identical when temporal dependency is ignored.  Dashed(cid:173)
circles show that all the coordinates can be used for hydrostatic (HYD) and nonhydrostatic 
(NHY) application, regardless of the dynamic characteristics of the variables used to define 
vertical coordinates. 

Table 5-1.  Summary of Characteristics of the Geometric Height and Pressure Coordinate 
Systems. [Note: HYD and NHY stand for hydrostatic and nonhydrostatic applications, 
respectively.  D( ) and P( ) symbols are assigned for diagnostic and prognostic formulas with 
equation numbers.  p 0  and p are the reference and dynamic (time-dependent) hydrostatic 
pressure, respectively.] 

Coordinate 

geometric height 
(z) 

vertical velocitv 
NHY: w with P(S-9) or P(5-
9') 
HYD: D(S-23) 

) 

reference 
hydrostatic 
pressure  (p 0
~ =-p.(z)g 
dynamic 
hydrostatic 
pressure  (n), 
an 
a;= -p(x,y,z,t)g 

large-scale 
hydrostatic 
pressure  (p) , 
:  = -p(x,y,z,t)g 

NHY: P(S-9) or P(S-9') 
HYD: D(S-23) 

v3  =ii =-f [m2V  •( Vw )- QP]dn' 
for both NHY &  HYD 

"  m' 

p 

wr 

NHY: P(S-9) or P(S-9') for 
perturbation component 
HYD: 
v =.P=-f[mV  •  __e...  --::--ld.P 

c) 

V-
fi  m' 

Q,, 
p 

fi 
;, 

J 

• 

2 

Vertical Jacobian 
J.=J 
constant in 
(x1,.x2 . .x3,t) 
J  = (p gf1  constant 
in  c.x1 

.. ~2 ,t) 

Po 

o 

Geoootential hei!!ht 
<P=gz 

- t  dpo' 

Pu.ifr  p" 

cJJ=cJJ 

.ifc: 

11' = (pg)-1  but, 
pl i. = 1 I g  constant 
in  (x1,.x2,.x3,t) 

JP  =(pgfl 

sfc 

c.P=c.P 

"*  p 

- r dn' 
c.P=c.P  -r dfl 

i"r'  p 

.tfc 

Table 5-2.  Summary of Time Independent Terrain-influenced Height and Reference Hydrostatic 
Pressure Coordinate Systems.  [Note: D( ) and P( ) symbols are assigned for diagnostic and 
prognostic formulas with equation numbers, ~espectively, and '* f( )' represents that the 
parameter is not dependent on the argument.] 

Coordinate 

Application  Vertical Momentum 

Vertical 
Jacobian 

Geopotential height 

la,= H-zifc 
-:t:. f(x 3,t) 

<P=gz= 
g[z,1,. + a.(H - z.ifc)] 

. 
J  =  Po 
a,.  P.(x3)g 
¢  f (t), 
P; = P.<zs1,)- Pr 

f'"'  ~ ' 

apo 

.ifc- a 

<P-<P 

-

. 

'"''' P. 

nonnalized 
geometric 
height ( O" z) 
a  = z-z* 
'  H -z>fc 

terrain-
influenced 
reference 
pressure 
(O" p.) 
u  •  &-e.c 
,.  P.(z.,,)-p, 

hydrostatic 

0(5-23) 

generalized 
hydrostatic 

non-
hydrostatic 
hydrostatic 

P(5-9) or, 
P(5-9') with Eq.(5-10) 

0(5-23) 

non-
hydrostatic 

P(5-9) or, P(5-9') with Eq.(5-
10) for perturbation 
component 

Table 5-3.  Summary of Characteristics of the Time Dependent Terrain-influenced Coordinate 
Systems. 

EP A/600/R-99/030 

Geopotential height 

tP = <Plfr. -

tP = <Plfc -

t  jf 

"""'  p 

' 
!7der,, 

r  ir· 

"•,fe  p 

7der,.' 

tP = tP,1r - J."'  ~erJ>' 

a,,,,  p 

tP = <Plfc - f  _'f  dr]' 

q.,. P11src 

Vertical 
Jacobian 

t 

-· 
pJC1  =}!_ 
g 
-:;: J(x 3
n• = 1T:efc  -1T:T 
• 
1C 
pJ  = -
g 

CT" 

) 

) 

*f(x3
pJC1  = 'f/ 
g 
-:;: J(x3

) 

p 

-· 
J  =...:.}!__ 
"  -
pg1Jsfc 
pJ11-:;: 
J(x 3

) 

• 
'IC 

J  = - - <P = <Psfc  -
11 

pg1Jsfc 

r  n' 

q,,.,  PT/src 

~r]' 

pJ11-:;: 
J(x3

) 

-· 

J  =-p-
-
11 
pg1J.rfc 

tP = <Psfr - r _Ji'  dr]' 

q_,.  P11sfr 

Coordinate 

terrain-
influenced 
hydrostatic 
pressure 
(an") 
(J  = 
" 

1C-1T: 

T 
n:.ifc  -1T:r 

Applicatio  Vertical Momentum 
n 
hydrostatic 

n .. a,.j"• 
""' 

"•  Q 
p 

= f  [1r• =:.!!..-m2V  •~J do' 
" 

1rv 
m2 

"• 

non-
hydrostatic 

""' 

iltc" 
-(er  -er  ) -
iJt 

1(1' 

" 

non-
hydrostatic 

terrain-
influenced 
large-scale 
hydrostatic 
pressure( O' fi) 
step-mountain  hydrostatic 
eta  (77)with 

(j n"' 
11  = (j 1C11sfc' 
11.ifc  = 
Po(Zsfc)- Pr 
Pa(O)- Pr 

non-
hydrostatic 

P(5-9) or, P(5-9') with Eq.(5-10) for 
perturbation component when  p 
and  p  given 

iltc. 
-= - f  [ir"=:.!!..-m277  V  • - -q  J d1f 
dt 

1r·v 
sfc  q  m271sfc 

t  q..  Q 
p 
111/r.  o 

iltc" 
dt 

. T 
1r 71  =-11-+ 
q  Q 
f [1r' =:.!!..-m277  V  •~] dr/ 
p 
o 

·v 
sfc  q  m271sfc 

0 

step-mountain  non-
ETA ( 11u-) 

p 

hydrostatic 

.with  <J"p, 
11u;;  = (j p1Jsfc 

P(5-9) or, P(5-9') with Eq.(5-IO)for 
perturbation component when i/u  , 
p 
p  provided 

5.3 

Coupling of Meteorology and Air Quality 

Characteristics of air quality model simulations are heavily dependent on the quality of the 
meteorological data.  Meteorological data for air quality can be provided either by diagnostic 
models, which.'analyze observations at surface sites and upper air soundings, or by dynamic 
models with or without four-dimensional data assimilation (FDDA).  Readers are referred to 
Seaman (1999) for a state-of-science review on this topic.  In the next section a dynamic 
modeling with FDDA approach, which is used in the Models-3 CMAQ system, is described. 

5.3.1  Meteorolo~cal Data for Air Quality Modeling 

Meteorological simulations are applied to drive a CTM for solving atmospheric diffusion 
equations for trace species.  For regional scale simulations, whose problem size is continental 
i;cale or somewhat smaller, hydrostatic meteorological models have been used, usually with 
FDDA.  For small scale simulations where topographic effects are important, nonhydrostatic or 
compressible atmospheric models are used.  These differences in the assumptions used for 
atmospheric characterization affect air quality simulations greatly. 

Meteorological data can be supplied by running dynamic models prognostically, or with the 
archived reanalysis data routinely available as a part of numerical weather forecasting for air 
quality simulations (Schulze and Turner, 1998).  Currently, GCIP (GEWAX Continental-scale 
International Project) provides an archive of the Eta model reanalysis of surface and upper air 
fields at 48 km resolution (Leese, 1993; Kalany et al., 1996).  Based on th~~ success of GCIP, the 
National Center for Environmental Prediction (NCEP), NOAA, is planning to archive regional 
reanalysis at a higher resolution.  Similarly, the Mesoscale Analysis and Prediction 
System/Rapid Update Cycle (MAPS/RUC) of the Forecast Systems Laboratory (FSL), NOAA, 
produces accurate and timely analyses and short-term forecasts at 40-60 km resolutions 
(Benjamin et al.,  1995, 1998).  The output data are archived at 1-3 hour intervals on 25-34 levels. 
These alternative data sources are promising because of the wealth of observation data used for 
the reanalysis and the availability of long-term meteorological characterization data suitable for 
seasonal or annual assessment studies. 

5.3.2  Off-line and On-line Modeling Paradigms 

Air quality models are run many times to understand the effects of emissions control strategies 
on the pollutant concentrations using the same meteorological data.  A non-coupled prognostic 
model with FDDA can provide adequate meteorological data needed for such operational use. 
This is the so-called off-line mode air quality simulation. However, a successful air quality 
simulation requires that the key parameters in meteorological data be consistent.  For example, to 
ensure the mass conservation of trace species, the density and velocity component should satisfy 
the continuity equation accurately.  Details of this issue will be discussed below. 

If air quality is solved as a part of the "meteorology modeling, this data consistency problem 
would be much less apparent.  Dynamic and thermodynamic descriptions of operational 
meteorological models should be self-consistent, and necessary meteorological parameters are 
readily available at the finite time steps needed for the air quality process modules during the 
numerical integration.  The ultimate goal within atmospheric community is the development of a 
fully integrated meteorological-chemical model (Seaman, 1995).  This is the so-called on-line 
mode air quality simulation.  There have been a few successful examples of integrating 
meteorology and atmospheric chemistry algorithms into a single computer program (e.g., Vogel 
et al.,  1995).  For certain research purposes, such as studying two-way interactions of radiation 
processes, the on-line modeling approach is needed.  However, the conventional on-line 
modeling approach, where chemistry-transport code is imbedded in one system, exhibits many 
operational difficulties.  For example, in addition to tremendously increasing the computer 
resource requirements, differences in model dynamics and code structures hinder development 
and maintenance of a fully coupled meteorological/chemical/emissions modeling system for use 
in routine air quality management. 

Figure 5-2 shows structures of the on-line and off-line air quality modeling systems, 
respectively, commonly used at present time.  Table 5-4 compares a few characteristics of on(cid:173)
line and off-line modeling paradigms.  Each method has associated pros and cons.  Therefore, in 
the future versions of the Models-3 CMAQ system, we intend to realize both on-line and off-line 
modes of operations through the use of an advanced input/output (I/O) applications programming 
interface (API) (Coats, 1996).  Figure 5-3 provides a schematic diagram of the implementation 
idea.  A proof-of-concept research effort using MM5 and a prototype version of CMAQ is  . 
underway (Xiu et al.,  1998).  However, to accomplish the goals of multiscale on-line/off-line 
modeling with one system, a full adaptation of the one-atmosphere concept is needed. 

Development of the fully coupled chemistry-transport model to a meteo~ological modeling 
system requires a fundamental rethinking of the atmospheric modeling approach in general. 
Some of the suggested requirements for a next generation mesoscale meteorological model that 
can be used as a host of the on-line/off-line modeling paradigms are: 

• 

• 

• 

Scaleable dynamics and thermodynamics: Use fully compressible form of governing 
set of equations and a flexible coordinate system that can deal with multiscale dynamics. 

Unified governing set of equations: Not only the weather forecasting, dynamics and 
thermodynamics research but also the air quality studies should rely on the same general 
governing set of equations describing the atmosphere. 

Cell-based mass conservation: As opposed to the simple conservation of domain total 
mass, cell-based conservation of the scalar (conserving) quantities is needed.  Use of 
proper state variables, such as density and entropy, instead of pressure and temperature, 
and representation of governing equations in the conservation form rather than in the 
advective form are recommended. 

State-of-the-art data assimilation method: Not only the surface measurements and 
upper air soUndings, but also other observation data obtafued thro~gh the remote sensing 
and other in situ means must be included for the data assimilation. 

Multiscale physics descriptions: It has been known that certain parameterizations of 
physical. processes, including clouds, used in present weather forecasting models are 
scale dependent.  General parameterization schemes capable of dealing with a wide 
spectruffi of spatial and temporal scales are needed. 

'fh.e Weather ~~secy:~h &  ~orecasting (WRF) Modeling System (Dudhia et al., 1998), which is 
under development by scientists at NCAR and NOAA, could meet most of the above 
requirements.  Therefore, the WRF modeling system has the potential to be: the future 
meteorologicat'model oftlie Models-3 CMAQ system to provide the multiscale on-line/off-line 
air quality modeling capability simultaneously. 

Table 5-4.  Comparison of On-line and Off-line Modeling Paradigms 

Off-line Modeling 

On-line Modeling 

Dynamic 
Consistency 

Process Interactions 

• Need sophisticated interface 
processors 
• Need careful treatment of 
meteorology data in AOM 
• No two-way interactions between 
meteorology and air quality 

System 
Characteristics 

• Systems maintained at different 
institutions 
• Modular at system level.  Different 
algorithms can be mixed and tested 
• Large and diverse user base 
• Community Involvement 

Appllcation 
Characteristics 

• Easy to test new science concept 
• Efficient for emissions control 
study 
• Good for independent air quality 
nrocess studv 

• Easier to accomplish, but must have 
proper governing equations. 
• Meteorology data available as 
computed 
• Two-way interaction 
•Small error in meteorological data 
will cause large problem in air 
quality simulation (positive feedback 
problem). 
• Proprietary ownership 
• Expensive in terms of computer 
resource need (memory and CPU) 
• Unnecessary repeat of 
computations for control strategy 
study 
• Low flexibility 
• Limited user base 
• Legacy complex code, which 
hinders new develooment 
• Difficult to isolate individual 
effects 
• Excellent for studying feedback of 
met. and air quality 

5-20 

Off-line Modeling 

QJ.1-line Modeling 

EP A/600/R-991039 

Meteorology 

Modeling System 

Atmospheric 
Mod~ling System 

Environinental 
Data 

Met., Landuse, 
& Assimilation 
Data 

Surrogate & 
Emisssions 
Data 

• 

Chemistry 
Data 

~ 

Figure 5-2.  Current On-line and Off-line Air Quality Modeling Paradigms  · 

5-21 

Met., Landuse, 
& Assimilation 
• 
Data 

Meteorology 

Modeling System 

------ - - "' 

1/0API 

CPU/Network 
Boundary 

Unified C3overning 
Set of  Ec~uations 

+ 

-

Chemistry 
Data 

• 

1/0API 

Consistent Numerics 

~~MIMW 

CPU/Network 
Boundary 

+ 

real-time 1/0 API 
feedback on 

: On-line model 

file-based 1/0 API  : Off-line model 
feedback off 

Figure 5-3.  Proposed One-atmosphere Air Quality Modeling Paradigms.  Double arrowhead 
lines represent possibility of two-way coupling. The coupling of independent modeling 
components is accomplished through the 1/0 API linking the cooperating executables. 

5.4  Mass Conservation 

For air quality simulations, mass conservation is the most important physical constraint.  This is 
because it is unreali.stic to have injection of primary pollutant mass through any other means than 
a real source emission process, and also because the little perturbations in the mass of both 
primary and secondary pollutants will jeopardize the correct simulation of reactions among trace 
species.  Therefore, conserving mass of a passive primary trace species is a necessary property of 
an air quality model. 

5.4.1  Mass Consistency in Meteorological Data 

The main objective of many meteorological models has been to predict synoptic or mesoscale 
weather phenomena.  Therefore, major design considerations are focused on such issues 
important for energy conservation, resolving a spectrum of different wavelengths, and energy 
cascade under nonlinear wave-wave interactions.  Conservation of mass is not usually 
emphasized as the other constraints listed.  Also, the predictive quantities are generally 
thermodynamic parameters, such as temperature and pressure.  The conservation equation for air 
density is rarely solved directly in meteorological models because of little operational use of air 
density for weather forecasting and no direct measurements to compare.  Usually it is estimated 
from the equation for the state of ideal gas or from a hydrostatic relation when hydrostatic 
assumptions are made.  Even the predictive equations for the moisture variables are often written 
in an advective form rather than a continuity equation form.  On the other hand, air quality 
simulation relies mostly on the continuity equation.  The success. of a simulation is heavily 
dependent on the consistency of density and wind data (i.e., how well they satisfy the continuity 
equation). 

The mass inconsistency in density and wind fields from a meteorological model is most likely 
caused by one or more of the following reasons: 

1. 

2. 

3. 

· 4. 

5. 

6. 

7. 

8. 

9. 

Many meteorological models do not use the proposed ideal set of governing equations.  A 
continuity equation for air is not used as one of the prognostic equations and air density is 
usually a diagnostic parameter in meteorological models. 

The prognostic equation for temperature is often used to represent thermodynamics of the 
atmosphere.  It is well known that temperature is not a good conserving parameter. 

Removal of hydrometeors due to condensation or sublimation may subtract and add mass 
and heat to the moist atmosphere making the system nonadiabatic (thermodynamically 
irreversible) and not mass-conserving. 

Numerical schemes used in meteorological models are designed to conserve energy, 
entropy, rather than the mass of air. 

The FDDA and overall assimilation process, including the effects of Newtonian forcing 
terms in the momentum and temperature equations, may cause inadvertent modification 
of the energy balance and subsequent perturbation of air density resulting in mass 
conservation problems. 

Heat, moisture and momentum flux exchanges at the surface-atmosphere interface may 
affect the air density distribution.  Usually this effect is not significant as it is often 
neglected with the Boussinesq approximation. 

Flux exchanges at the nesting boundaries for nested rups affect mass balance. 

Energy and mass balance characteristics of cloud modules used influence air and 
moisture density fields. 

Data output time steps are too large to capture the dynamic variations in the 
meteorological models.  If temporally averaged data are provided from the meteorology 
model this problem can be minimized (Scamarock, 1998). 

5.4.2  Techniques for Mass Conservation in Air Quality Models 

As presented in Byun (1999b ), species mixing ratios ( ci Ip) is a useful conserved quantity for 
photochemical Eulerian air quality modeling, in particular.  In limited area atmospheric modeling 
like an urban or a regional scale simulation, the total air mass in the simulation domain is subject 
to the inflow conditions determined by large synoptic scale weather systems.  In this situation, 
the conservation of pollutant mass in the modeling domain can be difficult unless the density and 
wind fields are perfectly mass consistent.  When the mass inconsistency in the meteorological 
fields is expected, the conservation equation for mixing ratio must be used as a necessary 
condition to ensure exact conservation of pollutant mass.  This is accomplished by replacing the 
right-hand-side term of Equation 5-11  with  Qc.  = c;  QP.  Then, the conservation equation for 

' 

p 

pollutant species is rewritten as: 

(5-24) 

This adjustment alone is not sufficient to conserve pollutant mass when tht: density error term is 
not small.  Equation 5-24 shows that the correction term has the same form as a first-order 
chemical reaction whose reaction rate is determined by the normalized air density error term. 
Table 7-5 in Chapter 7 in this document summarizes correction methods discussed in Byun 
(l 999b ).  Among these, the method based on the two-step procedure (i.e., solving the lhs of 
Equation 5-24 first followed by the mass correction step solving for rhs) is expected to be the 
most accurate: 

(c.J  )r:or  = (c;Js)T (pJ )int 

(pJ.,l 

I 

S 

S 

' 

(5-25) 

where superscripts cor, int, and Trepresent corrected, transported (advected), and interpolated 
quantities, respectively.  It should be noted that  ls in Equation 5-25 must not be canceled out 
even for a coordinate with time independent  J_.  because the spatial variation of the Jacobian must 
be taken into account for the numerical advection.  In the event the total air mass in the 
computational domain fluctuates, this correction procedure would affect air quality predictions. 
In general, the air quality prediction can be as good as the density prediction of the 
meteorological model.  However, ~onsidering the nonlinear interactions of trace species in the 
chemical production/loss calculations, one could expect serious effects on air quality simulations 
when the quality of meteorology data is in doubt. 

Byun (1999b) also provides an alternative method to deal with the mass inconsistency in 
meteorological data through the modification of wind field, while keeping the density field 
intact, before solving the species conservation equation.  Assuming a modified wind field exists 
that eliminates the source term in the continuity equation for air, the relationship between the 
original and modified wind components is given as: 

" 

,...  M 

V:.  = v .. + 2a2 V)L 

1  . 

I 

(5-26a) 

(5-26b) 

where A, is the Lagrangian multiplier to be determined and a 1 and a3 are the weights for the 
horizontal and vertical wind components. A, must satisfy the Poisson equation 

(5-27) 

with the associated boundary conditions: 

A-=  0 for flow-through boundaries; and 
()A,/ as= Ofor impenetrable boundaries (i.e., at the topographic surface). 

The modified wind components are subject to the same top and bottom boundary conditions 
imposed by the given coordinate system and dynamic assumptions. 

The main difference in the two proposed correction methods, correction after advection versus 
correction of wind fields before advection, is practically.philosophical.  Should we process a 
CTM using meteorological data as supplied, then correct possible errors in the species 
concentrations, or should we modify the velocity field to be mass consistent before the 
computation of trace gas concentrations in the CTM?  The answer to this question lies in whether 
the air quality modeling need is satisfied with simple mixing ratio conservation with the 
adjustment process or not.  In case the source-receptor relation is important, it is preferable to 
maintain the linearity of transport process using the mass-consistent wind components, which 
have been modified at the expense of truthfulness of meteorological fields.  In practice, a 
combination of both methods is needed.  The mass consistency error in the meteorological data 
must be corrected before air quality simulations with the wind-field adjustment method and the 
mixing ratio correction method Equation 5-25 should be applied to compensate the numerical 
differences in advection processes between meteorological and air quality models. 

5.4.3  Temporal Interpolation of Meteorological Data 

Byun (1999b) discusses a mass-conservative temporal interpolation method to complement the 
mass inconsistency correction.  Temporal interpolations of density and velocity data are often 
required in a CTM because the meteorological model output has a coarser temporal resolution 
than the transport time step (which is usually the synchronization time step for a CTM using a 
fractional time-step method). 

The Jacobian and density at a time  ta  = (1- a)tn + atn+i  between the two consecutive output time 
steps,  tn  and  tn+P  are interpolated with linearity as~umed: 

(5-28a) 

where  0~a~1. It is obvious that the functional form of the Jacobian (which depends on a 
vertical coordinate) changes the characteristic of density interpolation.  The premise used here is 
that the Jacobjan is a fundamental quantity that determines the coordinate system.  When the 
Jacobian is interpolated to define the vertical layers through linear interpolation, all other 
components involved in the mass conservation equation need to be interpolated accordingly. 
Wind components multiplied with the Jacobian-weighted density are interpolated linearly: 

(5-28b) 

and interpolated wind components are derived with: 

(5-29a) 

(5-29b) 

(5-30a) 

(5-30b) 

However, the proposed scheme, Equation 5-28b, has a problem in such cases where the finite 
difference value of (pls) cannot approximate the linear interpolation of the time rate change of 
the quantity,  acr;;.), adequately.  Usually, this tendency term is not available with the 
meteorological data.  However, when the tendency is available or can be estimated with the 
diagnostic relations for certain meteorological coordinate systems, a different interpolation rule 
must be sought.  Because the tendency term, not  (pls)  itself, is a component of the continuity 
equation, linear interpolation of the tendency may be more appropriate.  Then,  (pls) at the 
interpolation time step must be estimated in such a way that satisfies the continuity as well as the 
tendency term (Byun 1999b ). 

5.5 

Conclusion 

In this chapter I attempted to bridge the information gap between dynamic meteorologists and air 
quality modelers and to promote the proper use of meteorological information in air quality 
modeling studies.  It highlights the importance of dynamic consistency in meteorological and air 
quality modeling systems.  The effects of the common assumptions used for the atmospheric 
study on the mass conservation for trace species have been re"'.iewed.  Although meteorological 
data provided by operational meteorological models are usually self-consistent, air quality 
modelers need to evaluate the data for exact consistency before they can be used in air quality 
simulation.  Minor adjustment of the meteorological data may be needed to assure mass 
conservation of trace gas species in CTMs.  Also, characteristics of vertical coordinates have 
been discussed.  Certain coordinates provide diagnostic irelations that can be used to maintain 
mass consistency in meteorological fields.  When meteorological data are needed at sub-output 
time steps within CTM, the interpolation of the data should be done in such a way that the mass 
conservation and consistency in the thermodynamic variables are not compromised. 

In addition, the on-line and off-line.modeling concepts are discussed to provide design guidance 
for fully integrated meteorological-chemical models .. To realize the noble goal of implementing 
the one-atmosphere modeling system, both the multi-pollutant chemistry and multiscale physics 
capability in meteorology are needed.  The following are the features that make the CMAQ air 
quality model a suitable key component of an one-atmosphere modeling system: 

• 

• 

• 

• 

• 

• 

Flexible chemistry representations through a mechanism reader; 

Comprehensive list of atmospheric processes that are implemented; 

Modular coding structure and versatile data handling method; 

Capability to handle multiscale dynamics and thermodynamics; 

Fully compressible governing set of equations in generalized coordinates; and 

Robust mixing ratio conservation scheme, even with mass inconsistent meteorology data. 

At present, we are encouraged by the efforts of the WRF meteorology model development 
groups that focus on issues such as choice of coordinates, grid staggering method, state variables 
in the governing equations (e.g., fully compressible), conservation properties (mass and energy) 
both in the model equations and numerics, modulanty of code, data communication methods, 
and coding language.  This entails continuous exchange of ideas between the Models-3 CMAQ 
and WRF modeling groups. 

To achieve the true one:-atmosphere modeling system, we must address multi-pollutant and 
multiscale processes that are typically broader than any one group (or institution) has expertise to 
address.  The need is well summarized in Dennis (1998): 

· 

Considering additional needs for emerging environmental problems such as 
coastal eutrophication and ecological damage issues related with cross-media 
purview, encompassing the one-atmosphere scope is needed.  This means we have 
to work with a more complete one-atmosphere description to facilitate 
interactions within it as efficiently as broadly as possible.  One potential answer is 
to foster a community modeling perspective and model system framework that is 
supported and used by a critical fraction of the scientific community. 

5.6 

References 

Arakawa, A., C.R. Mechso, and C.  S. Konor, 1992: An isentropic vertical coordinate model: 
Design and application to atmospheric frontogenesis studies. Meteor.  Atmos. Phys. 50, 31-45. 

Arya, S. Pal, 1988i Introduction to Micrometeorology.  Academic Press, Inc., 307 pp. 

Batchelor, G.  K.,  1967: An Introduction  to  Fluid Mechanics.  Cambridge University Press,  615 
pp. 

:aenjamin, S.G., D.  Kim, and T.W.  Schlatter,  1995: The Rapid Update Cycle: A new mesoscale 
assimilation system in hybrid-theta-sigma coordinates  at the National  Meteorological Center. 
Second  International  Symposium  on  Assimilation  of Observations  in  Meteorology  and 
Oceanography, Tokyo, Japan, 13-17 March, 337-342. 

Benjamin, S.G., J.M. Brown, K.J. Brunge, B.E. Schwarts, T.G. Smirnova, and T.L. Smith, 1998: 
The operational RUC-2.  16th Conference  on  Weather Analysis and Forecasting,  Phoenix, AZ, 
Amer. Meteor. Soc., 249-252. 

Bishop, R. L. and S. I.  Goldberg, 1968: Tensor Analysis on Manifolds. Dover Publications, Inc. 
New York. 

Byun, D. W.,  1999a: Dynamically consistent formulations in meteorological and air quality 
models for multiscale atmospheric applications:  I. Governing equations in a generalized 
coordinate system. J.  Atmos. Sci., (in print) 

Byun, D. W., 1999b: Dynamically consistent formulations in meteorological and air quality 
models for multiscale atmospheric applications:  II. Mass conservation issues. J.  Atmos.  Sci., (in 
print) 

.. 

Byun D. W., A .. Hanna, C. J.  Coats, and D. Hwang, 1995a: Models-3 Air Quality Model 
Prototype Science and Computational Concept Development. Trans.  TR-24  Regional 
Photochemical Measurement and Modeling Studies, San Diego, CA, of Air &  Waste 
Management Association, 197-212. 

Coats, C. J., cited 1996: The EDSS/Models-3 VO Applications Programming Interface. MCNC 
Enviromnental Programs, Research Triangle Park, NC. [Available on-line from 
http://www.iceis.mcnc.org/EDSS/ioapi/H.AA.html.] 

Defrise, P., 1964: Tensor Calculus in Atmospheric Mechanics. Advances in Geophysics 10, 261-
315. 

. 

DeMaria, M., 1995: Evaluation of a hydrostatic, height-coordinate formulation of the primitive 
equations for atmospheric modeling. Mon.  Wea.  Rev.,  123, 3576-3589. 

Dennis, R.L.,  1998: The environmental protection agency's third generation air quality modeling 
system: an overall perspective. Proceedings of the Ameri.can Meteorological Society 78th 
Annual Meeting, Phoenix, AZ, Jan.  11-16, 1998. 255-258. 

Dudhia, J., D. Gill, J. Klemp, and W.  Skamarock, 1998: WRF: Cuurrent status of model 
development and plans for the future.  Preprints of the Eighth PSU/NCAR Mesoscale Model 
User's Workshop. Boulder, Colorado, 15-16 June,  1998. 

Dutton, J. A.,  1976: The Ceaseless Wind,  an Introduction to the Theory of Atmospheric Motion. 
McGraw-Hill, 579 pp. 

Dutton, J. A., and G. H. Fichtl, 1969: Approximate equations of motion for gases and liquids. J. 
Atmos. Sci., 26, 241-254. 

Gal-Chen, T., and R. C. J.  Somerville, 1975: On the use of coordinate transformations for the 
solution of the Navier-Stokes equations. J.  Comput.  Phys., 17, 209-228. 

Kalany, E., and Co-authors, 1996: The NCEP/NCAR 40-year Reanalysis Project.  Bull. Amer. 
Meteor.  Soc., 77, 437-471. 

Leese, J. A.,  1993: Implementation Plan for the GEWEX Continental-Scale International Project 
(GCIP). Int. GEWEX Project Office #6, 148 pp. [Available from IGPO, 1100 Wayne Ave., Suite 
1225, Silver Springs, MD 20910]. 

Lipps, F. B., and R.  S.  Hemler, 1982: A scale analysis of deep moist convection and some related 
numerical calculations. J.  Atmos. Sci., 39, 2192-2210. 

Nance, L.B., and D.R. Durran, 1994: A comparison of the accuracy of three anelastic systems 
and the pseudo-incompressible system. J.  Atmos. Sci., 51, 3549-3565. 

Ogura, Y., and N. W. Phillips, 1962: Scale analysis of deep and shallow convection in the 
atmosphere. J.  Atmos. Sci.,  19, 173-179. 

Ooyama, K. V.,  1990: A thermodynamic foundation for modeling the moist atmosphere. J. 
Atmos. Sci., 47, 2580-2593. 

Pielke, R. A.,  1984: Mesoscale Meteorological Modeling.  Academic Press, 612 pp. 

Scamarock, W.  1998: Personal communication. 

Schulze, R.H., and D. B. Turner, 1998: Potential use of NOAA-archived meteorological 
observations to improve air dispersion model performance.  EM, March 1998, 12-21. 

Seaman, N. L,  1995: Status of meteorological pre-processors for air-quality modeling. 
International Conf on Particulate Matter, Pittsburgh, PA, Air &  Waste Management 
Association, 639-650. 

Seaman, N.L., 1999: Meteorological modeling for air-quality assessments. (Submitted to Atmos. 
Environ., 32, 87pp.) 

Stull, R. B., 1988: An Introduction to Boundary Layer Meteorology.  Kluwer Academic 
Publishers. 666 pp. 

Thunis, P. and R. Bornstein, 1996: Hierarchy ofmesoscale flow assumptions and equations. J 
Atmos. Sci., 53, 380-397. 

V9gel, B., F. Fiedler, and H. Vogel, 1995: Influence of topography and biogenic volatile organic 
compounds emission in the state of Baden-Wurttemberg on ozone concentrations during 
episodes of high air temperatures. J  Geophys.  Res., 100, 22,907-22, 928. 

Xiu, A., R. Mathur, C. Coats, and K. Alapaty, 1998: On the development of an air quality 
modeling system with integrated meteorology, chemistry, and emissions. Proceedings of the 
International Symposium on Measurement a/Toxic and Related Air Pollutants, Research 
Triangle Park, North Carolina, 1-3 September, 1998.  144-152. 

This chapter is taken from Science Algorithms of the EPA Mode/s-3 Community 
Multiscale_ Air Quality (CMAQ) Modeling System, edited by D. W. Byun and J. K. S. 
Ching, 1999. 

Appendix SA. Tensor Primer and Derivation of the Continuity Equation in a Generalized 
Curvilinear Coordinate System 

The Appendix SA summarizes essential information needed for understanding the goyerning 
equations represented in tensor form.  It includes tensor primer and derivation of the continuity 
equation in a generalized coordinate system.  Readers are referred to classic references such as 
Dutton (1976), Defrise (1964), and Pielke (1984) for the details. 

5A.1  Tensor Analysis in a Curvilinear Coordinate System 

Cartesian coordinates are those curvilinear systems in which the positions of fluid elements are 
determined by their distance from intersecting planes.  Al1hough the Cartesian coordinates with 
orthogonal intersecting planes are specifically called rectangular, the adjective rectangular is 
often dropped.  To represent formulations governing atmospheric phenomena in a coordinate 
system other than a rectangular Cartesian one, a tensor representation is often used.  This 
generally involves determination of the unit vectors in the new system, determination of the 
components of a tensor with respect to theses unit vect?rs, and determination of the differential 
derivatives (e.g., divergence, curl, and gradient) of a tensor.  All these quantities depend 
explicitly on the form of the new coordinate system and it is always convenient to express these 
quantities in a rectangular Cartesian coordinate system for comparison purposes. 

In atmospheric modeling one is frequently led to adopt a curvilinear coordinate system other than 
the Cartesian coordinates depending on the problem under consideration.  A general curvilinear 
coordinate system can be defined relative to a Cartesian system x  = (x 1 .x2 ,x3
three families of curved surfaces 

)  represented by 

•  1 2 3 
x  = 1/f;  x  ,x  ,x· ,t , i  =  , , 

Aj 

2 

I 

( 

3 

) 

(SA-1). 

Here, the symbols with carat(") are used to denote a transformed curvilinear system.  In vector 
form, it is given as: 
x= 'fl(.x,t). 

(SA-2) 

), are three: independent, single-valued, and 

), then the system is called a Euclidean system.  Here we 

When the curvilinear system 1Jf is at rest relative to the rectangular Cartesian system, i.e., 
independent of time,  xi= 1/f;(x1 ,x2 ,x3
assume that components of vector i, (x1 ,x2 ,x3
differentiable scalar point functions such that to every point of some region 9t of three(cid:173)
dimensional Euclidean space, there is a corresponding unique triple of values  (x 1,x2 ,x3
Cartesian space  9t.  In other words, the function 1Jf prescribes one and only one value of x  and is 
such that the three coordinates are independent  of each other.  Also, we assume continuity of the 
function lfl.  Then the new coordinates  i  are called curviUnear and the surfaces  x1 =  1ff1 = 
constant,  x2=  1/f2  =constant,  x3=  1ff3  =constant are called coordinate surfaces.  The curvilinear 
coordinates  (x1 ,x2 ,x3
)  should be independent, single-valued, and differentiable.  As shown in 

)  in the 

Figure SA-1, the vector OP  pointing a parcel of air enclosed by the boundary ail can be 
represented either in Cartesian or Euclidean curvilinear coordinate systems. 

3-x  -z 

2 -x  -y 

I -
X  -x 

Figure SA-1.  Coordinates of the Cartesian and Curvilinear Coordinates.  9\ and 9't  represent 
Cartesian and Euclidean spaces, respectively. 

Note that the transformation involves with not only the spatial variables but also time as an 
independent variable.  We need a tensor calculus in the four variables of space-time with regard 
to the coordinate transformations.  Defrise (1964) used the term 'world tensor' to distinguish it 
from the time independent Euclidean tensor. 

5A.2  Basis Vectors 

In a rectangular coordinate system, directions of the basis vectors are constant in space. 
However, in a general curvilinear coordinates, directions of the basis vectors will vary from point 
to point and no one set of directions can be regarded as more natural than any other for the 
directions of base vectors to defme the local base vectors.  Usually, an upper index denotes 
contra variant, and a lower index denotes covariant tensors, respectively. 

With the coordinates defined by Equation SA-2, the chain rule provides the two expansions: 

d  - ax  J!',.j 

X - - .  U>I. 

ai' 

(5A-3) 

5-32 

,J~i 
UJL  =-.  = 

:L"!i 
OX  dxi 
ax1 

(V"i)  d 
•  x 

x 

EP A1600/R-99JD30 

(5A-4) 

Here, the Einstein summation convention (i.e., the repeated indices on two quantities that are 
multiplied by each other are summed over) has been implied.  The symbol(•) represents the 
inner product.  An inner product of two vectors yields a scalar that is invariant of the coordinate 
system.  An inner product of two tensors results in contraction of the rank in the resulting tensor. 

From Equations 5A-3 and 5A-4, we can form two distinct sets of basis vectors.  One is the 
tangential vectors: 

(5A-5) 

that reveals the variation of the position vector as it traces out a curve in which .Xi  varies and the 
other two coordinates are constant.  Hence  ~ is tangent to the curve along which only .Xi  varies. 
The other set of basis vectors is the normal vectors of the surfaces where  xi  =  constant: 

(5A-6) 

While there could be many choices, the tangential  ( 1i) and normal (ii) vectors are considered as 
a natural choice for the local basis vectors for the curvilinear coordinate system.  Using 
Equations 5A-5 and 5A-6, one can show that: 

,.. 
'f. ® 171  = 8! = 

,.. .  . {1  i = j 

0  i'#j 

I 

I 

(5A-7) 

where 8/ is the Kronecker delta and the symbol ®  represents the outer product.  Outer product 
of two tensors with rank r 1 and r2 yields a tensor with rank (r 1+r2  ). 
A curvilinear system is not orthogonal when not all the off-diagonal components of f]i  ® W and 
fi ®  fi  vanish.  The orthogonal curvilinear coordinate system is often used for interesting 
engineering problems that can be described with simple geometric orthogonal coordinates, such 
as spherical, cylindrical coordinate systems.  Usually, meteorological coordinates are not 
orthogonal and therefore, the vector calculus specific for the orthogonal curvilinear coordinates 
must not be used. 

SA.3  Distance and Metric Tensor in a Curvilinear Coordinate System 

The differential element of distance ds can be expressed in terms of the curvilinear coordinates 
as: 

(5A-8) 

Because of its obvious role in the measurement of distance, the quantity  yik  is called the metric 
tensor.  It is a symmetric tensor.  As such, it has an inverse matrix yik, which will satisfy 
following condition: 

(5A-9) 

"ik 

:L~i  :t..~k 
U,Ji,  U,Ji, 

r  = ax,  ax,  =  ., 

ni@ nk 

., 

(SA-10) 

(5A-11) 

The Levi-Cevita symbol e used in Equation 5-1  is an antisymmetric tensor defined as 

eijk = 

if  i = j,  j  = k,  or  i = k 

. 
0 
1  if  i, j, k  are  an  even  permutation  of  1, 2, 3 
-1  if  i,j,k  are  an  odd  permutation  of  1,2,3 

{ 

(5A-12) 

Using the Levi-Cevita symbol, the cross vector product  A =Bx C  can be written as 
At= e'ii: BJCk. 

One of the uses of the metric tensor and its inverse is for converting a covariant tensor to a 
contravariant tensor, and vice versa.  Another important usage of the metric tensor is the 
estimation ofthe Jacobian determinant of the transformation, which is defined as: 

(SA-13) 

where  J = 1{1:}1 =  ac:1

2
· :

3
· :
d(XpX2 ,X3 ) 

)  •  Note that the Jacobian matrix and the metric tensor are related 

as: 

(5A-14) 

A necessary and sufficient condition that (x1 ,£2 ,x3
components of the metric tensor vanish for i :t: j. 

)  be orthogonal at every point in  9\ is that the 

SA.4  Covariant Tensor and Contravariant Tensor 

In this section, the covariant and contravariant tensor concepts are presented using a vector, 
which is a simple form of a tensor (i.e., a tensor of rank one).  A distance in a Euclidean space 
can be represented in two corresponding sets of tangential basis vectors: 

5-34 

s =  x  'rj = 
d 

d "j" 

dxl 

-r, 

where 

EPA/600/R-99/030 

(5A-15) 

(5A-16) 

Any vector that transforms similarly to the tangential basis vector  ~ is called as a covariant 
vector.  On the other hand, when a vector transforms like the local normal basis vectors  ii, we 
call it a contravariant vector: 

"k 
j 
v  =-.v 
' 

::t.~k 
O.JC 
()x' 

(5A-17) 

where vi  is the components of V with respect to the normal base vectors. 

Since a vector A is invariant between coordinate systems, we can express it using either 
contravariant components (i.e., with the tangential basis vectors) or covariant components (i.e., 
with the normal basis vectors): 

l"' 
A=A/71  =A-r1 

,..  . 

(5A-18) 

Using Equation 5A-7, one can readily find the covariant and contravariant components with: 

(5A-19a) 

(5A-19b) 

SA.5  Derivatives, Total Derivative, and Divergence in Euclidean Coordinate 

Covariant derivative of a contravariant vector is defined as: 

"· 

V" i  _  av· 
;k  - axk  +  kj 

r." iv" j 

, 

Similarly, covariant derivative of a covariant vector is defined as: 

(5A-20) 

(5A-21) 

The Christoffel symbol I'icJ  is not a tensor but it is an important quantity relating the derivatives 
in the curvilinear coordinate system with those in the original Cartesian coordinate system.  Its 
relation with the metric tensor is: 

5-35 

Divergence of a contravariant vector W , wind for example, can be expressed as: 

A 

(5A-22) 

(SA-23) 

The total derivative of a covariant vector A  is represented in a Cartesian coordinate as 

(SA-24) 

dA = aA + v. v A  = a~ +vi a~ 
dt 
()Xi 

dt 
I  a  Ai  ax1  a  Ai  a 

dt 

V 

h 

= V  ()xi  = V  ()Xi  ()xi  = V  ()Xi  Was use  . 

W  ere  V • 
coordinate system where the covariant comp~nentA1, metric tensor, velocity, andx!' all refer to 
the same system whether or not the coordinate system is time dependent. 

. 
S expression lS correct lll any  0  onom1c 

d  Thi 

h  1 

. 

. 

. 

SA.6  Continuity Equation in Generalized Curvilinear Coordinate System 

Many practical coordinate systems used for atmospheric studies are time dependent.  Consider 
the case when a volume element that confines the fluid moves with the fluid.  Then, this is also 
the velocity of the fluid in the respective coordinate system.  A direct conversion from the 
continuity equation expressed in a Cartesian coordinate system does not work because the 
divergence term should take into account for the time rate change of volun1e element as well the 
same for the time dependent curvilinear coordinates.  In this situation, the Lie derivative concept 
(e.g., Bishop and Goldberg, 1968) becomes appropriate.  A Lie derivative is obtained by 
differe11ti.~1ing a function with respect to the parameters along the moving frame of reference. 
Following Defrise (1964), one can show that a Lie derivative of a mass volume integral along the 
moving frame vanishes: 

~(OM.) =0 

av~cp.jf) = sV<vµ a~f + p.ff ;: ) 

= av acpjf vµ)  = o 

axµ 

5-36 

(SA-25) 

(SA-26) 

where, indexµ= 1,4;  x4  = t  and v4 =1.  Using the same notation convention, the contravariant 
velocity is defined as for the coordinates that moves with fluid: 

EPA/600/R-99/030 

(SA-27) 

Note that one cannot derive the same result by directly replacing the divergence term in the 
continuity equation for a Cartesian coordinate system because the volume element is dependent 
on time as well. 

Alternatively, one can obtain Equation SA-26 by a method based on the finite derivative of a 
volume integral with the application of the Leibnitz rule.  This method of derivation helps to 
visualize the meaning of terms in the equation more clearly than the procedure based on the Lie 
derivative.  Volume integral in a Cartesian coordinates is defined as: 

F= JfJ1cx 1,x2,x3 )cW 

on 

(SA-28) 

where/is a conservative quantity, such as density or total kinetic energy.  Equation SA-28 can 
be rewritten in the cilrvilinear coordinate as: 

F= JfJ1cx1,.x2,x3)./Y8V 

on 

For example, if/=1: 

F = Jff  cW = von = fJJ  .fYD\I = .fYvon 

on 

on 

on 

(SA-29) 

(SA-30) 

(SA-31) 

The meaning of the metric becomes very clear-it is a measure of volume correction for the 
transformed coordinates. 

F = JJJ Jc.xi ,.x2 ,x3)./YW = JJJ h(x1 ,.x2 ,.x3)&1&2&3 

on 

where h(x1 ,x2 ,x3

)  = f(x 1 ,x2 ,x3).fY was used. 

Consider a time derivative following the control volume.  Applying a three-dimensional version 
of Leibnitz mle for the time differential of the integral, we get: 

Then, using the following relation with the aid of Figure SA-2: 

( 

..Jt-.2 

J +zh  _cu_ 
il  :i 
·lax 
"• 

dt  bd 

) 

..J!'..2 

8£2 = h(x;)-CM.-b - h(x;)-CM.-" 
dt 

dt 

..J!'..2 

we obtain an integral equation: 

=JII{ah +3-(hdi1I J+-4-(hdi2I J+-4-(hdx3I J}u1ae&e3 

dt 

bd 

c1X3 

dt 

bd 

oFI 
lit  fol/aw/nz 

W>lume 

at 

c1x1 

an 

dt 

bd 

ax2 

(SA-32) 

(SA-33) 

(SA-34) 

!"""-~:-.-_.,, -'--_..... .... di; ot 

dt 

Figure SA-2.  Volume Element in a Curvilinear Coordinate System 

When f  = p  (density), thenF = JJI p(x1 ,x2 ,x3)&1& 2& 3  = M  =mass of the volume element. 

en 

Therefore, the conservation law states: 

oFI 
ot  following 

volume 

= oMI 

Here, for example,  dX

dt  bd 

=O 

volume 

ot  following 
2 I is the velocity of the boundary of the volume element in the curvilinear 

(5A-35) 

coordinate  £2
velocity component of the fluid in the curvilinear coordinate x2

•  Because the volume element confines the fluid and moves with the fluid, this is 

•  Then, we have 

(5A-36) 

Since above integral should be satisfied for an arbitrarily infinitesimal volume element, we 
obtain the continuity equation in differential equation fonn for the time-dependent curvilinear 
coordinate as follows: 

- (5A-37) 

5-39 

EPA/600/R:-99/030 

Chapter 6 
==============

GOVERNING  EQUATIONS  AND  COMPUTATIONAL  STRUCTURE  OF  THE 

COMMUNITY  MULTISCALE  AIR  QUALITY  (CMAQ)  CHEMICAL  TRANSPORT 

MODEL 

Daewon  W.  Byun*  and  Jeffrey  Young** 

Atmospheric Modeling Division, 

National Exposure Research Laboratory 
U.S. Environmental Protection Agency 

Research Triangle Park, NC 27711 

M. Talat Odman"** 

MCNC-Environmental Programs 

P.O. Box 12889, 3021  Cornwallis Road 

Research Triangle Park, NC 27709-2889, USA 

ABSTRACT 

The chemical transport model (CTM) of the Models-3/CMAQ (Community Multiscale Air 
Quality) modeling system can be configured to follow the dynamics of the preprocessor 
meteorological model.  A science process module in the CMAQ CTM is not specific to a 
coordinate system.  The generality is accomplished through the use of the coordinate 
transformation Jacobian within the CMAQ CTM.  In this chapter, we derive the governing 
diffusion equation in a generalized coordinate system, which is suitable for multiscale 
atmospheric applications.  We describe the CMAQ system's modularity concepts, fractional 
time-step formulation, and key science processes implemented in the current version of the 
CMAQ CTM.  We examine dynamic formulations of several popular Eulerian air quality models 
as emulated by the governing diffusion equations in the g1eneralized coordinate system.  Also, a 
nesting technique for the CMAQ CTM is introduced.  Finally, because the amount of a 
substance in the atmosphere can be expressed in many different ways, we summarize the most 
popular expressions for concentration and their transfomiation relations. 

·on assignment from the National Oceanic and Atmospheric Administration, U.S. Department of Commerce. 
Corresponding author address: Daewon W. Byun, MD-80, Research Triangle Park, NC 27711. 
E-mail: bdx@hpcc.epa.gov 
** On assignment from the National Oceanic and Atmospheric Administration, U.S. Department of Commerce. 
*** Present Affiliation: Georgia Institute of Technology, Atlanta, GA. 

GOVERNING EQUATIONS AND COMPUTATIONAL STRUCTURE OF THE 

6.0 
COMMUNITY MULTISCALE AIR QUALITY (CMAQ) CHE1.\1ICAL TRANSPORT 
MODEL 

' 

. 

. 

' 

II 

• 

' 

• 

In Chapter 5, "Fundamentals of Atmospheric Modeling ... " we discussed the :fundamental set of 
equations for atmospheric dynamics and thermodynamics in a generalized coordinate system.  In 
this Chapter, we investigate the diffusion equation for the trace species in the atmosphere in the 
generalized coordinate system and the computational structure of the Community Multiscale Air 
Quality chemical transport model (CMAQ CTM or, hereafter, CCTM). 

One requirement of the CMAQ modeling system is to maintain a consistent description of the 
atmosphere for different meteorological and chemical transport mo~els.  This is a feature that is 
essential for spatial scalability.  Various coordinate systems are used in atmospheric models. 
Selection of a suitable coordinate system is an important step of model formulation.  There are 
numerous criteria to be considered in selecting a coordinate system, such as the dynamic 
characteristics it can handle and how well it can deal with curvature of the earth's surface and 
features of the terrain.  Formulation of the models may vary substantially for different coordinate 
systems.  If a CTM can be formulated and coded using a generalized coordinate system, it would 
be easy to switch from one coordinate to another depending on the application.  The generalized 
coordinate concept is useful becau~e a single CTM formulation can adapt to any of the 
coordinates commonly used in meteorological models.  It is also desirable to compare the benefits 
of various coordinate systems and to be able to link the CTMs to meteorological models and 
databases in different coordinates. 

Conformity of the coordinates to the physics of the problem is very important.  Unlike a model 
with a fixed coordinate system, a generalized coordinate system allows use of generic coordinates 
for the specific science processes within a model.  Although the model's overall structure is 
determined by the choice of a coordinate system, the individual science modules can still use their 
own generic coordinates that best suit the. physical processes they model.  This means that each 
science process can utilize the parameterizations based on the best coordinate to represent the 
problem.  For example, the planetary boundary layer (PBL) parameterizations can be expressed 
in terms of geometric height, or dimensionless height scaled with PBL height, while for cloud 
physics, they can be represented in terms of pressure.  The linkages between the generic 
cootdinate parameterizations in the science processes and the governing conser\ration equation in 
the generalized coordinates are established through the application of appropriate coordinate 
transformation rules. 

Here, we intend to provide a comprehensive and rational development of the governing 
conservation equation in generalized coordinates, which can be readily implemented in an Eulerian 
model.  The operating assumptions used for the derivations are listed below (see Srivastava et al., 
1995). 

• 

Assumption 1: Pollutant concentrations are sufficiently small, such that their presence 
would not affect the meteorology to any detectable extent.  Hence, the species 
conservation equations can be solved independently of the Navier-Stokes and energy 
equations.  The conditions which could invalidate this assumption are for cases where 
sufficient heat is generated by chemical reactions to influence the temperature of the 
medium or where an atmospheric layer become so concentrated with pollutants that 
absorption, reflection, and scattering of radiation alter the air flow (Seinfeld, 1986). 

Assumption 2: The velocities and concentratfons of the various species in atmospheric 
flow are turbulent quantities and undergo turbulent diffusion.  Because turbulent diffusion 
is much greater than molecular diffusion for most trace species, the latter can be ignored. 

Assumption 3: The metric tensor that defines the coordinate transformation rules is not a 
turbulent variable.  This means that we Call define the coordinates based on the Reynolds 
averaged quantities.  The vertical grids will be defined incrementally between time steps 
when a time-dependent vertical coordinate is used. 

Assumption 4:  The ergodic hypothesi's holds for the ensemble averaging process.  This 
means that the ensemble average of a property can be substituted with the time average of 
that property. 

Assumption 5: The turbulence is assumed stationary for the averaging time period of 
interest (say 30 minutes to one hour for atmospheic applications). 

Assumption 6:  The source function (i.e., emissions of pollutants) is deterministic for all 
practical purposes and there is no turbulent component. 

Assumption 7: The effect of concentration fluctuation on the rate of chemical reaction is 
negligible, i.e., contributions of covariance effects among tracer species are neglected. 

Assumption 8:  Because the large-scale motions of the atmosphere are quasi-horizontal 
with respect to the earth's surface, science processes can be separately represented in 
horizontal and vertical directions (i.e., quasi-orthogonal in transformed coordinates). 

• 

• 

• 

• 

• 

• 

• 

6.1 

Derivation of the Atmospheric Diffusion Equation 

In Chapter 5, we derived the species continuity equation in generalized coordinates.  It is given 
as: 

(6-1) 

where <fJ;  is the trace species concentration in density units (e.g., kg m"3
Jacobian of the terrain-influenced coordinates, m is the map scale factor, \I:,  and 8  are horizontal 
and vertical wind components in the generalized coordinates, and Qcp, 
is the source or sink term. 

),  J.  is the vertical 

To make the instantaneous species continuity equation useful for air qtiality simulation, we need 
to derive the governing diffusion equation.  This is done by decomposing the variables in 
Equation 6-1, except for the Jacobian and map scale factor, in terms of mean and turbulent 
components.  The Reynolds decompositions of species concentration and mixing ratio are 
expressed as: 

<pi = <pi + <p, II 

<pf + <p, II= "iftp +qi II 75 + 7f;pll +qi II p" 

(6-2a) 

. (6-2b) 

(6-2c) 

p 

where  q1 = <p,  is the species mass mixing ratio and a stochastic quantity is decomposed into 
mean , O, and turbulent,  ("), components.  Stationary turbulence assumption 5 implies that a 
turbulent component has a zero mean for the averaging period.  Following Venkatram (1993), we 
can estimate the mean and turbulent components of species and air concentrations as 

q,llp" 
--=--<<1 
q,p 

p112 
(/5)2 

(6-3a) 

(6-3b) 

(6-3c) 

Without loss of generality, we redefine the terrain-influenced vertical coordinates with a 
coordinate  X3  , whose value is increasing monotonically with height, as: 

x3 = ~ = {  s 
1- s 

(if  s  increases  with  height) 
(if  s  decreases  with  height) 

(6-4) 

The choice of a generalized vertical coordinate which increases monotonically with height 
simplifies the derivation of the governing equation and thtls reduces the likelihood of making sign 
errors in the formulas and in computer codes.  The transformation does not change the horizontal 
wind components or the Jacobian, which is always defined to be a positive quantity.  Hereafter, 
the subscript s is replaced with ~ to reflect modification of the vertical coordinate.  Subsequently, 
the vertical v~locity is represented with v3 = d~ I dt = g, which is positive for upward motion. 
Application of decomposition of velocity components in Equation 6-1  and ensemble averaging 
produces Reynolds flux terms in the mass conservation equation as: 

(6-5) 

where we used  Jf.  = Jf. and  ~' = ~' based on Assumption 3 and Assumption 6, respectively. 
The Reynolds flux terms in Equation 6-5 can be approximated in terms of the mixing ratio. as: 

'lf;p"Vf," << 1 

(6-6a) 

.·  (6-6b) 

(6-6c) 

(6-6d) 

in which we have neglected the second order perturbation terms based on the scale analysis of the 
equations.  Equation 6-5 can be rewritten using Equations 6-3a-c and 6-6a-c to give: 

+mzv  •  p  ' 

.  .q."V "J  ]· 
(

f, 
m2 

f,  + 

c 

iJ(pq."v3"J) 

.  , 

~3 

c  = J  n 
. 
f.~1 

. . (6-7) 

The turbulence flux terms can be parameterized using a simple closure scheme such as the eddy 
diffusion concept (K-theory):. 

"'31  (}Q.. 
--,..-
q."u "=-K  _'2'._• • q."v "=-K  _'2'._•.  q."v  "=-K  _'2'._• 
!;  · 
~l 
' 

"21  (}a.  --;-3 

--,..-
!; 
·  1. 

"II (Ja.. 

~I ' 

~l ' 

I 

I 

(6-8) 

where  K.11 .denotes the eddy diffusivity tensor in the transformed coordinate.  The eddy 
diffusivity tensor for the generalized meteorological coordinates is related to the diffusivity 
tensor in Cartesian coordinates as: 

:'.\..~k 

Kkl  = _o;i;_. _o;i;_. Kii 

:i..~l 

. 

ax·  ax1 

(6-9)• 


If we postulate that the diffusivity tensor in Cartesian coordinates is diagonal (i.e., all the off(cid:173)
diagonal components vanish), then the eddy diffusivity tensor in the generalized meteorological 
coordinates becomes: 

m2K 
xx 

0 

K= 

0 

ax3 

m dx.Kxx  m-K 

yy 

m2K 
yy 
ax3 
dy 

m-K 
xx 

ax3 
ax 
ax3 

m dy  KYY 

(6-10) 

('!1 )2 Kxx  + (~ )2 KYY  + (~ )2 Ku. 

where  Kxx = K 11

,  KYY  = K22 , and  Ku.  = K33  are the diagonal components of eddy 

diffusivity tensor in the Cartesian coordinate.  To match with the computational grid, the gradient 
terms in Equation 6-10 must be rewritten in terms of the generalized coordinates  .£3  (defined 
based on height above ground  hAGL  = h- z.ifc, where  z.efc  represents the height of topography) 
using the appropriate chain rules, for example,  ~ ( ~) z = (:;; ) x
= x3

:  ( ;  ) ( : ;  )  x

•  When A 

,  we get 

-

3 

3

m2K xx 

0 

K= 

0 

m2K yy 

(6-11). 

Then the non-zero diffusion terms in Equation 6-7 can be parameterized with the eddy diffusion 
theory as follows: 

and 

(6-12) 

(6-13) 

6-6 

Rewriting Equation 6-7 with Equations 6-12 and 6-13, and separating the diagonal and off(cid:173)
diagonal diffusion terms with an explicit description of the source terms, one can obtain the 
governing atmospheric diffusion equation in the generalized coordinates where the turbulent flux 
terms are expressed with the eddy diffusion theory: 

EP A/600/R-99/030 

(a) 

(b) 

(c) 

_  z~[P1~ cK.11  aqi)]- 2_}_[P1~ cftzz  aqi )J-~[-1 cK.33  ~ )] 
m axi  m2 

axi  m axz  m2 

ax3  p  ~ 

axz 

ax3 

(d) 

(e) 

_  2 ~[pl~ cK.13  aqi )]- 2 _}_[Pl~ ck23  aqi )] 
m axi  m2 

JX3  m axz  m2 

ax3 

(t) 

(g) 

-

-

=l~~;(<fJp••••<fJN)+l~(4,; +  dt 

d(qi;l~) 

d(<p;l~) 

+  dt 

d(<p;l~) 

+ 

dt 

(6-14) 

cltl 

aero 

ping 

(h) 

(i) 

(k) 

(1) 

The terms in Equation 6-14 are summarized as follows: 

(a) time rate of change of pollutant concentration; 
(b) horizontal advection; 
( c) vertical advection; 
( d) horizontal eddy diffusion (diagonal term); 
(e) vertical eddy diffusion (diagonal term); 
(t) off-diagonal horizontal diffusion; 
(g) off-diagonal vertical diffusion; 
(h) production or loss from chemical reactions; 
(i) emissions; 
G) cloud mixing and aqueous-phase chemical production or loss; 
(k) aerosol process; and 

(1) plume-in-grid process. 

Note that the dry deposition process can be included in the vertical diffusion process as a flux 
boundary condition at the bottom of the model layer: 

Alternatively, we can express the turbulent flux terms in Equation 6-7 using the Reynolds flux 
terms defined as: 

· 

q II u 11  = frt  q. 11 v 11  = fr2  q 11V311 = fr3 

i 

~ 

91  ' 

and the turbul~nt flux terms are related with the Cartesian counterpart using  ~~ = :i F j, : 

.  "-k 

91  ' 

~ 

q; 

I 

I 

(6-15) 

F" I  _ 
91  - m  q, ' 

F,;  p" 2  _ 

q;  - m  q;  ' 

FY  p" 3  _  (-OA-)F,; 

q,  -

'.l.~3 

ax 

'.l.~3 

'.l.~3 

(-OA-)FY 

q,  +  ()y 

q,  +  (}z 

(-OA-)Fz 
q, 

(6-16) 

In comparison with Equation 6-14, the Reynolds flux terms shown in Equation 6-15 include the 
off-diagonal components.  One can now rewrite the governing conservation equation for trace 
species equivalently to Equation 6-14 in terms of the Reynolds flux terms: 

2 a [pl~ "1 J  2 a [pl~ "2]  a [- "3] 
. +m  dXl  m2  ~I  + m  dX2  m2  ~I  + dX3  pJ~~i 

(6-17) 

The governing equation can be simplified for a domain with gentle topography for which one may 
ignore all the terms involved with the horizontal gradients of the surface normal to the vertical 
coordinate.  This forces the vertical diffusion terms in the curvilinear coordinate system to be 
identical to those of the orthogonal Cartesian coordinate system. Then the trace species 
conservation equation can be written in a simpler form: 

=  Gr" R  (<p 

"\/ "{ 

'Pt 

<p  ) +  Gr" s  + iJ(cp;)I  + iJ(cp;)I  + iJ(cp;)I 

1' ... ,  N 

"\/ f 

'P1 

at 

cld 

at 

. 

prng 

at 

aero 

(6-18) 

where cp; =..[Yep;= U1:, I m2 )<fJ;·  In writing Equation 6-18, we have explicitly identified terms to 
directly relate to science process modules implemented in the CMAQ.  Equation 6-18 is similar 
to the conservation equation in the generalized coordinates as suggested by Toon et al. (1988). 

6.2 

Representation of Science Processes  in  CMAQ Modeling System 

This section describes how the CMAQ modeling system is structured to accommodate many 
different science process modules that provide a one-atmosphere, multiscale and multi-pollutant 
modeling capability to the CMAQ system.  First, we describe the modularity concepts and key 
science processes implemented in the current version of CMAQ.  Then the governing fractional 
time-step formulation for each science process is presented. 

6.2.1  Supporting Models and Interface Processors 

Key supporting models for the current version of the CMAQ modeling system are the 
Mesoscale Model Version 5 (MM5) (Seaman et al.,  1995)and Models-3 Emissions Processing 
and Projection System (MEPPS).  The CMAQ modeling system is comprised of the main 
CMAQ chemical transport model (CCTM) and several interface processors that link other model 
input data to the CCTM.  The Meteorology-Chemistry Interface Processor (MCIP) processes 
MM5 output to provide a complete set of meteorological data required for CCTM.  MCIP is 
designed in such a way that other meteorological models can be linked with minimal effort.  Initial 
and boundary conditions are generated with the ICON arid BCON processors, respectively, and 
the Emissions-Chemistry Interface Processor (ECIP) combines area and point source emissions 
to generate three-dimensional gridded emissions data for CCTM.  In addition, a plume dynamics 
model (PDM) is used to provide dimensions and positions of plumes from major elevated point(cid:173)
sources.  The PDM data are used for driving the plume-in-grid processing in CCTM.  A 
photolytic tate constant processor (JPROC) which is based on the RADM (Chang et al.,  1987) 
approach, computes species specific photolysis rates for a set of predefined zenith angles, 
latitude, and altitudes.  An alternative detailed-science version adopts state-of-the-science 
radiative transfer models that can take into account the total ozone column (TOMS data) and 
turbidity.  Refer to Table 6-1  for the list of the interface processors in CMAQ and Figure 6-1  for 
the data linkage among these interface processors. 

By assembling appropriate science modules available in the CMAQ system, users can build a 
specific CCTM' s that may include all or some of the critical science processes, such as 
atmospheric transport, deposition, cloud mixing, emissions, gas- and aqueous-phase chemical 
transformations, and aerosol dynamics and chemistry.  One of the features of CMAQ that 
distinguishes it from other air quality models is the hierarchical functional modularity of the 
science processor codes.  We define the levels of modularity in the science model based on the 
granularity of the modeling components.  The coarsest level of modularity is the distinction 
between the system framework and science models.  The second level is the division of science 
sub-models (MM5, MEPPS, and CMAQ).  The third level of modularity involves a driver 
module, processor modules, data provider modules, and a utility module (a collection of assisting 
subroutines) in a CTM.  While the emissions processing and the meteorology model are modular 
at the second level, the CCTM achieves the third-level of modularity by employing the operator 
splitting, or fractional time step, concept in the science processes.  The next level of modularity 
is based on th~ computational functionality in a processor module, e.g., science parameterization, 
numerical solver, processor analysis, and input/output routines.  The lowest meaningful 
modularization level is the isolation of sections of code that can benefit from machine dependent 
optimization. 

6.2.2  Modularity Concept of CMAQ 

To allow for both the continuous improvement of science and for the addition of new capabilities 
in. a unified fashion, it is critical to have efficient modular schemes in the CMAQ design. 
Currently, the modularity within CMAQ is based mostly on the fractional time-step 
implementation of the science processes.  This level of modularity involves the distinction of a 
driver, processor modules, data provider modules, and utility subroutines in CMAQ.  We have 
chosen this method because it provides a natural disciplinary distinction for different science 
processes through which developments in specific research areas can readily be incorporated 
(Refer to Figure 6-2). 

In some of the process modules, such as the aqueous-phase chemistry module, the science 
algorithms and numerical solvers are tightly linked.  For other types of modules, the science 
parameterization components and numerical solvers have a looser association.  In such cases the 
modularity can be defined either at the parameterization level, the numerical algorithm level, or 
both.  For example, the module definition for the advection process is based on the numerical 
advection algorithm used.  For the gas-phase chemistry process, the modularity is based on the 
ordinary differential equation numerical solvers.  The chemistry mechanism description is 
generalized aiid the Models-3/CMAQ framework provides a straightforward method to link 
model species surrogate names with the species names in the data set.  See Chapter 15 for details. 
The use of different chemical mechanisms is accommodated through the mechanism reader and 
generalized codes for setting up the production and loss terms of the chemistry reactions. 
Therefore, the CCTM does not require different gas-phase chemistry modules for different 
mechanisms. 

The vertical cliffusion process can be formulated using either local- or non-local-mixing 
parameterization schemes.  The current classification of vertical diffusion modules is based on the 
process parameterization methods.  The modularity of this process can be enhanced if we 
distinguish the method used for computing the vertical diffusivities for local-mixing.  In this case, 
the modularity is defined at the level of data provider modules.  The modularity level can be 
deepened further if we identify different numerical solution methods for the diffusion. 

With the current version of CMAQ, the level of science modularity is subordinated by the way 
the science process codes are archived in the system.  Here, we define a class as a collection of 
cllfferent mogllles for a given science process.  The science classes are identified with the grouping 
of the terms in the governing conservation equation, Equation 6-18. ·Currently, nine science 
process classes are defined in CCTM: 

• 

• 

• 

• 

• 

• 

• 

• 

• 

• 

DRIVER controls model data flows and synchr<;mizes fractional time steps; 

HADV computes the effects of horizontal advection; 

V ADV computes the effects of vertical advection; 

ADJ CON adjusts mixing ratio conservation property of advection processes; 

HDIFF computes the effects of horizontal diffusion; 

VDIFF computes the effects of vertical diffusion and deposition; 

CHEM computes the effects of gas-phase chemical reactions; 

CLOUD computes the effects of aqueous-phase reactions and cloud mixing; 

AERO computes aerosol dynamics and size distributions; and 

PING computes the effects of plume chemistry. 

CCTM does not have emissions as a separate science process because it can be either a part of 
the vertical diffusion or the gas-phase chemical reaction proces.s.  It is worthwhile to mention 
here that the current modular paradigm does not prevent establishment of combination of 
processes in a larger single module.  For example, one can develop a module describing the vertical 
transport, chemistry, and emissions simultaneously when time scales of those processes become 
comparable.  Users could experiment with the combination of modules to best fit to their 
problems at hand. 

In addition to nine science process modules, CCTM includes two .science process. classes.  The 
PHOT computes photolysis rates, and AERO_DEPV computes particle size-dependent dry 
deposition velocities.  These are typical "data-provider" science process classes, which do not 
involve updating concentrations directly.  There are some other classes that do not fall in any of 
the above definitions.  We have grouped these auxiliary routines as the UTIL class, which is a 
collection of utility subroutines.  As one can see, the current modularity of the CCTM is 
implemented more on a practical basis rather than by strictly following a design paradigm.  One 
can also see that the present modularity definition of CN.[AQ is somewhat subjective.  In the 
future we intend to allow definition of the modularity at the user-defined granularity level. 

Figure 6-1  describes the key science process modules in CCTM and their data linkage with 
CMAQ's preprocessors, whose descriptions are available in other chapters.  The only data 
dependencies among the CCTM science modules are the trace species concentration field as seen 
in the diagram and the model integration time step.  Figure 6-2 shows the distinct data 
dependencies within the CCTM.  To facilitate modularity and to minimize data dependency in 
CCTM, we store concentrations in global memory while the environmental input data are 
obtained from random-access files and interpolated to the appropriate computational 
(synchronization) time step.  This realizes the recommended "thin-interface" structure of the 
model: 

• 

• 

• 

• 

• 

Common timing data are managed through the science process main subroutine's call 
arguments; 

Conceµtrations are. the object of all process opera~ions; 

Environmental data are provided through a standard 1/0 interface; 

Model stru~ture data are provided through shared include files; and 

Standard physical constants are obtained from shared include files. 

See Chapter 18 for further details on how the science codes are integrated in the Models-3 
CMAQ  system. 

CMAQ  Science  Processors 

ECIP 

I 

.  I 

~Boundary 
~ I Conditions 

M Cl P 

I 
I 

r. Meteorology 
I 
I 

I 

G 

Figure 6-1.  Science Process Modules in CMAQ.  Interface processes are shown with rectangular 
boxes.  Typical science process modules are updating the concentration field directly and the data(cid:173)
provider modules include routines to feed appropriate environmental input data to the science 
process modules.  Driver module orchestrates the synchronization of numerical integration across 
the science processes. Concentrations are linked with solidi lines and other environmental data with 
broken lines. (From Byun et al.,  1998.) 

Table 6-1.  Interface Processors for the CMAQ Modeling System 

Interface 
Processor 
ICON 

B.CON 

ECIP 

MCIP 

JPROC 

PDM 

Description 

Reference 

Chapter 13 

Provides initial three-dimensional fields of trace species 
concentrations for modeling domain 
Prqvides concentrations of trace species for the boundary  Chapter 13 
cells 
Incorporates emissions from separate area and major 
point sources to generate hourly 3-D emissions input file 
Processes the output of a meteorological model to 
provide the necessary meteorological data for CMAQ 
models 
Computes photolysis rates for various altitudes, 
latitudes, and sun zenith angle 
Generates plume information needed to apply plume-in-
grid (PinG) processing in CCTM 

Chapter 9 

Chapter 3 

Chapter 12 

Chapter 14 


6.2.3  Description of Science Processes 

In this section we describe individual science processes, shown in Figure 6-1, associated with the 
groups of individual terms in the governing diffusion equation.  Note that different concentration 
units are used for different science processes in CMAQ CTMs.  Appendix 6A provides the 
relationships among the concentration units and their conversion factors from one unit to another. 

CMAQ CTM  's Data Flow 

Output 

IC 
Data 

Figure 6-2.  Data Dependencies Among Modules in CCTM.  P and Sk represent a science process 
module and the related subroutines for the module, respectively. (From Byun et al.,  1995.) 

6.2.3.1 Driver Class for CCTM 

The key function of the driver class module is hosting the science processors.  It is responsible 
for coordinating model integration time (synchronizing :fractional-time steps of science process 
call) and some input/output sequences.  The driver struc1ure of the current CCTM is given in 
Figure 6-3.  A synchronization time step is used to ensure the global stability of the CCTM's 
numerical integration at the advection time step, which is based on a Courant number limit. 
Nesting requires finer synchronization time steps for the fine grid domain.  The CCTM's process 
synchronization time steps are represented as integer seconds because the Models-3 I/O API can 
only handle integer seconds for I/O data.  All the needed data are appropriately interpolated 
based on the synchronization time step.  For maintaining numerical stability and for other 
reasons, an individual process module may have its own internal time steps.  In general, each 
science process module uses the synchronization time step ( /),.t.rync)  as the input time step of 
required environmental data.  The global output time steps can be set differently from the 
synchronization time step.  Usually, the output time step (~t0"1 ) is set as one hour,  but sub(cid:173)
hourly output down to the synchronization time step is possible. 

Table 6-2.  List of Science Process Subroutines Called by the CMAQ Driver 

• 

Description 
Sets up pointers for different concentration species: gas 
chemistry, aerosol, non-reactive, and tracer species 
Initializes simulation time period, time stepping constants, and 
concentration arrays for the driver 
Computes the model synchronization time step and number of 
repetitions for the output time  step 
Converts units and couples or de-couples concentration values 
with the density and Jacobian for transport 
Controls all of the physical and chemical processes for a grid 
(currently, two versions are available: symmetric and 
asymmetric around the chemistry processes) 
Computes advection in horizontal plane (x- and y-directions) 

Subroutine 
CGRID  MAP 

Science Class 
UTIL 

INITSCEN 

INIT* 

ADV STEP 

DRIVER 

COUPLE/ 
DECOUPLE 
SCIPROC 

COUPLE* 

DRIVER 

XADV, 
YADV 
ZADV 

HADV 

VADV 

ADJ ADV 

ADJ CON 

HDIFF 
VDIFF 
CHEM 
P~NG 
AERO 

HDIFF 
VDIFF 
CHEM 
PING 
AERO 

Computes advection in the vertical direction in the generalized 
coordinate system 
Adjusts concentration fields to ensure mixing ratio 
conservation given mass consistency error in meteorology data 
Computes horizontal diffusion 
Computes vertical diffusion and depositio~ 
Solves gas-phase chemistry 
Computes effects of plume-in-grid process 
Computes aerosol dynamics, particle fo1mation, and 
deposition 
Computes cloud mixing and aqueous ~!;_emistry 

. 

CLDPRC 
•represents a process class that is part of DRIVER function. 

CLOUD 

6-16 

CMAQ-DRIVER 

Asymmetric SCIPROC 

Symmetric SCIPROC 

EP A/600/R-99/030 

CGRID_MAP 

} 
.-----_,Time Step} 

Output 

/),.tout 

• 
; 
' 

I 
} 

! 
i 
! , 

XADV* 

L1~<ync 

~ 
i 
I 
t 
' 
l 
l 
' l 

IiECOUPLE 
~ .. -:;;:;-=---;e::····::::: ... ~ Litsync 

QDIFF 

QING 

312::::::::, 

UHEM 

.----~-----.! 

Synchronization 

Time Step L1~<ync  i 

SCIPROC  I, 

QERO 

.......... 

.......... 

~.... 

* Alternating 
XADV and YADV calls 
for each asymmetric 

"· ....  SCIPROC call 

.......... 

'-.. 

.. .. ..._,,, 

;... . ., 

ADJ CON 

';&~~~~~~~~~___, 

Figure 6-3.  Driver Module and Its Science Process Call Sequence. 
Both asymmetric and symmetric call sequences in SCIPROC are presented. ·/),.tsync  and  /),.tout  are 
model synchronization and output time steps, respectively. Refer to Table 6-2 for the description 
of the subroutines. 

The DRIVER program calls initialization routines to set up CCTM runs.  It initializes the 
concentration field and checks ifthe input files, run time, and grid/coordinate information are 
consistent for a given scenario.  Subroutines used for the jnitialization process are grouped into 
the INIT class.  Usually, initial concentrations for gaseous species are in molar mixing ratio units 
(ppm) and aerosol species in density units (µg  m-3), the same as the output units of CMAQ. 
Also, DRIVER calls couple/decouple subroutines to convert concentration units for appropriate 
data processing.  The pair of couple/decouple calls, which are available in the class COUPLE, 
limit the interchange of process modules between two different concentration units, such as 
density versus mixing ratio.  The classes INIT and COUPLE are introduced just for the 
convenience of code management from the point of view of science process modularity, and they 
should be considered as part of the DRIVER class modules. 

6.2.3.2 Advection Processes for CCTM: HADV, V ADV and ADJCON 

For convenience, the advection process is divided into horizontal and vertical components.  This 
distinction is possible because the mean atmospheric motion is mostly in horizontal planes. 
Usually the vertical motion is related with the interaction of dynamics and thermodynamics.  The 
advection process relies on the mass conservation characteristics of the continuity equation: 

Using the dynamically and thermodynamically consistent meteorology data from MCIP, we can 
maintain data' consistency for air quality simulations at the synchromzation time step.  In case 
. 
the meteorological data provided and the numerical advection algorithms are not exactly mass 
consistent, we need to solve a modified advection equation: 

(6-19) 

(6-20) 

where  QP  is mass' consistency error term (Byun, 1999).  Equation 6-20 ensmes conservation of 
mixing ratio, which is a necessary (though not sufficient) condition for preserving total tracer 
mass given significant fluctuations of density field in space and time.  The equation shows that 
the correction term has the same form as a first-order chen}ical reaction whose reaction rate is 
determined by the mass consistency error (normalized with air density) in the meteorology data. 

Modules in r.IADV class solve for the horizontal advection: 

a(jf"ip;) __ n 

(  E-y" ) 
v ~ •  "rep;  ~ 

at 

-

(6-21) 

and modules in V ADV class solve for the vertical advection with boundaiy conditions v3  = 0  at 
the bottom and top of the model. 

a<$q;;) =  ac$"fP;~) 

at 

a_x3 

(6-22) 

In simulating air quality, one of fundamental characteristic of the model application should be 
conservation of mass.  Therefore, the modules in the ADJ CON class solve for the mass 
correction term: 

(6-23) 

We wish to emphasize that the artificial distinction of advection modules between horizontal and 
vertical processes is not adequate and that all three modules (HADV, V ADV, and ADJCON) 
should be considered as an integral unit for solving the physical advection process of trace 
species.  The advection and mass adjustment algorithms are described in detail in Chapter 7. 

6.2.3.3 Diffusion Process Classes for CCTM: HDIFF ~md VDIFF 

For convenience the atmospheric diffusion process is divided into horizontal and vertical 
components.  This distinction is needed because the vertical diffusion mostly represents the. 
thermodynamic influence on the atmospheric turbulence by the air-surface energy exchange 
processes while the horizontal diffusion represents subgrid scale mixing due to the unresolved 
wind fluctuations.  To handle the atmospheric diffusion processes in the generalized coordinates, 
we need to carefully examine the governing equation to properly set up the diffusion solver. 

We start from the atmospheric diffusion equation in the same concentration units as used in 
advection: 

d<p; 
at  diff 

diff 

(6-24) 

where  <p;  = .fYcp;, and the term (Q~ Ip)  is the time rate change of mass mixing ratio due to 
emissions of species i.  Initially, it is assumed that we can. decompose the diffusion into the 
horizontal and vertical components with respect to the curvilinear coordinates: 

acp;I  =a( $i5?f;)  = _ ac.fYi5~) +  G-(Qrp, J 

'.:}. 
ai  vdiff 

'.:}. 
at 

i~3 
OA 

"\/ r P 

P--

(6-25) 

(6-26) 

vdiff 

Emissions can be included either in vertical diffusion or gas-phase chemistry module.  If we can 
parameterize the turbulent fluxes directly in the curvilinear coordinates, we can implement 
HDIFF and VDIFF modules following Equations 6-25 and 6-26.  When the turbulent fluxes are 
parameterized with eddy diffusion theory, the contributions of the off-diagonal (cross(cid:173)
directional) diffusion terms show up explicitly as shown in Equation 6-14: 

acp; I  = _}__[  G-cK.13  aqi )] 
at 

'VYP 

axi 

. 
cdiff 

_!____[  G-cK.23  dil )]. 

ax3  + ax2 

'VYP 

ax3 

6-19 

BP N600/R-99/030 

, 

, 

';1,,I' 

,, 

"32  aqi  J 
,,  a [ rz- "31  aqi 
+ ax3  -vrPCK  ax' +K  ax2) 

(6-27) 

For a domain with a significant topographic feature, the module CDIFF must be implemented. 
However, the current CMAQ version does not include CDIFF module as the off-diagonal terms 
are often neglected in operational air quality models.  In such a case, the HDIFF and VDIFF 
modules so1ve for diagonal terms (with respect to the curvilinear coordinates) as follows: 

~I  = ~[ rz-ct" (}(f; )]  ~[ rz-ct22 aqi )] 
ailhdiff 

ax'  + ax2  "'r P 

axi  "'r P 

ax2 

a<p; 
at  wli/f 

= ~[ rz-cf(33 aqi )] 

ax3  "'r P 

ax3 

(6-25') 

(6-26') 

Compared with above formulations, let's consider the case that we approximate the quantity 
.[-975, which defines the computational grid, to be constant for the duration of synchronization 
time step for integrating the diffusion process with the fractional time-step method.  Then, the 
problem becomes equivalent to solving for the diffusion equations In terms of the mass mixing 
ratio instead of density: 

aq,,  =-V  •[F  ]- acfr~) +({4,')-F  •V [inc  1Zy"p-)]-fr3 a[inc.Jri»] 
at  diff 

ax3 

-yr, 

75 

ax3 

~ 

q, 

q, 

~ 

q, 

(6-28) 

Ifwe rely on Equation 6-28 for representing the atmospheric diffusion process, the concentration 
must first be decoupled to obtain mass mixing ratio, q1•  Once the new mixing ratio is computed, it 
needs to be coupled with .[-975 to give the updated concentration in terms of <p;.  This means 
that the operator for the horizontal diffusion process should compute: 

and the vertical diffusion process should solve for: 

(6-29) 

(6-30) 

This approach is more convenient in numerically solving the flux-form turbulence mixing 
representation because most of the flux-based closure algorithms use parameterizations of 
turbulent fluxes in terms of conserving quantities, such as the mass mixing ratio, q1•  A 
considerable amount of meteorological and air quality literature on turbulence diffusion fails to 
clarify this important point.  Especially for the case of multiscale applications, the representation 
of diffusion in terms of a conserving quantity is critical as shown by Venkatram (1993). 

6-20 

' 

The effects of turbulence flux caused by the divergence of the grid boxes in the coordinate system 
need to be included in order to describe the turbulence exchange processes precisely.  One can 
readily show that the coordinate-divergence term in Equation 6-30 vanishes for a mass conserving 
vertical coordinate.  Similar Ly,  when topographical feature~s vary significantly and horizontal 
variations of the quantity .Jr75 are large, one cannot n~glect the last term in Equation 6-29. 
Chapter 7 of this document describes physical parameterization schemes and numerical 
algorithms for the horizontal and vertical diffusion processes· in the CCTM. 

One may wonder how deposition should be represented in the generalized coordinate system.  In 
Eulerian air quality models, the deposition process affects the concentration in the lowest layer 
as a boundary flux condition.  Considering the deposition process as the diffusion flux at the 
bottom of the model, we can relate the boundary condition in the generalized coordinate system 
to that of the Cartesian coordinate system as: 

(6-31) 

because  Fq~I 
concentration is accounted for by the following relationship: 

and  FqYI 

•  dep 

•  dep 

· 

do not exist.  Then, the effects of dry deposition on the species 

acp; I  _ a( .fY75<L) 
at  dep 

at 

= 

dep 

dep 

a ( rz-cax3)F7.) 

= - ax3  -vrP  az 

q; 

dep 

(6-32) 

where  hd•p  = (;,)  (Af 3

)dep  is the thickness of the lowest model layer in the geometric height 

dep 

coordinate.  In the derivation of Equation 6-32, we assume that the deposition flux is constant in 
the lower part of the surface layer (i.e., a constant flux layer).  Thus, the deposition velocities are 
computed at the middle (in terms of the generalized coordinate, g) of the lowest model layer at 
which the concentrations are represented.  For the case in which the mass mixing ratio is used as 
the concentration variable for solving the diffusion equation, the deposition should be 
implemented as a boundary condition for the vertical diffusion (VDIFF) in the following manner: 

;;qi I  _  ac~) 

'."\. 
at  dep 

-

-

:t.~3 
ax· 

dep 

a ( ax3 

= - :t.~3 
ax 

·  ) 
(  1. )F:i~ 

u~ 

. 

d 
ep 

(6-33) 

Therefore, the bottom boundary condition for the VDIFF module is given as: 

6-21 

~I  =-:X3 (c~ )~~)  = 

""' 

dtp 

(Fz) 

q;  dtp 

) 

(ax3
- -
(}z. 
(L1£3) 

bonnm 

, 

tfep 

z 
F 
h 

= ( q; t,p  = _ V d  -1 
h  qi  /aytrl 

. 

, 

dtp 

.. dtp 

(6-33') 

Equations 6-32 and 6-33 show that we do not need to estimate contravariant deposition 
velocities if the deposition process is implemented as a bottom boundary condition in the 
generalized coordinate formulation. 

In the current CCTM implementation, the concentration units for horizontal and vertical 
M 
diffusion processes are density (coupled with Jacobian) and niolar mixing ratio,  m; =  q;----1lli:.  , 
M; 

c:,,.. 

,,,, 

. 

. 

. 

. 

. 

,,,,, 

respectively.  We have chosen m;  as the generic concentration unit for the vertical diffusion to 
coordinate with the emissions units in the data .. Subsection 6.2.3.6 provides a detailed 
explanation for this.  Therefore, HDIFF i's placed.outside and VbIFF is placed in between the 
pair of couple/decouple calls.  Because the ratio of molecular weights are constant, equations for 
the vertical qiffusion in terms, of molar mixing ratio are equivalent ~() those in terms of mass 
mixing ratio,  q1 •  Refer to Chapter 7 for details of the computational algorithms for HDIFF and 
VDIFF. 

6.2.3.4 Gas-phase Chemistry Process for CCTM 
Instead of directly computing the time rate of change of <p;, as is given by: 

(6-34), 

we need to decou~le the Jacobian and air density in .JY"li5;  before computing gas-phase chemistry. 
This is useful because we can approximate that the computational grid remains constant for the 
duration of a synchronization time step, which is set by the Courant conditions for the fractional 
time step numerical integration schemes.  Because the concentration unit required in the gas(cid:173)
phase chemistry is the volumetric mixing ratio, we rewrite the concentration <p;  as follows: 

" 

' 

<p;  = jrq,i = .fYpl]; ~'.r :'.  = 1f; ~'.r [-fYp :'. ] 
--[ rz- M;] 
-m; "'rp--

air 

arr 

t 

1 

Mair 

(6-35) 

where m; =ff; ~'.r  is used as the definition of the volumetric or molar mixing ratio.  The time rate 
of change of the volumetric mixing ratio due to the gas-phase cherilistry is evaluated with the 
following equation: 

t 

(6-36) 

where  ~; and  Qm; represent chemistry reactions and source terms in molar mixing ra~io units, 
respectively. 

CMAQ employs generalized chemistry solvers, such as QSSA (Young et al.,  1993) and 
SMVGEAR (Jacobson and Turco, 1994), which are designed to solve the nonlinear set of stiff 
ordinary equations presented in Equation 6-36.  They can be applied independent of the 
coordinate and grid descriptions.  To accommodate the need for modified or new chemical 
mechanisms, the CMAQ system is equipped with a generalized chemical mechanism processor. 
Refer to Chapter 8 for detailed description of numerical solvers used for gas-phase chemistry. 

The Models-3 framework provides a mapping table to link chemistry mechanism species with 
surrogate species names in the initial and boundary condition files and emissions files.  See 
Chapter 15 for details.  When a new mechanism is used, aippropriate emissions data must be 
supplied.  It is possible to include emissions either in the gas-phase chemistry or:in the vertical 
diffusion process.  It is preferable that the emissions are interpolated with the same temporal 
interpolation schemes used in the transport processes. 

6.2.3.5 Aerosol Process Class for CCTM 

The fractional time step implementation solves for the effe:cts of aerosol chemistry and dynamics 
on trace gas and aerosol species concentrations with: 

(6-37) 

where  Raero, represents processes such as new particle fom1ation and growth and depletion of. 
existing particles.  Qaero,  stands for all the external sink and source terms, and vg  is the 
contravariant sedimentation velocity.  The generic concentration units for the aerosol process are 
[µg  m-3
Because the aerosol process is called within the pair of couple/decouple calls, the input 
concentration is already decoupled and the following set of governing equations are solved in the 
aerosol process module: 

]  (density) for aerosol mass and [number  m-3

]  for aerosol particle number density. 

The present implementation of the aerosol module in CCTM is derived from the Regional 
Particulate Model (Binkowski and Shankar, 1995).  Here, primary particles are divided into two 
groups: fine particles and coarse particles.  The fine particles result from combustion and 
secondary production processes and the coarse group is composed of materials such as wind-
blown dust and marine particles.  The key scientific algorithms simulating aerosol processes for 
the CCTM are: (1) aerosol removal by size-dependent dry deposition; (2) aerosol-cloud droplet 
interaction and removal by precipitation; (3) new particle formation by binary homogeneous 
nucleat,ion in i:i. sulfuric acid/water vapor system; ( 4) the production of an organic aerosol 
component from gas-phase precursors; and (5) particle coagulation and condensation growth. 
Refer to Chapter 10 for details on aerosol process implemented in CCTM. 

6.2.3.6 Emissions Process for CCTM 

' 

1'•'111'

111::1 

,,'1

As mentioned earlier, the emissions process does not have its own science process class.  Instead, 
it is included .either in vertical diffusion or in the gas-phase chemistry process.  In the governing 
conservation equations for the trace gases, the emissions process is represented simply as source 
terms. 

I 

I• 

'I 

11 

,, 

, 

If emissions data cire given in the unit of time rate of change of mass, for example for particulate 
species, such as I'M2.5  and PMl 0 in [g s"1

], they are expressed as: 

'4. = ~ = _1 accp;ov)I  = _1 _acpqiov) 

emis 

(6-39) 

dt 

8V  OV 

dt 

emis  OV 

where 8V is vohu~e of the cell and E;  = d( ~OV) I . represents the emissions rate into the cell.  If 

the mass of air in the cell does not change for each time step (usually one hour), the concentration 
expression, either as the time rate of change of density or as the mass mixing ratio can be used. 
Otherwise, when the volume and density of a cell change substantially with time, the effect of 
change in air mass must be accounted for in determining the emissions rates. 

em1s 

For gaseous species, the time rate of change of  E1 for each hour and each grid cell are provided in 
the three-dimensional emissions data files in molar units, (i.e.,  mole  s-1 

): 

E. =(Mair  (4,, )ov 

M;  p 

I 

(6-40) 

Emissions for gaseous species in molar units are preferred to those in mass units because molar 
units are the natural units for chemistry arid mass units must be transfomied into  [mole  s-1
eventually for the gas-phase chemistry process.  For gaseous species the molar mixing ratio and 
mass mixing ratio differ only by a simple multiplication factor, the ratio of molecular weights. 
However, for lumped species, the molecular weights are variable depending''on the fractional 
compositions of the categorized hydrocarbon species in the emissions data.· Therefore, 
transformation of emissions in mass units into the molar units for the lumped species can 
introduce misrepresentation of emissions amount.  The data for the fractional compositions of 
the categorized hydrocarbon species are available in the emissions processor, Models-3 
Emissions Projection and Processing System (MEPPS) (See Chapter 4).  Thus, when emissions 

] 

6-24 


data are processed in [mole  s-1
emissions process is represented as: 

]  units, we do not have this conversion problem.  Then the 

dmi I  ""'  Mair  ~; 
at  emiss  M;  P 

(6-41) 

An additional benefit is that the same transformation rule can be applied when emissions are 
included either in the vertical diffusion or in the chemistry. 

6.2.3.7 Cloud Mixing and Aqueous-phase Chemistry (CLOUD) for CCTM 

The rate of change in pollutant concentrations due to cloud processes is given by: 

am.., 
am.., 
-·  __ ,  +-' 
at  resc/d 
at  c/d 

am.., 
at  subc/d 

(6-42) 

where subscripts cld, subcld, and rescld represent cloud, subgrid scale cloud, and resolved cloud, 
respectively.  Although calls to the CLOUD module are made at every synchronization time 
step, the subgrid cloud effects are accounted for once an hour while the resolved cloud effects are 
impacted at each call.  This is equivalent to assuming that the cloud life time of all sub-grid clouds 
is one hour.  The effects of subgrid cloud processes, such as mixing (mix), scavenging (scav), 
aqueous-phase chemistry (aqchem), and wet deposition (wdep) on grid-average concentrations 
are parameterized with a "representative cloud" within the grid cell: 

am.., at' 

subc/d 

- f(mix,  scav,  aqchem,  wdep) 

(6-43) 

where/represents a function of its arguments.  We chose this expression because of the implicit 
nature of the algorithm representing the processes.  For the resolved cloud, no additional cloud 
dynamics are considered in CMAQ and only effects of the scavenging and aqueous-phase 
chemistry are considered: 
am., 
at  scav 

am.., 
am.., 
-·  __ ,  +-' 
at  aqchem 
at  resc/d 

(6-44) 

See Chapter 11  for details of the cloud process descriptions. 

6.2.3.8 Plume-in-Grid Process (PING) for CCTM 

Anthropogenic precursors of the tropospheric loading of ozone, aerosols, and acidic species are 
largely emitted from major point sources, mobile sources, and urban-industrial area sources.  In 
particular, inadequate spatial resolution of the major point source emissions can cause inaccurate 
predictions of air quality in regional and urban Eulerian air quality models.  A plume-in-grid 

6-25 

EPA/600/R-99/030 

(PinG) approach in CCTM provides a more re~listic treatment of the subgrid scale physical and 
chemical processes for major elevated point source emitters (MEPSEs). 

The PING module solves for: 

(6-45) 

where  mp  is concentration of the subgrid plume (in molar mixing ratio) and the time-rate of 
change terms with subscripts disp, emis, chem, and dep represent effects of plume dispersion, 
point source emissions, plume chemistry, and dry deposition in the plume, respectively.  The 
location and shape of plumes are determined by the PDM and plume chemistry is computed in 
the CCTM within plume subsections.  When the subgrid scale phase of the plume simulation has 
been completed, the PING module updates grid scale concentrations with: 

anz;I 
at  ping 

= ov,,  ac~p -mibg) 

8V 

at 

(6-46) 

where  mib: is the back ground concentration and 8Vp  is the volume of plume in a grid cell with 
volume 8V.  Currently, only gaseous species are treated with the PING module. Readers are 
referred to Chapter 9 for the details.  The work for the inclusion of particulates in the PING 
process has been started. 

6.3 

Equivalent Model Formulations for Different Vertical Coordinates 

Because the CCTM is based on a generalized coordinate system, it is possible to emulate the 
governing equations of other popular Eulerian air quality models.  For most urban and regional 
applications, the choice of horizontal map projection is handled with the map scale factors at the 
individual grid points.  Therefore, there are no real differences in formulations in horizontal 
directions.  One caveat is that the current CMAQ version is not tested with anholonomic 
coordinates, such as spherical coordinates.  A few implementation details must be taken into 
account to accommodate the spherical coordinates.  Most of the distinction of the dynamics is 
attributed to the choice of the vertical coordinate of the system. 

The generalized governing conservation equation for trace species, written in the Reynolds flux 
form, is given in Equation 6-18.  The same equation in eddy-diffusion form, in which the 
components of the eddy diffusivity tensor are represented in terms of those in Cartesian 
coordinates, is given below: 

6-26 

EPA/600/R-99/030 

(6-47) 

In most popular air quality models, including the present implementation of the CCTM, the 
cross-terms from the off-diagonal components of the diffusivity tensor are neglected.  Note that 
some models use wind components defined in Cartesian coordinates.  The mass conservation 
characteristic of Equation 6-4 7 is heavily dependent on the quality of the wind data provided.  In 
particular, depending on the dynamic assumptions used in atmospheric models, methods for 
estimating the contravari~t vertical velocity component vary considerably.  Refer to Chapter 5 
for the details. 

Formulations of other air quality models with popular meteorological vertical coordinates, such 
. as z, <J'z,  a po' and  av; and the step-mountain eta coordinate, 17,  can be obtained by substituting 
the appropriate vertical Jacobian in Equation 6-47.  Refer to Table 6-3 for the coordinate 
definitions, associated Jacobians and contravariant vertical velocity components.  Occasionally, 
one may find discrepancies in the governing equation between the one represented by Equation 6-
4 7 and the one presented in the documentation of a specific model with the same vertical 
coordinates.  Some of these can be attributed to the explicit representation of the dynamic 
characteristics and other idiosyncratic implementation practices used in those models.  In the 
CCTM, the vertical coordinate is defmed to increase with geometric height as given in Equation 
6-4.  This restriction simplifies interpretation of terms in the governing equations and eventually 
the computer coding of the algorithms.  For example, the sign of the contravariant vertical 
velocity component is kept the same (i.e., positive value represents upward motion) across the 
different coordinate systems. 

The terrain-influenced height coordinate  <J'z  has been used often for studying air quality 
especially with some simplifying conditions such as the Boussinesq approximation and anelastic 
assumption.  For urban air quality simulations, there are a few examples of applying the  az 
coordinate defmed with time and space dependent H  (thickness of model), which is often related 
with the boundary layer height.  The  <J'z  coordinate is used in air quality models, such as the 
Urban Airshed Model (UAM) (Scheffe and Morris, 1993), STEM-II (Carmichael et al.,  1991), 
CIT (Harley et al.,  1993), CALGRID (Yamartino et al.,  1992), and others.  The terrain-influenced 
reference pressure coordinate is used in SAQM (Chang et al.,  1997), which is designed to be 
consistent with the nonhydrostatic MM5 meteorological model.  The terrain-influenced time 
dependent hydrostatic pressure coordinate is used in RADM (Chang et al.,  1987).  It is the same 
coordinate used for MM4 or MM5 hydrostatic applications.  Step-mountain eta coordinate is 

6-27 

EPA/600/R-99/030 

used for NCJ3f' s Eta meteorological model (Black, 1994, and Mesinger et al., 1988), but no 
operational alr quality model using the.eta coordinate is available. 

.  .. 

Table 6-3.  Vertical Coordinates and Associated Characteristics 

Coordinate 

CMAQ 
_xJ  =c; 

z 

CJ".. 
% 

cr, 

1-apo 

1-<Y-
p 

l-77 

Definition 

Contravariant 

Vertical 
Velocity 

v3 
dz 
w=-dt 

daz 
dt 

da:i: 
dt 

~ dapo 
dt 
_ dafi 
dt 
_ d1J 
dt 

<Y--

- H  z-zsfc 
H-zsfc 

:i: 

a  =  z-z.<fc 
z  H-zsfc 

a  =Po-PT 
po 
Pos  -pT 
<Y- = p-pT 
-
p 
P .•  -Pr 
( ~-~ J 

re,.  -reT 

T  1J.<fc 

1J = 
. 

Vertical 
Jacobian 

Remarks 

JI; 

1 

H  -z.ifc 

H 

H-zsfc 

Pos  - Pr 

Pog 

P ..  -Pr 

pg 

res-,. reT 
pg1J.<fc 

Geometric height 

His the thickness of 
model and az  is the 
scaled height 
Nondimensional height, 
terrain-influenced 

Nondimensional 
reference pressure 
Nondimensional 
geostrophic pressure 
Step-mountain ETA 

71  = ( P.(z,1) - Pr J 

Po(O)- Pr 

.<Jc 

6.4 

Nesting Techniques 

The nested grid CTM is needed to provide the required high resolution simulations.  At present, 
Models-3 CMAQ allows only static grid nesting.  In static grid nesting, finer grids (FGs) are 
placed (i.e., nested) inside coarser grids (CGs).  The resolution and the extent of each grid are 
determined a priori and remain fixed throughout the CTM simulation.  Static grid nesting 
conserves mass and preserves transport characteristics at the interfaces of grids with different 
resolutions (Odman et al.,  1995).  It allows for effective interaction between different scales with 
efficient use of computing resources. · On the other hand, the nest domain is redefined during a 
simulation with the dynamic nesting.  Both static and dynamic nesting techniques allow one-way 
or two-way exchange of information among FGs and the CG and periodically by independently 
simulating CTMs at each grid (coarse or nested) with its own time step.  The dynamic nesting 
procedure is not implemented in the CMAQ system. 

In' one-way nesting, the primary concern is the mass conservation at the grid, interface where 
boundary conditions are input to the FG using the CG solution.  The advective flux at the inflow 

6-28 

EPA/600/R-991030 

boundaries of the FG is the flux as determined by the CG solution that passes through this 
interface.  We also allow for time variation of the flux during the CG time step.  This is 
performed by computing the departure point of the last particle passing through the interface for 
each FG time step.  In the Lagrangian description, the mass crossing the interface is equal to the 
spatial integral of the concentration distribution between the departure point and the interface. 
Most flux-conserving advection schemes use the same Lagrangian concept to calculate the mass 
transfer between grid cells (e.g., Bott, 1989).  During each FG time step, we meter into the FG 
the exact amount of mass that would have crossed the interface on the CG (Byun et al.,  1996). 

In two-way nesting, the concentrations are updated in each CG cell by averaging the 
concentrations of all the FG cells overlapping with the CG cell.  Special care is required to assure 
strict mass conservation at the grid interface.  The mass of some species (e.g., radicals) may no 
longer be conserved because, when advancing the FG solUltion, we perform nonlinear chemical 
transformations in addition to transport.  However, the mass of the basic chemical elements such 
as sulfur, nitrogen, and carbon must be conserved.  The FG solution is used to compute the flux 
of each element at the grid interface.  When conservation principles are applied to the grid 
interface, as described above, the CG concentrations near the interface must be corrected (when 
the Courant stability limit is applied, only the first row of CG cells immediately outside the 
interface need correction).  This is done by renormalizing the concentration of each species based 
on the assumption that the ratio of the species mass to element mass will remain the same before 
and after the correction.  This method is similar to the renormalization procedure used to make 
slightly non-conservative chemical solvers strictly conservative.  Alapaty et al. (19.98) compares 
different spatial interpolation schemes used for the two-way nesting. 

Cpa 

Figure 6-5.  Static Grid Nesting Used in CMAQ System 

The CCTM provides a static nesting (see Figure 6-5) capability while maintaining a high level of 
modularity by separately processing object codes for different grid domains and by enforcing the 
protocol that each module r~ads its required input data independently from others.  The scheme 

6-29 

EPA/600/R-99/030 

is also applicable for multiple and multi-level grid nesting.  Multi-level nesting is a natural 
extension of the single static grid nesting.  Figure 6-6 presents a schema for multi-level nesting, 
where three-levels are illustrated.  The feedback processes update coarser grid concentrations at 
each synchronization time steps of the nest grids.  The information about the grid is 
communicated to each process module through a set of FORTRAN include files specific to each 
grid domain dilling compilation time.  This allows use of the same process modules for different 
grids.  Customizmg a nested model is as simple as preparing include files with grid dimensions for 
each grid and a driver with the appropriate process calling sequence. 

As seen in Figure 6-6, the only difference between the one-way and two-way nesting is whether 
concentration.S in coarser grid simulations are updated with the finer grid simulations through the 
feedback processors or not.  Depending on the computer hardware and software configurations, 
one could build a nested CTM model with one executable collectively simulating all the FGs and 
CG, or with independent CTM executables for different grids that run simultaneously on 
m,ultiple CPUs accessing common data through appropriate 1/0 APL  The latter approach relies 
on the cooperating processors concept in a UNIX environment.  As mentioned before, the 
current CMAQ version lacks a feedback module, which is necessary for the two-way nesting. 

cGrkl 
Emls 

----~Q~Coarse_Conc 

' 

Coarse  '§P:ad< 

Interpolate 
cone 
.j, 

I:_:  ~§Grid_1 ~ 
tGfl((1 ~  l""  lt.LSync_fGrid1 

v  @"'--"'"'-""' 
_J_ 
~'G"d 1 ~--
Cc\ fGrkU '-
' 
v 
_J_ 

~ 

Driver 

...-------,..  "  - -""'"' 

int~l'!Xllate 
Cone 

Mil 

J  file 

!Grid  1 

Update 

..J-

~1Grid_2_Conc 

1Gtfd_1 

Legend 

c:G'ld:  coarse  grid  domaln 
!Grid:  fine  grid  domaln 
Emls:  emissions  file 
Met:  meteorology  flies 
J: 
C: 
EC: 
Cone:  conce ntr all on 
Sync:  synchronizat Ion 
Proc:  processor 

photolysis  rate 
Initial  conditions 
boundary conditions 

Figure 6-6.  Schematics for Multi-level Nesting (three levels illustrated) 

6-30 

EPA/600/R-991030 

6.5 

Summary 

The CMAQ system achieves multi-pollutant and multiscale capabilities by combining several 
distinct modeling techniques.  The generalized governing conservation equations of the CCTM 
allow transformation among various vertical coordinates (e.g., terrain-influenced geometric height, 
or pressure) and transformation among various horizontal coordinates, especially map 
projections (e.g., rectangular, Mercator, Lambert, and polar stereographic) by simple changes in a 
few scaling parameters defining the boundary domain, map origin, and orientation.  Therefore, 
CMAQ can be configured to match the dynamic characteristics of the preprocessor 
meteorological models.  The CMAQ system uses a nesting technique and a plume-in-grid 
approach to handle small scale air quality problems and subgrid scale plume dispersion and 
chemical reactions, respectively.  The multi-pollutant capability is provided by a generalized 
mechanism reader and generalized chemistry solvers, linked cloud mixing and aqueous reaction 
processes, and aerosol modules.  The CCTM code uses a modular structure that allows for the 
continuing improvement of the science and addition of new capabilities in a unified fashion.  It 
provides a natural disciplinary distinction among different science processes through which 
developments in specific research areas can be readily incorporated. 

As mentioned above, there remain a few implementation tasks, such as development of feed-back 
modules for two-way nesting and adaptation of anholonomic coordinates (e.g., latitude(cid:173)
longitude ), which will provide additional functionalities in CCTM. 

6.6 

References 

Alapaty, K., R.  Mathur, and T.  Odman,  1998: Intercomparison of spatial interpolation schemes 
for use in nested grid models. Mon.  Wea.  Rev.  126, 243-249. 

Binkowski, F. and U.  Shankar, 1995: The regional particulate model; Part I: Model description 
and preliminary results. J.  Geophys.  Res., 100: 26191-26209. 

Black, T.,  1994:  The new NMC  mesoscale Eta model:  Description  and forecast examples.  Wea. 
Forecasting, 9, 265-278. 

Bott, A., 1989: A positive definite advection scheme obtained by nonlinear renormalization of 
the advective fluxes~ Mon.  Wea.  Rev.  117, 1006-1015. 

Byun D. W., A. Hanna, C. J.  Coats, and D.  Hwang,  1995: Models-3 Air Quality Model 
Prototype Science and Computational Concept Development. Trans.  TR-24  Regional 
P_hotochemical Measurement and Modeling Studies, 8-12 November 1993, San Diego, CA, Air & 
Waste Management Association. Pittsburgh, PA.,  197-212. 

Byun, D.W., D. Dabdub,  S.  Fine,  A. F.  Hanna, R.  Mathur,  M. T.  Odman, A. Russell, E. J. 
Segall, J. H.  Seinfeld, P.  Steenkiste, and J. Young,  1996:  Emerging Air Quality Modeling 
Technologies for High Performance Computing and Communication Environments, Air Pollution 
Modeling and Its Application XI, ed. S.E. Gryning and F. Schiermeier, 491-502. 

Byun, D.\V., J. Young., G.  Gipson., J.  Godowitch., F. Binkowsk, S. Roselle, B. Benjey, J. Pleim, 
J.  Ching., J. Novak, C. Coats, T. Odman, A.  Hanna, K. Alapaty, R. Mathur, J.  McHenry, U. 
Shankar, S. Fine, A. Xiu, and C. Jang,  1998: Description of the Models-3 Community Multiscale 
Air Quality (CMAQ) model.  Proceedings of the American Meteorological Society 78th Annual 
Meeting, Phoenix, AZ, Jan.  11-16, 1998. 264-268. 

Byun, D. W., 1999: Dynamically consistent formulations in meteorological and air quality 
models for multi-scale atmospheric applications: II. Mass conservation issues. J.  Atmos.  Sci., (in 
print). 

Carmichael, G.R., L.K. Peters, and R.D. Saylor, 1991: The STEM-II regional scale acid 
deposition and photochemical oxidant model-I. An overview of model development and 
applications. Atmos. Environ.  25, 2077-2090. 

Chang, J.S., R.A. Brost, LS.A. Isaksen, S. Madronich, P. Middleton, W.R. Stockwell, and C.J. 
Walcek, 1987:A three-dimensional Eulerian acid deposition model: Physical concepts and 
formulation, J.  of Geo phys. Res., 92, 14,681-700. 

Chang J.  S., S. Jin, Y. Li, M. Beauharnois, C.-H. Lu, H.-C. Huang, S.  Tanrikulu, and J. DaMassa, 
1997: The SARMAP air quality model. Final Report, SN AQS/AUSPEX Regional Modeling 
Adaptation Project, 53 pp. [Available from California Air Resources Board, 2020 L Street, 
Sacramento, California 95814.] 

Coats, C.J., cited 1996: The EDSS/Models-3 1/0 Applications Programming Interface. MCNC 
Environmental Programs, Research Triangle Park, NC. [Available on-line from 
http://www.iceis.mcnc.org/EDSS/ioapi/H.AA.html.] 

Harley, R.A., A.G. Russell, G.J. McRae, G.R. Cass, and J.H.  Seinfeld.  1993: Photochemical 
modeling of the Southern California air quality study. Envir.  Sci.  Technol. 27, 378-388. 

Jacobson, M.Z. and R.P. Turco,  1994: SMVGEAR: A sparse-matrix vectorized Gear code for 
atmospheric models. Atmos. Environ.  20, 3369-3385. 

Mesinger, F., Z. I. Janjic, S. Nickovic, D.  Gavrilov, and D.  G.  Deaven, 1988: The step-mountain 
coordinate: model description and performance for cases of Alpine lee cyclogenesis and for a case 
of Appalachian redevelopment. Mon.  Wea.  Rev.,  116, 1493-1518. 

Odman, M.T .. ~ R. Mathur, K. Alapaty, R.K. Srivastava, D.S. McRae, and R.J. Yamartino, 1995: 
Nested and adaptive grids for multiscale air quality modeling. U.S. EPA Workshop on Next 
Generation Models Computational Algorithms (NGEMCOM), Bay City, MI, June  1995. 

Seaman, N. L., D.R. Stauffer, and A. M. Lario-Gibbs, 1995: A multiscale four-dimensional data 
assimilation system applied in the San Joaquin Valley during SARMAP. Part I: Modeling design 
and basic performance characteristics. J.  Appl.  Meteor., 34, 173 9-17 61. 

Seinfeld, J.H.,  1986: Atmospheric Chemistry and Physics of Air Pollution. Wiley-Interscience, 
New York. 

Scheffe, R. D., and R. E. Morris, 1993: A review of the development and application of the 
Urban Airshed Model. Atmos.  Environ., 27B, 23-39. 

Srivastava, R.K., D.S. McRae, M.T.  Odman, 1995: Governing Equations of Atmospheric 
Diffusion. Technical Report, MCNC [Available from MCNC-North Carolina Supercomputing 
Center, P.O. Box 12889, 3021  Cornwallis Rd. Research Triangle Park, NC 27709-2889.] 

Schwartz, E.  S.  and P. Wameck, 1995: Units for use in atmospheric chemistry. Pure &  Appl. 
Chem. 67, Nos 8/9, 1377-1406. 

Toon, O.B., R.P. Turco, D. Westphal, R. Malone, and M.S. Liu, 1988: A multidimensional 
model for aerosols: Description of computational analogs. J.  Atmos. Sci., 45, 2123-2143. 

Venkatram,A., 1993: The parameterization of the vertical dispersion ofa scalar in the 
atmospheric boundary layer. Atmos. Environ.  27 A, 1963-1966. 

Yamartin~, R.J., J.S. Scire, G.R. Carmichael, and Y.S. Chang, 1992: The CALGRID mesoscale 
photochemical grid model - Part I.  Model formulation, Atmos. Environ.  26A, 1493-1512. 

Young, J.O., E. Sills, D. Jorge, 1993: Optimization of the Regional Oxidant Model/or the Cray Y(cid:173)
MP, EPA/600/R-941065.  [Available from U.S. Environmental Protection Agency, Research 
Triangl~ Park, NC 27711.] 

This chapter is taken from Science Algorithms of the EPA Models-3 Community 
Multiscale Air Quality (CMAQ) Modeling $ystem, edited by D. W. Byun and J. K. S. 
Ching, 1999. 


Appendix 6A. Concentration Units Used for Air Quality Studies 
============

As we have seen above, many different concentration units are used for air quality studies.  In 
this section we summarize the relations among the concentration units and their conversion 
factors from one unit to another.  For Models-3/CMAQ system we follow the International 
System of Units (Systeme International, SI) as a framework for units in the formulations.  The 
fundamental assumption used here is that air and trace gases follow the ideal gas law, i.e., 

(6A-1) 

where  Re  is the universal gas constant  = 8.314510 [J l(mol • K)], 

v is molar number, 
Vis volume of the gas [ m3 
pis pressure [Pa], and 
T is temperature [ K]. 

]  , 

There are many different ways to express the amount of substance in the atmosphere.  We 
introduce most popular quantities and transformation relations among them are presented below. 

Number Density, n 

One way to ·express trace gas quantities is to count number of molecules in the unit volume.  For 
example, number of molecules of air in the unit volume,  nair' is expressed as: 

where  v air  is number of moles of air, 

NA  is the Avogadro's number= 6.0221367x 1023

,  and 

Similarly, number of molecules of trace gas per volume, i.e., number density of species n;, is 
defined as: 

(6A-2) 

v.NA 

n1 =-'-= 

v.NA 
' 

V 

V1RgT IP; 

=-'-[mo ecu es 

l 

l 

P· 
k8T 

(6A-3) 

where  v,  is number of moles of trace gas i in a given volume, and 

k8  =Re I NA  is Bolzmann's constant 
p1  is the partial pressure of species i. 

Molar Density, c, 

The number of moles of air (ca1r) and trace gas (c1)  normalized for a unit volume of air are simply 
defined as: 

6-34 

v. 
c.  =......!EL 
V 
arr 

BP A/600/R-991030 

(6A-4a) 

(6A-4b) 

with the unit [mole  m-3
can be used conveniently for expressing chemical relationships. 

]. ·Because the SI unit for the ~mount qf substance is mol, this quantity 

Partial Pressure, Pt 

Although not used widely in atmospheric chemistry, the partial pressure has been playing an 
important role specifying thermodynamic properties of the atmosphere, especially for water 
vapor in the air.  The Dalton's law states that the total pressure exerted by a mixture of gases is 
equal to the sum of the partial pressure exerted by each constituent  at the given temperature and 
volume.  Because we assume that each trace gas follows the ideal gas law, the partial pressure 
can be used to express the trace gas quantity.  The partial pressure of atmospheric constituent 
gas is related to the number of moles per volume as: 

P.=--=c.RT 

I  g 

I 

viRgT 
v 

.(6A-5) 

and the standard SI unit for the partial pressure is Pascal [Pa]. 

Molar Mixing Ratio,  m; 

Often, the molar mixing ratio is used as a synonym for the volume mixing ratio, or the mole 
fraction of a substance in air.  Basically it is a unitless quantity.  However, it is customary to 
identify in terms of molar unit as [mole I mole].  Because the volume occupied by a mole of ideal 
gas at given pressure is the same regardless of the constituent, the mole fraction is essentially 
equal to the volume fraction.  However, mole fraction is preferred because it does not require the 
implicit assumption of the ideality of the gases, and more importantly because it is applicable 
also to condensed-phase species (Schwartz and Warneck, 1995).  For a given volume, the volume 
mixing ratio of a trace species is expressed in terms of concentration units defined above as: 

m.= 

I 

v. 

I 

Vair  +Vi 

=-C....;.;_=_Pi 
p 

where p  is the total pressure. 

(6A-6) 

Because  vi<< Vair  for trace gases, Equation 6A-6 can be approximated as: 

v. 

m; =-' =-' =-' 

c. 

p. 

Vair 

cair 

Pair 

When dealing with trace gases in the real atmosphere, the contribution of moisture can be used in 
the definition of mixing ratio.  Therefore,  Pair  represents total pressure of the atmosphere which 
includes vapor pressure of water while the contributio.n of other trace gases are neglected. 
Because the vwiation caused by the moisture can amount to several percent, some researchers 
prefer to use dry air when expressing trace gas mixing ratios.  However, in the Models-3/CMAQ 
system, we use the trace gas mixing ratio with respect to the moist air because we rely on the 
continuity equation for the total air density to represent atmospheric mass conservation. 

Mass Mixing Ratio, q, 

,1·:11!: 

Mass mixing ratio is used often for describing transport process and is simply related with the 
volume mixing ratio as: 

(6A-7) 

Density,  <p1 

Cpncentrations of l>Ubstances in air can be expressed in terms of amount of substance mass per 
volume of air, i.e. density.  Density is a most popular unit for dynamic representation of 
atmospheric concentration because it is the operating units of the mass continuity equation. 
Density can be expressed in terms of other concentration units as: 

_  v,M;  _ 

m1 ----c.M. - - c .  M. 
r 

air 

't'. 

r 

V 

_  c; 

1 

cair 

s= (~I:~ )(cairMair) = qiPair 

arr 

(6A-8) 

Table 6A-1 provides cross-reference relationships among the concentration variables described. 
However, the individual process science area prefers to use certain specific units of decimal 
multiples of the SI unit suggested.  We included the conversion factors among the concentration 
variables actually implemented in science process modules.  Because it is convenient to express 
the conversion factors in terms of the dry air quantities, the virtual temperature is used in Table 
6A-1. 

. 

. 

... 

6-36 

Table 6A.1.  Conversion formula among various trace gas concentration units used in the CMAQ system 
==========

number density,  N1 

[molecules!m3] 

molardensity,  c1 

[mol/m 3

] 

partial pressure, p1  molar mixing ratio,  mass mixing ratio, 

demity,  <p1 [µglm1 

[Pa.rcalj 

m1 fppmV] 

(/;  fppm] 

number density, 
N; 
[molecules/m 3

] 

molardensity, c1 
[mol!m3] 

1 

N;= (NA)C; 

N;  = (ksD-

1
P1 

C;  = (NAf1N; 

1 

C;  = (RgT)-l P; 

N,= Hr•  NA~ , 
. 

3 

( 

p  } 
M.,, 

Ni  =10-

C.  = 10~ -( pair  )m. 

M 
air 

I  C;= 

I 

. 

3 

· (  ~ ~ } /   ~ =10-6 ·(~} 
10~ (P·•) 

•  M  qi  c =10-6•(Mfl<p. 

I 

I 

I 

. 
I 

P;=  Q?.gT~ 

1 

-6 

. 

P1  =10  •(p)m; 

P1  = 10  •  ~;r P  q1 

-6  (M. 

) 

(RTJ 
P.  =10"6.  _, J~ 
~  I 
. .I 

°' I w 

-...J 

p1  [Pacal] 

P; =("f<aT)N; 

partial pressure,  I 
molarmixing  I  , ( M } 
mass  mixing  I q,= 1()1  -( 2L )N; 
I ~' =IO'•(*)N, 

density,  <p1 
[µglm1 

ratio,  fl;  fppm] 

Pa.NA 

NApal 

ratio,  m;  fppmV]  m;  =10  •  ~ ;  m; =  td •  -..!!!!:  C; 

·  ( M . )  m;  = 106 •(pf1P; 

Pa1r 

1 

m;=( ~:r}, 

•  -1 

m1 =IO ·•  ~ '1'1  · 

(  M.  ) 
P.1.M1 

( M) 
. 
q;=l03•  - :  lj 
Parr 

6 

'fJ;  = 10  • (M;)c; 

qi= Hf •(~Pi  q1=( Mi.  }1 
-IO'  (M')  ~-io'-(PwM}  'Pt  =10 3 

pMair 

Marr 

•  -

<p.  -

M 

· 

I 

I 

1 

I 

air 

RT 

g 

P.· 
I 
. 

q1  =Id ~ <P.,,f1 'P, 

•(pairMi 

1 

Note: Values for the Avogadro's constant (NA) is 6.0221367x1023 [number/mol], the universal gas constant (Rg)  is 8.314510 [J/mol-K], and the Boltzmann's 
constant (kB)  is defined with R/ Nk  Molar mixing ratio is equivalent to volume mixing ratio and their units [ppmV],  [ppb], and [ppt] are short hand notations for 
[µ  mol motl ], [n mol mo[-1], and fp mol mol-1], respectively.  The unit for  mass mixing ratio, [ppm], is a short hand for 110-6 kg kg-1].  Both  and  may 
represent values for dry air or moisture air depending on applications.  However, in one processing system, their usage should be consistent.  · Mair and  Mi 
(molecular weight of species i) are in [g moz-l] and Pair is in [kg m-31. 

ttl 

~ g 
~ I 
'O 
~ 
8 
" 

EPA/600/R-99/030 

Chapter 7 
==============

NUMERICAL TRANSPORT ALGORITHMS FOR THE COMMUNITY MULTISCALE 

AIR QUALITY (CMAQ) CHEMICAL TRANSPORT MODEL IN GENERALIZED 

COORDINATES 

Daewon W. Byun,* Jeffrey Young,** and Jonathan Pleim ** 

Atmospheric Modeling Division 

National Exposure Research Laboratory 
U.S. Environmental Protection Agency 

Research Triangle Park, NC 27711 

M. Talat Odman+ and Kiran Alapaty 

MCNC-Environmental Programs 

P.O. Box 12889, 3021  Cornwallis Road 
Research Triangle Park, NC 27709-2889 

ABSTRACT 

The transport l?rocesses in the atmosphere primarily consist of advection and diffusion, except 
for the mixing of pollutants by the parameterized subgrid-scale clouds.  In this chapter, numerical 
algorithms for advection, vertical diffusion, and horizontal diffusion implemented in the 
Community Multiscale Air Quality (CMAQ) chemical transport models are di.scussed.  To 
provide the CMAQ system with multiscale capability, we have formulated the transport 
processes, both advection and diffusion, in conservation (i.e., flux) forms for the generalized 
coordinate system.  Therefore the numerical transport algorithms implemented in CMAQ will  -
function under a wide variety of dynamical situations and concentration distribution 
characteristics.  Users can not only choose transport algorithms from optional modules available 
in CMAQ, but also are encouraged to experiment with their own algorithms to test different 
numerical schemes for air quality simulations. 

* On assignment from the National Oceanic and Atmospheric Administration, U.S. Department of Commerce. 
Corresponding author address: Daewon W. Byun, MD-80, Research Triangle Park, NC 27711. 
E-mail: bdx@hpcc.epa.gov 

000n assignment from the National Oceanic and Atmospheric Administration, U.S. Department of Commerce. 

"l>resent Affiliation: Georgia Institute of Technology, Atlanta, GA. 


NUMERICAL TRANSPORT ALGORITHMS FOR THE COMMUNITY 

Chapter 7 
=========

MULTISCALE AIR QUALITY (CMAQ) CHEMICAL TRANSPORT MODEL IN 
GENERALIZED COORDINATES 

hi. this chapter, we study numerical algorithms for the transport processes in a turbulent 
atmosphere.  Many of the contents provided here are the results of a collaborative research 
project, the EPA's Cooperative Agreement CR822053-01 with MCNC-Environmental Programs 
(Exploratory Research on Air Quality Modeling Techniques: Research on Numerical Transport 
Algorithms for Air Quality Simulation Models), and other related in-house projects at EPA. 
Readers are referred to Alapaty et al. (1997), Byun (1999a, b), Byun and Lee (1999), and Odman 
(1998) for additional information. 

In principal, the transport process consists of advection and diffusion that cause the movement 
and dispersion of pollutants in space and time.  Transport of pollutants by the parameterized 
subgrid-scale cloud modules is not considered here.  We have assumed that the transport of 
pollutants in the atmospheric turbulent flow field can be described by means of differential 
equations with appropriate initial and boundary conditions.  In Eulerian air quality models, the 
transport process is modeled using numerical algorithms.  These numerical algorithms for the 
advection and diffusion processes must satisfy several propertfos that are essential for making 
useful air quality simulations.  As with all numerical methods, the numerical schemes for solving 
the transport equations must meet convergence conditions and correctly model the conservation, 
dissipation, and dispersion properties of the governing equations.  A numerical scheme is said to 
be convergent if the solution approaches the true solution of the corresponding partial differential 
equation as the grid spacing and time-step size become infinitesimally small.  Thus, a convergent 
numerical scheme can provide a numerical solution of any desired accuracy within finite precision 
bounds by reducing the grid spacing and the time-step size.  For linear equations, consistency and 
stability are both necessary and sufficient conditions for convergence (Lax's equivalence 
theorem).  In practice, machine precision and the computational resource availability limit the 
reduction of grid spacing and time-step size.  Therefore, numerical errors associated with using 
limited grid spacing and time-step sizes must be of concern. 

· 

There have been ~any studies on the numerical advection algori~s used in air quality models. 
The reason it ~ttracted so much attention is that the equation is hyperbolic in nature and spatial 
discretization of the solution generates a finite number of Fourier modes that travel at different 
speeds and leads to constructive and destructive interference.  If the high wave-number Fourier 
modes are damped significantly, then numerical diffusion becomes prevalent.  Solving the 
diffusion equation, on the other hand, is a lot safer because the stiffness matrix is diagonally 
dominant and  the .discretized solution is stable and sign preserving for a relatively wide range of 
conditions (Chock, 1999). 

Transport processes are of central importance in turbulent flow studies, and in the literature there 
are numerous transport algorithms that have different nwnerical characteristics and varying 
degrees of accuracy and computational complexity.  The skill needed here is to select appropriate 
numerical schemes that provide solutions with the desired accuracy at reasonable computational 
cost.  This document does not intend to provide an extensive review of the transport algorithms 
used in air quality modeling.  Instead, we describe several popular numerical schemes 
implemented in the Community Multiscale Air Quality Chemical Transport Model (CMAQ 
CTM or, hereafter,· CCTM), expecting users to choose the algorithms appropriate to their own 
study objectives.  We offer a few examples of good transport.algorithms and present some key 
numerical characteristics users should look for.  With this information, users can find the best 
algorithms through evaluation processes, and may even bring in their own algorithms to build a 
transport model for their applications.  To provide the CMAQ system with the multiscale and 
multi-pollutant capabilities, we strive to incorporate schemes that can function under a wide 
variety of dynamic situations and distribution characteristics (e.g., distributions of different 
primary species and secondary species are quite distinct).  Also, the schemes should be efficient 
in the use of computer time and storage.  Selected numerical transport algorithms for horizontal 
and vertical advection and for vertical and horizontal diffusion are described below.· 

7.1 

Numerical Advection Algorithms 

Numerical advection algorithms for air quality models should satisfy several computational 
requirements. 

• 

• 

• 

• 

• 

They should be free of mass conservation errors to accurately account for pollutant 
sources and sinks. 

They should have small numerical diffusion to minimize the spread of a signal in every 
direction and the smoothing of spatial gradients. 

They should also have small phase errors since disturbances that propagate at different 
speeds produce spurious oscillations. 

Given initial positive concentrations, the schemes should be positive-definite (i.e., they 
should not produce negative concentrations. 

They should be monotonic (i~e., they should not produce new extrema). 

While it is essential that the schemes be positive-definite, this alone may not be sufficient 
because the monotonic property, for example, is just as desirable for air quality modeling. 

Numerical algorithms have not been able to satisfy all the requirements listed above, and they are 
imperfect, with varying degrees of accuracy.  Advection schemes with different properties 
introduce different errors, all of which are sources of uncertainty in air quality model predictions. 
Before recommending its use, it is critical to identify which of the computational properties a 
scheme possesses.  Because an advection scheme with all the desired properties is not currently 

·  available, a user needs to select a scheme with the most desirable properties and greatest 

efficiency to meet the needs of the application. 

7~1.1  Conservation Form Equation for Advection 

'111 

The atmospheric advection process is expressed in conservation (flux) form as: 

(7-1) 

• 

"' 

where cp,  is the concentration of trace species i coupled with the coordinate Jacobian.  Refer to 
Chapters 5 and 6 for the definition of symbols used in Equation 7-1.  For convenience, the 
advection process is decomposed into horizontal· and vertical adv.ection processes, with the 
fractional time-step implementation: 

(7-2) 

-

(7-3) 

,  v2  and v3  are contravariant components of wind velocity.  Splitting of the three(cid:173)

where v1
dimensional (3-D) advection into the horizontal and vertical components will lead some 
difficulties, such as the representativeness of the mass continuity and -setting up of proper 
boundary conditions for non-~rthogonal horizontal and vertical directions when simulating a 
region with complex topography. 

Many models further split the horizontal advection equation in two directions and solve for two 
one-dimensional equations, one in each direction, using the solutio~ of one as the initial condition 
of the other.  We refer to this scheme as a one-dimensional (1-D) algorithm.  Others solve the 
two-dimensional (2-D) form directly.  Although using 1-D schemes is very common, it has been 
found that problems can arise due to this additional splitting (Flatoy, 1993, and Odman and 
Russell, 1993).  Although 2-D schemes may be more desirable in this regard, fewer have been 
tested and they are often more cJifficult to implement and less computationally efficient than 1-D 
schemes.  Also, there are general conditions in which the splitting scheme is actually more stable 
and accurate than the non-splitting case for higher-order approximations because the splitting 
scheme intrinsically contains cross-spatial derivatives whereas the non-splitting scheme would 
not (Leith, 1965).  Yanenko (1971) has shown that time-splitting is second-order aecurate if the 
one-component advection operators commute.  Alternating the sequence of operations would be 
quasi-second-order accurate in the case of non-commutativity (Chock, 1999).  Here, only 1-D 
schemes will be discussed.  When using appropriately interpolated contravariant wind 
components, the 1-D advection in the generalized coordinate system is equivalent to the 1-D 
equation in the Cartesian coordinate system.  Therefore, it is sufficient here to discuss advection 
algorithms in Cartesian coordinates. 

The 1-D advection equation written in the Cartesian coordinate system is: 

acp 
ii+  ax  = 

(}(u<p) 

0 

(7-4) 

Equation 7-4 is the flux (or conservation) form and the quantity  Fx = u<p  is defined as the one(cid:173)
dimensional constituent flux.  The flux form is a natural choice here because it is based on the 
continuity equation without any assumptions on the atmospheric dynamics.  Maintaining the 
advection equation in flux form is key to providing transport schemes with multiscale and multi(cid:173)
pollutant capabilities.  A flux-form discretization of Equation 7-4 with first-order accuracy in 
time results in: 

n+l 

n 
<pj  = <pj  -

/lt  (Fn 
llx 
j 

j+1/2  -

) 
pn 
j-112 
' 

(7-5) 

where  Fj:1, 2  and  Fj"_112  denote the advective fluxes through the faces of cellj,  llt is the time-step 
and  L1xj =  xj+ 112  -xj_ 112  is the horizontal grid spacing.  To maintain numerical stability, and to 
accommodate other physical changes such as emissions input in a synchronized way, the time(cid:173)
step of 1-D advection should satisfy the Courant-Friedrich-Lewy (CFL) condition for hyperbolic 
equations: 

(7-6) 

where  f3j+ 112  = ju1+1, 2I ::. is the Courant number for advection.  This condition should be viewed 

J 

as a method defining a reference time scale for accommodating different physical processes in 
AQMs.  lfwe do not consider the synchronization of mass injection to the ~ell through other 
physical processes, the CFL condition can be determined sep_arately for individual advection 
schemes.  For certain schemes the restriction can be significantly less than one.  
And for advection alone, an implicit scheme may not have the Courant number restriction for stability 
(Chock, 1999). 

7.'1.2  Classfucation of Advection Schemes 

" 

, 

, 

I 

' 

I'''" 

,111,p 

"""'•II' 

, 

, 

Numerical advection schemes in the literature were developed using several different approaches 
(e.g., Chock and DUnker,  1983, and Chock, 1985, 1991).  Following Rood (1987), we classify 
these schemes based on the methoqs used in their formulations.  However, reviews in the 
literature may not capture the most recent developments in advection research.  Depending on· 
the methods used, the schemes may be classified as: 

I 

• 
• 
• 
• 
• 
• 

Finite diffe~ence schemes; 
Finite volume schemes; 
Flux corrected schemes; 
Lagrangian Schemes; 
Finite element schemes; or 
Spectral schemes . 

The distinction is somewhat arbitrary and only meant to convey the key intrinsic features of the 
scheme.  Current trends in advection scheme development show a merging of the methods to take 
advantage of the most desirable properties of several schemes.  For example, the Characteristic(cid:173)
Galerkin method (Childs and Morton, 1990) combines the best of the finite element and 
Lagrangian methods.  Flux corrections are being used in the framework of finite element and 
spectral schemes (Lehner et al., 1987).  Also, the classical finite difference schemes are being 
abandoned in favor of modem finite volume schemes.  Refer to Odman (1998) for details of the 
classification. 

' 

7.1.3  Description of Advection Schemes in CCTM 

In this section we describe the schemes that are available with the first release of the CCTM 
codes in the following order: the piecewise parabolic method (PPM), the Bott scheme (BOT), 
and the Y am~o-Blackman Cubic scheme (YAM). 

Odman (1998) provides additional descriptions of the Smolarkiewicz scheme (SMO), the 
accurate space derivative scheme (ASD) (Chock,1991, and Dabdub and Seinfeld,1994), the flux(cid:173)
corrected transport, the semi-Lagrangian method, and the chapeau function scheme with Forester 
filter.  These codes are no~ integrated into the CMAQ system yet, but along with other advection 
modules, will be aclded to the system in the near future. 

To simplify the discussion, we will consider a uniform (i.e., constant~= Ax i  ) and staggered 

grid (<fJ.j  represents the grid cell average of the concentration, while Uj+112  is the advection velocity 
defined at grid cell interfaces).  While discussing the finite-volume schemes (the piecewise 
parabolic method, the Bott scheme and the Y amartino scheme) below, we use the explicit flux 
formula presented in Equation 7-5.  Further, a nondimensional coordinate 1J is defined as 1J  = (x -
Xj-l12J!Ax,  so that, in grid cellj, 0S1J S  1.  Now, suppose that the concentration has a certain 
distribution <fJ.J{ TJ)  in each grid cell.  Depending on the direction of the velocity, the flux Fj+ 112  can 
be expressed as: 

Fj+l/2  = 

Uj+l/2  < 0 

(7-7) 

where /3j+ 112 is the Courant number at the right boundary of grid cellj. 

The conditions of high-order accuracy and freedom from spurious oscillations are difficult to be 
achieved simultaneously.  The usual way to satisfy one of these conditions without significant 
violation of the other is to introduce a correction mechanism.  Typically, this mechanism is 
provided by nonlinear flux-corrections, or by nonlinear filtering.  In advection schemes, such 
adjustments are either applied implicitly through the solution or explicitly as a subsequent step 
to the linear solution.  There is extensive literature on both solution algorithms (linear and 
nonlinear) and explicit nonlinear mechanisms. 

7.1.3.1 Piecewise Parabolic Method (PPM) 

In the piecewise parabolic method (Colella and Woodward, 1984) the concentration distribution 
is assumed to be parabolic in any given grid cell.  In terms of the grid cell average concentration cpj 
and the predicted values of the parabola at the left and right boundaries of the cell cpLj and <pRj· 
this distribution can be written as: 

. 

(7-8) 

Since the initial cell average is known, the construction of the parabola involves the determination 
of the edge values.  First, an approximation to  <pat Xj+ 1/2 is computed subject to the constraint that its 
value js ~."'1tln the range of the values at the neighboring cells.  For the uniform  L1xj, a 

first guess for <pj+l/2  is estimated with: 

(7-9) 

I, 

"' 

,, 

In smooth parts of the solution away from extrema,  <pLj+ 1 =  <pRj =  <pj+ 112  so that the distribution 
is continuous at Xj+112·  In other parts, the cell boundary values are further modified so that cp  is 
monotonic on each grid cell.  This step introduces discontinuities at cell edges and yields a 
piecewise continuous global distribution for concentration.  There are two cases where the edge 
values are modified.  First, if <f'.j is a local extremum, then the distribution is assumed to be 

' 

' 

constant instead of parabolic.  The second case is when <f'.j  is between <pLj and <pRj•  but 
sWficiently close to one of the values so that the parabola may take on values outside the range, 
ahd lead to overshoots or undershoots.  In this case, to make the distribution monotonic, one of 
the edge values is reset so that the derivative of <p  (7])  is zero at the opposite edge. 

I 

, 

,, 

' 

II' 

I•,," 

,J!. 

The most distinctive feature of this monotonic scheme is that the nonlinear adjustments are 
purely geometric.  The numerical diffusion introduced by this scheme may be slightly higher than 
in some other schemes discussed here, but its monotonic property is desirable for photochemical 
IIlodeling purposes.  The scheme has been used in meteorological modeling (e.g., Carpenter et al., 
1990) and in~ q~ality models (Odman et al., 1993) including the CCTM.  The schem~ can be 
modified so ¢.at, in the neighborhood of a discontinuity, it produces a narrower profile.  This 
feature, kno'wn as steepening, avoids the smearing of sharp gradients.  Though Carpenter et al. 
(1990) did not recommend steepening for meteorological modeling, this fea~e may be beneficial 
in air quality modeling practice, where steep gradients may occur in the vertical direction. 
However, it should be noted that steepening is of no value and the PPM reverts to a lower order 
method in the case of sharp spikes or extreme values in a single cell such as emissions from point 
sources. 

1: 

'I 

' 

,, 

7.1.3.2 Bott Scheme (BOT) 

~e numerical scheme introduced in Bott (1989) is a positive definite scheme with small 
numerical diffusion.  The distribution of the concentration within the cell is represented by a 
polynomial of order I as: 

<p.(TJ) =°"'a. kT]k 

J 

I 
£.J  J, 
k=O 

(7-10) 

The polynomial can be made area-preserving by requiring: 


(7-11) 

over a stencil of!+ 1 grid cells by varying the value of i.  The solution to this linear system yields 
the coefficients aj,k·  The coefficients obtained this way for a quadratic (l=2)  and quartic (l=4) 
together with those of the donor cell (or upwind) scheme, and Tremback's scheme with second(cid:173)
order polynomials (Tremback et al.,  1987), are listed in Table 7-1. 

Using Equation 7-7, integrating the polynomial of Equation 7-10 between appropriate limits, we 
arrive at a first estimate of the fluxes.  Finally, to make the scheme positive-definite, the total. 
outflux from cell} is limited by requiring that it should be positive and less than what the 
available mass in the cell would allow: 

0 < Fout  < Llx C. 
- ,   -1:!.t' 

(7-12) 

The outflux Fj0 ut is a combination of the boundary fluxes and its expression depends on the sign 
of the velocities.  In the CCTM implementation, we used. fourth-order polynomials as 
recommended by Bott (1989) except for the boundary cells.  The scheme is receiving increasing 
attention in current air quality models because of its high accuracy and low computational cost. 

Recently, a monoto.nic version of the scheme was also developed (Bott, 1992) and the time(cid:173)
splitting errors associated with the use of one-dimensional operators in multidimensional 
applications ~ere reduced (Bott, 1993).  Monotonicity is obtained by directly replacing the 
positive-definite flux limiter of the original approach by new monotone flux ~imiters as: 

min( <p;_1, <p;) :s; cp;+1 :s;  max( <pj_1, <p;) , if  u ~ 0 
min( <p;+t • <p;) :s; cp;+1 :s; max( <p;+i • <p;) , if  u < 0 

(7-13) 

Although the new flux limited Bott scheme yields monotonic results, there is an inherent mass 
conservation problem.  This problem is directly related to the flux limiting that takes place.  Near 
the leading edge of a sharp wave the use of second or higher order polynomials causes an 
underestimation of a certain advective flux, Fk-112·.  When this flux is not corrected it is. less than 
F1c+112,  and an undershoot occurs in cell k,  as experienced With the original algorithm (Bott, 1989). 
The motivation for the monotone flux limitation is to avoid such undershoots.  However, there 
are cases when the monotone flux limiter leaves the underestimated flux intact.  Instead of 
increasing the underestimated flux, the limiter reduces the advective flux downwind, F k:+ 112, in 
order to avoid an undershoot in cell k.  This eventually reduces the net flux out of the domain 
resulting in an accumulation of mass in the domain. 

Table 7-1.  Coefficients of the Polynomials Used in Each Scheme 
Bott-4 

Tremback-2 

Bott-2 

Donor 
Cell 

cpl 

7.1.3.3 Yamartino-Blackman Cubic Scheme (YAM) 

Yamartino (1993) presents another finite volume scheme where the interpolating polynomial is a 
cubic spline: 

where  a0  =<pi 

a1 =di L1x 

a,_ = -! ( 'Pi+I  - 2<pj + <pj-1) + 3:x ( dj+I  - dj-1) 

a3 = ( <pi+I  -<pi-1)-1!; ( di+I + lQdi +di-I) 

"' The spline derivatives,  di, are obtained from the tridiagonal system: 

ad.  + (1-2a) d. +ad.  = 'Pi+1  -<pi-1 

2L1.x 

1-1 

J 

l+I 

(7-14) 

(7-15) 

(7-16) 

with a:=0.22826.  Note that a value of a:=O would correspond to explicit expressions of d .. 
J 

' 

7-10 

The positivity of <p/1J)  is ensured by various mechanisms.  First, when <fJ.j  is a local minimum, a 
donor-cell scheme is used instead of the cubic spline.  Second, the spline is spectrally limited by 
the relation: 

EPA/600/R-991030 

k 

ak  $; !!___,  k = 1,2,3. 
a0 

k! 

(7-17) 

Third, a mass conservative flux renormalization is applied, where the fluxes are normalized with 
the ratio for the upwind cell of the cell concentration (i.e., concentration at 17=0) divided by the 
average concentration.  Finally, a mildly diffusive filter is applied in an attempt to block the 
depletion of donor cells.  Y amartino' s scheme is not monotonic and can generate new maxima. 

7.1.4  Treatment of Boundary Conditions 

Mathematically, the advection equation is a first-order hyperbolic partial differential equation, so 
it accepts only inflow boundary conditions.  Physically, the solution is not affected by the 
downwind concentrations, so no outflow boundary conditions should be imposed.  In practice, 
however, some outflow boundary conditions have to be imposed.  Often, the characteristics of a 
numerical advection scheme are affected by the boundary condition used. 

In the CCTM, a positive.,definite zero-flux outflow boundary condition with appropriate flow 
divergence restriction is used.  The zero-flux divergence condition at the boundary (flux gradient 
out of the boundary cell is set equal to the flux gradient into the cell, i.e., 
u1 ( <p1 - <fJo) I L1x = u2 ( <p2  - <p1) I L1x)  gives: 

(7-18) 

where <p0,  <pi.  and <fJ2  represent concentrations outside the computational domain, at the boundary 
cell, and first cell of the inner domain, respectively. u1 is wind at the outer boundary flux point 
and u2  is wind at the inner boundary flux point.  Refer to Figure 7-1  for the cell subscript 
definitions at the outflow boundary.  To prevent spurious boundary flux situations that are often 
associated with the zero-flux divergence boundary condition, the following constraints are 
applied.  When u1 is sufficiently small (for example smaller than 10-3 mis), or when the wind is 
divergent at the boundary cell (i.e., u1•  u2 < 0), a zero concentration gradient at the outflow 
boundary (i.e.,  <fJo  = <p1)  is imposed.  This boundary scheme can be used with any of the 
numerical advection algorithms implemented in CCTM. 

On the other hand, Odman (1998) introduced a "no condition at outflow boundary" [sic], for 
Bott's scheme where the scheme is modified to remove the need for the concentration <p  0 at the 
downwind cell.  A first-order polynomial (derived from <p  1 and <p 2)  is used in Cell 1 to compute 
the flux out of the domain.  A second-order polynomial (derived from <p  i. <p 2 and <p 3 is used in 
Cell 2 and a (cmrtJ:l-~rder polynomial is used in Cell 3.  Mathematically, this condition is more 
correct than tpe ot:hers.  However, the order of the polynomial is reduced to
one at the boundary 
while the other conditions use a second-order polynomial to compute the flux out of the domain. 
Because of the lack of generality of this approach, we have not implemented Odman' s boundary 
s~heme in th~.,CC::'TM.  The improved positive-definite zero-flux outflow boundary condition 
scheme essentially reproduces his results without having to rely on the modified advection 
algorithms ne.ar bOundary. 

'  ' ~ 

'I' 

1

I 

I 

, 

_..,_ 

<f'o 
x 

0 

<f'1 
x 

1 

x 

2 

3 

Figure 7-1.  Outflow boundary condition.  Cell 0 is outside the domain.  Vertical solid line 
denotes the domain boundary and the vertical dotted lines denote the cell interfaces. The 
advection sc~eme computes concentrations for Cells 1, 2, 3, and so on. 

7.1.5  Test of Algorithms with Idealized Linear Horizontal Flow Fields 

Typically, the performances of advection schemes are measured and compared with each other 
m;ing test cases with idealized flow fields.  These ideal flow tests have analytic solutions and 
Illay be very use~ for determining certain properties of the schemes.  Odman (1998) provides 
some evaluation results identifying schemes with desirable properties.  Here we summarize the 
results of the one-dimensional tests and rotating cone test. The evaluaiion and comparison of the 
schemes are based on the performance measures listed in Table 7-2.  Again, readers are referred to 
Odman (1998) for the details of the analysis. 

Table 7-2.  Summary of Performance Measures Used to Test the Effects of Numerical 
Advection.  <p;  and  <p;e  methods and exact concentrations.+ 
Peifonnance Measure 
peak ratio& 

Description 
Measure of peak preservation (best when  1.0) 

EPA/600/R-99/030 

Formula 
max(<p;) 
max(<p;e) 
min(<p;) 
max(<p;e) 

Background to peak ratio 

mass ratio 

Distribution ratio 

Measure ofripples introduced by a non(cid:173)
monotonic scheme 

Measure of mass conservation characteristic 
(best when 1.0) 

Measure of shape retention (best when 1.0) 

Average absolute error 

Measure of absolute difference (best when 0.0) 

root-mean square error 

Measure of distribution error (best when 0.0) 

To account for the total mass correctly, the concentration should be coupled with the Jacobian of the grid system 
& Peak ratio alone is not a meaningful criteria unless the positions of the computed and actual peaks are also given. 

7.1.5.1 Advection of One-nhnensional Pulses 

Various tests have been conducted in the literati.ire with pulses of different shapes advected with 
uniform velocity.  We conducted tests using a Gaussian sngnal of exactly 88x width with 100 
ppm peak advected from cell 25 to cell 75  in a 100-cell uniform grid· domain.  Background values 
were set at 5 ppm.  Table 7-3 summarizes the value of various performance measures after 
advected the signal for a .distance of 508x at a Courant number of 0.25 (i.e., after 200 time-steps). 
The Accurate Space.Derivative (ASD) an~ Yamartino's schemes (YAM) preserved the peak. 
height very well.  _However, the distribution ratio has a lower value for YAM,. indicating 
distortions of the pulse's shape.  For the same reason, the average and RMS errors are larger than 
those of the ASD .. On all accounts, these two schemes p~rform much better, than the other 
schemes in this test.  Bott's scheme (BOT) ranks third overall, but large ripples are observed at 
leading and trailing edges of the pulse as indicated by the values below the background (as much 
as 4% of the peak height).  When the monotonic limiter is used (BOT-M), the ripples are 
eliminated but the peak retention performance deteriorates.  Also, a 2% increase in mass is 
observed.  PPM is somewhat more diffusive than BOT-M.  However, PPM performed better 
than BOT-Min minimizing the average absolute error and root mean square error and because it 
is intrinsically monotonic, did better in regard to shape retention as measured by the distribution 
ratio.  Smolarkiewicz's scheme (SMO) displays poorer performance than the other schemes. 


SMO produces ripples upwind from the pulse and leads to average and RMS errors larger than 
other schemes. 

'" 

Table 7-3.  Gaussian signal test (Abridged from Odman, 1998) 
Scheme 
PPM 
Peak Ratio 
0.69 
Background 
0.05 
Mass Ratio 
1.00 
Distribution 
0.79 
Average Error 
1.16 
0.17 
RMS Error 

BOT 
0.87 
0.01 
1.00 
0.93 
0.87 
0.18 

ASD 
0.99 
0.05 
1.00 
0.99 
0.08 
0.01 

0.74 
0.05 
1.02 
0.83 
1.38 
0.27 

BOT-M 

SMO 
0.61 
0.02 
1.00 
0.66 
2.21 
0.50 

YAM 
0.98 
0.05 
1.00 
0.92 
0.51 
0.12 

7.i,.5.2 Rota#ng Cone Test 

In this test, a cone-shaped puff is introduced into a rotational flow field and followed for a certain 
number of revolutions.  The exact solution is a rigid-body rotation of the puff without any change 
to its original shape.  Various errors can be revealed in this test.  For example, numerical diffusion 
(or dissipation) manifests itself in the drop of the peak height during rotation.  Also, by 
observing the location of the peak, one can determine the leading or lagging phase-speed errors. 

A 32x32 grid is used for this test (i.e.,  -16.6.x::; x::; + 16.6.x;  -16~y::; y::; + 16.Ay  L\x= L1y ).  A 
cone-shaped puff with peak concentration equal to 100 ppm and a base radius of 4.6.x is 
initialized suqh that its peak is located at [+8 L\x, O].  Note that the peak is not initially at a grid(cid:173)
cell center but a cell comer (i.e., there are four cells around the peak with the same average 
concentration).  The background concentration is set to 5 ppm.  To obtain a counterclockwise 
rotation around an axis passing through the center of the domain, the wind field is defined 
as u =-my and  v = mx.  The angular velocity, ro,  is adjusted so that the Cou'rant number of 
approximately 0.28 at the location of the peak of the puff. 

" 

I 

I: 

I! 

Table 7-4.  Rotating Cone Test (Abridged from Odman, 1998) 
Scheme 
Peak Ratio 
~ackground 
Mass Ratio 
Distribution 
Average Error 
RMS Error 

BOT 
0.87 
0.03 
1.00 
0.93 
0.46 
0.16 

ASD 
0.99 
0.06 
1.00 
0.96 
0.18 
0.05 

0.65 
0.06 
1.02 
0.83 
0.76 
0.30 

0.65 
0.06 
1.02 
0.83 
0.76 
0.30 

BOT-M 

BOT2D 

PPM 
0.61 
0.06 
1.00 
0.78 
0.54 
0.18 

SMO 
0.49 
0.02 
1.00 
0.64 
1.60 
0.51 

YAM 
0.99 
0.06 
1.00 
0.91 
0.33 
0.13 

ASD and YAM maintain the peak height and the overall shape of the cone better than the others. 
BOT performs third best in this test, but it yields non-monotonicity, which results in values 
below the background (as seen in a ring-shaped valley at the base of the cone).  BOT-M and 


PPM predict similar peak heights (65% and 61 %, respectively), but the shape distortions look 
very different in each case.  PPM has the worst peak clipping effect but the resulting shape has 
the smallest base span among the three schemes. SMO is clearly the most diffusive scheme; it 
also introduces a ripple upwind from the cone.  Table 7-4 summarizes the performance measures 
at the end of two rotations.  Since there is no shear in the flow field, BOT-Mand the two(cid:173)
dimensional version ofBott's scheme (BOT2D) (Bott, 1993) produce identical results.  Again, 
the mass conservation problem is revealed with BOT-M.  BOT preserves 87% of the peak height 
(third best after ASD and YAM), but it leads to ripples with an amplitude of 3% of the original 
peak height.  Performances ofBOT-M and PPM are comparable in predicting the peak.  But 
PPM produces the lower distribution ratio, smaller absolute average and RMS errors.  Notice 
that the comparison results obtained from this test are ve:ry similar to those of the Gaussian 
signal test.  Additional test results such as skew advection of a point-source plume and advection 
with shear flow are available in Odman (1998).  Also, effects of density distribution on the 
numerical advection are studied with a set of linear flows in Byun and Lee (1999).  The solvers 
integrated into the CCTM are BOT, PPM and YAM.  Although ASD has very high accuracy 
except for the 2 Ax wavelengths, ASD is neither strictly mass conservative nor monotonic.  It is 
also the most CPU-intensive scheme (taking about 4-5 times longer than BOT).  In addition to 
BOT' s overall performance, results reported in Odman (1998) for a broad series of tests showed 
that BOT had the best computational performance of all the schemes tested.  However, because 
of the concerns over the non-monotonicity about BOT and the mass conservation problem and 
diffusive nature of BOT-M, we chose PPM for a number of demonstration executions (Byun et 
al.,  1998).  Similar testing with BOT and YAM is underway.  We intend to integrate other 
methods into the CCTM at a later time. 

7.1.6  Vertical Advection 

Algorithms in the CCTM for vertical advection are essentially the same as those for the one(cid:173)
dimensional horizontal algorithms.  However, the vertical advection is performed in terms of the 
generalized vertical coordinate in CMAQ.  The contravariant vertical velocity component is used 
as the transport wind for the irregular vertical grid spacing (usually expanding with altitude) 
represented in the generalized coordinate.  For the irregular grid, the computational time-step 
should satisfy the CFL condition: 

At < 

.  { Agk-1 
k 

Agk 
v· k-112  v  k-112 

- mm  I "3 

I ' I "3 

Agk  Agk+I  } 
I ' I "3 
I 
v· k+112  v  t+112 

I ' I "3 

(7-19) 

As in the case of Cartesian representation, we assume there is no mass exchange by advection 
(i.e.,  v3 = 0) at the top and bottom boundaries of the model.  Therefore, there is no need to apply 
special algorithms for the boundary process.  Because vertical grid spacing is usually irregular in 
most air quality models, a scheme that can accommodate irregular spacing must be used for 
vertical advection.  This means that numerical algorithms used to represent the vertical advection 
may be different from that used for horizontal advection.  For example, when the ASD algorithm, 
which requires equal spacing in the computational domain, is used for horizontal advection, a 
numerical algorithm that allows irregular spacing (e.g., BOT and PPM) would need to be used for 
vertical advection. 

7.1.7  Adjustment of Mass Conservation Error 

' 

,,,11:' 

Recently, Byun (1999a, b) has highlighted the importance of dynami.c consi~tency in 
meteorological and air quality modeling for multiscale atmospheric applications.  Mass 
consistency quantifies how well the density and wind fields satisfy the continuity equation for 
air.  One of the furldamental requirements for the numerical transport algorithms used in air 
quality models is the conservation of trace species in the domain.  Ideally, the input 
meteorological data for air quality simulations should be mass consistent.  However, using 
n.umerical models with highly parameterized physical and cloud algorithms, inappropriate set of 
governing equations, misapplication of four-dimensional data assimilation (FDDA) schemes, or 
using incomplete objective analysis methods to characterize the atmosphere for a CTM could 
result in meteorological conditions that are not mass consistent.  In this situation, even precisely 
mass conserving numerical algorithms may fail to conserve trace species mass in the domain. 
Preferably, the mass inconsistency must be minimized before air quality simulation using a 
suitable diagnostic relation or a variational wi.tid field adjustment scheme as discussed in Byun 
(1999b) and in Chapter 5.  For certain vertical coordinates with appropriate dynamic 
assumptions, the diagnostic methods can be used within the CTM to provide mass consistent 
wind data.  This is accomplished usually by adjusting the vertical wind component for the 
advection process.  However, the variational methods are applied during the meteorological data 
preparation stage, instead of inside CTMs, mostly due to the computational efficiency reasons. 

• 

1 

•11,, 

I 

Whether the meteorological data are mass consistent or n~t, Byun (1999b) has shown that the 
trac~r mixing ~ati~ must be c~nserved as a p~econdition f~r .the trac~r mass conservation.  He has 
r~ported se~e~al adjustm~nt schemes used in current air quality models and.proposed a two-step 
time splitting numerical algorithm that satisfies the mixing ratio conservation equation.  In the 
event the meteorological data are not mass consistent, the mixing-ratio conservation scheme is 
demonstrated to be useful for photochemical air quality models where chemical production and 
loss terms are computed using molar mixing ratio.  For this purpose, Equation 7-1  should be 
modified as follows to conserve trace species: 

(Jq/ __ , = 
at 

(7-20) 


where  QP  is the density error term for the meteorological data.  This is a necessary condition for 

the tracer mass conservation.  The total tracer mass of the domain is conserved only when the 
additional condition that total air mass of the domain is conserved, i.e.: 

(7-21) 

where an  represents the boundary of a computational domain.  However, even this condition 
does not guarantee the cell base conservation of tracer mass except for the case of uniform mixing 
ratio, because  Jf J <p;  QP dV = Jf J q;  l.; QPdV :t= q;f Jf  .I.; QPdV  in general.  Because of this, the 

anm 

an 

P 

an  m 

correction methods should only be used for improving mass conservation characteristics of the 
numerical advection algorithms after the mass inconsistency is minimized .  Nevertheless, if the 
objective is to maintain the property of cell-based mixing ratio conservation, the mass 
conservation error caused by the inconsistency in meteorology data ( <p;  Qp ) can be corrected 

p 

with: 

(<p~Y°r = (<p~)T exp[J QP dt] 

I 

I 

p 

(7-22) 

where superscripts 'T' and 'cor' represent values after transport (advection) and after correction, 
respectively.  Table 7-5 summarizes several adjustment methods reported in Byun (1999b).  An 
adequate correction scheme for photochemical Eulerian AQMs should conserve the tracer mixing 
ratio at least even if wind and density fields are not m:ass consistent.  The correction scheme 
proposed and labeledA5 in Table 7-5 is expected to maintain conservation of mixing ratio up to 
machine precision.  Correction schemes Al and A2 ignore the effects of coordinate/grid structures 
during the advection process.  For Cartesian coordinates where the Jacobian is uniform and 
constant with time, the scheme A2 is equivalent to A5.  For a steady-state flow, schemes A3, A4, 
andA5 become identical.  Note that all the correction algorithms in Table 7-5 become the same for 
a steady state flow with uniform density distribution in Cartesian coordinates. 

Table 7-5.  Trace Gas Mass Correction Schemes 
Symbol  Correction Method 

Mass correction algorithm 

AO 
Al 

A2 

A3 

A4 

AS 

No correction 

AcivectJon of unity 

Advection of air density 

Advection of pl~ I m 2  with 
anelastic approximation 
Advection of pl~ I m 2  with 
fmite differencing of tendency tenn 
Advection of pl~ lm 2  with two(cid:173)
step time splitting 

<p  cor  = J!.L_<p  ,  <p  = 1.0 

J 

r 

r 

T 

T 
'Pr 
T 
PT 

<p cor  = PJ_ pint 

I 

(  J  I  2)"" - (  J  I  2)T 
<p1  < m 

- c1  < m 

exp 
[

(pJ  I m2)  (pl  I m2)T] 

{ 

• -

~ 
(pJ,tm  ). 

2 

(Note: Superscripts cor, int, and Trepresent corrected, interpolated, and advected quantities, respectively.) 

Byun and Lee (1999) compared the performance of the correction algorithms under several 
idealized two-dimensional linear flows and different density fields.  In addifam, the linearity of 
the advection processes was studied to show how well the different precursors from same 
sources can be advected without losing their integrity.  The characteristics of the correction 
procedures can be summarized as follows: 

• 

• 

• 

The correction scheme fixes mass conservation errors due to the time splitting and 
numerical algorithms as well as the mass inconsistent meteorological data input. 

The cqrrection scheme does not, however, improve inherent properti~s of the numerical 
advection scheme such as monotonicity, or numerical diffusion. 

In a budget study, such as in process analysis, the adjustment proces~ must be considered 
as an iµtegral part of the three-dimensional advection.  Horizontal advection, vertical 
advection, and the mass correction ste~ all together simulate the atm~spheric advection 
process. 

I 
I 

7.2 

Vertical Mixing Algorithms 

In this section, we describe turbulence closure schemes for the CCTM.  We describe numerical 
algorithms for vertical mixing and dry deposition, and discuss the details of the mathematical 
representations, integration time-steps and solvers.  Unless stated otherwise~ the vertical 
structures of meteorological and chemical transport models are assumed to be the same.  This is 
desirable because the interpolation of meteorological quantities in vertical direction would alter 
the original turbulent flux exchange characteristics. 

7.2.1  Closure Problem 

Because of the stochastic nature of atmospheric motion, the primitive equations in the set 
describing the atmosphere are averaged to form a set of deterministic equations before they can be 
solved numerically.  The decomposition of velocity components and concentrations into mean 
and turbulent terms and the application of ensemble avera.ging produces Reynolds flux terms in 
the species mass continuity equation.  Introduction of the Reynolds flux terms generates a new 
problem set in which the number of unknowns is larger than the number of equations.  This 
closure problem is caused by the attempt to represent nonlinear processes such as momentum 
advection using a linear decomposition such as the Reynolds decomposition.  We describe some 
approaches on the closure of the Reynolds flux terms below. 

7.2.1.1 Local Closure 

Local closure assumes that turbulence is analogous to molecular diffusion, i.e., that an unknown 
turbulence flux at any point in space is parameterized by values of known quantities at the same 
point (Stull, 1988).  First order closure retains the prognostic equations for only the mean 
variables such as wind, temperature, humidity, and trace gas concentrations while the second(cid:173)
order moments (Reynolds fluxes) are approximated.  An example of a local closure scheme is the 
approximation of Reynolds flux terms using a gradient transport theory, or a mixing length theory 
resulting in an eddy diffusion method.  One of the problems with the gradient transport theory is 
finding a rational basis for parameterizing the eddy diffusivity.  Also, the theory fails when 
eddies larger than the grid size are present, like they are in a convective boundary layer. 

The so-called one-and-a-half order closure retains the prognostic equations for the mean variables 
and adds equations for the variances of those variables.  The set of one-and-a-half order equations 
is obtained by simplifying the full second-order turbulence equations.  Instead of the velocity 
component variance equations, the turbulent kinetic energy (TKE) equation is often used.  By 
including the variance equations, we have increased the number of unknowns that need to be 
parameterized compared to the first-order closure approach.  However, the benefit is that the 
eddy diffusivity can be parameterized not only with the mean quantities but also with the TKE 
and the temperature variance which characterize turbulence intensity.  However, if an air quality 
model is based on one-and-a-half order closure in a true sense, the prognostic equations of the 
variances for the tracer concentrations should be included explicitly.  In practical Eulerian air 
quality models that deal with photochemical problems, additional prognostic variance equations 
for the tracer species are very expensive computationally.  Also, the additional closure problem 
must be dealt with by parameterizing the Reynolds average terms involved with the variances for 
tracer species.  Therefore, the one-and-a-half order closure for an air quality model often actually 
means that the diffusion equations for the tracer species are formulated. with first order closure, 
while eddy diffusivities (if gradient theory is applied for the closure) or turbulent fluxes (if non(cid:173)
local flux-bas~d closure is used) are estimated with the TKE information from a meteorological 
n1.odel with o~e-aP.<l-a-half order schemes for wind, temperature, and humidity. 

The set of sec~md--0rder turbulence equations includes all the second moment terms.  To derive 
these terms, parameterizations on a full set of third-order moments are required.  Similar to the 
first-ord~r cas,~~ th~ second-order closure approximates terms involving third moments.  Several 
basic closure assumptions such as down-gradient diffusion, return to isotropy, and turbulent 
dissipation in the inertial subrange are used in the parameterization of the third moment terms. 
These parameterizations must be valid, especially, for the scales of the energy-containing eddies 
that are sensitive to atmospheric stability.  Measurements of high-order moments in the real 
atmosphere are difficult because oflarge scatter in the direct flux measurements and because a 
long averaging time or a very large sample size of data is required because the events with a much 
lower probability of occurrence must be gathered to estimate higher-order moments using eddy(cid:173)
correlation methods.  For air quality applications, especially for a complex chemical reaction 
system, the technique requires too many ad-hoc assumptions that cannot be confirmed by 
observations ~r other theoretical reasoning.  In addition the second-order closure incurs a 
prohibitively high computational cost.  As before, we can solve the first-orcler tracer diffusion 
equations with the variances and covariances for wind components, temperature, and humidity 
from the second-order meteorological models.  For air quality applications, the true second-order 
closure formulation solves for the cross-species covariances explicitly.  Some researchers have 
attempted second-order closure for simple chemical mechanisms with a limited number of 
photochemically reactive species.  The introduction of additional parameterizations for the third(cid:173)
order moment terms among the tracer species themselves and wind components (about which we 
lack sufficient knowledge) and the added cost of solving for a large number of covariance terms 
make this scheme impractical and prohibitively costly for operational Eulerian photochemical 
models. 

7.2.1.2 Non-local  Closure 

Non-local closure recognizes that larger-size eddies can transport fluid across finite distances 
before the smaller eddies have a chance to cause mixing.  This advection-like concept is supported 
by observations of thermals rising with undiluted cores, finite size swirls of leaves or snow, and 
the organized circulation patterns sometimes visible from cloud photographs. 

"•111;: 

" 

,1 

I 

'' 

•i•h:ll' 

Two main approaches of non-local closure methods are the transilient turbulence theory and the 
spectral diffusion theory.  Both allow a range of eddy sizes to contribute to the turbulent mixing 
process.  The spectral diffusion theory attempts to simulate mixing process by transforming 
signals into a spectral space.  For example, a spectral diffusion model of Otte and Wyngaard 
(1996) represents the mean variables within the planetary boundary layer (PBL) by a truncated 
series of Legendre polynomials.  The first Legendre mode represents the layer average, and 
additional modes add structure to the vertical profiles.  Only a few modes are necessary to 
resolve vertical profiles comparable to high resolution diffusion models.  However, the need to fit 
a different number of spectral modes for each trace species makes the scheme less attractive for 
air quality application and thus it have not been considered here.  The transilient turbulence 
theory (e.g., Stull, 1988) is a general representation of the turbulent flux exchange process.  The 
Latin word transilient, meaning to jump over, is used since turbulent eddies that exist in the PBL 
can transport mass and momentum directly across several grid layers.  A variety of mixing 
processes can be modeled with the transilient scheme depending on the form of the transilient 
matrix.  Examples include complete mixing, top-down/botil:om-up mixing, asymmetric convection 
mixing, small-eddy mixing, cloud top entrainment, a detra:ining updraft core, patchy turbulence, 
no turbulence, or eddies triggered by the surface layer.  Non-local closure is most suitable for 
describing vertical turbulence mixing process, which should representturbulent diffusion and 
atmospheric transport by eddies of different sizes simultaneously. 

In the following, we describe only the first-order turbulent mixing schemes.  The true one-and-a(cid:173)
half and the second-order closure schemes are not discussed here.  We organize the description of 
vertical mixing algorithms based on the details of the turbulence parameterization; the eddy(cid:173)
diffusion form or the Reynolds-flux form.  Both the eddy-diffusion and the Reynolds-flux forms 
are capable of accommodating information from higher order turbulence closure for momentum 
and other meteorological parameters such as potential temperature and humidity.  The vertical 
diffusion modules in CMAQ will include two different ways of parameterizing the eddy 
diffusivity (using PBL similarity theory and using TK.E) and three flux form non-local algorithms 
(Blackadar, ACM, and Transilient Turbulence). 

7.2.2  Computing Vertical Mixing with the Eddy Diffusion Formulation: K-Theory 

The eddy diffusion algorithm in the CCTM computes the following: 

a<p; I  = _J_[  E-(k33 aqi )] 
ax3 
at 

ax3  -vrP 

. 

vdiff 

(7-23) 

7-21 

A16ooffi._991d~o 

where K33  is the contravariant vertical component of eddy diffusivity in the generalized 
coordinates.  The contravariant eddy diffusivity is related to the diffusivities in Cartesian 
coordinates as: 

(7-24) 

where J~ -t = l~l Here we focus on the parameterization of the eddy diffusivity,  Ka, in a 
generic Cartesian vertical coordinate z (geometric height h).  Parameterizatio~s of the horizontal 
eddy diffusivity are described later.  However, in the current CMAQ implementation, the term 
involving horizontal diffusivity kH in Equation 7-24 for the estimation of K33  is neglected. 
Evaluation o~ the effects of this simplification is left for future work. 
7.2.2.1 Paran;_eterization of Vertical Eddy Diffusivity  Kv.  with PBL Similarity Theory 

.. 1 

":11111:. 

'" 

I' 

11·':i 

, 

• 

" 

' 

There are several eddy diffusivity parameterizations using different similarity theories.  Since 
~ese ar~ somewh~t similar, we consider the formulations suggested by Businger et al. ( 1971) and 
Hass et al. (1991) to represent the turbulent process in the surface layer and'mixed layer. 
Previous studies (Chang et al.,  1987, and Hass et al.,  1991) indicated that this type of 
formulation can represent turbulent mixing in air quality models adequately.  With K-theory, we 
assume that kce ~pecies have non-dimensional profile characteristics similar to potential 
temperature~e, i.e., Kzz =  Kh.  We briefly describe the surface and boundary layer similarity 
theory used for the parameterization of eddy diffusivity for different stability regimes of the 
PBL below.  The stability regime is defined with a nondimensional number z/L, where z is the 
height above the ground and L is the Monin-Obukhov length. 

.. 

For the surfa9e layer, the non-dimensional profile functions of the vertical gradient of e are 
expressed as: 

i 

····. 

z 
</Jh  = Pro(l + f3h  L) 
<Ph  = h - r h ~ t 112 

L 

for moderately stable conditions (1  ;:: z/L ;:: 0) 

(7-25a) 

for unstable conditions (z/L < 0) 

(7-25b) 

where  Pr0  is .the Prandtl number for neutral stability and  f3h  and r h are coefficients of the profile 
functions determined through field experiments.  In addition, following Holtslag et al. (1990) we 

' 

7-22 

add a function for the very stable condition (z/L ~ 1) to extend the applicability of the swface 
layer similarity: 

Parameterizations for eddy diffusivity for the surface layer can be shown as: 

K 

ku.z 

_ 
h-----
<l>h(zl L) 

where u* is the surface friction velocity. 

For the PBL (above the surface layer), eddy diffusivity is parameterized with: 

ku,.z(l- zl h)312 
K l= - - - - - -

' 

</>,,(zl L) 
K,. = kw.z(l- zl h) 

z 

for.  L> 0  (stable) 

z 
L 

for  -< 0  (unstable) 

. .  

(7-25c) 

(7-26a) 

(7-26b) 

(7-26c) 

In the above expressions, his the depth of the boundary layer, kthe Von Karman constant, and 
w* the convective velocity.  Refer to Chapter 12 for the method used to estimate the PBL height 
in the CMAQ modeling system. 

These parameterizations for Khare sensitive to the boundary-layer height (h) and surface-layer 
height. Therefore, when the vertical resolution is too coarse in the boundary layer, using a 
"representative" eddy diffusivity together with the mean-concentration gradient at the interface 
seems to be more appropriate for the estimation of the diffusive flux.  In fact, the diffusive flux 
across the interface can be estimated more accurately with the mean diffusivity and mean 
concentration gr~dient than with local di:ffu:~ivity and mea~ c~nc~ntration ~adient; the former has 
an error of O[(Ac;)2
"representative" eddy diffusivity at the layer interface, integrated eddy diffusivity formulas are 
used as in RADM and CMAQ.  They are summarized inthe following equations (Byun and 
Dennis,  1995) 

]  (at best) while the latter has.an error.of 9[Ac;] ..  To. _estiµiate, the  . 

• 

Surface Layer 

(a) Stable conditions: 

where  f3  = J!.L. 
1  Pr  L 

n 

(b) Unstable conditions: 

where a= - r,/L. 

•  Planetary Boundary Layer 

(a) Stable conditions: 

= [ 1 + a23-1 ri +(a4 -a2)rz ]-[ ~ + a23_\3 +(a4 -a2)1i] 
= (a6 -a4J _!_In (a+ 12)la-1jl] 
.. 
la+ 121(a + 1i) 

'l 2a 

where 1i  = (1- z1 I h)112

.. 

' 

,  r2  = (1- z2 /  h)1 12 ,  a2  = (1+8)18, and8 =  'f3hh  . 
fr0  L 

···· 

(b) Unstable conditions: 

K  = 

h 

kw 
-
Z2 

Z1  Zt 

3h 

Z2 

•  J<  -~)d  =kw [Z2  +z1  _  Z2  +ZiZ1  +z1] 

2 

2 

2 

. 

z  hz 

• 

2 

(7-27b) 

(7-27c) 

(7-28) 

In the free atmosphere above the mixed layer, turbulent mixing is parameterized using the 
formulatio~ as implemented in RADM (Chang et al.,  1987), in whlch vertical eddy diffusivities 
are represented as functions of the bulk Richardson number and wind shear in the vertical.  This 
formulation can be written as: 

' 

7-24 


(7-29) 

. 

. 

. 

. 

g 

~.ek 

where the Richardson number IS defined asRln  = e  s2  ~ 'Ko  IS the background value set at 

0 

k 

1 m2  s- 1,  and S  is the vertical wind shear.  Effects of the parameterization, Equation 7-29, on air 
quality simulation will be evaluated in near future.  Furthermore, not much is known of the eddy 
diffusivity formulas for strong stable condition (i.e., z/L > 1) and  therefore require further 
research in this area. 

7.2.2.2 Estimation of Vertical Eddy Diffusivity Using Turbulent Kinetic Energy 

Various forms of higher order closure schemes are becoming common in mesoscale meteorology 
models.  Typically, such models are referred to as TKE models.  The simplest form of a TKE 
model, which Mellor and Yamada (1974) referred to as level 2.5, has only one second order 
prognostic equation, for TKE itself.  The next level up in complication is the true one-and-a-half 
order closure model, level 3 in Mellor and Yamada (1974) nomenclature, which in addition to 
TKE includes prognostic equations for the turbulent variances of other relevant quantities such as 
temperature and humidity.  The TKE scheme in the latest version of MM5 can be run as either 
level 2.5 or level 3 where prognostic equations for temperature variance, moisture variance, and 
temperature-moisture covariance are added to the TKE equation (Burk and Thompson, 1989). 
Another similar form of a higher order closure model is known as TKE-E, which has prognostic 

equations for TKE and the turbulent dissipation rate (E).  An example of this type of model is 
described by Alapaty et al (1996). 

A common feature of TKE models, for level 2.5 or 3 or TKE-E, is that the turbulent fluxes of 
momentum, heat, and moisture are represented as local gradient diffusion similar to Equation 7-
23.  It is this characteristic that distinguishes 1.5 order closure from true 2nd order closure where 
the flux covariances are explicitly represented by prognostic equations.  Therefore, adaptation of 
a CTM to a meteorology model that includes TKE closure is essentially simple if the TKE fields 
are available to the CTM.  Only a small part of the TKE model need be reproduced in the CTM, 
namely the parameterization of eddy diffusion coefficients based on quantities already produced 
in the meteorology model.  For example, in the TKE-E model of Alapaty et al. (1996), the 
governing TKE equations in Cartesian coordinates are: 
- .. - .. au  -,,-,,av 
ik 

dE 
-=-u--v--w--u w  --v w  -
at 

dE 
ax 

dE 
ik 

()E 
ay 

ik 

7-25 


g - d(- 1-) 

+-e"w"-- w"E"+-p"w"  -e 

p 

e 

dz 

de 
-=-u--v--w-+- -u w  --v w  -+- w 
dt 

C1e (  -,-, -11  du 
dz 
E 

dze 

-,-, -,, dv 

g  -811  ") 

de 
dz 

de 
ax 

de 
ay 

2 

----c - we 

d  (-"-") 
' 

3  dz 

C2e
E 

(7-30a) 

(7-30b) 

where  u, v are horizontal wind components; 

E is the turbulent kinetic energy per urtlt mass; 
z is height; 
ev is the virtual potential temperature; 
e is the rate of TKE dissipation; 

, 
u"w"  v"w"  and .K.e"w" are turbulence fluxes of momentum components and heat flux· 

e 

, 

, 

p is the density; and 
p" is the fluctuating pressure. 

The constants CJ, c2, and c3 can be estimated following Detering and Etling (1985).  The first 
three terms on the right-hand-side of the first equation represent advection of turbulent kinetic 
energy, and the other terms, shear production, buoyancy production, turbulence transport and 
the dissipation, respectively.  Similarly, the first three terms on the right-hand-side of the second 
equation represent advection of e.  The rest of the terms represent the net rate change of e due to 
shear and buoyancy production, the rate c.hange of e related to the time-scale of turbulence, and 
the vertical transport, respectively.  The coefficients of eddy viscosity for momentum and h~at 
can be written as: 

K  =  C2E2 

m 

e 

K  = K  </Jm(zl L) 
h 
m  </>h(zl L) 

(7-31a) 

(7-31b) 

where Km  and  Kh  are the eddy exchange coefficients for momentum and heat, respectively.  E 

and E need to be provided by meteorological models in their native coordinates, thus the 
parameterization does not depend on the grid spacing explicitly.  Obviously, we are assuming 
here that the verti~al layer structure in the CTM is compatible with that used in the preprocessor 
meteorological model.  Once  Kh  is computed, chemical fluxes can be modeled assuming similarity 

7.;.26 


with heat flux using the same eddy diffusion numerical algorithm described below (section 
7.2.3.1).  The derivation of eddy coefficients in the Burk and Thompson (1989) model is 
algebraically more complex (see Mellor and Yamada, 1974, 1982) but based only on mean 
quantities plus TKE.  Therefore, given the TKE fields, which are output automatically from 
MM5 when the Burk and Thompson (1989) option is invoked,  Kh  can be re-diagnosed within 
the  CTM. 

7.2.2.3 Numerical Algorithm for Vertical Eddy Diffusion Modules 

As described in Chapter 5, the vertical eddy diffusion module must solve the following equation 
in terms of mixing ratio  q: 

dqj' 
at 

. 

vdifl 

= ~({(33 dii.;) + {(33 aln(,jfp) dii.; 

ax3 

ax3 , 

ax3 

ax3 

(7-32) 

where the vertical mixing is represented with the pure diffusion term and the turbulent flux 
exchange term, respectively. 

Numerical algorithm for the diffusion kernel 

In its generic form, the diffusion kernel solves for: 

(7-33) 

where  i;  is the generic vertical coordinate which increases with geometric height. To account for 
the loss process due to deposition in the lowest model layer (j= 1 ), dry deposition flux is 
considered as the flux boundary condition at ·the surface, i.e.: 

(7-34) 

where the geometric thickness of the lowest model layer is used for hdep-

The diffusion equation can be discretized for levelj  (1 < j  < N) in aN-layer model and time(cid:173)
steps  tn  and  tn+t  as: 

7-27 


where  7J  is a time-step weighting factor and 

(7-35a) 

For the lowest model layer, we need to account for the loss due to deposition process: 

-L\t :d [ 19q~+l + (1-19-)qn 

' 

dtp 

and for the top layer we have zero flux through the top boundary: 

(7-35b) 

(7-35c) 

Depending on 7J, the finite difference scheme is explicit ( t>=O), semi-implicit ( 7J=l/2), or fully 
implicit ( 7J=l).  In the current version of CMAQ, the semi-implicit (Crank-Nicholson) algorithm 
is implemented.  Equations 7-3Sa-c can be rearranged to yield a matrix equation: 

Aq=b 

(7-36) 

where A is tridiagonal whose coefficients (sub-diagonal componentai, diagonal component  di, 
and super-diagonal component  ci) whenj=l are given as:,. 

::,1 

''I' 

" 

' 

I' 

d  - 1' 

AQ A  v d 
- +---- + VL.lf-

I 

"' 

.,,,  K 
•} 
iMt 
L\~I  L\~1.!. 

2 

" 

hdtp 

7-28 

(7-37a) 


(7-37b) 

(7-37c) 

(7-37d) 

and forj=N: 

and for  2 ~ j  ~ N - 1: 

Coefficients of vector b are, for j= 1 and N: 

and for  2 ~ j  ~ N - 1: 

7-29 


+((1- fi)At [  KJ+i  ])  n  + ((1-~)At [  KJ-i  ])  n 

L\c;. 

J 

L\c;  I 

J+2 

q)+I 

L\~. 
J 

L\c;  1 

1-2 

qj-1 

(7-37e) 

The numerical algorithm solving the tridiagonal system is based on the Thomas algorithm.  Refer 
to Appendix 7 A.1  for details of the algorithm and stability characteristics. 

Numerical algorithm for the coordinate divergence kernel 

The coordinate divergence kernel solves for 

(7-38) 

where  V,,"  = K (Jin( f /5).  The differential equation is in advective from with the effective mass 

. 

I' 

a, 

"' 

': 

;, 

·,.::: .. ·' 

transfer velodty  Vm;x·  It can be solved with a vertical advection code.  Because most operational 
meteorological models rely on logarithmically spaced vertical layering based on sigma-p type 
coordinates,  Vmix  is expected to be small.  Currently, this component is not implemented in 
CMAQ.  However, a quantitative study is needed to assess the importance of this term. 

,·, 

• 

I 

:, 

• I '  

Integration time-steps 

A~cording to Oran and Boris (1987), any numerical algorithm for the diffusion equation (with 
equal grid spacing) should produce the followillg quantitative properties: 

'II' 

I' 

I, 

the total irltegral of q(c;,t)  should be conserved; 
the amplitude lq(c;,t)I should decay monotonically; 
there should be no phase errors introduced by the algorithm (for equal grid spacing); and 

• 
• 
• 
•  positivity should be preserved. 

Although the numerical solver algorithm for the semi-implicit scheme is stable fo the sense that 
the amplitude of the signal either decays or stays the same, the positivity condition may not be 
satisfied if we choose a large time-step for the integration, especially for signals with small 
Wavelengths.  For example, with equal grid spacing, we can use the Von Neuman stability 
analysis technique to demonstrate that some part of the short-wavelength spectrum shows a 
negative amplitude when the time-step is too long.  The semi-implicit scheme is positive definite 
given the rather stringent CPL condition, for a uniform vertical grid spacing: 

EP A/600JR-99J030 

2AtK 

/3 = (L1;)2  < 1.0 

For non-uniform grid spacing, we use the CPL condition: 

max {/3i} = max{  L1t  (. K1-112  +  K1+112  J} < 1.0 

L1~)  L1~J-1/2 

L1~J+l/2 . 

(7-39a) 

(7-39b) 

to ensure positive definiteness of the semi-implicit solution .. The internal time-step for vertical 
diffusion is thus determined in CMAQ with the following equation: · 

L1tvdiff  = min{L1t) 

where  L1t.  = L1;.(  K1-112  +  K1+112  J-1 

J 

J  L1;J-1/2 

L1;J+l/2 

7.2.3  Flux Form Representation of Vertical Mixing 

Vertical mixing can be represented in flux form as: 

(7-40) 

(7-41) 

where  F~ = ~~ is the turbulent flux represented in the generalized vertical coordinate  ;  , whose 
value increases monotonically with geometric height.  Here, the flux should be parameterized in  ~ 
coordinate instead of the generic height'coordmate.  nie cross directional.(w.r.t. generalized 
coordinate) diffusion terms, as well as the flux divergence due to grid spacing (second term in 
Equation 7-41 ), are neglected. 

Thus, the nwnerical solver kernel for the flux form vertical diffusion should solve for: 

aq 
aF~ 
-=---
dt 
a~· 

(7-42) 

when the source term is zero.  The flux form representation is extremely useful in describing the 
algorithms based on non-local closure.  Non-local closure recognizes that larger-size eddies can 
transport fluid across distances longer than the grid increment before the smaller eddies have a 
chance to cause mixing (Stull, 1988). 

To represent the turbulent mass exchange with the transilient parameterization, the boundary 
layer height must coincide with the height of layer interfaces of the vertical grid.  For most 
situations, the index for the boundary layer top (Lp)  is less than the total ntimber of model layers 
(i.e.,  LP< N).  With the transilient turbulence formulation, the new values of the trace species 
mixing ratio q due to turbulent mixing for a layerj at a future time  (t + L1t)  can be written as: 

LP 

qj(t + L1t) = ~>jk(t,L1t)qk(t) 

k=l 

(7-43) 

where  cjk  are the components of a transilient matrix and subscripts j  and k are indices of two 
different grid boxes (vertical layers) below boundary layer top in a column of atmosphere.  If we 
consider turbulent mixing between grid boxesj and k,  cjk  represents fraction of air mass ending in 
the grid boxjthat came from grid box k. The grid boxj is considered as the "destination" box 
while grid box k is considered as the "source" box.  Thus, the change in the tracer concentration 
due to turbulent mixing for grid boxj at a time interval  L1t  is a simple matrix multiplication with 
concentration from the source cell.  The transilient matrix representation is in fact applicable for 
any physical process that involves mass exchange among grid boxes in a column.  For example, 
convective cloud mixing can be represented by a transilient matrix as well, sim1lar to how mixing 
in a convective boundary layer is handled. 

. 

' 

The mass conservation requirements provide constraints for the coefficients of the transilient 
matrix.  The conservation of air mass requires that the sum over k of all mixing fractions be unity: 

(7-44) 

and the conservation of trace gas amount requires that the sum over j  of all mass-ratio weighted 
transilient coefficients be unity as well: 

(7-45) 

where  L1~i I L1~.c  represents the mass ratio (i.e., ratio oflayer thicknesses for mixing ratio q) 
between the source and destination boxes.  In order that transilient turbulence theory be useful, 
the coefficient~ should be determined using appropriate turbulent flux parameterizations. 

I 

7-32 

Consider how the mixing coefficients are related with the turbulent flux representations.  Because 
the transilient matrix describes the exchange of mass between grid boxes, the kinematic turbulent 
fluxes across the j-th level can be expressed, for a vertical layering with non-uniform grid spacing 
(Stull, 1993), for  2 ~ j  ~LP as: 


andforj=l as: 

(7-46a) 

(7-46b) 

The concentration (mixing ratio) of the lowest model layer, taking into account the deposition 
flux, is: 

(7-47) 

where  F;  is the flux at the sUrface. 

The transilient turbulent representation, as shown in Equation 7-43, is an explicit expression in 
which the magnitudes of mixing coefficients depend on the numerical integration time-step.  To 
use the transilient matrix representation as a general expression for the non-local turbulent closure 
methods, we need to relate Equation 7-43 with the semi-implicit representations of simple non(cid:173)
local closure algorithms such as in Blackadar (1978) and the Asymmetric Convection Model 
(Pleim and Chang, 1992).  Using Blackadar's definition of mik• which is the fraction of mass 
exchange between two levels j  and k per unit time, the turbulent fluxes at a given time t can be 
rewritten as: 

Fj(t) = Fj_I (t) + Li~j L,.mjk(t)[qj(t)-qk(t)] 

LP 

k=I 

(7-48) 

Note that  mik  = cik I Lit for an explicit method.  Substituting Equation 7-43 into the semi-implicit 
method, as in Equation 7-46, we get: 

q~+I = q~ _  Lit  [iJ(F.n+I  _ p,n+I) + (1- iJ)(Fn _ p,n  )] 

1 

Li~j 

1 

1 

1-I 

1 

1-I 

(7-49) 

7-33 

resulting in a general matrix equation: 

where the coefficients of P and Rare given as: 

(7-50) 

p D = 1 + f}Llt L mJk ;  Pik  = -fJt1tmik 

LP 

kc! 
k¢j 

j¢k 

r0  = 1- (1- tJ)t1t I,mik; ljk  = (1- tJ)t1tmik 

j-l>k 

Lp 

k:I 
bj 

If the matrix Pis nonsingular, we have a general expression for the transilient turbulence: 

• 

I 

I 

'I 

(7-51) 

The relationship between the coefficients of the transilient matrix and the mass exchange ratio 
among the grid boxes are somewhat complicated for the semi-implicit scheme.  However, the 
semi-implicit scheme becomes attractive for the closure algorithms with sparse P matrix (i.e., 
when the matrix inversion is not so expensive) because it allows longer integration time-steps 
than the explicit method.  In the following, we describe non-local flux-form atmospheric 
turbulence algorithms as a subset ~f the generalized transilient turbUlence representations. 

I 

7.2.3.1 Blackadar Non-local Scheme 

This scheme, first introduced by Blackadar (1978), has long been used as one of the PBL schemes 
in the Mesoscale Meteorology model generation 4 (MM4) and generation 5 (MM5).  The 
Blackadar model is a simple non-local closure scheme designed to simulate vertical transport by 
large convective eddies during conditions of free convection.  Therefore, this scheme is used only 
in the convective boundary layer and must be coupled with another scheme for non-convective 
conditions and above the boundary layer, such as K-theory.  In general, the flux-form diffusion 
algorithm can be written for the lowest layer as: 

(7-52a) 

(7-52b) 

where  mik  is the rate of mass exchange between two grid boxes in a column of the atmosphere 
(below boundary layer top) per unit time.  The convective mixing is assumed to be dominated by 
eddies of varying sizes but all having roots in the surface layer, each eddy exchanging a certain 
amount of its mass with the air around it as it ascends.  1he rate of change of mean potential 
temperature caused by the mass exchange in the mixed layer can be expressed as: 

(7-53) 

where w(c;J  is a weight function that accounts for the variation of exchange rate with height. 

The mass exchange rate,  Mu, can be estimated from conservation of energy, which requires the 
heat flux at any level to satisfy the equation: 

H  = H.ifc  -Mu f Cpdp(esfc -e)w(~' )J~d~ 

~ 

~sfr 

(7-54) 

where  H.efc  is the sensible heat flux leaving the surface layer and Cpd is the specific heat at 
constant pressure.  When the integration limit is extended to the top of the boundary layer, where 
His assumed to be zero, we can estimate Mu with: 

Mu= If.ifJ f Cpdp(esfc -e)w(/;)J~dl; 

~h 

~sir 

(7-55) 

Usually the weight function w is approximated to be un!ty In the mixed layer.  With the 
Blackadar scheme, the mixing algorithm is represented for the lowest model layer by: 

and for  2~j~LP by: 

dq. 

a:  =-Mu L1/;~ [q/t)- % (t)] 

L1/; 

(7-56a) 

(7-56b) 

where we used  m,k =Mu L1;k,  mi1 =Mu L1~1  ,  and all other components of mik  are zero. 

L1':>1 

L1':>j 

Finite difference representations of the above equations are: 

where we used ~h = L L1gk , and for  2 s:;  j  s:;  LP : 

LP 

k=I 

q;+

1 
-q'j =-?JM  L1g,  (qn+t -qn+t)-(1-?J)M  L1g,  (q~ -qn) 
L1t 

u  L1gj 

u L1gj 

1 

1 

J 

1 

After rearrangement, we obtain the following matrix equation: 

h. 
d2 
0 

0 

di 
e2 

el 

eL,. 

h 
0 

dj 
0 
0 

0 

0 
0 

!LP 
0 
0 

0 
dL 

p 

q~+I 
q;+I 

b, 
bz 

q'tl  = 

bj 

qn+I 
LP 

bL 

p 

0 

where the elements are defined with: 

(7-57a) 

(7-57b) 

(7-58) 

di  = 1 + 1J V tlL\t. + i} L\tMu  ( ~h - L1gl) 

htltp . 

L1gt 

The numerical algorithm to solve the sparse matrix system is similar to the Thomas algorithm for 
the tridiagonal system.  For the details of the numerical algorithm, refer to Appendix 7 A.2. 

(a) 

(b) 

Figure 7-2.  Schematics of the Blackadar Scheme (a) and the Asymmetric Convective Model (b) 

7.2.3.2 Asymmetric Convective Mixing 

The Asymmetric Convective Model (ACM), developed by Pleim and Chang (1992), is based on 
Blackadar's non-local closure scheme (Blackadar, 1978) but with a different scheme for 

downward mixing In the convective boundary layer (CBL).  Blackadar's scheme is based on the 
assumption that the turbulent mixing is isotropic (i.e., symmetric) in :the CBL.  However, 
observational ~yid~nce anc;l large-eddy simulation modeling studies indicate that mixing processes 
in a convective boundary layer are essentially asymmetric (i.e., ·turbulence is anisotropic; 
Sc;h~ann, 1989) with fast upward buoyant plumes and slow broad compensatory subsidence. 
Therefore the direct, non-local downward transport of the Blackadar scheme is replaced with 
layer by layer subsidence which increases in mass flux as it descends, like a cascading waterfall 
(Figure 7-2).  As with the Blackadar model, the ACM can only be used during convective 
conditions in the PBL.  For other stability regimes, one needs to rely on other schemes such as 
K-theory. 

" 

" 

, 

I 

, 

, 

, 

-

, 

Turbulent mixing in the PBL for any dynamic, or thermodynamic variables, or trace gas species 
concentrations can be represented in essentially the same way as in the above transilient 
parameterization.  Also, the conceptual design of :the ACM ailows Ioi considerable 
simplification.  Because the mass influx to the lowesf model layer is from the second layer only 
in ACM (refer to Figure 7-2), we can write the time rate change of mixing ratio as follows: 

(7-59a) 

.  (7-59b) 

where Mu represents upward mixing rate. MdJ represents downward mixing rate at layer j  and is 
defined as: 

(7-60) 

, 

' 

. 

The scheme can be represented in terms oftrruisilient ~xing rates (m1k), as shown in general fonii 
in Equation 7-48: 

. . 

. 

· 

(7-61) 

Therefore, by equating Equations 7-59b and 7-61, we see thatmi1 =Mu'* m1i, which shows that 
the transfer coefficients are asymmetric as expected, and  mi 1 + mi.i+I = Mdj, which demonstrates 
a recursive relationship for MdJ: 


M 

dj-1  - Mu  + 

M  L1~j+I 
~ 
L1~j 

di 

Finally, we rewrite the prediction equation in terms ofth1~ upward mixing rate: 

dq,  =-M ~h -~1 (q  -q )-3L._q 
dt 

2 

I 

I 

u  L1J: 
':.1 

h 
dtp 

EP A/600/R-991030 

(7-62) 

(7-63a) 

(7-63b) 

Note that this scheme does include the effects of vertical wind shear in generating turbulent 
mixing.  The magnitude of the mixing rates of the transilient matrix is based on the conservation of 
· 
sensible heat flux in the vertical direction: 

(7-64) 

Finite difference representations of the above equations are: 

q;+

1 

- q~ =-(~+Mu ~h - ~1 )ct9q~+1 +(I-~)qn 
Lit 

L1~1 

hdtp 

. 

+Mu ~h~~1~1 [t9q;+1 + (1-.~)q;] 

(7-65a) 

n+I 
qi  ;; qi  = Muf t9q~+I + (1- ~)qf] 

n 

{  ~. ~~J-1 )tiqt' + (1-1')qj] + ( ~~:.1).iq;:: +(I- 1')qj., J 

(7-65b) 

This results in a sparse matrix of the form: 


c, 

d2 
0 

0 

d, 

e2 

el 

, 
eL 

C2 

0 
0 

0 
0 

di 
0 
0 

0 
0 
0 

q~+I 

qt! 

bl 
b2 

q;+'  =  bj 

' 

CLP-I 
dL 
p 

qn+I 
LP 

bl 

p 

cl 

0 

(7-66) 

where: 

The numerical algorithm solving the sparse matrix system is presented in Appendix 7 A.3. 

7.2.3.3 Transilien.t Turbulence Parameterization 

The general computational paradigm for the transilient turbulence parameterization has been 
presented above.  In order to use the transilient turbulence concept for mixing trace gases, one 
needs to knovy the mass exchange coefficient matrix.  This is the closure pr~blem with this 
parameterization.  A couple of methods have been presented in the 1.iterature.  One method is 
based on the tkE equation (Stull and Driedonks, 1987, and Raymond and Stull, 1990) and the 
other is the one based on non-local Richardson number (Zhang and Stull, 1992).  In the following 
we describe briefly the TKE based scheme and discuss its associated difficulties. 

,  1" 

11:'1,' 

•  ~ 

ii•:,1 

'1 

l,11:'!· 

' 

1

I' 

• 

:' 

I'' 

'' 

, , 

, 

''," 

" 

, 

" 

",I., 

,,,,.  · 

' 

' 

• 

The horizontally homogeneous form of the TKE equation, Equation 7-30a is given as: 


aE 
-
at 

-au  -av  g -

= -u"w"--v"w"-+-fJ"w"-8 
. 

eo 

<k 

<k 

BP A/600/R-991030 

(7-67) 

Note that the pressure and turbulent transpo~ terms have been ignored.  After normalizing with 
E, the non-local analogy of the finite difference form.of Equation 7-67 can be written as: 

~ = 
A  E 

[(-u"w")  ( 

jk  L1u  + 

) 

·(-v"w")  ( 

) 

jk  Liv  + ...L 

(fJ"w") 

jk  - 8jk  L\t' 

] 

(7-68) 

Ejk 

Ejk 

jk 

Ejk 

jk  ej 

Ejk 

Ejk 

L1z 

L1z 

where the symbol  L\  represents temporal change while L1 represents spatial gradient.  To close 
the system, the unknown parameters are written in terms of known parameters by introducing 
three scaling parameters T0 ,  Ric, and D, which.are the time scale of turbulence, the critical 
Richardson number, and dissipation factor, respectively.  Thus, weighted kinematic fluxes can be 
written as: 

(-fJ"w"). 

__  __,1'-k -

T  (Lie) 

0 

Ejk 

- Ric 

L1z 

jk. 

Then Equation 7-68 can be rewritten as: 

•  ';..  !',.~ •, 

• ;.. 

. ; 

r 

.;  ' 

(7-69a) 

(7-69b) 

(7-69c) 

(7-70) 

To use Equation 7-70 for the generalized coordinate ;,'the.correspond.illg iayer heightslAz )Jk 
should be computed for  (A;) jk. 

Since we are dealing with fraction of masses that are .commg .from and g~ing t? different l~yers. 
(i.e.,j-:/:! k),  Jjk in the above equation is for off-diagonal elements only.  Diagonal elements in 
Equation 7-70, J}j, represent mass of air that remain in each layer without interaction with other 
layers.  Observations during convective conditions (Ebert et al.,  1989) indicated that turbulent 
eddies cause a well-mixed rather than convectively overturned boundary layer.  This requires 
that the values of the mixing potential elements (Jjk) should increase monotoi:llcally from the 
upper right-most element towards the main diagonal.  Further, to account forthe subgrid scale 
mixing in each layer, an independent parameter Y,.e1 was introduced.  Thus, the diagonal elements 
can be written as: 

I 

I 

(7-71) 

given values for T0 ,  Ric, and D.  Usually, Yref  is estimated based on observations (Stull, 1988). 
Finally, the off-diagonal elements of the transilient matrix are estimated with: 

" 

" 

I 

(7-72) 

where llYll.. is the infinite norm of matrix Y,  max {IYIJ.  The formulation presented in Raymond · 
and Stull (1990) and Alapaty et al. (1997) includes the additional weighting based on the mass in 
the layer for irregularly spaced grids.  However, we believe that Equation 7-72 should be valid 
e'V'.en for irregularly spaced grids when the constraint Equation 7-45 is satisfied.  Also, Stull 
( 1993) states that the formulation Equation 7-72 causes too much mixing near the surface and 
inclusion of the mass weighting in the formulation exacerbates the p~oblem further.  The diagonal 
elements of the transilient matrix can be computed by rewriting Equa~ion 7-44 as: 

cil = 1- fcik 

l•I 
l"'} 

(7-73) 

Once the transilient matrix is determined, the concentration due to turbulent processes in the 
boundary layer can be estimated from Equation 7-43.  The difficulties associated with this 
parameterization are: 

",I 

• 

• 

The scheme still depends on many free parameters (T0 ,  Ric, D, and Yref)  and they control 
the behavior of the mixing algorithm; and 

',:'" 

111' 

The time-s~eps should be such that the trace species mixing ratio cannot be negative 
because Eq~ation 7-43 is written in explicit form.  Althoughexplicit methods do not 
require matrix inversion, the time-step must be small enough to ensure positivity and 
numerical stability of the solution. 

I•"',.· 

" 

'" 

I 

11 

,,, 

7.3 

Horizontal Mixing Algorithms 

Unfortunately, our understanding of horizontal turbulence is limited due to the lack of adequate 
turbulence me1;1Surements as well as the scale dependency of the problem.  In earlier days of 
atmospheric modeling, the horizontal diffusion process was often ignored because the numerical 
diffusion associated with the advection algorithms used was large. For problems with large scales, 
such as regional to global transport studies, the coarse grid resolutions did not require an explicit 
implementation of horizontal diffusion.  However, with the advent of very accurate (i.e., less 
diffusive) numerical advection schemes and the emerging need for high resolution grids for urban 
scale problems, a good algorithm for horizontal diffusion is required.  The skill needed is 
balancing numerical diffusion associated with the advection schemes with the added explicit 
diffusion to model horizontal diffusion in the atmosphere.  A fundamental problem is that we do 
not know much about the expected magnitude of the actual horizontal diffusion.  In this section 
we will describe the numerical algorithm for the horizontal diffusion implemented in the CMAQ 
system. 

The horizontal diffusion process in the curvilinear coordinate system (See Equation 6-25' in 
Chapter 6) is given as: 

(7-74) 

There are not many choices for the horizontal diffusion parameterizations. Frequently, the 
horizontal turbulent fluxes are parameterized using eddy diffusion theory.  The contributions of 
the off-diagonal diffusion terms show up explicitly as in Equation 6.,.14 in Chapter 6.  Often, 
these off-diagonal terms are neglected in air quality simulations, and in the CMAQ 
implementation, we solve for diagonal terms only: 

ac; I  = _j_[  E-cK.11 aqi )]  _J__[  E-cK.22  aqi )] 
. 
a.x2 
at  hdiff 

a.xi  + ax2  "r P 

a.xi  "r P 

(7-75) 

The contravariant eddy diffusivity components are related to the Cartesian counterparts as 
K11  = mKxx  and  K22  = mKYY.  In practice, for Eulerian air quality modeling, we do not distinguish 
between eddy diffusivities in two different horizontal directions (i.e.,  Kxx  = KYY  = KH ).  For a 
Lagrangian simulation of atmospheric turbulence, the longitudinal. (following the plume 
movement) and lateral (perpendicular to the plume movement) dispersion are treated ~ifferently 
according to characteristics from the isotropic turbulence analysis.  Often the horizontal eddy 
diffusivity in the Cartesian coordinates is parameterized with the magnitude of the deformation in 
the gridded wind field.  For that case, one must be careful whether the wind data are represented 
in Cartesian coordinates or in the transformed coordinates. 
Unlike the vertical diffusion case, we do not separate the grid divergence terri:i from the diffusion 
e'!-uation.  An,,explicit solution method for Equation 7-75 is: 

• 

11+1 

(p  ),,,. q,,.,  - (p  ),,,.q,,lfl + (.1£')2  (p  )l+l,in 

11+1  _ 

L1 

n 

.. 

• 

n 

n 

l+l,,.(q,+l,m  -q,,,.)-(p  ),.m 

n 

/,,.(q,,llt  -q/-1,m) 

n 

-,.. 

*  n  Kll 

] 

' 

"t[ 

-,.. 
•  n  Klt 

(c  • )" 
, + (.1£2)2  p  /,.,+I 

Lit 

t22  < • 
l.m+I  q,,.,+I  - q,,,.  - p  /,in 

• )  <  • )"  t22 c • 

•  )] 
/,m  ql.m  - ql,n-1 

' 

(7-76) 

-,..-

1 

w!?,ere  K:~ = 2(K,'.~+I + K11.~) and  K,~! = 

- , . . -

A 

A 

1 
2 

A 

A 

(K,~ ...  + K,~).  At the boundary cells, a zero-gradient 

bqundary condition (Neumann) is applied.  Because Equation 7-76 is an explicit scheme, the 
time-step should be chosen to prevent numerical instability and to maintain positivity.  With an 
a~propriate Courant number for horizontal diffusion,  f3htliff"  the time-step can be determined 

I 

I 

with: 

,,,, 

Atl,uiiff = f3htliff 

(L1x)2 
(K"  t22) · 

,,.. 

,,. 

max 
'V(l,in) 

(7-77) 

At present  f3htliff= 0.3  and a uniform eddy diffusivity  KHl.11r= 4
grid resolution.  To compensate for larger grid sizes for coarser grids, the eddy diffusivity is 
modified to give: 

km  =  2000 m2/s is used for the 4-km 

K  I  - ( 4000)2 K  I 

H  "1r  -

(L1x)2 

H  "1r=4km 

(7-78) 

where  L1x  is in meters. 

Obviously, the above parameterization is too simple to be realistic in a variety of atmospheric 
conditions.  Also, depending on the numerical advection algorithms chosen, the artificial 
diffusivity can be quite different.  This calls for several in-depth studies on following two major 
issues: 

I 

(1) 

Quantification ofrealistic horizontal sub-grid scale diffusion. 

The simplest approach is to assume a space independent diffusivity (e.g., Kh =  50 m2/s). 
Smagorinsk.y (1963) formulated a horizontal diffusivity that accounts for diffusion due to 
distortion or stress in the horizontal wind field. For plumes which are several, kilometers or more 
across, the Briggs (1973) parameterizations of horizontal diffusion define th~ diffusivity as a 
constant times the transport wind speed.  The constant is usually based on the landuse (i.e., 
urban or rural) and the stability class (i.e., stable through unstable).  However, it is difficult to 
quantify what the horizontal eddy diffusivity should be appropriate for a variety of atmo.spheric 
conditions without more detailed wind field and turbulence information. 

(2)  Maintaining appropriate horizontal diffusion in the presence of numerical diffusion. 

Most methods for simulating advective transport in current models yield an effective numerical 
diffusivity much larger than physical horizontal diffusivities (Y amartino et al.,  1992).  Thus, the 
physical process may be outweighed by the numerical errors in the model.  A re-assessment of 
this issue is required when the resolution of the model changes or when the method for simulating 
advection is updated.  For idealized concentrations and wind fields distributions, we may be able 
to quantify the magnitude of the numerical diffusion in an advection scheme.  However, for the 
more general applications, estimating the magnitude of numerical diffusion with a specific 
advection scheme is almost impossible.  Refer to Odman (1997) for methodologies that quantify 
numerical diffusion errors associated with advection algorithms. 

7.4 

Conclusions 

In this chapter, we have described numerical advection and diffusion algorithms.  It has two 
purposes: to provide a description of the algorithms currently implemented in CCTM, and to 
describe the fundamental formulations that would guide future implementation of advection and 
diffusion modules.  We encourage the development of algorithms in conservation (i.e., flux) forms 
to ensure compatibility of new modules with existing ones. 

Because of the concerns over the non-monotonicity of BOT and YAM schemes and the mass 
conservation problem and diffusive nature ofBOT-M, we have used PPM for a number of 
demonstration executions (Byun et al.,  1998).  Similar testing with BOT and YAM is underway. 
We intend to integrate other methods into the CCTM at a later time. 

Also, we have identified several aspects in vertical and horizontal diffusion algorithms that 
require additional quantitative stUdies: 

• 
• 

• 

• 

Effects of the parameterization for the free troposphere; 
Importance of coordinate divergence term for vertical diffusion, in particular for the 
height-based constant coordinates; 
Characteristics  among competing algorithms for the vertical diffusion, such as TK.E and 
transilient turbulence schemes; and 
Practical and theoretiCal concerns with the horizontal diffusion algorithms. 

7.5 

References 

Alapaty, K., R. Mathur, and D.W. Byun, 1996: A modeling study of vertical diffusion of passive 
~d reactive trac~r~ using local- and nonlocal-closure boundary layer schemes. Air Pollution 
Modeling and Its Application XI, ed. S.E. Gryning and F. Schiermeier. 433-442. 

'""" 

,,, 

" 

, 

, 

"I 

Alapaty, K.A., J.E. Pleim, S. Raman, D.S. Niyogi, and D.W. Byun.  1997: Shnulation of 
atinospheric boundary layer processes using local- and nonlocal-closure schemes. J  Applied 
Meteor. Vol. 36. 214-233. 

Blackadar, A. K., 1978: Modeling pollutant transfer during daytime convection, Preprints, 
Fpwth Symposium on Atmospheric Turbulence,  Diffusion,  and Air Quality, Reno, Am. Meteor. 
Soc., 443-44 7. 

I 
I 

Bott, A.,  1989: A positive definite advection scheme obtained by nonlinear renormalization of 
the advective fluxes. Mon.  Wea.  Rev.  117, 1006-1015. 

Bott, A.,  1992: Monotone flux limitation in the area-preserving flux-form advection algorithm. 
Mon.  Wea.  Rev.  120, 2592-2602. 

Bott, A., 1993: The monotone area-preserving flux-form advection algorithm: reducing the time(cid:173)
splitting error in two-dimensional flow fields." Mon.  Wea.  Rev.  121. 2637-2641. 

Briggs, G. A., 1973: Diffusion estimates for small emissions. ATDL Contribution No. 79 
[Available from Atmospheric Turbulence and Diffusion Laboratory, Oak Ridge, Tenn.] 

Brooks, A. N., and T. J. R. Hughes, 1982: Streamline upwind/Petrov-Galerkin formulations for 
cpnvection d~min~ted flows with particular emphasis on the incompressible'Navier-Stokes 
equations. Comp.  Meth.  Appl. Mech.  Eng.  32, 199-259. 

· 

1'1•,I 

'i' 

1
1 

II' 

Ii 

111

I 
I 

Burk, S.D., and W.T. Thompson, 1989: A vertically nested regional numerical weather prediction 
model with second-order physics. Mon.  Wea.  Rev.  117, 2305-2324. 
Businger J. A.~ i C.  Wyrigaard, Y. Izumi, ~d E. F. Bradley, 1971:,Flux profile relationships in 
the atmospheric surface layer, J.  Atmos. Sci., 28, 181-189. 

I• 

" 

"' 

I 

Byun, D. W., 1999a: Dynamically consistent formulations in meteorological and air quality 
~odels for ~111ti-s~ale atmospheric applications: I. Governing equations in a generalized 
coordinate system. J.  Atmos. Sci., (in print). 

Bylli1, D. W.,  1999b: Dynamically consistent formulations in meteorological and air quality 
models for multi-scale atmospheric applications: II. Mass conservation issues. J.  Atmos. Sci., (in 
print). 

Bylli1, D. W., and R. L. Dennis, 1995: Design artifacts in Eulerian air quality models: Evaluation 
of the effects of layer thickness and vertical profile correction on surface ozone concentrations. 
Atmos.  Environ., 29, 105-126. 

Bylli1, D.W., and S.-M. Lee,  1999: Mass conservative numerical integration of trace species 
conservation equation: I Experiment with idealized two-dimensional flows.  (in preparation) 

Byun, D.W., J. Yolli1g., G.  Gipson., J. Godowitch., F. Binkowsk., S. Roselle, B. Benjey, J. 
Pleim, J.  Ching., J. Novak, C.  Coats, T. Odman, A.  Hamia, K.  Alapaty, R.  Mathur, J.  McHenry, 
U.  Shankar, S. Fine, A. Xiu, and C. Jang,  1998: Description of the Models-3 Community 
Multiscale Air Quality (CMAQ) model.  Proceedings of the American Meteorological Society 
78th Annual Meeting, Phoenix, AZ, Jan.  11-16, 1998. 

Carpenter, R. L., K. K. Droegemeier, P.R. Woodward, and, C. E., Hane, 1990: Application of 
the piecewise parabolic method (PPM) to meteorological modeling. Mon.  Wea.  Rev.  118, 586-
612. 

Chang, J.S., R.A. Brost, LS.A. Isaksen, S. Madronich, P.  Middleton, W.R. Stockwell, and C.J. 
Walcek,  1987: A three-dimensional Eulerian acid deposition model: Physical concepts and 
formulation, J.  ofGeophys. Res., 92, 14,681-700. 

Childs, P. N., and K.  W. Morton, 1990: Characteristic Galerkin methods for scalar conservation 
laws in one dimension. SIAM J.  Numer.  Anal.  27, 553-594. 

Chock, D. P., and A. M. Dunker, 1983: A comparison of numerical methods for solving the 
advection equation. Atmos.  Environ.  17(1 ),  11-24. 

Chock, D. P., 1985: A comparison of numerical methods for solving the advection equation - II. 
Atmos.  Environ.  19( 4), 571-586. 

Chock, D. P., 1991: A comparison of numerical methods for solving the advection equation-III. 
Atmos.  Environ.  25A(5/6), 853-871. 

Chock, D. P.,  1999: Personal communication. 

Colella, P., and, P.R. Woodward, 1984: The piecewise parabolic method (PPM) for gas(cid:173)
dynamical simulations. J.  Comp.  Phys 54, 174-201. 

Dabdub, D., and Seinfeld, J.  H., 1994: Numerical advective schemes used in air quality models -
sequential aJl.d parallel implementation. Atmos. Environ.  28(20), 3369-3385.' 

Detering, H.W., and D. Etling, 1985: Application ofE-e turbulence model to the atmospheric 
boundary layer. Bozmd.-Layer Meteor.,  33, 113-133. 

Ebert, E.E., U. Schumann, and R. B. Stull, 1989: Nonlocal turbulence mixing in the convective 
~undary layer evaluated from large-eddy simulation. J.  Atmos. Sci., 46, 2178-2207. 

Flatoy, F .,  1993: Balanced wind in advanced advection schemes when species with long lifetimes 
are transported. Atmos.  Environ.  27A(l2), 1809-1819. 

I 
I 
i 

'I 

1, 

"' 

""" 

Hass, H., H.J. Jacobs, M. Memmescheimer, A. Ebel, and J.S. Change, 1991: Simulation of a wet 
deposition case in Europe using the European Acid Deposition Model (EURAD).  Air Pollution 
Modelling and Its Applications, Vol. VIII (edited by van Dop H. and D.G. Steyn), Plenum Press, 
205-213. 

I 

' 

'" 

" 

' 

Holtslag, A. A., E. I. F. de Bruin, and H.-L. Pan, 1990: A high resolution air mass transformation 
model for shprt-1<µ1ge  weather forecasting. Mon.  Weather Rev., 118, 1561-1575. 

I 

Leith, C. C., 1965: Numerical simulation of the earth's atmosphere.  A chapter in Methods in 
Computational Physics.  Vol.  4,  Applications in Hydrodynamics.  p. I. ed., B. Alder, Academic 
l;lress, New York. 

'"' 

,, 

Lohner, R., K. Morgan, J. Peraire, and M. Vahdati, 1987: Finite element flux-corrected transport 
(FEM-FCT) for the Euler and Navier-Stokes Equations.  Finite Elements in Fluids.  Vol.  7 . John 
Wiley &  Sons.  lO:S-121. 

I 

Mellor, G.L: andT. Yamada, 1974: A hierarchy of turbulence closure models for planetary 
boundary layers, J. Atmos. Sci., 31, 1791-1806. 

• 

I 

Mellor, G.L, and'.f. Yamada, 1982: Development of a turbulence closure model for geophysical 
fluid problems. Reviews ofGeophysica and Space Physics, 20, 851-875. 

• 

I 

! 

Odman, M. T.,  1997: A quantitative analysis of numerical diffusion introduced by advection 
algorithms in air quality models. Atmos.  Environ.  31, 1933-1940. 

" 

Odman, M. T., 1998: Research on Numerical Transport Algorithms for Air Quality Simulation 
Models. EPA Report. EPA/660/R-97/142. [Available from National Exposure Research 
Laboratory, U.S. Environmental Protection Agency, Research Triangle Park, NC 27711]. 

Odman, M. T., and A.G. Russell, 1993: A nonlinear filtering algorithm for multi-dimensional 
finite element pollutant advection schemes. Atmos. Environ.  27A, 793-799. 

Odman, M. T., A. Xiu, arid D. W. Byun, 1995: Evaluating advection schemes for use in the next 
generation of air quality modeling systems, In Regional Photochemical Measurement and 
Modeling Studies, eds A.J. Ranzieri and P.A. Solomon, Vol. Ill, Air &  Waste Management 
Association, Pittsburgh, PA.  1386-1401. 

Oran, E., and J.  Boris, 1987: Numerical Solution of Reactive Flow, New York, Elsevier. 

Otte, M.J. and J.C. Wyngaard, 1996: A general framework for an "unmixed layer" PBL model. J. 
Atmos.  Sci., 53, 2652-2670. 

Pleim, J.E. and J.  Chang, 1992: Anon-local closure model for vertical mixing in the convective 
boundary layer.Atmos.  Envi., 26A, 965-981. 

Raymond, W.H. and R.B. Stull, 1990: Application oftransilient turbulence theory to mesoscale 
numerical weather forecasting. Mon.  Weather Rev., 118, 2471-2499. 

Rood, R. B., 1987: Numerical advection algorithms and their role in atmospheric transport and 
chemistry models. Rev.  Geophysics 25(1), 71-100. 

Schumann, U., 1989: Large-eddy simulation of turbulent diffusion with chemical reactions in the 
convective boundary layer. Atmos. Envi., 26A, 965-981. 

Smagorinsky, J.,  1983: General circulation experiments with the primitive equations:  1. The basic 
experiment. Mon.  Wea.  Rev.  91, 99-164. 

Stull, R.  B., 1988: An Introduction to Boundary Layer Meteorology.  Kluwer Academic, 666 pp. 

Stull, R. B., 1993: Review of non-local mixing in turbulent atmosphere: Transilient turbulence 
theory. Bound-Layer Meteor.,  62, 21-96. 

Stull, R. B., and A.G.M. Driedonk, 1987: Applications of the transilient turbulence 
parameterization to atmospheric boundary layer simulations. B~und. -Layer Meteor.,  40, 209-
239. 

Tremback, G. J., Powell, J., Cotton, W.R. and Pielke, R. A., 1987: The forward-in-time 
upstream advection scheme: extension to higher orders . .Nfon.  Wea.  Rev.  115, 540-555. 

Yamartino, R. J.,  1993: Nonnegative, conserved scalar transport using grid-cell-centered, 
spectrally constrained Blackman cubics for applications on a variable-thickness mesh. Mon.  Wea. 
Rev.  121, 753-763. 

Yamartino, R.J., J.S. Scire, G.R. Carmichael, and Y.S. Chang, 1992: The CALGRID mesoscale 
photochemical grid model-Part I.  Model formulation, Atmos. Environ.  26A, 1493-1512. 

'"'''''' 

' 

,, 

I 

Yanenko, N. N., 1971: The Method of Fractional Steps. Spring-Verlag, New York,  160pp. 

Zhang, Q., al1.d Stull, R. B. Stull, 1992: Alternative nonlocal descriptions of boundary-layer 
evolution. J. Atmos. Sci., 49, 2267-2281. 

This chapter is taken from Science Algorithms of the EPA Models-3 Community 
Multiscale Air Quality (CMAQ) Modeling System, edited by D. W. Byun and J. K. S. 
Ching, 1999. 

; 

11',•1 

Appendix 7 A  Numerical Solvers for Diffusion Equations 
==============

In this appendix we describe numerical procedures for eddy diffusion, the Blackadar mixing 
scheme, and the asymmetric convective model. 

7 A.1  Stability of Tridiagonal Solver 

The eddy diffusion formulation requires the solution of the linear equation 

Aq=b 

where: 

(7A-1) 

A= 

C1 
d2 

Cl;i 

di 
a2 
0 

0 
0 

0 
C2 
d3 

0 
0 

0 
0 
C3 

0 
0 
0 

an-I 
0 

dn-1 
an 

Cn-1 
dn 

q=(q1  q2 

q3 

qn(; and 

b=(h1  h2 

b3 

bn(• 

The system Equation 7 A-1  can be solved by the Thomas algorithm (Gaussian elimination of a 
tridiagonal matrix without pivoting) followed by back substitution.  Assume that the following 
stage of the elimination has been reached: 

(7A-2a) 

(7A-2b) 

(7A-3a) 

(7A-3b) 

Forj=2,3; .. n-1, eliminating  qi-I  from Equations 7A-2a,b leads to: 

where 

a.c.  1 
a. = d. - -1.......1:::._ 
a 

i 

i 

j-1 

f3  = b. - ajf3j-I 
a. 
l 
,  1-I 

l 

T!}e last pair ~f simultaneous equations are: 

lXn-lqn~I + Cnqn  = l3n-I 
anqn-1 + dnqn  = bn 

Eliminating  qn-I  gives: 

, 

""II 

,.", 

,,, 

(7A-3c) 

(7A-4a) 
(7A-4b) 

(7A-5a) 

atd with Equation 7A-3a, we can obtain the solution by back substitution, i.e.,j = n-l, n-2;··,1: 

(7A-5b) 

The algorithn1 described above is stable for the tridiagonal system if: 

(i)  di> 0,  a1 <0, andc1 < O; 
(ii)  d1 > -(aj+I + Cl~I) forj=l,i, ;··n-i, defining  C0  =an = 0; and 
(iii) d1 >-(a1 +c1)  forj=l,2, ;··n-1, defining  a1 =en-I =0. 

~.~ first two cond~tions e~sure tp(!.t the forward eliminatiqn is stable and tQ.e  first and third 
conditions ensure that the back substitution is stable. 

T? prove that., ~e forward elimination procedure is stable, it is necessary to show that the moduli 
of the multipliers  m1 = -a1 I a1_1  used to eliminate qi, q2,  •••  are positive and less than or equal to 
one.  From Equation 7A-2, we get: 

I 

and 

(7A-6a) 

(7A-6b) 

(7A-7a) 

Similarly, we have: 

EPA./600/R.-991030 

since  d2 > -( ll:i + c1)  •  In this way, we can show that  0 < mi < 1 for j= 1, 2, · ··n-1. 

For back substitution, we can write: 

(7A-7b) 

(7A-8) 

I 

' 

' 

n-1 

with  a  = c  = 0 fior;"=l  2  ···n-1 
There will be no build-up of errors in the back substitution process if !Pi+! I < 1, where: 

• 

Now, 0 < p2  = -c1Id1 <1, since  a1 =0 and  d1 >-c1  by hypothesis.  Then: 

P  -

3-

-c 
2 

d2  +a2P2 

As  -c2  > 0,  0<p2 <1, and  d2 > -a2  > 0, it follows that: 

(7A-9a) 

(7A-9b) 

(7A-10) 

Similarly, we can show that 0<pi<1 forj=l, 2;··n-1. 

7 A.2  Solver for Blackadar Scheme 

The Blackadar scheme requires solving the sparse linear matrix equation_ Aq=b of the form 

A= 

di 
e2 
e3 

en-I 
en 

ln-1 

h  A 
0 
0 
di 
~  0 
0 

0 
0 

0 
0 

dn-1 
0 

In 
0 
0 

0 
dn 

(7A-11) 

The solver for this system uses a similar numerical procedure as for the tridiagonal system.  The 
e.l~me~~ of 1h,e Hnear set of ~quations are related as follows: 

dlql + "L.'1q1 = b, 

n 

)=2 

and for  2 S. j  S. n: 

'li'',,,,I 

By substitu~g q1 with  q1 for eachj, we get: 

~.d for  2 S. j  ·.;;; n : ·· 

111 

(7A-12a) 

(7A-12b) 

(7A-13a) 

(7A-13b) 

Note that Equation 7A-13b involves neither a fonvard nor a backward substitution loop. 

1A.3  Sofye[ for Asymmetric Convective Model (ACM) 

The Asymmetric Convective Model requires solving the linear matrix equation Aq=b with a 
sparse matrix of the form: 
r 

, 

i. 

A= 

C2 

d2 
0 

di 

e2 

e3 

en-I 

en 

0 

C2 

d3 

0 
0 

0 

0 
0 
0 

dn-1 
0 

Cn-1 

dn 

0 

C3 

0 
0 

EPA/600/R-991030 

(7A-14) 

The solver for this system is based on a numerical procedure .. simil~ to the tridiagonal solver. 
The relation among the variables qi are given as: 

and for  2 $. j  $. n - 1: 

(7A-15a) 

(7A-15b) 

(7A-15c) 

Assume that the following stage of the elimination has been reached for  1 $. j  $. n - 1 : 

where: 

a.=e.--1 a. 1 

l-

l 

[3 . = b. _ _  l 

[J.  I 

l(cid:173)

l 

d. 

cj-1 
d. 

cj-1 

l 

l 

(7A-16a) 

(7A-16b) 

(7A-16c) 

with  a 1 = d 1  and /31 = b1•  From Equation 7 A-16a for  j  = n - 1 and Equation 7 A-15b,  q1 is found 
to be: 

and all other qis are computed with: 

-
j+I  -

q 

[3.  -a.qi 
l 

l 

ci 

7-55 

(7A-17a) 

(7A-17b) 

for  1 ~ j  ~ n - 1.  The final substitution stage can be implemented either in a forward or backward 
sweep. 


Chapter 9
=============

GAS-PHASE CHEMISTRY 

Human Exposure and Atmospheric Sciences Division 

Gerald L. Gipsolll * 

National Exposure Research Laboratory 
U.  S.  Environmental Protection Agency 
Research Triangle Park, NC 27711, USA 

Jeffrey 0. Young•• 

Atmospheric Modeling Division 

National Exposure Research Laboratory 
U.S. Environmental Protection Agency 
Research Triangle Park, NC 27711, USA 

ABSTRACT 

This chapter describes the manner in which gas-phase chemistry is treated in the Models-3 
Community Multiscale Air Quality (CMAQ) modeling system.  The CMAQ system currently 
includes two chemical mechanisms -- RADM2 and CB4 -- with plans to incorporate a third -- the 
SAPRC97 mechanism -- in the near future.  Each of these mechanisms is described, and the 
manner in which the first two are  linked to the aqueous chemistry and aerosol formation 
processes is discussed.  Enhanced isoprene chemistry that has been included in the RADM2 
mechanism is also described, and  procedures for entering new chemical mechanisms in the 
CMAQ system are addressed.  The representation of reaction kinetics in the CMAQ system and 
the numerical  modeling of gas-phase chemistry are also presented.  The CMAQ system currently 
employs two numerical solvers, SMVGEAR and a variant of the QSSA method. The numerical 
procedures used in each are presented, and the relative computational efficiencies of each on 
different computing platforms are not.ed. 

•Corresponding author address: Gerald L. Gipson, MD-80, Research Triangle Park, NC 27711.  E-mail: 
ggb@hpcc.epa.gov 

··on assignment from the National Oceanic and Atmospheric Administration, U.S. Department of Commerce. 


8.0 

GAS-PHASE CHEMISTRY 
===================

Since atmospheric chemistry plays a major role in many air pollution problems, the representation 
of chemical interactions among atmospheric constituents is often an essential element of an air 
quality model.  All important chemical transformations relevant to the problem being studied must 
be included to make accurate predictions of ambient pollutant concentrations.  Many atmospheric 
pollutants or their precursors are emitted as gases and interact primarily in the gaseous phase. 
However, some important atmospheric processes such as acid deposition and the formation of 
aerosols involve tlie interaction of constituents in the gas, liquid, and solid phases, so 
transformations taking place in all three phases often need to be represented.  For computational 
efficiency, these processes are usually modeled separately.  This approach has been adopted in the 
Chemical Transport Model (CTM) that is part of the Community Multiscale Air Quality (CMAQ) 
modeling system (hereafter referred to as the CCTM). This section addresses the modeling of gas(cid:173)
phase transformatfons alone in the CCTM.  Descriptions of the linkages of gas-phase constituents 
With aer9sols i;md :mth aqueous chemistry are discussed below and in Chapters 10 and 11, 
respectively.  A potential future improvement fo the CCTM would involve more closely coupling 
t1w .. 9hemical fu.tet.~ctions taking place in all three phases.  Nevertheless, the current formulation 
still enables the investigation and assessment of environmental problems using a multi-pollutant, 
o~e-atmosphere modelmg concept. 
· 

· 

,1,11.  L' 

,,I 

11'1'"1 

·.1·:"11111.1 

·:, 

• 

,, 

' 

,, 

,; 

11• 111' 

1,, 

Interactions in the gas-phase are represented in air quality models by means of chemical 
mechanisms.  The CMAQ system currently includes two base chemical mechanisms that have 
been developed primarily to address issues associated with urban and regional scale ozone 
formation and acid deposition -- the CB4 (Gery et al.,  1989) and RADM2 (Stockwell et al.,  1990) 
l!lechanisms. Variants of these two mechanisms have been develop~d for the CMAQ system to 
provide the n~ces~~ linkages to 'ilie aerosol and aqueous chemistry processes.  Current plans 
also call for adding a third mechanism -- the SAPRC-97 mechanism (Carter, 1997).  Although 
these mechanisms should be adequate for many air pollution applications, it may be necessary to 
modify or even replace these mechanisms to address some issues.  to facilitate changing 
mechanisms and adding new ones, the CMAQ system has been equipped with a generalized 
chemical mechanism processor.  It must be emphasized, however, that supplemental data for other 
CMAQ processors may be required when one of the predefined mechanisms is modified or 
replaced. This is addressed in more detail section 8.2.5. 

The remainder of this chapter addresses different aspects of the representation of gas-phase 
chemistry in the CMAQ system.  The first section includes background information on chemical 
mechanisms and provides the rationale for including the predefined chemical mechanisms in the 
CMAQ system.  The subsequent section describes the predefined chemical mechanisms as 
implemented in the CMAQ system and addresses adding new mechanisms or changing existing 
ones.  This is followed by a description of reaction kinetics as it relates to the CCTM 
representation, and the fmal section describes the mathematical procedures used internally in the 
CCTM to solye the equations that arise from the mathematical representation of gas-phase 
chemistry. 

8.1 

Background 

A chemical mechanism is a collection of reactions that transforms reactants into products, 
including all important intermediates.  Chemical mechanisms developed for air quality modeling 
are highly condensed, parameterized representations of a true chemical mechanism. They include 
artificial species and operators, and many of the mechanism reactions are parameterizations of a 
large set of true atmospheric reactions. In some cases, mechanism reactions may include elements 
which have no physical significance (e.g., products with negative stoichiometry).  While it would 
be difficult to design a generalized mechanism processor to handle all possible parameterizations 
used in various condensed mechanisms, some degree of generalization in the CMAQ system is 
achieved by using special conventions for entering chemical mechanisms.  First, all reactions in the 
mechanism are treated as if they are elementary, and the stoichiometric coefficients for all 
reactants must be one.  Since all reactions are assumed to be elementary, a reaction can have no 
more than three reactants.  These conventions permit the reaction rate to be derived directly from 
the stoichiometric equation, thereby simplifying the mathematical representation of the reactions. 
Other conventions adopted· for the CMAQ generalized mechanism processor are included in 
Section 8.3  and in Chapter 15. 

Mechanism species can be divided into two categories: inorganic and organic.  The number of 
important inorganic species is relatively small, and they are almost always represented explicitly in 
chemical mechanisms.  The important inorganic species included in these mechanisms are ozone, 
nitric oxide, nitrogen dioxide, nitric acid, nitrous acid, hydrogen peroxide, sulfur dioxide, and 
several radicals formed through their interactions with other species.  Although most of the 
chemical reactions involving these species are common to all mechanisms, some differences do 
exist.  For example, some of the mechanisms omit a few reactions because they are normally 
minor pathways and thus do not affect modeling results significantly.  Also, different rate 
constants may be used  for some reactions, especially those that are photolytic.  The 
representation of organic species usually differs more substantially, however.  Some species in the 
mechanism represent real organic compounds, but others represent a mixture of several different 
compounds. The manner in which the grouping of organic compounds is carried out typically 
distinguishes one mechanism from another, and that is described next.  In this chapter, the phrase 
mechanism species is used to refer to any species in the gas-phase mechanism, regardless of 
whether it is an explicit species or not. 

Although explicit mechanisms have been developed for many organic compounds, the resultant 
number of reactions and species needed to represent their atmospheric chemistry is too large to 
model efficiently in photochemical grid models such as the CCTM.  In addition, explicit 
mechanisms have not yet been developed for most organic compounds, thereby requiring that 
some reaction pathways be postulated.  Thus, both compression and generalization are necessary 
when depicting organic reactions.  Although chemical mechanisms differ in the manner in which 
organic species are represented, the mechanism developer usually chooses some distinguishable 
organic property to group similar organics into classes that reduce both the number of mechanism 
species and reactions.  The three most common representations include the lumped structure 

8-3 

I 
I 

technique, the surrogate species approach, and the lumped species method.  In the lumped 
structure appr6'ach, organic compounds are apportioned to one or more mechanism species on the 
basis of chemical bond type associated with individual carbon atoms (Whitten et al., 1980).  In the 
surrogate species method, the chemistry of a single species is used to represent compounds of the 
same class (e.g., Lurmann et al., 1987).  Generalized reactions are then written bas~d on the 
hypothetical model species.  The lumped species method is very similar to the surrogate species 
approach, but various mechanism parameters associated with a particular surrogate are adjusted 
to account for variations in the composition of the compounds being represented by the surrogate 
species (e.g., Carter, 1990, and Stockwell et al., 1990). 

·I· 

The construction of a compact chemical mechanism necessarily introduces varying levels of 
distortion, generalization, and omission in the representation of atmospheric chemistry (Jeffries, 
19'9s).  Alihough"mechamsms are routinely tested using results obtained from environmental 
· 
chamber experiments, the data are often insufficient to resolve uncertainties associated with some 
of the chemical representations.  For example, Carter (1990) noted that much is unknown about 
several important reaction types, and that their representations" ... continue to be largely 
speculative or are based on empirical models derived from fits to environmental chamber data." 
Further, rate constants for some reactions are either unknown completely, or significant 
dfoagreemerit exists as to their accuracy.  Several studies have been conducted to compare 
different chemicafmechanisms (e.g., Leone and Seinfeld,  1985; Hough, 1988; and Dodge, 1989). 
These comparisons revealed that the mechanisms often yield results that are similar for some 
species.  This could indicate that the fundamental atmospheric chemistry is fairly well understood 
for these species, or that the mechanisms were derived from the same experimental kinetic or 
nl~94anistic q~ta, .. which may or may not be accurate.  Larger differences tend to occur for those 
species for which the atmospheric chemistry is more uncertain.  thus, it is often difficult to assess 
the relative merits of different mechanisms when applied to any one situation.  Therefore, the 
CMAQ system includes the capability to use more than just one chemical mechanism. 

Given the inherent uncertainties in existing chemical mechanisms, alternate approaches for 
representing gas-phase chemistry are needed.  One approach being explored involves decreasing 
unc::ertainties a,~soqiated with the simplifications that are introduced to reduce mechanism size. 
'fh.is approach is based on the concept that much of the information needed for an expanded 
chemical representation does not necessarily have to be included in the mechanism explicitly, but 
ra,tl:ier can be wairjJained in atpdliary variables linked to a :relatively small number of core species 
that are inclugedi!l the m~chanism (Jeffries et al.,  1993).  Thus, it may be possible to expand 
chemical representations without greatly increasing the size of the basic mechanism, and this 
could be a future enhancement to the treatment of gas-phase chemistry in the CMAQ system. 

8.2 

Chemical Mechanisms in the CMAQ System 

This section includes summary descriptions of the two basic chemical mechanisms included in the 
CMAQ system -- the CB4 (Gery et al.,  1989) and the RADM2 (Stockwell et al., 1990).  Since the 
SAPRC-97  mechanism (Carter, 1997) is to be added in the near future, some discussion of it is 
also included.  These mechanisms require that information be supplied to the CCTM in a form 
that is unique for each mechanism, and this is carried out in several sub-systems incorporated in 
the CMAQ system.  These include the emissions processing system which generates emissions for 
key mechanism species; the initial conditions/boundary conditions processor that generates 
ambient starting and boundary concentrations for mechanism species; and the photolysis rate 
processor that produces mechanism specific photolysis rates.  The reader is referred to the 
chapters describing those sub-systems for a description of the treatment of mechanistic data, and 
to the mechanism references for a more detailed description of each chemical mechanism. 

In addition the base mechanisms, both the base CB4 and RADM2 mechanisms have been 
modified in the CMAQ system to provide necessary linkages for aerosol and aqueous chemistry 
processes, and the RADM2 mechanism has also been modified to create two new mechanism 
variants that include enhanced isoprene chemistry representations.  Note that the existing sub(cid:173)
systems provide all of the necessary information for the extensions to the base mechanism.  The 
modifications to the base mechanisms are discussed below in the section on mechanism 
extensions.  Complete listings of all mechanisms currently available in the CMAQ system are 
included in Appendix 8A. The last portion of this section briefly discusses changing the base 
mechanism or their variants or adding new mechanisms to the CMAQ system. 

8.2.1  CB4 Mechanism 

The CB4 mechanism is a lumped structure type that is the fourth in a series of carbon-bond 
mechanisms, and differs from its predecessors notably in the detail of the organic compound 
representation.  It has been used in models such as EP A's Empirical Kinetic Modeling Approach 
(EPA, 1989) and Regional Oxidant Model (Lamb, 1983), and in versions IV and V of the Urban 
Airshed Model (EPA,  1991  and SAI, 1993).  The CMAQ implementation of the basic CB4 
mechanism includes 36 species and 93  reactions, including 11  photolytic reactions. 

The CB4 uses nine primary organic species (i.e., species emitted directly to the atmosphere as 
opposed to secondary organic species formed by chemical reaction in the atmosphere).  Most of 
the organic species in the mechanism represent carbon-carbon bond types, but ethene (ETH), 
isoprene (ISOP) and formaldehyde (FORM) are represented explicitly.  The carbon-bond types 
include carbon atoms that contain only single bonds (PAR), double-bonded carbon atoms (OLE), 
7-carbon ring structures represented by toluene (TOL), 8-carbon ring structures represented by 
xylene (XYL), the carbonyl group and adjacent carbon atom in acetaldehyde and higher molecular 
weight aldehydes represented by acetaldehyde (ALD2), and non-reactive carbon atoms (NR). 
Many organic compounds are apportioned to the carbon-bond species based simply on the basis 
of molecular structure.  For example, propane is represented by three PARs since all three carbon 
atoms have only single bonds, and propene is represented as one OLE (for the one carbon-carbon 
double bond) and one PAR (for the carbon atom with all single bonds).  Some apportionments are 
based on reactivity considerations, however.  For example, olefins with internal double bonds are 
represented as ALD2s and P ARs rather than OLEs and P ARs.  Further, the reactivity of some 
compounds may be lowered by apportioning some of the carbon atoms to the non-reactive class 
NR (e.g., ethane is represented as 0.4 PAR and 1.6 NR).  Apportioning rules have been 
es~blished fo~ hundreds of organic compounds, and are built into the emissions processing sub(cid:173)
systems to produce the appropriate emission rates for the CB4 mechanism species. 

. 

I 
I 

• 

' 

The CB4 mechanism described by Gery et al. (1989) has undergone several changes since its 
publication.  In 1991, the PAN rate constants were changed and a termination reaction between 
th~)C02 operator and the H02 radical were added.  Subsequently, terminal reactions for the 
X02N operator were also added.  An updated CB4  isoprene chemistry mechanism based on the 
work of Carter (1996) was developed in 1996.  All of these changes have been incorporated in the 
CMAQ version.  It should also be noted that the original CB4 mechanism incorporated simple 
Arrhenius type rate constant expressions that were derived from more complex expressions for 
temperature and. pressure dependent rate constants.  Since the top of the CCTM domain may 
e~tend toh~ights that makes pressure dependencies important, the CMAQ version incorporates 
the original expressions rather than the derived ones .. 

8.2.2  RADM2 Mechanism 

The RADM2 mechanism is a lumped species type that uses a reactivity based weighting scheme to 
adjust for lumping (Stockwell et al.,  1990).  It has evolved from the original RADMl mechanism 
(Stockwell,  1986), and is employed in version 2 of the Regional Acid Deposition Model (Chang 
et al., 1987).  The base mechanism as implemented in the CMAQ system contains 57 model 
s~cies and 158 reactions, of which 21  are photolytic. 

I 

In RADM2, the primary organics are represented by 15 mechanism species, five of which are 
explicit because of their high emission rates or because of special reactivity considerations 
(methane, ethane, ethene, isoprene, and formaldehyde ).  The other ten represent groups of 
organic comp0ilnds aggregated on the basis of their reactivity with the hydroxyl radical (HO) 
and/or their molecular weights.  To account for varying reactivities of the different organics that 
are lumped into a single group, emissions of each organic within a group are weighted by a 
reactivity factor (F) that is computed as the ratio of the fraction of emitted organic compound that 
reacts to the fo1cti.on of the mechanism species that reacts: 

1
111,, ' ~ 111 
I '  ' 

" " " ' 

' I 

I  - exp( -~0 Emiss  J [HO]  dt) 
F  =  ~~~~~~~~~~-
1  - exp( -~o Mech  j[HO]  dt) 

(8-1) 

The integral term is estimated from a daily average integrated HO radical concentration of 110 
ppt min that was derived from RADM simulations  (Stockwell et al., 1990).  Note that F 
approaches unity if the reactivity of the emitted organic nearly equals that of the mechanism 
species or ifthe reactivities of both are very large.  As with CB4, the RADM2 lumping and 
weighting rules have been built into the CMAQ emission processing system. 

The implementation of the RADM2 mechanism in the CMAQ system is almost identical to that 
described by Stockwell et al. (1990), with only two minor modifications. First, the reaction of HO 
with cresol (CSL) was reformulated as follows to eliminate negative stoichiometry in the 
mechanism: 

From:  HO + CSL - 0.1  H02 + 0.9 X02 + 0.9 TC03  - 0.9 HO 

To: 

HO + CSL - 0.1  H02 + 0.9 X02 + 0.9 TC03 

HO+CSL- CSL 

0.9 kHo+CSL• 

(Note that negative stoichiometry is permitted in the CMAQ system, but was removed here for 
consistency with previous implementations ofRADM2.)  Second, the concentration of methane in 
the CCTM is assumed to be constant at 4.5xl013  molecules/cc.  Thus, methane was removed as a 
reactant in the reaction of OH with methane and the corresponding rate constant changed from 
second-order to pseudo first-order using the assumed CCTM methane concentration. 

8.2.3  SAPRC-97 Mechanism 

The SAPRC-97 mechanism (Carter, 1997) employs the lumped surrogate species approach, but 
offers the capability to incorporate semi-explicit chemistry of selected organics.  The SAPRC 
series of mechanisms evolved from the "ALW" mechanism of Atkinson et al. (1982).  SAPRC-97 
is similar to its predecessors SAPRC-90 and SAPRC-93, but incorporates improvements to 
aromatic chemistry and updates to reactions of many individual organic compounds.  Although 
many of the reactions for organic compounds are generalized and incorporate non-explicit 
species, product yield coefficients and rate constants are tabulated for over 100 individual organic 
compounds.  Thus, each of these organics can be modeled individually by including their semi(cid:173)
explicit chemistry in the mechanism.  Due to computational constraints, however, the full set of 
organic compounds cannot be incorporated In an Eulerian model.  For this situation, the 
mechanism is condensed by lumping individual organic compounds into groups with 
corresponding rate constants and product yield coefficients that have been weighted by mole 
fractions of the individual organics.  The mole fractions are typically derived from emission 
inventory data used in the model simulation.  Thus, unlike the previous mechanisms, the SAPRC-
97 mechanism can potentially change with each application since new rate constants and product 
yield coefficients can be computed for each application. 

The SAPRC-97 mechanism has been develop.ed with supplemental software to facilitate 
constructing mechanisms of varying levels of condensation.  Documentation of the procedures 
include three distinct levels of detail, differing primarily in the number of organic species that are 
included in the mechanism (Carter, 1988).  Since no decisions have made on the form of the 
mechanism that will be added to the CMAQ system, listings for this mechanism are not included 
in Appendix 8A.  Documentation will be provided when the CMAQ version is made available 
however. 

8.2.4  Extended Mechanisms 

I 

Each gas-phase chemical mechanism has been linked to aqueous chemistry and to aerosol 
formation processes.  Since these linkages required some modifications to the' original gas-phase 
mechanisms, di.fferent versions of the same mechanism were created for modeling gas-phase 
ch~mistry alone or for modeling gas-phase chemistry with or without aerosols and/or aqueous 
chemistry.  Different versions of the mechanisms are distinguished by means of a special naming 
conventi.on.  G~-phase mechanisms that have not been modified are referred to by their base 
name (e.g., CB4, RADM2, and SAPRC when the latter is available).  Mechanisms that have been 
modified to account for aerosol production have their names appended with "_ AE", mechanisms 
mcidified for aqueous chemistry are appended with "_AQ", and mechanisms modified for both are 
appended with "_AE_AQ".  Thus, CB4_AE_AQ refers to the CB4 gas-phase mechanism that has 
been modified to include linkages to both aerosols and aqueous chemistry. A second set of 
RA.DM2 gas-phase mechanisms that incorporates new isoprene chemistry has also been included 
in the CMAQ system. These mechanisms include either"_ CIS 1" or "_ CIS4" 1n their names to 
denote that the mechanism incorporates enhanced isoprene chemistry.  Methods used to develop 
the extended mechanisms are described below according to the three types of 'extensions: aerosol, 
aqueous chemistry, and isoprene chemistry. 

s.2.4.1 Aerosol Extensions 

'" 

I 

A major pathway leading to the formation of aerosols is the oxidation of sulfur dioxide (S02)  to 
sul,fate, primarily by the gas-phase reaction of S02 with the hydroxyl radical (OH).  All 
mechanisms in the CMAQ system incorporate this reaction.  Because organics are represented 
differently in the base mechanisms, however, aerosol formed from the reactions of organic 
COIJlpounds must be handled somewhat differently.  In the CCTM, organic aerosol formation is 
quantified using aerosol yields, i.e., µgm· 3  of aerosol produced per ppm of organic reacted with 
OH~ ozone or nitrate radical (N03).  The yields used in the CCTM are those reported by Bowman 
et al. (1995) that were derived from the work of Pandis et al. (1992).  These yields are given in 
terms of the SA,PRC-90 chemical mechanism species, so some adjustments were required to adapt 
th~.rn to the C!y!AQ mechanisms.  In the CMAQ system, aerosol production is assumed to occur 
from reactions involving five different generic organic groupings.'  Individual mechanism species 
are then mapped to these general groupings to obtain the aerosol yields.  The five generic groups 
are defined as:  1) long-chain alkanes; 2) alkyl-substituted benzenes such as toluene and xylene; 3) 
cresol and phenols; 4) long-chain olefins; and 5) monoterpenes.  Note that the' aerosol yields vary 
significantly among these five groups, so it is important to map the organic species in each 
m~.~hanism to ~e proper aerosol production group. Jhe remainder of this section describes the 
mapping that is used for the CMAQ base mechanisms and how the aerosol production rates are 
determined from the gas-phase reactions.  The derivation of the yields used in the CCTM and the 
manner in which they are used in the aerosol module are described in Chapter I 0. 

To apply the aerosol yields, the amount of reactant consumed by reaction must be determined for 
several mechanism, species.  In the CMAQ system, this is accomplished by using "counter" species 

I 

i 

that have been added as products to those reactions involving the mechanism species of interest 
(e.g., Bowman ~t al.,  1995).  These counter species are es~entially "dummy" species with no 
physical significance, and are not subjected to any other model process such as advection or 
diffusion.  Thus, changes in their concentrations reflect the effect of chemical reaction alone. 
Also, their inclusion in the mechanisms does not affect basic gas-phase chemistry since they do 
not interact with any of the other species in the mechanism. 

Special procedures are used in the CCTM to determine aerosol production from monoterpenes 
since their aerosol yields are relatively large and they are either lumped with other organic 
compounds into a single mechanism species or are apportioned among several mechanism species. 
The approach involves tracking the rate of reaction of monoterpenes separately from the rates of 
their mechanistic representation.  The CMAQ emission processor generates emissions for 
monoterpenes as a unique species in addition to lumping or apportioning the emissions into the 
appropriate mechanism species. Whenever aerosols are being modeled, the unique monoterpene 
species is included in the mechanisms and is modeled as a separate species.  As with the counter 
species, however, the monoterpene species is incorporated in the mechanisms such that it does 
not affect the basic gas-phase chemistry.  This is described in more detail below.  A p~tential 
future modification to the CMAQ system would involve incorporating a more explicit 
representation of monoterpenes in the base mechanisms that would eliminate the need for this 
special treatment and would also improve the chemical representation of these species in the gas(cid:173)
phase mechanisms (e.g., Stockwell et al.,  1997). 

• 

RADM2_AE.  Much of the linkage between the lRADM2 mechanism and aerosol 
formation is relatively straightforward.  Aerosol production from S02 and long-chain 
alkanes is derived from the amount of S02 and HC8 reacted with OH, respectively. 
Similarly, aerosol production from alkyl-substituted benzenes is derived from the sum of 
the TOL and XYL reactions with OH.  The  production from phenols and cresols is based 
upon the sum of the CSL reactions with OH and N03•  Thus, special counter species 
named SULAER, HC8AER, TOLAER, XYLAER, and CSLAER have been added to 
track these reactions. 

In the RADM2 mechanism, both monoterpenes and other olefinic compounds are lumped 
into the mechanism species OLI.  As noted above, however, monoterpenes are modeled 
separately whenever aerosols are modeled.  The monoterpenes are represented in the 
RADM2 mechanism by the species TERP, and the following reactions are added: 

TERP+HO 

TERPAER+HO 

TERP+N03 

TERPAER+N03 

TERPAER+03 

These reactions use the same rate constants as the reaction of OLI witJ.:i these species, and 
have the TERPAER counter species added to track the throughput of this reaction.  Note 
that concentrations of the reactants OH, N03  and ozone are unaffected by these reactions 
since their production equals their loss. 

· 

The final pathway for aerosol production in the RADM2 mechanism is via reaction of 
long-chain olefins with OH, N03 and ozone.  The RADM2 mechanism species OLI is used 
as the surrogate for long-chain olefins, and thus a counter species product named 
OLIAER is added to each of the reactions ofOLI with OH, N03 and ozone.  Since OLI 
includes both monoterpenes and other olefins, however, OLIAER tracks the reaction rate 
of both.  The amount of long-chain olefins reacted is determined by subtracting the 
concentration of the counter species TERP AER from that of OLIAER. The yield of 
aerosols from long-chain olefins is then applied to this difference to obtain aerosol 
production by this pathway. 

' 

• 

i 
I 

CB4_AE.  Since the CB4 gas-phase mechanism is structure-based, individual organic 
molecqles are often disaggregated and assigned to more than one mechanism species.  For 
example, long-chain alkenes are apportioned to both the PAR and OLE mechanism 
species.  Thus, many of the organic mechanism species contain fragments of molecules, 
and the identity of the original contributing organic compound is lost. As a result, it is not 
possible to ascertain with certainty the amount of long-chain alkanes and alkenes reacting 
in the CB4 mechanism, and thus aerosol production via these pathways is omitted.  The 
production of aerosols from the reactions of toluene, xylene, and cresol is included, 
however, by tracking the amounts of TOL, XYL, and CRES that react using the counter 
species TOLAER, XYLAER, and CSLAER.  The manner in which aerosol production 
from monoterpenes is modeled is identical to that used in the RADM2 mechanism. 
Monote!penes are modeled Independently as the mechanism species TERP' with rate 
constants for the reactions of TERP with OH, 0 3,  and N03  set to the same values as those 
used in the RADM2 mechanism extension. 

' 

8.2.4.2 Isoprene Extensions 

I 

Over the past few years, the importance of isoprene in ozone formation has become a major 
concern.  Its representation in the original gas-phase mechanisms was substantially condensed, 
partially because of computational resource considerations and partialiy due to significant 
uncertainties about the pathways of its reaction products.  Recent mechanistic and environmental 
chamber studies have led to a greater understanding of its atmospheric chemistry and thus 
improved mechanistic representations (Carter and Atkinson, 1996).  In the CMAQ system, two 
different levels of more detailed isoprene chemistry have been included in the RADM2 
me~panism, and these are referred to as the one-product and the four-product Carter isoprene 
mechanisms (Carter, 1996).  Both are condensed forms of the more detailed mechanism 
developed by Carter and Atkinson (1996).  Since this detailed mechanism may be too large to use 
in full-scale Eulerian modeling studies, Carter condensed the detailed mechanlsm to two levels of 
detail: one in which isoprene products are represented by four products, and one in which only 
one product is used.  The four-product mechanism is the lesser condensed of the two, and 
includes the explicit representation of many of the isoprene's unique products (e.g., methacrolein, 
methyl vinyl ketone, and methacrolein's PAN analogue).  The one-product form lumps the major 
products into a single species, thereby yielding a more compact albeit less explicit mechanism.  As 
noted above, these two mechanisms are named RADM2_CIS4 and RADM2_CIS1, and both have 
been linked to aerosols and aqueous chemistry as well.  It should also be noted that the isoprene 
chemistry incorporated in the CMAQ CB4 mechanism corresponds to the Carter I-product form, 
but the 4-product form is not available for the CB4 mechanism in the CMAQ system 

8.2.4.3 Aqueous Chemistry Extensions 

The base RADM2 mechanism does not have to be modified to link it to the aqueous chemistry 
processes since the aqueous processes in the CMAQ system are similar to those incorporated in 
the original RADM model. As described in Chapter 15, other aspects of the linkages require a 
separate mechanism with a unique name. The linkages to aqueous chemistry do require some 
minor changes to the CB4 mechanism however ..  These changes were based on a variant of the 
CB4 mechanism developed for acid deposition modeling by Gery et al. (1987).  In this version, 
the following product species that were omitted in the base CB4 mechanism are included: formic 
acid, acetic acid, peroxyacetic acid, and methylhydroperoxide (MHP).  Since these species are 
proc:Iucts only, their inclusion in the mechanism does not affect the concentrations of any of the 
other mechanism species.  It should be noted, however, that the concentration ofMHP in this 
modified mechanism represents an upper limit for two reasons. First, known decomposition 
pathways for it are not included in the mechanism.  Second, the production ofMHP will be 
overstated since it is produced by an operator that includes radicals other than the methylperoxy 
radical (Gery et al.,  1987). 

8.2.5  Changing or Adding Mechanisms in CMAQ 

As noted in the introduction to this chapter, the CMAQ system has been instrumented with a 
generalized chemical mechanism processor to facilitate making changes to existing mechanisms or 
adding new mechanisms.  The pro'?edures for altering or adding a new mechanism are described in 
EPA (1998), and will not be repeated here.  It should be emphasized, however, that the addition 
of a new mechanism will likely require modifications to the previously mentioned subsystems that 
provide key mechanism-specific information, i.e., emissions, initial/boundary condition, and 
photolytic rate processors.  Changes to an existing mechanism would also likely require 
modifications to these processing subsystems if new organic species are added or if an alternative 
organic grouping scheme is implemented.  If changes are limited such that they affect only the 
reactions of intermediate and/or product species, however, these subsystems may not need to be 
changed at all, and the modifications can then be implemented solely within the generalized 
chemical mechanism processor.  For example, the modifications to the base mechanisms to 
provide linkages to aerosol and aqueous chemistry and to expand isoprene chemistry that were 
described previously did not require any major changes to the other processors except to add a 

8-11 

II' 


'" 

'111,. 

' 

I 

,'1,,:1 

' 

photolysis rate for acrolein in the photolytic rate processor for the CIS 1 and CIS4 versions of 
RADM2. 

,,,: 

,,,I,,,' 

i 
I 

' 

I 
I 

Although the CMAQ system provides a convenient tool for making mechanism changes, some 
caution should be exercised in modifying existing CMAQ mechanisms.  The mechanisms currently 
in the CMAQ system have been evaluated outside of the CMAQ system using environmental 
chamber data andlor more detruled chemical mechanism representations.  An§ proposed changes 
to .i::~actions or .reac~.ions rates that significantly affect model predictions should normally be 
subjected to similar independent testing before being introduced into the CMAQ system and 
subsequently used in modeling applications. Thus, it would be expected that the introduction of 
most changes to a mechanism in the CMAQ system would only be performed by a researcher who 
is experienced in atmospheric chemistry and is familiar with the base mechanism..  Finally, it 
should be noted that the existing CMAQ mechanisms are fully specified.  In most instances, it will 
only be necessary for a user to choose one of the existing mechanisms for their application, and it 
will not be necessary to make any changes to that mechanism. 

' 

8.3 

Reaction Kinetics 

' 
i 

The rates of chemi~al reaction determine whether a species is formed or destroyed by gas-phase 
ch~mistry.  sin:~e the CMAQ syste~ treats all reactions as if they are elementary, the laws of 
reaction kinetics can be used directly to develop mathematical expressions for the rates of each 
chemical reaction.  This section describes the rate expressions and the forms of the rate constants 
that are used in those expressions, with special emphasis placed on the conventions used in the 
CMAQ system. The reader may also wish to refer to Chapter 15 and EPA ( 1998) for details on 
how mechanism data are entered in the CMAQ system. 

8.3.1  Reaction Rates 

The rate of a chemical reaction l (r1)  can be expressed as the product of a rate constant (k1)  and a 
term that is dependent on the concentrations of the reactants: 

' 

' 

illl 

r 1  =  k1 f( concentration)  . 

I 

ii.'ll,'' 

I' 

I 

i 

(8-2) 

For. elementary reactions, the concentration dependent term is simply the product of reactant 
concentrations, and the rate of reaction takes one of the following forms: 

"''I 

'''Ill'"' 

•I'' 

for  first-order  reactions 
for  second-order  reactions 
for  third-order  reactions 

(8-3) 

,,, 

" 

"  .. ,, 

.,,.. 

.I 

wq~re C1,  C2,and C3 refer to the concentration ofreactants 1, 2 and 3, respectively.  Note that 
when a species reacts with itself, the concentration dependent term includes the species 
concentration squared.  Thus, the rate for the reaction NO +NO + 0 2  ...  2NO:z  is equal to 
k[NO][N0][02]  and not k[N0][02]. 

Several important ter-molecular reactions involve 0 2 and/or N 2 which mediate those reactions by 
absorbing energy from exothermic bi-molecular reactions.  When either N2 or 0 2  serves this role, 
the third body is usually referred to as "M", where M =  N2 + 0 2• Since their concentrations are 
relatively stable in the atmosphere, some mechanism developers convert second- or third-order 
reactions that include these species to a reaction one order lower by multiplying the higher-order 
rate coefficient by the concentration ofM, 0 2,  or N2•  The CMAQ convention is to include third(cid:173)
body reactants in the reaction rate calculations if they are explicitly shown in the reaction, and to 
omit them if they are not shown or included only as comments.  For example, consider the 
bimolecular reaction: 0 1D + 0 2  - 0 3P + 0 2•  If the reaction is written in this form, the reaction is 
assumed to be second-order and the CCTM will use the appropriate concentration for 0 2 in the 
rate computation.  If the reaction is written as  0 1D  - 0 3P (or as 0 1D {+ 0 2}  ...  0 3P, where here 
the braces denote a comment), the reaction rate will be assumed to be first-order and the CCTM 
will not include the 0 2  concentration in the reaction rate calculation.  In the latter case, the 
mechanism developer must specify a pseudo first-order rate constant for the reaction.  The same 
convention also applies to H20. 

8.3.2  Rate Constant Expressions 

As shown in Equation 8-3, the rate of reaction is related to the concentration term by a constant 
of proportionality k1•  The rate constant k1 can take many forms depending upon the characteristics 
of the reaction.  One important class of uni-molecular reactions involves the absorption of radiant 
energy and subsequent dissociation of the reactant into product species.  The rate constants for 
these types of reactions are functions of the incident radiant energy and properties of the 
absorbing molecule, such as the absorption cross section and the quantum yield.  In the CMAQ 
system, these rate constants are calculated by the photolytic rate processor, and the details of 
these calculations are described in Chapter 14.  The remainder of the reactions are classified as 
thermal, and their rate constants are typically functions of temperature and sometimes pressure. 
The calculation of these rate constants is discussed below. 

To facilitate incorporating rate constant information for thermal reactions, the CMAQ generalized 
mechanism processor (discussed in Chapter 15) has been designed to accept the standard rate 
constant expressions used in NASA (1997).  Rate constant information is most often supplied in 
ems units (i.e., gas concentrations in molecules/cc and time in seconds), but some mechanisms use 
mixing ratio units (i.e, gas concentrations converted to mixing ratios in parts per million and time 
in minutes).  The CMAQ generalized mechanism reader is designed to accept either, but they 
must be consistent throughout the mechanism (i.e., the same units must be used for all rate 
constant forms that can be expressed in either set of units).  Some rate constant expressions (e.g., 
falloff expressions and other special forms discussed below) can be expressed only in ems units, 
however, and must always be in these units even when mixing ratio units are being used for all 
other types of rate constants.  The CCTM will automatically perform the necessary units 
conversions during the model simulation. Nevertheless, since the CMAQ domain typically extends 
through the entire troposphere, ems units are usually preferred because differences in number 
density differences with height are explicitly accounted for with those units.  · 

I 
I 
I 

Descriptions of the forms of rate constant expressions currently used in the CMAQ system are 
presented next. 

· 

i 
I 

• 

• 

• 

Arrhenius Equation.  Many rate constants exhibit a temperature dependence that 
corresponds to the Arrhenius equation: 

· 

I 

k  =A eC-EIT) 

(8-4) 

where A. is the pre-exponential factor, Eis the activation energy divided by the gas 
c0nsta.Q~ R, and Tis the temperature in degrees Kelvin.  For this form of reaction, either 
cins or mixing ratio units may be used, and only A and E need to be specified. 

.  . 

' 

i 
i 

Temperature Dependent A-factors.  For some reactions, the temperature dependence of 
t4e pre-exponential factor can become significant, and the Arrhenius equation does not 
hold.  These rate constant expressions can often be put in the following form that is 
available in the CMAQ system: 

· 

' 

k  =A (T/300)8  ~(-EIT) 

(8-5) 

where A, E, and Tare defined as above, and B is an empirically derived constant that 
provides a best fit to the data (Pitts-Finlayson and Pitts, 1986).  For this form, either set of 
units can be used, and only A, E and B need to be specified. 

I 
I 

Falloff Expressions.  Several ter-molecular reactions exhibit pressure dependencies that 
can be significant when modeling atmospheric chemistry.  These can be especially 
important when modeling from the troposphere through the stratosphere.  In these cases, 
the rate constant increases with increasing pressure.  In effect, the behavior of these 
reactions approaches second-order at high pressure and third-order at low pressure. 
Equation 8-6 gives an effective second-order rate constant for the falloff region between 
these two limits. 

' 

' 

k 

k0 [M] 

F{I  +  [N- 1!og(k0[M]/k.))2)-1 

= - - - - - c 

1  +  k0 [M]lk .. 

(8-6) 

In Equation 8-6, k0 and k .. are the low- and high-pressure limiting rate constants, 
respectively, and are calculated using the temperature dependent A-factor form described 
above .... Jh~ parameters Fe and N are also reaction specific, but for atmospheric conditions 
are very often 0.6 and LO respectively (Firllayson-Pitts and Pitts, 1986). · For this type of 
rate constant expression, A, E, and B must be specified for both k0 and k .. , and only ems 

i 
I 

8-14 

I 
' 

units are allowed. If the parameters N and Fe are not specified, the values listed above will 
be used. 

• 

Special Forms.  The following special rate constant forms are also in general use and 
have been included in the CMAQ system: 

EP A/600/R-99/030 

k  =  k1  +  Is [M] 

k  =  k  +  ( 

o 

/s [M] 

1  +  /s[M]/k2 

) 

k  = A  ( 1.0  +  0.6P) 

(8-7) 

(8-8) 

(8-9) 

Equation 8-7 is used for the rate constants of the reactions forming hydrogen peroxide 
from hydroperoxy radicals (H02 + H02  ....  H20 2 and H02 + H02 + H20  ....  H20J.  Equation 
8-8 is used for the reaction of the hydroxyl radical with nitric acid (HO + HN03  ....  N03 + 
H20), and Equation 8-9 is used for the reaction of the hydroxyl radical with carbon 
monoxide (HO + CO ....  H02 + C02). In these equations, k0,  k1,  k2,  and k3 are calculated 
using the Arrhenius equation, and A and E must be specified for each, with A given in ems 
units.  In Equation 8-9, Pis the atmospheric pressure in atmospheres andA can be 
specified in either set of units. 

• 

Reverse Equilibria Forms.  The CMAQ system also includes a special reverse 
equilibrium form for first-order decomposition reactions.  With these types of reactions, 
the equilibrium constant is input in a form similar to the Arrhenius equation.  Thus, the 
rate constant can be expressed as follows: 

k  =  k  I  Ae(-EIT} 

'f 

. (8-10) 

In Equation 8-10, k1 is the rate constant for the fo1ward reaction forming a species, and the ' 
denominator is an Arrhenius-like form for _the equilibrium constant. These reaction rate 
coefficient types are used, for example,  for the decomposition of pernitric acid and 
nitrogen pentoxide (i.e., HN04 ....  H02 + N02  and. N20 5  ....  N02 + N03). In the CMAQ 
system, A, E, and the corresponding forward reaction must be specified.  Either set of 
units may be used with this form. 

8.4  Mathematical Modeling 

This section describes the mathematical modeling concepts used in the CCTM to simulate gas(cid:173)
phase chemical reactions.  The first sub-section describes the fundamental equations that must be 
solved and some of the difficulties encountered in obtaining solutions to them. The next two sub(cid:173)
sections describe the two gas-phase chemistry solvers that are currently available in the CCTM. 
The last sub-section summarizes some of the important solver characteristfos. 

8.4.1  Governing Equations 

"II 

1' 

,1: 

A~ described iri Chapter 5, operator splitting allows gas-phase chemistry to be de-coupled from 
physical processes· such as advection, diffusion and deposition, and, as noted in the introduction to 
this chapter, gas-phase chemistry is modeled separately from aerosol formation and aqueous 
chemistry.  As a consequence, continuity equations for each gas-phase mecharusm species can be 
formulated anc::l. solved independently on a cell-by-cell basis.  By using the killetics laws for 
elementary reactions and applying a mass balance to each species, the following equation for the 
rate of change of each species concentration can be derived for a single cell: 

I 

l 

dC; 
dt 

=P;-L;C1 

m, 

pi  =E 

/=I 

V1,lrl 

where 

and 

L,CJ=  L  rt 

n, 

/=I 

(8-11) 

(8-12) 

(8-13) 

In Equations 8-11 through 8-13, C, is the concentration of species i,  V; 1 is the stoichiometric 
coefficient for species i in reaction /, and r1 is the rate ofreaction /.  The sum l =  l...m1 is over all 
reactions in which species i appears as a product, and the sum I= l ... n1 is over all reactions in 
which species i appears as a reactant. 

• Equation 8-11  states that the change in species concentration is equal to the chemical production 
of that species minus its chemical loss, and it is the fundamental species continuity equation for 
gas-phase chemistry that is solved in the CCTM.  If the concentration of species i is known at 
some particular time, its concentration can be computed at a later time by solving Equation 8-11. 
Since the production and loss terms contain references to other species concentrations, however, 
Equation 8-11 must be solved as part of a coupled set of ordinary differential 'equations. 

It should also be noted that the CCTM contains an option for including emissions in either the 
ve:rtical diffusiOn process or in gas-phase chemistry.  When emissions are included in gas-phase 
chemistry, the fundamental form of the Equation 8-11  is not altered since an emission source term 
is simply a zeroth:order production  rate.  Thus, for the discussions that follow, the production 
term P, is assumed to include an emission source term if species i is emitted and emissions are 
in9luded in gas-phase chemistry. 

8-16 

The system of non-linear, ordinary differential equations (OD Es) arising from Equation'8-11 for N 
species can be expressed as follows: 

EP A/600/R-99/030 

dC. 
- '  =  P.(c,t)  - L.(c,t) C.  = J;1(c,t) 
dt 

I 

I 

I 

with the initial conditions: 

i  =  1,2,. .. ,N 

(8-14a) 

(8-14b) 

where c is the vector of species concentrations and N is the total number of species in the 
chemical mechanism.  Numerical "marching" methods are typically employed to obtain 
approximate solutions for this class of problem.  In these methods, the concentrations of all 
species are given at the starting point and a solution is computed at selected time intervals (i.e., 
time steps) using the right hand side of Equation 8-14a.  Two sources of difficulty arise in 
obtaining numerical solutions to these equations as they apply to atmospheric chemistry problems. 
First, the system is nonlinear because the production and loss terms include second- and third(cid:173)
order reactions.  Second, the system of equations is "stiff" because of the widely varying time 
scales of the chemical reactions and complex interactions among species.  A stiff system can be 
described mathematically as one in which all the eigenvalues of the Jacobian matrix of Equation 8-
14a are negative, and the ratio of the absolute values of the largest-to-smallest real parts of the 
eigenvalues is much greater than one.  Systems are typically termed stiff if the latter ratio is 
greater than 104
the system very stiff (Gong and Cho,  1993). 

•  For atmospheric chemistry problems, the ratio is often greater than 10 10

,  making 

The stiffness problem coupled with the fact that these equations must be solved for tens of 
thousands of cells in a typical modeling application require that special numerical methods be 
employed.  The use of standard explicit methods is often precluded because relatively small time 
steps are required to maintain numerical stability and obtain accurate solutions.  On the other 
·hand, classical implicit methods that are both accurate and stable have not often been used 
because of high computational demands.  As a result, several special techniques have been 
developed to obtain reasonably accurate solutions in a computationally efficient manner.  At 
present, two solution techniques are available in the CCTM: the implicit Sparse-Matrix 
Vectorized Gear algorithm (SMVGEAR) and a variant of the explicit Quasi-Steady State 
Approximation (QSSA) method.  Each of these is described in detail below.  Although each of 
these techniques, as well as others that have been used in atmospheric ~hemistry models, have 
been designed to be computationally efficient, they still consume 50 to 90% of the total CPU time 
used in a model simulation.  Thus, obtaining a numerical solution to Equation 8-14a,b is normally 
the most computationally intensive portion of the CCTM. 

8.4.2  SMVGEAR 

I 

·111 

Numerical solvers based on the algorithm developed by Gear (1971b) have traditionally been used 
to obtain accurate solutions to stiff ODE problems.  The technique is implicit in method, does not 
amplify erro~~ from one step to another and incorporates automatic step size and error control.  In 
fas~~ solvers b .. ~ed.~n this method have often been used to evaltiate .?ther .fastrr solutio!1 meth()ds 
for accuracy (e:g.,Odman et al.,  1992; Gong and Cho,  1993; Dabdub and Seinfeld,  1995; and 
S~ylor and Ford, 1995).  Past versions of this code have rarely been installed 'in Eulerian models, 
hq,vever~ ~ecapse Qfthe high computational ~ost.  Jacobson and Turco (1994~ have modified the 
Gear algorithm to obtain considerable speedups on vector computers.  The SMVGEAR algorithm 
is highly vectorized to improve computational performance on vector computers and it 
incorporates special sparse matrix techniques to increase computational efficiency.  Further 
enhancements have been obtained by ordering the cells for processing.  Each of these are 
described further below.  Since the technique is based on Gear's original algorithm, it is briefly 
described first.  For more details on the Gear method, the reader is referred to Gear (1971a) and 
Gear (1971b). 

h," 

1111!!!11111' 

,, 

"'" 

, 

, 

I 

, 

, 

'" 

8.4.2.1  Standard Gear Algorithm 

The Gear algorithm is one of a class of methods referred to as backward differentiation formulae 
(BDF).  The generalized BDF that forms the basis for Gear's method can be expressed as follows: 

I 

(8-15) 

w~ere n refers to the time step, h is the size of the time step, p  is the assumed order, /30  and ~ are 
scalar quantities that are functions of the order, and f( cmtn)  is the vector of production and loss 
terms defined by the right hand side of Equation 8-14a.  The method is implicit since 
concentiations at the desired time step n depend on values of the first derivatives contained in 
f( cn,tn) that are functions of the concentrations at the same time.  The order of the method 
corresponds to the number of concentrations at previous time steps that are incorporated in the 
summation on the right hand side of Equation 8-15. 

, 

""''" 

"' 

I 

'" 

,,, 

I 
I 

To facilitate changing step size and estimating errors, the multi-step method i~ Equation 8-15 is 
transformed to a multi-value form in which information from only the previo{is step is retained, 
but information on higher order derivatives is now used (Gear,  1971b).  In this formulation, the 
solution to Equation 8-14a,b is first approximated by predicting concentrations and higher order 
deriyatives at the end of a time step for each species using the following matrix equation: 

I 

z 
1,n,(O) 

= Bz 

1,n- I 

(8-16) 

8-18 

where zi =  [c;,  he';, ... , hpc/PJ/p!]T, the subscript n,(O) refers to the prediction at the end of time step 
n, and the subscript n-1  refers to values obtained at the end of previous time step (or the initial 
conditions when n =  1 ).  B is the Pascal triangle matrix, the columns of which contain the 
binomial coefficients: 

EPA/600/R-991030 

1  1  1  1  ... 

2  3 

3 

...  p-1  p 
... 

B 

0 

p 

(8-17) 

The prediction obtained from Equation 8-16 is then corrected by solving for z;,n  such that the 
following relations hold for all species: 

(8-18) 

In Equation 8-18, r is a vector of coefficients that is dependent on the order, but r 2,  the element 
corresponding to the first derivative location in z,  is always equal to one.  Thus, the correct value 
of c;,n  is obtained when the calculated value of c  ~.n equalsi(cmtn) in Equation 8-18.  An 
approximate solution for C;,n  is obtained by applying Newton's method to the system of equations 
that correspond to the first equation in 8-18 for all species.  This leads to the following corrector 
iteration equation: 

where m refers to the Newton iteration number, the vector f(cn,tn)  is calculated using 
concentrations computed for the m-th iteration, oc is a vector containing the most recent 
estimates of first derivatives, I is the identity matrix, and J  is the Jacobian matrix whose entries 
are defined as: 

(8-19) 

i,j  =  1,2, .. .N 

(8-20) 

At the end of each iteration, the vector containing the first derivatives ( oc) is updated, but higher 
order derivatives in z need not be computed until convergence is achieved. 

After convergence is achieved, the local truncation error for each species, e;, is given by: 

'1111'' 

,I., 

1111' 

,II 

' 

:11•11 

, 

' 1 

I• 

11 

:• 

"111 

)  term and approximating fr 1c/p+i) 
Th.e error is estimated in the algorithm by neglecting the O(J.r2
from the backward. difference of lt'c/P>/p!  which can be calculated using the last components of the 
vJ6tors Z;~m) arid ~;:'~-!  de:fined abo~e.  These error estimates are used to control accuracy and to 
cq,!,lllge both the time step size and the order of the method when warranted. 

!"""', 

, 

, '::· 

I 

(8-21) 

,;111"11' 

,, 

" 

I 

1
' 

Although several variants of the basic Gear algorithm have been developed, the fundamental 
computational scheme can be described generically as follows.  At the begiruling of any 
integration interval, the order is set to one and the starting time step is either calculated or 
selected by the user.  Each time step is initiated by predicting concentrations at the end of the time 
step using Equation 8-16.  Corrector iterations are then carried out using Equation 8-19 until 
prescribed convergence criteria are achieved or non-convergence is deemed to have occurred. 
when convergence is achieved~ the error is computed using the approximation for Equation 8-21. 
If the error is within prescribed limits, the solution for the step is accepted and the step size and 
orger to be us~.cl iq,Jhe next step are estimated.  The size of the time step is estimated for the 
current order, the next lowest order, and the next highest order using error estimates derived from 
Equation 8-21  for the next step.  From these, the largest time-step size and its corresponding 
order are then selected for use in the next step.  If either the convergence or error test fails, the 
integration is restafied from the beginning ofihe failed time step after re-evaluating the Jacobian 
m~trix, reduci.Ilg the size of the time step, and/or lowering the order. 

' 

Th~ individual operations described above are normally handled automatically in Gear algorithms. 
To reduce comput(ltional demands, the algorithms also utilize several empirically based rules.  For 
example, the Jacobian matrix is only updated after a prescribed number of successful steps have 
been completed, if the order changes, or if a convergence or error test failure occurs.  In the 
Newton iterations, progress towards convergence is monitored and the iterations halted if the 
progress is judged insufficient or if three complete iterations have been performed without 
convergence being achieved.  To maintain numerical stability, changes to the size of the time step 
and the order are allowed no more than once every p+ 1 steps for a p-th order method. 

I 

I 

8.4.2.2 Vectorized Gear Algorithm 

Jacobson and Turco (1994) have modified the Gear algorithm to incorporate additional 
computational ~fficiencies that can achieve speedups on the order of 100 on vector computers. 
A~cmt half of tlie improvement is attributed to ellhanced vectorization, and h~lf to improved 
ma;trix operations.  Because of the improved matrix operations, SMVGEAR also runs faster than 
traditional Gear solvers on non-vector machines, but the greatest benefit will be obtained with 
vector machines.  The major enhancements incorporated in SMVGEAR are now described in 
m~re detail. 

' 

"' 

,, 

In the conventional application of the Gear-type algorithm, the method is applied to each grid cell 
individually.  With this implementation, the length of the innermost loops in most computations 
corresponds to the number of species, which is typically on the order of 30 to 100.  In 
SMVGEAR, the modeling domain is divided into blocks of cells, and the Gear algorithm is 
applied to each cell within a block simultaneously.  With this structure, the length of the innermost 
loops for most calculations is equal to the number of cells in a block.  Substantial improvements in 
vectorization can therefore be obtained if the block size is larger than the number of species. 
Jacobson and Turco (1994) found that a block size on the order of 500 cells achieves about 90% 
of the maximum vectorization speed on a Cray C-90 computer.  The use oflarger block sizes may 
not substantially increase computational speed and may incur some additional penalties.  For 
example, memory requirements increase with increasing block size.  Furthermore, the size of a 
time step in SMVGEAR is the same for each cell within a block and is based on the time-step 
estimate for the stiffest cell in the block.  Limiting the block size can therefore reduce excess 
calculations that need to be performed for the less stiff cells.  Jacobson (1995) also achieved 
computational savings by ordering the cells by stiffness before dividing them into blocks.  Each 
block then tends to contain cells of similar stiffness, thereby reducing excess computations for 
some cells.  Jacobson found excess computations were reduced by about a factor of two, and that 
these reductions more than offset the additional work incurred with calculating and sorting the 
cells by stif:fiiess. 

Much of the computational intensity associated with the Gear method arises from the matrix 
operations that are needed to perform the Newton iterations in the corrector step.  Jacobson and 
Turco have introduced two techniques to improve the efficiency of these operations.  First, all 
known cases of multiplication by zero in matrix multiplication and decomposition are eliminated. 
This is particularly beneficial for atmospheric chemistry problems since the Jacobian matrices are 
almost always sparse (i.e., they contain a large number of zero entries).  However, decomposition 
techniques that are applied to these matrices often result in substantial fill-in, thereby reducing the 
benefits of employing sparse-matrix techniques.  To maintain maximum sparsity after the 
decomposition operation, SMVGEAR orders the species in the Jacobian such that those with the 
fewest partial derivative terms are located in the top rows, and those with the most are in the 
bottom rows.  At the very beginning of the program, the ordering is done and a symbolic 
decomposition is performed to identify multiplies by zero.  Since the computations associated 
with the matrix operations are determined entirely by the structure of the chemical mechanism, it 
is necessary to do this only once and the results can then be applied to every cell uniformly. 

The SMVGEAR algorithm has been implemented in the CCTM with minor changes to the 
original algorithm but extensive changes to the original computer code.  The code changes arose 
from linking the algorithm to the generalized chemistry processor used in the CMAQ system, and 
developing a driver routine specific to the CCTM structure.  The only significant change to the 
algorithm involved modifying the code to eliminate the possibility of obtaining negative 
concentrations.  With the standard Gear algorithm, negative concentrations can occur when a 
species is rapidly depleted, although the magnitudes of these concentrations are extremely small. 
In the CCTM implementation, a lower bound on allowable concentrations is applied, and the rates 
of change and the Jacobian matrix are modified to reflect that no changes in concentration are 
occurring when the lower bound is reached.  Comparisons with the standard Gear algorithm show 
virtually no differences in species concentrations above the lower bound, but a small penalty in 
computational performance is incurred. Nevertheless, the approach insures a positive-definite 
solution. 

' 

' 

The computational performance of SMVGEAR is also affected by the error tolerances used for 
the Newton iteration convergence tests and the local truncation error tests.  Error control in 
SM\f GEAR 1~ similar to that used. in LSODE (Hindmarsh,  1980).  Both a relative and an absolute 
tolerance must be specified. In their discussion of ODE solvers, Byrne and Hindmarsh (1987) 
relate the relative error tolerance to the number of accurate digits and the absolute error tolerance 
to the noise level (i.e., the size of the largest concentration that can be neglected).  If r is the 
number of accurate digits required, then Byrne and Hindmarsh suggest setting the relative 
tqlerance to  ~g·Cr+ 1>,  The absolute error tolerances cannot be specified as generically because 
particular model applications may require different accuracies for the mechanismn species.  In the 
CCTM implementation of SMVGEAR, the relative tolerance and absolute tolerances have been 
preset to 10·3 and 10·9 ppm, respectively.  However, these values can be changed by the user 
relatively easily in the CCTM as described in EPA (1998). 

8.4.3  QSSA Solver 

The QSSA solver is a low order, explicit solver that exhibits good stability for stiff systems. 
Although less accurate than the Gear solver, it is still a reasonably accurate, fast solver that is 
especially suitable for large scale grid models.  There are actually many versions of solvers that go 
by the name "QSSA" (e.g., Mathur et al.,  1998).  The solver developed for the CCTM is a 
predictor/corrector version based on the one developed by Lamb and used in the Regional 
Oxidant Mod~.l (Lamb,  1983, and Young et al.,  1993). 

. 

i 

I  '":I' 

'" 

The QSSA method originates from assuming integration time steps sufficiently small such that in 
Equation 8-11, the production and loss rate terms Pi and L; can be considered constant. If the 
Jacobian is diagonaily dominant, this assumption may be valid as Llt ...  0, and the time step 
solution at tn+ 1 =  tn+ Llt can be written formally as: 

c,  :  c,  +  ( c.  - c.  ) e 

• 

In 

1. 

-l t.1 

I 

(8-22) 

where  C1_  =  P, I Li  and  C;.  is the solution at  tn-

The CCTM QSSA makes no a priori assumptions about reaction time scales.  For example, there 
ru;:~ no assume:<:l  st~ady states.  However, the algorithm separates the numerical computation into 
either an Euler step, a fully explicit integration, or an asymptotic evaluation based on 
photochemical lifetimes estimated from an initial, predictor calculation of P; and L;.  The cut-offs 
and equations for each predictor step are: 

I 

8-22 

Eulerstep: 

LJ!::..t  ~  0.01 

Explicit: 
Asymptotic:  Li /:,.t  l=:  10.0 

0.01  -<  Li /:,.t  -<  10.0 

n 

C  = C1  +  (P.  +  L.C1  ) 
C.  = C  +  ( C. 
- C.  ) e 
C.  =  C. 

I. 

In 

I,. 

I 

I 

n 

I 

I 

I 

1_ 

EPA/600/R-991030 

(8-23) 

The CMAQ QSSA algorithm proceeds in three stages: an optimal time step determination, a 
predictor evaluation, and a corrector evaluation.  In the first stage, an optimal chemistry time step 
interval Lit is determined at time tn  based on a tolerance parameter, A.,  such that 

I c.  - c.  I ~  )., c  . 

I 

1n 

1n 

Substituting Equation 8-22 into 8-24 gives: 

c 
'n 

IC.  - c  I 

'• 

1n 

/:,.t  ~  - -

1 
L 

I 

In 

[ 

I  - A 

l 

. 

(8-24) 

(8-25) 

The algorithm attempts to weight the time step determination against species whose 
concentrations are very small compared to the primary oxidants. These usually include some of 
the fastest reacting radicals. The following quantity is defined as 

(8-26) 

Then the following quantity is computed for only those species that satisfy Ca> eC,est ( e= 0.01): 

(8-27) 

(8-28) 

ot  =  __  n 

).Ca. 
p 
ex 

ex 

The tolerance parameter A.  is controlled by the rate at which the key NO species concentrations 
are changing; if they are changing too rapidly, the tolerance is tightened, otherwise it is relaxed: 

A.= 

{ 

0.001,  if d[NO] I [NO] 

dt 

0.005,  otherwise 

2:  0.5%  per  minute 

(8-29) 

After determiriing a time scale for each species a, .Lit is set to min{ ota}.  For computational 
efficiency, .Lit is further constrained to be no less than one second and of course is also constrained 
to be no greater than the total integration time. 

· 

In the predictor step, the species concentrations are updated ( C; _.  C; * ) with the optimal time step 
u~,i11g the Euler-step, explicit or asymptotic calculations described above.  Once  c,· is calculated, 
QSSA computes new production and loss rate coefficients P; • and L; ·, respectively. 

I 
' 

,. 

In the corrector step, the final production rate is set as the average of the initial and predictor 
values,  ft,  =  ( P/  +  P1 )  I 
the same cut-offs based on L1 that were determined in the predictor step: 

, and the new concentration C; for time  tn+t  =  tn + .Lit is computed using 

I 

Eulerstep: 

Explicit: 

Asymptotic: 

I 

'n 
P  IL•+ (C.  - P./L.*)e-L,"At 

C1  =  C.  +  ( P  +  L, • C.  )  llt 
C 
c,  =  P/ L;. 

1
11 

In 

i 

I 

: 

I 

I 

I 

(8-30) 

The algorithm has been optimized for vector computers by moving the grid cell loops into the 
innermost position (Young et al.,  1993) as is done in SMVGEAR described above.  To minimize 
storage requirements, grid cell blocking has been implemented wherein blocks of cells are handed 
off to the solver in sequence. The CMAQ QSSA has also been optimized for the Cray T3D by 
utilizing vario'us coding techniques aimed specifically at that architecture. Some of these 
optimizations are described in Chapter 19. 

· 

I 

8.4.4  Summary 

Gear type solvers have generally been considered the most accurate for gas chemistry, 
representing ''exact solutions" (provided the controlling numerical tolerances are sufficiently 
tight). Until the advent of SMVGEAR, however, it has not been feasible to use these solvers in 
Eulerian models.  SMVGEAR is designed to run optimally on high end vector computers such as 
the Cray C90, but its use on scalar machines may be impractical. Although less accurate, the 
QSSA solver may be more suitable for those types of computers. 

· 

The issue of ~ccuracy versus computational speed is a continuing concern (Mathur et al.,  1998), 
p~icularly siiice the availability of high-end machines like the Cray C90 is limited.  The CMAQ 
QSSA solver presents a reasonable, numerically efficient alternative and, although not considered 
as accurate as a Gear-type solver, may be sufficiently accurate for modeling, taking into 
consideration the uncertainties of the other numerical modeling components.  Accuracy can be 
somewhat improved by using shorter integration steps in the solver, but then computational work 
mounts, defeating the purpose. For the CMAQ QSSA, accuracy will be compromised when the 
ODE system is very stiff and the system Jacobian strays from diagonal dominance.  Nevertheless, 
the trade-off between solution efficiency and accuracy may still warrant its use in these cases. 

Finally, both the SMVGEAR and the QSSA solvers have been incorporated in the CMAQ system 
with the predefined accuracy controls that were described in the previous two sections.  Of 
course, these error controls can be changed by the user if desired, but that will of course affect 
both the prediction accuracy and the efficiency of obtaining a solution.  Note also, that either 
solver can be used with any of the CMAQ chemical mechanisms that were described in section 
8.2. 

8.5 

References 

Atkinson R., Lloyd A.  C.  and Winges L. (1982) An updated chemical mechanism for 
hydrocarbon/NO:x/S02 photooxidations suitable for inclusion in atmospheric simulation models. 
Atmos. Environ., 16, 1,341-1,355. 

Bowman F. M., Pilinis C., and Seinfeld J.  (1995) Ozone and aerosol productivity of reactive. 
Atmos. Environ., 29, 579-589. 

Byrne G.  D. and Hindmarsh A. C.  (1987) Stiff ODE solvers: a review of current and coming 
attractions. J.  Comput.  Phys.  70, 1-62. 

Carter W. P. L. (1988) Appendix C Documentation of the SAPRC Atmospheric Photochemical 
Mechanism Preparation and Emissions Processing Programs for Implementation in Airshed 
Models. Final Report for California Air Resources Board Contract No. A5-122-32. 

Carter W. P. L. (1990) A detailed mechanism for the gas-phase atmospheric reactions of organic 
compounds. Atmos.  Environ.  24A, 481-515. 

Carter W. P. L. (1996) Condensed atmospheric photooxidation mechanisms for isoprene. Atmos. 
Environ.  24, 4,275-4,290. 

Carter W. P. L. and Atkinson R. (1996) Development and evaluation of a detailed mechanism for 
the atmospheric reactions of isoprene and NOx. Int.  J.  Chem.  Kinet. 28, 497-530. 

Carter W. P. L., Luo D.  and Malkina I. L. (1997) Environmental Chamber Studies for 
Development of an Updated Photochemical Mechanism for Reactivity Assessment. Final Report 
for California Air Resources Board Contract No. 92-345, Coordinating Research Council, Inc., 
Project M-9 and National Renewable Energy Laboratory, Contract ZF-2-12252-07. 

c;J:)l;ll1g J.  S., Brost R. A., Isaksen I.  S. A., Madronich S., Middleton P., Stockwell W.R. and 
WSleck C.J. (1987) A three-dimensional Eulerian acid deposition model: physical concepts and 
formulation,.!.  geophys.  Res., 92, 14,681  - 14,700. 

Dabdub D. and Seinfeld J.  H. (1995) Extrapolation techniques used in the solution of stiffODEs 
associated with chemical kinetics of air quality models. Atmos. Environ.  29, 403-410. 

I)odge M.C. (1989) A comparison of three photochemical oxidant mechanisms,.!. geophys.  Res., 
94, 5,121-5,136. 

I 

EPA (1989) Procedures for Applying City-specific EKMA. EPA-450/4-89-012. 

''''"" 
i 

EPA (1991) User's Guide for the Urban Airshed Model, Volume I: User's Manual for UAM 
(CB4). EPA-~,50/4-90-007a. 

I 

El'A (1998) EPA Third-Generation Air Quality Modeling System, Models-3 Volume 9b User 
Manual. EPA-600/R-98/069b. 

I 

Gear C. W.  (1971a) Numerical Initial Value  Problems in Ordinary Differential Equations. 
Prentice-Hall, Englewood Cliffs, NJ. 

I 
'I" 

Gear C.  W.  (1971 b) The automatic integration of ordinary differential equatfons. Comm.  ACM 
14, 176-179. 

I 

Gery M. W., Morris R. E., Greenfield S.  M., Liu M. K., Whitten G. Z., and Fieber J. L.  (1987) 
Development of a Comprehensive Chemistry Acid Deposition Model (CCADM). Final Report for 
.IJ:iteragency Agreement DW 14931498, U.  S. Environmental Protection Agency and U.  S. 
Department of Interior. 

: : ~ i ! : : ' : : ; " ' ' 

~ : : : : '  : 1

11 
: 

Gery M. W., Whitten G. Z., Killus J.P. and Dodge M. C.  (1989) A photochemical kinetics 
mechanism for ur~an and regional scale computer modeling . .!.  geophys.  Res. 94,  12,925-12,956. 

I ' 

' I 

I 

,' I  " 

I 

' 

"' 

I i 

' " 

Gong W. and Cho H.  R. (1993) A numerical scheme for the integration of the gas-phase chemical 
rate equations in three-dimensional atmospheric models. Atmos.  Environ.  27A, 2,147-2,160. 

Hindmarsh A'.C.  (1980) LSODE and LSODI, two new initial value ordinary differential equation 
solvers. ACM News!. 15, 10-11. 

· 

Hough A. (1988) An intercomparison of mechanisms for the production of photochemical 
oxidants . .!.  geophys. Res.,  93, 3,789-3,812. 

Jacobson.~.!'~q,,Jurco ~,~,, P.  (1994) SMVGEAR: A sparse-matrix, vectorized Gear code for 
alinospheric models. Atmos.  Environ.  28, 273-284. 

Jacobson M.  (1995) Computation of global photochemistry with SMVGEAR II. Atmos.  Environ. 
29, 2,541-2,546. 

Jeffries H. E. (1995) Photochemical Air Pollution. Chapter 5 in Composition,  Chemistry,  and 
Climate of the Atmosphere. Ed. H.B. Singh, Von Nostand-Reinhold, New York. 

Jeffries H. E., Gery M. and Murphy K.  (1993) Advanced Chemical Reaction Mechanisms and 
Solvers for Models-3. Progress Report for EPA Cooperative Agreement CR-820425. 

Lamb, R.G. (1983) A Regional Scale (1000 km) Model of Photochemical Air Pollution.  Part I -
Theoretical Formulation.  EPA-600/3-83-035, U. S.  Environmental Protection Agency, Research 
Triangle Park, NC. 

Leone J.A. and Seinfeld  J.H. (1985) Comparative analysis of chemical reaction mechanisms for 
photochemical smog. Atmos.  Environ., 19, 437-464. 

Lurmann F. W., Carter W. P. L.  and Coyner  L.A. (1987) A Surrogate Species Chemical 
Reaction Mechanism for Urban Scale Air Quality Simulation Models Volume 1. EPA-600/3-87-
014a. 

Mathur R., Young J.  0., Schere K. L., and Gipson G. L. (1998) A Comparison of Numerical 
Techniques for Solution of Atmospheric Kinetic Equations. Atmos.  Environ., 32, 1,535-1,553. 

NASA (1997). Chemical Kinetics and Photochemical Data for Use in Stratospheric Modeling 
Evaluation No.  12. JPL Publication 97-4, Jet Propulsion Laboratory, Pasedena, CA. 

Odman, M. T., Kumar N. and Russell A.G. (1992) A comparison of fast chemical kinetic solvers 
for air quality modeling. Atmos.  Environ.  26A, 1,783-1,789. 

Pandis S. N., Harley R. A., Cass G. R.  and Seinfeld J.  H.(1992) secondary aerosol formation and 
transport. Atmos.  Environ.  26A, 2,269-2,282. 

Pitts-Finlayson B.J. and  Pitts J.N. (1986) Atmospheric Chemistry: Fundamentals and 
Experimental Techniques, J.  Wiley and Sons, New York. 

SAI (1993) Systems Guide to the Urban Airshed Model (UAM-V). Systems Applications 
International, San Rafael, CA. 

Saylor, R. D. and Ford G.D. (1995) On the comparison of numerical methods for the integration 
of kinetic equations in atmospheric chemistry and transport models. Atmos.  Environ.29, 2,585-
2,593. 

Stockwell W. R, Middleton P.  and Chang J.  S.  and Tang X.  (1990) The second generation 
regional acid deposition model chemical mechanism for regional air quality modeling. J.  geophys. 
Res.  95 (dlO),  16,343-16,367. 

', 

"' 

111,' 

'11,, 

111111:1""' 

'", 

",1,1, 

ii1j:;,,11111, 

i' 

,,11:,1111' 

,, 

,l1 

Stockwell W.R (1986) A homogeneous gas phase mechanism for use in a regional acid 
deposition model, Atmos. Environ., 20,  1,615-1,632. 

' 
I 

I, 

,, 

Stockwell W.R., Kirchner F., Kuhn M., and S.  Seefeld (1997) A new mechanism for regional 
atmospheric chenifatry modeling. J.  geophys.  Res.  102 (D22), 25,847-25,879. 1 

I 
I' 

Whitten G.  Z., Hogo H.  and Killus J.P. (1980) The carbon bond mechanism:  a condensed kinetic 
mechanism for photochemical smog. Envir. Sci.  Technol.  14, 690-701. 

I 

Young J.  0., Sills E., Jorge D. (1993) Optimization of the Regional Oxidant Model for the Cray 
Y-MP. EPN6QO/R'.'"94-065, U.S. Environmental protection Agency, Research Triangle Park, 
NC. 

, 

This chapter is taken from Science Algorithms of the EPA Models-3 Community 
Multiscale Air Quality (CMAQ) Modeling System, edited by D. W. Byun and J. K. S. 
Ching, 1999. 

Appendix SA Chemical Mechanisms Included in the CMAQ System 

Table SA-I.  CB4 Mechanism Species List 

Table 8A-2.  RADM2 Mechanism Species List 

Table 8A-3.  CB4 Mechanism 

Table 8A-4.  CB4  AE Mechanism 

Table 8A-5.  CB4_AQ Mechanism 

111111,1!,11' 

Table 8A-6.  CB4  AE  AQ Mechanism 
Table 8A-7.  R.ADM2 and RADM2  AQ Mechanisms 

,"'111.1'  ~  7 

Ii 

'11 

-

~,' 

'', 

I 

-

-

11111:',I 

1 

"'· 

Table 8A-8.  RADM2  AE and RADM2  AE  AQ Mechanisms 

-

-

Table 8A-9.  RADM2  CISI and RADM2  CISI  AQ Mechanisms 

'

1 

::;;:,,1: 

'I, 

,,Ill:",::·,', 

1,, 

'"" 

'·:w'1

; , , , ,  

" 

11·!' 

"' 

-

-

Table 8A-10.  RADM2_CIS1_AE and RADM2_CIS1_AE_AQ Mechanisms 

Table 8A-1 l.  RADM2_CIS4 and RADM2_CIS4_AQ Mechanisms 

Table 8A-12.  RADM2_CIS4_AE and RADM2_CIS4_AE_AQ Mechanisms 

Notes to Tables 8A-3 through 8A-12: 

a) 

b) 

c) 

The mechanism listings are divided into two parts. The first lists the reactions and the 
second lists the rate constant expressions. 

. . 

The  parameters  for  the  rate  constants  are  given  in ems  units.  Rate  constants 
calculatedin ems units for T=298 °K and P= 1 atm are shown in the rightmost column 
of these listings. 

For photolytic  reactions,  photo  table  refers  to  the  photolysis  rates  described  in 
Chapter 14.  The rate constant for all photolytic contains a zero entry in these tables, 
but is calculated in the CCTM as the product of the scale factor and the photolysis 
rate that is calculated by the CMAQ photolysis rate processor. 

d) 

The falloff rate expression referred to in these tables is Equation 8-6 in Section 8 .3 .2. 

Table 8A".l 

CB4 Mechanism Species List 

Nitrogen Species 
NO 
N02 
HONO 
N03 
N205 
HN03 
PNA 

Oxidants 

ru(cid:173)

H202 

Sulfur Species 
S02 
SULF 

Atomic Species 
0 
om 

Nitric oxide 
Nitrogen dioxide 
Nitrous acid 
Nitrogen trioxide 
Nitrogen pentoxide 
Nitric acid 
Peroxynitric acid 

Ozone 
Hydrogen peroxide 

Sulfur dioxide 
Sulfuric acid 

Oxygen atom (triplet) 
Oxygen atom (singlet) 

Odd Hydrogen Species 
OH 
H02 

Hydroxyl radical 
Hydroperoxy radical 

Carbon oxides 

8-29 

co 

PAR 
ETH 
OLE 
TOL 
XYL 
!SOP 

Carbon monoxide 

Paraffin carbon bond (C-C) 
Ethene (CH2=CHi) 
Olefinic carbon bond (C=C) 
Toluene {C6H4-CH1) 
Xylene (C6Hs-{CH3)2) 
lsoprene 

Carbonyls and phenols 
FORM 
ALD2 
MGL Y 
CRES 

Formaldehyde 
Acetaldehyde and higher aldehydes 
Methyl glyoxal  (CH3C{O)C(O)H) 
Cresol and higher molecular weight  phenols 

Organic nitrogen 
PAN. 
NTR 

Organic Radicals 
C203 
ROR 
CRO 

Peroxyacyl nitrate (CH3C(O)OON02) 
Organic nitrate 

Peroxyacyl radical (CH1C(O)OO') 
Secondary organic oxy radical 
Methylphenoxy radical 

Qperttors 
X02 
X02N 

NO-to-N02 Operation 
NO-to-nitrate operation 

Products of organics 
T02 
Of EN 

ISPD 

Toluene-hydroxyl radical  adduct 
.  High molecular weight aromatic 
''  oxidation ring fragment 

Pro.~,µcts of isoprcne reactions 

Socc;ies added for aerosols 
SULAER 
TO~R 
xYLAER 
Oi~R . 
TERPAER 
TERP 

Counter species for H2S04 production 
Counter species for toluene reaction 
Couiiterspecies for xylene reaction 
COU!Jter species for cresol reaction 
Counter species for tcrpene reaction 
Monoterpenes 

SP!icies added for aqueous chemistry 
FACD 
AACD 
P~~D 
UMHP 

Formic acid 
Acetic and higer acids 
Pero~y acetic acid 
Upper limit ofmethylhydropcroxide 

,,•I 

Table 8A-2 

RADM2 Mechanism Species List 

OP! 
OP2 
PAA 

Organic acids 
ORAi 
ORA2 

Methyl hydrogen peroxide 
Higher organic peroxides 
Peroxyacetic acid 

Formic acid 
Acetic and higher acids 

Peroxv radicals from alkanes 
M02 
ETHP 
HC3P 
HCSP 
HC8P 

Methyl peroxy radical 
Peroxy radical formed from ETH 
Peroxy radical formed from HC3 
Peroxy radical formed from HCS 
Peroxy radical formed from HC8 

. Peroxy radicals from alkenes 
OL2P 
OL TP 
OLIP 

Peroxy radical formed from OL2P 
Peroxy radical formed from OL TP 
Peroxy radical formed from OLIP 

Peroxy radicals from aromatics 
TOLP 
XYLP 

Peroxy radical formed from TOL 
Peroxy radical formed from XYL 

Peroxy radicals with carbonyl groups 
AC03 
KETP 
TC03 

Acetylperoxy radical 
Peroxy radical formed from KET 
H(CO)CH=CHC03 

Nitrogen Species 
NO 
N02 
HONO 
N03 
N205 
HN03 
HN04 

Oxidants m(cid:173)

H202 

Sulfur Species 
S02 
SULF 

Atomic Species 
03P 
OID 

Nitric oxide 
Nitrogen dioxide 
Nitrous acid 
Nitrogen trioxide 
Nitrogen pentoxide 
Nitric acid 
Peroxynitric acid 

Ozone 
Hydrogen peroxide 

Sulfur.dioxide 
Sulfuric acid 

Oxygen atom (triplet) 
Oxygen atom (singlet) 

Odd Hydrogen Species 
HO 
H02 

Hydroxyl radical 
Hydroperoxy radical 

Carbon oxides 
co 

Carbon monoxide 

Alkanes 
ETH 
HC3 
HCS 
HC8 

Alken es 
OL2 
OLT 
OLI 
ISO 

Aromatics 
TOL 
XYL 
CSL 

Carbonyls 
HCHO 
ALO 
KET 
GLY 
MGLY 
DCB 

. 

Ethane 
Alkanes w/ 2.7xJ0·13 > kott < 3.4x10·12 
Alkanes w/ 3.4xJ0·12  > k0 "  < 6.8xto·12 
Alkanes w/ koH > 6.8xJ0·12 

Peroxy radicals involving nitrogen 
X02 
XN02 
OLN 

NO-to-N02 Operator 
NO-to-nitrate operator 
N03-alken adduct 

Species added for aerosols 
SULAER 
HCSAER 
OLIAER 
TOLAER 
XYLAER 
CSLAER 
TERP AER 
TERP 

Counter species for H2S04  production 
Counter species for HC8 reaction 
Counter species for OLI reaction 
Counter species for toluene reaction 
Counter species for xylene reaction 
Counter species for cresol reaction 
Counter species for terpene reaction 
Monoterpenes 

Ethene 
Terminal olefins 
Internal olefins 
Isoprene 

Toluene and less reactive aromatics 
Xylene and more reactive aromatics 
Cresol and other hydroxy substituted 
aromatics 

Formaldehyde 
Acetaldehyde and higher aldehydes · 
Ketones 
Glyoxal 
Methyl glyoxal 
Unsaturated dicarbonyl 

Organic nitrogen 
PAN 
TPAN 
ONIT 

Peroxyacetyl nitrate and higher PANs 
H(CO)CH=CHC03N02 
Organic nitrate 

Organic peroxides 

Table 8A-3.  CB4 Mechanism 

Reaction  List 
>----------------------------------------------------------------------< 
{  1}  N02 

+ 

0 

NO 
03 
N02 
NO 
N03 
N02 
N03 
0 
010 
0 
0 

2.000*0H 
H02 
OH 

0.890*N02 
2.000*N02 

NO 
N205 
2.000*HN03 

N03 
2.000*N02 
2.000*HONO 
HONO 
OH 
N02 
NO 
HN03 
N03 
OH 
PNA 
H02 
N02 
H202 
H202 

2 .. OOO*OH 

H02 
H02 
H02 
2.000*H02 
co 
OH 
HN03 
C203 
C203 
C203 
X02 
FORM 
N02 
H02 
PAN 
C203 
2.000*X02 
0.790*FORM 

+ 

+ 

+  0.790*0H 
X02 
0.870*X02 

+  0.110*AL02 

+  0.890*0 

+  O.llO*NO 

+ 

+ 

+ 

+ 

+ 

+ 

+ 
+ 

+ 
+ 
+ 

N02 

N02 

NO 

N02 

N02 

N02 

co 
co 

H02 
H02 
OH 

HN03 
+ 
+  2.000*H02 

+ 

X02 

+ 
+ 

+ 

+ 

co 
co 

co 

FORM 

N02 

+ 
+  2.000*FORM 
+  0.790*X02 

+  2.000*H02 
+  0.790*H02 

FORM 
+ 
+  0.130*X02N 
+  0.760*ROR 

H02 
+ 
+  0.110*H02 
- O.llO*PAR 

8-32 

<.... 

2)  0 

{  3}  03 

I :~ ~ 

{  6)  0 
( 
7}  03 
{  8)  03 
( 
9}  03 
(  10}  010 
{  11}  010 
f ~~l  ~~O 
{  14}  03 
(  15}  N03 
(  16)  N03 
(  17)  N03 
((  18}  N03 

+  hv 
+  [02] 
+  NO 
+  N02 
+  N02 
+  NO 
+  N02 
+  hv 
+  hv 
+  [N2] 
+  [02] 
+  [H20] 
+  OH 
+  H02 
+  hv 
+  NO 
+  N02 
+  N02 

19}  N205  +  [H20] 

+  [02] 
+  [H20] 

+  [H20] 

+  NO 
+  N02 
+  NO 
+  hv 
+  OH 
+  HONO 
+  N02 
+  HN03 
+  NO 
+  N02 

{  20}  N205 
{  21)  NO 
{  22}  NO 
{  23)  OH 
{  24}  HONO 
(  25}  HONO 
{  26)  HONO 
(  27)  OH 
(  28)  OH 
((  29}  H02 
30}  H02 
{  31)  PNA 
(  32)  PNA 
+  OH 
+  H02 
(  33}  H02 
+  H02 
{  34}  H02 
+  hv 
{  35}  H202 
+  OH 
{  36}  H202 
(  37)  co 
+  OH 
(  38}  FORM  +  OH 
{  39)  FORM  +  hv 
{  40}  FORM  +  hv 
(  41)  FORM 
+  0 
+  N03 
(  42}  FORM 
+  0 
{  43}  ALD2 
+  OH 
{  44}  ALD2 
{  45)  ALD2 
+  N03 
{  46)  ALD2  +  hv 

{  47}  C203  +  NO 

{  48)  C203  +  N02 
(  49}  PAN 
. {  so}  C203  +  C203 
(  51)  C203  +  H02 

52}  OH 
53}  PAR 

+  OH 

--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 

--> 

--> 
--> 
--> 
--> 

--> 
--> 

Table 8A-3.  CB4 Mechanism 

EPA/600!R-99/030 

1.100*ALD2  +  0.960*X02 

+  0.940*H02 
+  0.040*X02N  +  0.020*ROR 

- 2.100*PAR 
H02 
NTR 

0.630*ALD2  +  0.380*H02 

+  0.280*X02 

+  0.300*CO 
+  0.220*PAR 
FORM 

+ 

·  H02 

O.SOO*ALD2 
+  0.440*H02 
PAR 
0.910*X02 
ALD2 
FORM 

+ 

+  1.700*H02 
X02 

+  0.220*ALD2 
FORM 

0.080*X02 
+  O.S60*T02 
0.900*N02 
+  0.100*NTR 
CRES 
0.400*CRO 

+  0.300*0PEN 

CRO 
NTR 
0.700*H02 

{  S4}  ROR 

SS}  ROR 
S6}  ROR 
S7}  OLE 

+  N02 
+  0 

S8}  OLE 

+  OH 

S9}  OLE 

+  03 

60}  OLE 

+  N03 

61}  ETH 

+  0 

62}  ETH 

+  OH 

63}  ETH 
64}  TOL 

+  03 
+  OH 

6S}  T02 

+  NO 

66}  T02 
67}  CRES 

+  OH 

68}  CRES 
69}  CRO 
70}  XYL 

+  N03 
+  N02 
+  OH 

71}  OPEN 

+  OH 

72}  OPEN 
73}  OPEN 

+  hv 
+  03 

74}  MGLY 
7S}  MGLY 
76}  ISOP  +  0 

+  OH 
+  hv 

77}  ISOP  +  OH 

--> 

--> 
--> 
--> 

--> 

--> 

--> 

--> 

--> 

--> 
--> 

--> 

--> 
--> 

--> 
--> 
--> 

--> 

--> 
--> 

--> 
--> 
--> 

--> 

+  0.200*FORM  +  0.020*X02N 
+  0.200*0H 
+ 

X02 

+ 

ALD2 
J?AR 

+  0.740*FORM  +  0.330*CO 
+  0.220*X02 
+  0.100*0H 

+  o. 09o•:m2N  + 
+ 
+ 

PAR 
+  0.700*X02 
+  0.300*0H 
+  1.S60*FORM  + 

FORM 
N02 
co 

H02 

+  0.420*CO 
+  0.120*H02 
+  0.360*CRES  +  0.440*H02 

+  0.900*H02 

+  0.900*0PEN 

H02 
+ 
+  0.600*X02 

+ 

HN03 

+  0.600*H02 

+  0.200*CRES 
+  0.300*T02 
+  2.000*H02 

co 

+ 
+  0.700*FORM 
+  0.080*0H 

+  O.SOO*X02 
+  0.800*MGLY  +  1.100*PAR 

+ 

X02 
C203 
C203 

+  2.000*CO 
+ 
+ 

FORM 
H02 

0.030*ALD2  +  0.620*C203 

+  0.030*X02 
+  0.760*H02 
X02 
C203 

+  0.690*CO 
+  0.200*MGLY 
C203 
+ 
H02 
+ 

co 
+ 
+  0.2SO*X02 
+  0.2SO*PAR 
0.912*ISPD  +  0.629*FORM  +  0.991*X02 

0.7SO*ISPD  +  O.SOO*FORM 
+  0.2SO*C203 

+  0.2SO*H02 

78}  ISOP  +  03 

--> 

0.6SO*ISPD  +  0.600*FORM  +  0.200*X02 

+  0.912*H02 

+  0.088*X02N 

{  79}  ISOP  +  N03 

+  NO 
+  X02 

80}  X02 
81}  X02 
82}  X02N  +  NO 
+  OH 
83}  S02 
84}  S02 
8S}  X02 
+  H02 
86}  X02N  +  H02 
87}  X02N  +  X02N 
88}  X02N  +  X02 
89}  ISPD  +  OH 

--> 

--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 

+  0.066*H02 
+  0.1SO*ALD2 

+  0 .266.*0H 
+  0.3SO*PAR 
0.200*ISPD  +  0.800*NTR 
+  0.200*N02 

+  0.800*H02 
+  2.400*PAR 
N02 

+  0.200*C203 
+  0.066*CO 
X02 
+ 
+  0.800*ALD2 

NTR 
SULF 
SULF 

+ 

H02 

1.S6S*PAR 
+  O.S03*H02 
+  0.273*ALD2  +  0.498*C203 

+  0.167*FORM  +  0.713*X02 
+  0 .. 334*CO 

+  0.168*MGLY 

{  90}  ISPD  +  03 

--> 

0.114*C203 

+  0.1SO*FORM  +  0.8SO*MGLY 


Table 8A-3.  CB4 Mechanism 

+  0.154*H02 
+  0.020*ALD2  +  0.360*PAR 

+  0.268*0H 

91}  ISPD  +  N03 

92}  ISPD  +  hv 

{  93}  ISOP  +  N02 

+  0.064*X02 
+  o.225•co 

--> 

--> 

+  0.925*H02 
+  0.075*C203  +  0.075*X02 

0.357*ALD2  +  0.282*FORM  +  1.282*PAR 
+  o.850*NTR 
+  0.075*HN03 
+  0.067*ALD2  +  0.900*FORM 
+  1. 033*H02 

+  0.643*CO 

+  0.700*X02 

0.333*CO 

+  0.832*PAR 
+  0.967*C203 

--> 

0.200*ISPD  +  0.800*NTR 

+  0.800*H02 
+  2.400*PAR 

+  0.200*NO 

+ 
+  0.800*ALD2 

X02 

~----------------------------------------------------------------------< 

i. 

Rate  Constant 
Rate  Expression 
a"••···············•"ii:::it1::1zl:z=z====·=====:z==============::==============:::==========;::sm::=== 
{O.OOOOOE+OO} 
k(  1)  uses  photo  table  N02_CBIV88 
{1.37387E-14} 
~(  2)  is  a  falloff  expression  using: 

,  scaled  by  1.00000E+OO 

I 

kO 
kinf  • 
F  •  0.60, 

~.OOOOE-34  *  (T/300)**(-2.30) 
~,0000E-12  •  (T/3oo)••(  o.oo) 

n 

s 

1.00 

k(  3)  • 
k(  4)  • 
k( 

1.ilOooE-12  •  exp(  -1370.0/Tl 
9.3000E-12 

5)  is  a  falloff  expression  using: 

k(  6)  is  a  falloff  expression  using: 

kO 
kinf  • 
F  •  0.60, 

kO 
kinf  • 
F  •  0.60, 

9.0000E-32  *  (T/300)**(-2.00) 
2.lOOOE-11  • 
(T/300)**(  (l.00) 

n  =  1.00 

9.0000E-32  *  (T/300)**(-1.50) 
3.0000E-11  *  (T/300)**(  0.00) 

n  •  1.00 

7)  • 

1.2000E-13  *  exp(  -2450.0/T) 

9)  uses  photo  table  0301D_CBIV88 

k( 
k(  8)  uses  photo  table  N02_CBIV88 
k( 
k(  10)  • 
k(  11)  • 
k(  12) 
k(  13)  • 
k(  14)  • 
k(  15)  uses  photo  table  N02_CBIV88 
1.3000E-11  *  exp( 
250.0/T) 
k(  16)  • 
k(  17)  • 
2.5000E-14  *  exp(  -1230.0/Tl 
k(  18)  is  a  falloff  expression  using: 

1.SOOOE-11  *  exp( 
3.2000E-11  *  exp( 
2.2000E-10 
1.6000E-12  *  exp( 
1.4000E-14  *  exp( 

-940.0/T) 
-580.0/T) 

107.0/T) 
67.0/T) 

,  scaled  by  5.30000E-02 
,  scaled  by  1.00000E+OO 

,  scaled  by  3.39000E+Ol 

kO 
kinf  • 
F  •  0.60, 

2.2000E-30  *  (T/300)**(-4.30) 
1.5000E-12  *  (T/300)**(-0.50) 

n  =  1.00 

1.3000E-21 

k(  19)  • 
k(  20)  •  k(  18)  I  Keq,  where  Keq  =  2.700E-27  *  exp(  11000.0/T) 
k(  21)  • 
~<  22)  • 
k(  23)  is  a  falloff  expression  using: 

3.3000E-39  *  exp( 
~.~oobi~4o 

530.0/T) 

kO 
kinf  • 
F  •  0.60, 

6.7000E-31  *  (T/300)**(-3.30) 
3.0000E-11  *  (T/300)**(-1.00) 

n  =  1.00 

k(  24)  uses  photo  table  N02_CBIV88 
k(  25)  • 
k(  26)  • 
k(  27)  is  a  falloff  expression  using: 

6.6000E-12 
1.0000E-20 

2.60btiE-30  *  (T/300)**(-3.20) 
2.4000E-11  *  (T/300)**(-1.30) 

kO 
kinf  • 
F  • 

0.60, 

n  •  1.00 

8-34 

,  scaled  by  1.97500E-Ol 

{1.81419E~14} 
{9.30000E-12} 
{1.57527E-12} 

{1.66375E-12} 

{3.22581E-17} 
{o.oooooE+oo} 
{o.oooooE+oo} 
{2.57757E-11} 
{4.00676E-11} 
{2.20000E-10} 
{6.82650E-14} 
{1.99920E-15} 
{O.OOOOOE+OO} 
{3.00805E-11} 
{4.03072E-16} 
{1.26440E-12} 

{1.30000E-21} 
{4.36029E-02} 
{1.95397E-38} 
{4.39999E-40} 
{6.69701E-12} 

{O.OOOOOE+OO} 
{6.60000E-12} 
{1.00000E-20} 
{1.14885E-11} 

Table 8A-3.  CB4 Mechanism 

EPA/600/R-991030 

k(  28)  is  a  special  rate  expression  of  the  form: 

(1  +  k3[M]/k2)},  where 

7.2000E-15  *  exp( 

k  = kO  +  {k3[M]  I 
ko 
785.0/T) 
k2  =  4.1000E-16  *  exp(  1440.0/Tl 
k3  =  1.9000E-33  *  exp( 
725.0/T) 
3.7000E-12  *exp( 

k(  29) 
240.0/T) 
k(  30)  is  a  falloff  expression  using: 

kO 
2.3000E-31  *  (T/300)**(-4.60) 
kinf  =  4.2000E-12  *  (T/300)**(  0.20) 
F  =  0.60, 

n  =  1.00 

k(  30)  I  Keq,  where  Keq  =  2.100E-27  *  exp(  10900.0/T) 
380.0/T) 
1.3000E-12  *  exp( 
5.9000E-14  *  exp(  1150.0/T) 
2.2000E-38  *  exp(  5800.0/T) 

uses  photo  table  HCHOmol_CBIV88.,  scaled  by  2.55000E-Ol 

3 .1000E-12  *  exp ( 
1.5000E-13  *  (1.0  +  0.6*Pressure) 
1. OOOOE-11 

-18·7. O/T) 

uses  photo  table  HCHOrad_CBIV88 
uses  photo  table  HCHOmol_CBIV88 
3.0000E-11  *exp(  -1550.0/T) 
6.3000E-16 
1.2000E-11  *  exp( 
7.0000E-12  *  exp( 
2.5000E-15 

-986.0/T) 
250. O/T) 

uses  photo  table  ALD_CBIV88 

,  scaled  by  l.OOOOOE+OO 
,  scaled  by  1.00000E+OO 

,  scaled  by  1.00000E+OO 

{1.47236E-13} 

{8.27883E-12} 
{1.48014E-12} 

{9.17943E-02} 
{4.65309E-12} 
{2.79783E-12} 
{6.23927E-30} 
{0.00000E+OO} 
{1.65514E-12} 
{2.40000E-13} 
{1. OOOOOE-11} 
{O.OOOOOE+OO} 
{O.OOOOOE+OO} 
{1.65275E-13} 
{6.30000E-16} 
{4.38753E-13} 
{1.61972E-11} 
{2.50000E-15} 
{O.OOOOO!l:+OO} 
{1.90766E-11} 
{9.41356E-12} 
{4.23268E-04} 
{2.50000E-12} 
{6.50000E-12} 
{3.54242E-01} 
{8.10000E-13} 
· {2 .19325E+03} 
{ 1. 60000E+03} 
{1.50000E-11} 
{4.04572E-12} 
{2.82173E-11} 
{1.19778E-17} 
{7;70000E-15} 
{7.01080E-13} 
{7.94340E-12} 
{1. 89105E-18} 
{6.18715E-12} 
{8.10000E-12} 
{4.20000E+OO} 
{ 4 .10000E-11}. 
{2.20000E-11} 
{1.40000E-11} 
{2.50901E-11} 
{3.00000E-11} 
{O.OOOOOE+OO} 
{1.00858E-17} 
{1.70000E-11} 
{O.OOOOOE+OO} 
{3.60000E-11} 
{9.97368E-11} 
{1.28512E-:l7} 
{6.73819E-13} 
{8.10000E-12} 
{l.33359E-12} 

k(  31) 
k(  32) 
k(  33) 
k(  34) 
k(  35) 
k(  36) 
k(  37) 
k(  38) 
k(  39) 
k(  40) 
k(  41) 
k(  42) 
k(  43) 
k(  44) 
k(  45) 
k(  46) 
k(  47) 
k(  48) 
k(  49) 
k(  SO) 
k(  51) 
k(  52) 
k(  53) 
k(  54) 
k(  55) 
k(  56) 
k(  57) 
k(  58) 
k(  59) 
k(  60) 
k(  61) 
k(  62) 
k(  63) 
k(  64) 
k(  65) 
k(  66) 
k(  67) 
k(  68) 
k  (  69) 
k(  70) 
k(  71) 
k(  72) 
k(  73) 
k(  74) 
k( 
k( 
k( 
k( 
k( 
k( 
k( 

-180.0/T) 
3.4900E-11  *exp( 
380.0/T) 
2.6300E-12  *exp( 
2.0000E+16  *  exp(-13500.0/T) 
2.SOOOE-12 
6.5000E-12 
1.1000E+02  *  exp(  -1710.0/T) 
8.1000E-13 
1.0000E+15  *  exp(  -8000.0/T) 
1.6000E+03 
1.5000E-11 
1.2000E-11  *  exp( 
5.2000E-12  *  exp( 
1.4000E-14  *  exi;>( 
7.7000E-15 
l.OOOOE-11 
2.0000E-12 
1.3000E-14 
2.1000E-12 
8.1000E-12 
4.2000E+OO 
4.1000E-11 
2.2000E-11 
1.4000E-11 
1.7000E-11  *  exp( 
3.0000E-11 

-792.0/T) 
411. O/T) 
-2633.0/T) 
322.0/T) 

-324. O/T) 
504.0/T) 
-2105.0/T) 

*·exp( 
*  exp( 
*  exp( 
*  exp( 

116. O/T) 

c 

c 

uses  photo  table  HCHOrad_CBIV88 
-500.0/T) 

5.4000E-17  *  exp( 
1.7000E-11 

3.6000E-11 
2.5400E-11  *exp( 

75)-uses  photo  table  HCHOrad_CBIV88 
76) 
77) 
407.6/T) 
78)  =  7.8600E-15  *  exp(  -1912.0/T) 
79) 
-448.0/T) 
80) 
81) 

3.0300E-12  *  exp( 
8.1000E-12 
1. 7000E-14  *  exp (  1300. O/T) 

,  scaled  by  9.04000E+oo. 

,  scaled  by  9.64000E+OO 


Table 8A-3.  CB4 Mechanism 

160.0/T) 

8.lOOOE-12 
4.3900E-13  *  exp( 
1.3600E-06 
7.6700E-14  *  exp(  1300.0/Tl 
7.6700E-14  *  exp(  1300.0/T) 
1.7300E-14  *  exp(  1300.0/T) 
3.4SOOE-14  *exp(  1300.0/T) 
3.3606!;;-11 
7.llOOE-18 
1.ooooE-15 

{8.lOOOOE-12} 
k(  82)  • 
{7.51005E-13} 
k(  83)  • 
{1.36000E-06} 
k(  84)  • 
{6.01684E-12} 
k(  85)  • 
{6.01684E-12} 
k(  86)  • 
{1.35712E-12} 
k(  87)  • 
{2.70640E-12} 
k(  88)  • 
k(  89)  • 
{3.36000E-11} 
{7.llOOOE-18} 
k(  90)  • 
{1.oooooE-15} 
~(  91)  • 
k(  92)  uses  photo  table  ACROLEIN 
{o.oooooE:+oo} 
{1.49000E;19} 
k(  93)  • 
········--···==•=2========~================================================~=== 

1.4900E-19 

,  scaled  by  3.60000E-03 

'111111 

Table 8A-4.  CB4  AE Mechanism 

EP A/600/R-99/030 

l}  N02 

+ 
+ 

+ 
+ 
+ 

2.000*0H 
H02 
H02 
H02 
2.000*H02 
co 
OH 
HN03 
C203 
C203 
C203 
X02 
FORM 
N02 
H02 
PAN 
C203 
2.000*X02 
0.790*FORM 

+ 

+ 

+  0.790*0H 
X02 
0.870*X02 

+  O.l.10*ALD2 
1.100*ALD2 
- 2.l.OO*PAR 

8-37 

+ 

0 

[H20] 

[H20] 

+  0.890*0 

+  O.llO*NO 

NO 
N205 
2.000*HN03 

NO 
03 
N02 
NO 
N03 
N02 
N03 
0 
OlD 
0 
0 

2.000*0H 
H02 
OH 

0.890*N02 
2.000*N02 

+  hv 
+  [02] 
+  NO 
+  N02 
+  N02 
+  NO 
+  N02 
+  hv 
+  hv 
[N2] 
+ 
+  [02] 
+ 
+  OH 
+  H02 
+  hv 
+  NO 
+  N02 
+  N02 
+ 

Reaction  List 
>----------------------------------------------------------------------------------< 
{ 
{  2}  0 
{  3}  03 
{  4}  0 
s}  0 
{ 
{ 
6}  0 
{ 
7}  03 
{  8}  03 
{ 
9}  03 
{  10}  OlD 
{  11}  OlD 
{  12}  OlD 
{  13}  03 
{  14}  03 
{  15}  N03 
{  16}  N03 
{  17}  N03 
{  18}  N03 
{  19}  N205 
{  20}  N205 
{  21}  NO 
{  22}  NO 
{  23}  OH 
{  24}  HONO 
{  25}  HONO 
{  26}  HONO 
{  27}  OH 
{  28}  OH 
{  29}  H02 
{  30}  H02 
{  31}  PNA 
{  32}  PNA 
{  33}  H02 
{  34}  H02 
{  35}  H202 
{  36}  H202 
{  37}  co 
{  38}  FORM 
{  39}  FORM 
{  40}  FORM 
{  41}  FORM 
{  42}  FORM 
{  43}  ALD2 
{  44}  ALD2 
{  45}  ALD2 
{  46}  ALD2 

--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 

N03 
2.000*N02 
2.000*HONO 
HONO 
OH 
N02 
NO 
HN03 
N03 
OH. 
PNA 
H02 
N02 
H202 
H202 

+  OH 
+  H02 
+  H02 
+  hv 
+  OH 
+  OH 
+  OH 
+  hv 
+  hv 
+  0 
+  N03 
+  0 
+  OH 
+  N03 
+  hv 

+  NO 
+  N02 
+  NO 
+  hv 
+  OH 
+  HONO 
+  N02 
+  HN03 
+  NO 
+  N02 

HN03 
+ 
+  2.000*H02 

+  [02] 
[H20] 
+ 

+ 

+ 

+ 

+ 

+ 

+ 

co 
co 

H02 
H02 
OH 

NO 

N02 

N02 

N02 

co 
co 

co 

N02 

N02 

+ 
+ 

+ 

+  [H20] 

47}  C203 

+  NO 

48}  C203 
49}  PAN 
so}  C203 
51}  C203 

52}  OH 
53}  PAR 

54}  ROR 

+  N02 

+  C203 
+  H02 

+  OH 

--> 

--> 
--> 
--> 
--> 

--> 
--> 

--> 

+ 

X02 

+ 

FORM 

N02 

+ 
+  2.000*FORM 
+  0.790*X02 

FORM 
+ 
+  O.l.30*X02N 
+  0.760*ROR 
+  0.960*X02 
+  0.040*X02N 

+  2.000*H02 
+  0.790*H02 

H02 
+ 
+  O.ll.O*H02 
- O.ll.O*PAR 
+  0.940*H02 
+  0.020*ROR 

Table 8A-4.  CB4_AE Mechanism 

,,1,1, 

{  ss}  ROR 
{  56}  ROR 
{  57}  OLE 

{  SB}  OLE 

59}  OLE 

+  N02 
+  0 

+  OH 

+  03 

60}  OLE 

+  N03 

{  Gl}  ETH 

+  0 

62}  ETH 

63}  ETH 
64}  TOL 

65}  T02 

{  66}  T02 
{  67}  CRES 

68}  CRES 
69}  CRO 
70}  XYL 

+  OH 

+  03 
+  OH 

+  NO 

+  OH 

+  N03 
+  N02 
+  OH 

71}  OPEN 

+  OH 

72}  OPEN 
73}  OPEN 

+  hv 
+  03 

74}  MGLY 
75}  MGLY 
76}  ISOP 

+  OH 
+  hv 
+  0 

77}  ISOP 

+  OH 

{  78}  ISOP 

+  03 

79}  ISOP 

+  N03 

{  80}  X02 
'{  81}  X02 
' {  82}  X02N 
{  83}  S02 
{  84}  S02 
{  es}  xo2 
(  86}  X02N 
{  87}  X02N 
{  88}  X02N 
{  89}  ISPD 

+  NO 
+  X02 
+  NO 
+  OH 

+  H02 
+  H02 
+  X02N 
+  X02 
+  OH 

(  90}  ISPD 

I 

11, 

+  03 

--> 
--> 
--> 

--> 

--> 

--> 

--> 

--> 

--> 
--> 

--> 

--> 
--> 

--> 
--> 
--> 

H02 
NTR 

0.630*ALD2 

+  0.300*CO 
+  0.220*PAR 
FORM 
H02 

+ 

O.SOO*ALD2 
+  0.440*H02 
PAR 
0.910*X02 
ALD2 
FORM 
+  1. 700*H02 
X02 

+ 

+  0.220*ALD2 
FORM 
0.080*X02 
+  0.560*T02 
0.900*N02 
+  O.lOO*NTR 
CRES 
0.400*CRO 

+  0.300*0PEN 

CRO 
NTR 
0.700*H02 
+  O.SOO*MGLY 
+ 

XYLAER 
X02 
C203 
C203 
0.030*ALD2 

+ 

--> 

--> 
--> 

+  0.030*X02 
+  0.760*H02 
X02 
C203 
0.7SO*ISPD 

+  0.2SO*H02 

--> 
--> 
--> 

--> 

0.912*ISPD 

+  0.380*H02 
+  0.200*FORM 
+  0.200*0H 
+ 

ALD2 
PAR 

+  0.740*FORM 
+  0.220*X02 

+  0.090*X02N 

PAR 
+  0.700*X02 
+  0.300*0H 
+  1.560*FORM 

+  0.420*CO 
+  0.360*CRES 
+ 
+  0.900*H02 

TOLAER 

H02 
+ 
+  0.600*X02 
+ 
+ 

CSLAER 
HNOJ 

+  0.280*X02 
+  0.020*X02N 

' 

+ 

X02 

+  0.3JO*CO 
+  O.lOO*OH 

+ 
+ 
+ 

+ 

FORM 
N02 
co 

H02 

+  0.120*H02 
+  0.440*H02 

.j.  0.900*0PEN 

+  0.600*H02 

+ 

CSLAER 

+  O.SOO*X02 
+  1.100*PAR 

+  0.200*CRES 
+  0.300*T02 

FORM 
H02 

+  2.000*CO 
+ 
+ 
+  0.620*C203 
+  0.690*CO 
+  0.200*MGLY 
C203 
+ 
+ 
H02 
+  O.SOO*FORM 
+  0.2SO*C203 
+  0.629*FORM 
+  0.088*X02N 
+  0.600*FORM 
+  0.266*0H 
+  0.3SO*PAR 
+  O.SOO*NTR 
+  0.200*N02 

+  2.000*H02 

co 

+ 
+  0.700*FORM 
+  O.OSO*OH 

co 
+ 
+  0.2SO*X02 
+  0.2SO*PAR 
+  0.991*X02 

+  0,200*X02 
+  0.20!J*C203 
+  0.066*CO 
+ 
X02 
+  0.800*ALD2 

+  0.912*H02 

0.6SO*ISPD 

+  0.066*H02 
+  0.1SO*ALD2 
0.200*ISPD 

+  0.800*H02 
+  2.400*PAR 
N02 

--> 

--> 

--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 

--> 

NTR 
SULF 
SULF 

+ 
+ 

H02 
SULAER 

+ 

SULAER 

1.565*PAR 
+  0.503*H02 
+  0.273*ALD2 
0.114*C203 

+  0.154*H02 

+  0.167*FORM 
+  0.334*CO 
+  0.498*C203 
.+  O. lSO*FORM 
+  0.268*0H 

+  0.713*X02 
+  0.168*MGLY 

+  0. SSO*MGLY 
+  0.064*X02 
+  0.360*PAR 
+  0.282*FORM 
+  0.643*CO 
+  0.075*X02 
+  0.067*ALD2 
+  1.033*H02 

+  0.225*CO 
+  1.282*PAR 
+  0.850*NTR 
+  0.075*HN03 
+  0.900*FORM 
+  0.700*X02 

+  0.800*NTR 
+  0.200*NO 

+ 
+  0.800*ALD2 

X02 

--> 

+  0.020*ALD2 
0.357*ALD2 

+  0.925*H02 
+  0.075*C203 

--> 

0.333*CO 

+  0.832*PAR 
+  0. 967*C203 
0.200*ISPD 

+  o.8oo*Ho2 
+  2.400*PAR 

Table 8A-4.  CB4  AE Mechanism 

91}  ISPD 

+  N03 

92}  ISPD 

+  hv 

" 

94}  TERP 
95}  TERP 
96}  TERP 

+  OH 
+  N03 
+  03 

93}  ISOP 

+  N02 

--> 

>------------------------------·----------------------------------------------------< 

--> 
--> 
--> 

TERPAER  + 
TERPAER  + 
TERPAER  + 

OH 
N03 
03 

Rate  Expression 

Rate  Constant 

==============aa============m=========================================a======~a 

,  scaled  by  1.00000E+OO 

{O.OOOOOE+oo} 
{1.37387E-14} 

{l.81419E-14} 
{9.30000E-12} 
{1.575211\:-12} 

{1.66375E-12} 

{3.22581E-17} 
{O.OOOOOE+OO} 
{o.oooooE+oo} 
{2.57757E-11} 
{4.00676E-11} 
{2.20000E-10} 
{6.82650E-14} 
{1.99920E-15} 
{O.OOOOOE+OO} 
{3.00805E-ll} 
{4.03072E-16} 
{1.26440E-12} 

{l.30000E-21} 
{4.36029E-08} 
{1.95397E-38} 
{4.39999E-40} 
{6.69701E-12} 

{O.OOOOOE+OO} 
{6.60000E-12} 
{l.OOOOOE-20} 
{l.14885E-11} 

k(  1)  uses  photo  table  N02_CBIV88 
k(  2)  is  a  falloff  expression  using: 

=  6.0000E-34  *  (T/300)**(-2.30) 
kO 
kinf  =  2.8000E-12  *  (T/300)**(  0.00) 
F  =  0.60, 
. 

n  =  1.00 

k(  3)  =  1.8000E-12  *  exp(  -1370.0/T) 
k(  4)  =  9.3000E-12 
k( 

5)  is  a  falloff  expression  using: 

=  9.0000E-32  *  (T/300)**(-2.00) 
kO 
kinf  =  2.2000E-11  *  (T/300)**(  0.00) 
F  =  0.60, 

n  =  1.00 

k( 

6)  is  a  falloff  expression  using: 

n  =  1.00 

=  9.0000E-3~  ~  (T/300)**(-1.50) 
kO 
kinf  =  3.0000E-11  *  (T/300)**(  0.00) 
F  =  0.60, 
7)  =  1.2000E-13  *  exp(  -2450.0/T) 
8)  uses  photo  table  N02_CBIV88 

k( 
k( 
k(  9)  uses  photo  table  03010  CBIV88 
k(  10)  =  l.8000E-ll  *  exp( 
k(  11)  =  3.2000E-11  *  exp( 
k(  12)  =  2.2000E-10 
. 
k(  13)  =  l.6000E-12  *  exp( 
k(  14) 
l.4oooE-14  *  exp( 
k(  15)  uses  photo  table  N02  CBIV88 
k(  16)  =  l.3000E-11  *  exp(-
250.0/T) 
k(  17)  =  2.5000E~l4  *  exp(  -1230.0/T) 
k(  18)  is  a  falloff  expression  using: 

-940.0/T) 
-580.0/Tl  · 

-107.0/T) 
67.0/T) 

c 

=  2.2000E-30  *  (T/300)**(-4.30) 
kO 
kinf  =  l.5000E-12  *  (T/300)**(-0.50) 
F  =  0.60, 

1.00 

n 

c 

,  scaled  by  5.30000E-02 
,  scaled  by  l.OOOOOE+OO 

,  scaled  by·3.39000E+Ol 

k(  19)  =  l.3000E-21 
k(  20)  = k(  18)  I  Keq,  where  Keq  =  2.700E-21  *  exp(  11000.0/T) 
k(  21)  =  3.3000E-39  *  exp( 
k(  22)  =  4.4000E-40 
k(  23)  is  a  falloff  expression  using: 

530.0/T) 

=  6.7000E-31  *  (T/300)**(-3.30) 
kO 
kinf  =  3.0000E-11  *  (T/300)**(-1.00) 
F  =  0.60,.  n  =  1.00 

k(  24)  us.es  photo  table  N02_CBIVB8 
k(  25)  =  6.6000E-12 
k(  26)  =  l.OOOOE~20 
k(  27)  is  a  falloff  expression  using: 

kO 

=  2.6000E-30  *  (T/300)**(-3.20) 

,  scaled  by  l.97500E-Ol 

Table 8A-4.  CB4  AE Mechanism 

I 

kinf  =  2.4000E~ll  *  (T/3p0l**(-l,30) 
F  =  0.60, 

n  =  1.00 

i 

k(  28)  is  a  special  rate  expression  of  the  form: 

k  =  kO  +  {k3 [Ml  ,I  (1  +  k3 (Ml  /k2)}.  where 
kO  =  7.2000E-1S  *  exp( 
78S.O/T) 
k2  =  4.lOOOE-lG  *exp(  1440,0/Tl 
k3  =  1.9000E-3J  *  exp( 
72S.O/Tl 
k(  29)  =  3.7000E-12  *exp( 
240.0/T) 
k(  30)  is  a  falloff  expression  using: 

=  2.3000E~31 *  (T/~,,00)**(-4.60) 
kO 
kinf  =  4.2000E~l2  *  (T/300)**(  0.20) 
F  =  0.60, 

n  =  1.00 

,  scal'ed  by  2.SSOOOE-01 

-986.0/T) 
2SO.O/T) 

,  scaled  by  l.OOOOOE+OO 

l.1000E+02  *  exp(  -1710.0/T) 

l.SOOOE-13  *  (1.0  +  0.6*Pressure) 

l.OOOOE+lS  *  exp(  -8000.0/T) 

,  scaled  by  l.OOOOOE+OO 
,  scaled  by  l.OOOOOE+OO 

k(  31)  = k(  30)  I  Keq,  where  Keq  =  2.lOOE-27  *  exp(  10900.0/T) 
k(  32)  = 
380.0/T) 
l.3000E-12  *  exp( 
k(  33)  =  S.9000E-14  *  exp( 
llSO.O/T) 
k(  34)  =  2.2000E-38  *  exp(  SBOO.O/T) 
k(  3S)  uses  photo  table  HCHOmol_CBIVBB 
k(  36)  =  3.lOOOE-12  *  exp( 
-187.0/T) 
k(  37)  = 
k(  38)  =  l.OOOOE-11 
k(  39)  uses  photo  table  HCHOrad_CBIVBB 
k(  40)  uses  photo  table  HCHOmol_CBIVBB 
k(  41)  =  3.0000E-11  *exp(  -lSSO.O/T) 
k(  42)  =  6.3000E-16 
k(  43)  =  1.2000E-11  *exp( 
k(  44)  =  7.0000E-12  *  exp( 
k(  4S)  =  2.SOOOE-lS 
k(  46)  uses  photo  table  ALD_CBIVBB 
k(  47)  =  3.4900E-ll  *  exp( 
-180.0/T) 
k(  48)  =  2.6300E-12  *  exp( 
380.0/T) 
k(  49)  =  2.0000E+l6  *  exp(-13SOO.O/Tl 
k(  SO)  =  2.SOOOE-12 
k(  Sl)  =  6.SOOOE-12 
k(  S2)  = 
k(  S3)  =  B.lOOOE-13 
k(  S4)  = 
k(  SS)  =  l.6000E+03 
k(  S6)  =  l.SOOOE-11 
k(  S7)  =  l.2000E-ll  *  exp( 
k(  SB)  =  S.2000E-12  *  exp( 
k(  S9)  = 
l.4000E-14  *  exp( 
k(  60)  =  7.7000E-1S 
k(  61)  = 
l.OOOOE-11  *  exp( 
k(  62)  =  2.0000E-12  *  exp( 
k(  63)  = 
l.3000E-14  *  exp( 
k(  64)  =  2.lOOOE-12  *  exp( 
k(  65)  =  B.lOOOE-12 
k(  66)  =  4.2000E+OO 
k(  67)  =  4.lOOOE-11 
k(  68)  =  2.2000E-ll 
k(  69)  =  l.4000E-ll 
k(  70)  = 
k(  71)  =  3.0000E-11 
k(  72)  uses  photo  table  HCHOrad_CBIVBB 
k(  73)  =  5.4000E-17  *  exp( 
-500.0/T) 
k(  74)  =  1.7000E-11 
k(  75)  uses  photo  table  HCHOrad_CBIVBB 
k(  76)  =  3.6000E-11 
k(  77)  =  2.5400E-11  *  exp( 
407.6/T) 
k(  78)  =  7.8600E-1S  *  exp(  -1912.0/Tl 
k(  79)  =  3.0300E-12  *exp( 
-448.0/T) 

-792.0/T) 
411. O/T) 
-2633.0/T) 
322.0/T) 

-324.0/T) 
504.0/Tl 
-2105.0/T) 

l.7000E-11  *  exp( 

116. O/T) 

,  scaled  by  9.04000E+OO 

,  scaled  by  9.64000E+OO 

{1.47236E-l.3} 

'II 

{B.27883E-l.2} 
{l..480l.4E-l.2} 

{9.l.7943E-02} 
{4.6S309E-12} 
{2. 79783E-12} 
{6.23927E-30} 
{O.OOOOOE+OO} 
{l.6SS14E-12} 
{2.40000E-13} 
{l..OOOOOE-11} 
{O.OOOOOE+oo} 
{O.OOOOOE+oo} 
{l.6S27SE-13} 
{6.30000E-16} 
{4.387S3E-13} 
{1.61972E-ll.} 
{2.SOOOOE-15} 
{O.OOOOOE+OO} 
{l.90766E-l.l} 
{9.4l.3S6E-12} 
{4.23268E-04} 
{2.SOOOOE-12} 
{6.SOOOOE-12} 
{3. S4242E-,Ol} 
{B.lOOOOE-13} 
{2.19325E+03} 
{ 1. 60000E+03} 
{l.SOOOOE-11} 
{ 4. 04S72E-12} 
{2.82173E-ll} 
{l.1977BB-17} 
{7.70000E-l.S} 
{7.0lOBOB-13} 
{7.94340E-l.2} 
{l.8910SE-l.8} 
{6.l.871SE-l.2} 
{B.lOOOOE-12} 
{4.20000E+OO} 
{4.lOOOOE-11} 
{2.20000E-ll} 
{l.40000E-ll} 
{2.S0901E-ll} 
{3.00000E-11} 
{O.OOOOOE+oo} 
{l.OOBSBE-17} 
{l..70000E-l.l} 
{O.OOOOOE+OO} 
{3.60000E-ll} 
{9.97368E-ll.} 
{1.28Sl2E-17} 
{6.73819E-13} 

,, 

' 

1

Table 8A-4.  CB4  AE Mechanism 

EPA/600/R-99/030 

l..3600E-06 

l.60.0/T) 

l..7000E-l.4  *exp(  1300. O/T) 

k(  80)  =  8.l.OOOE-l.2 
k  (  Bl.)  = 
k(  82)  =  8.l.OOOE-l.2 
k(  83)  =  4.3900E-l.3  *  exp( 
k(  84)  = 
k(  85)  =  7.6700E-l.4  *exp(  1300. O/T) 
k(  86)  =  7.6700E-l.4  *  exp( 
l.300.0/T) 
k(  87)  = 
l..7300E-l.4  *  exp(  1300.0/T) 
k(  88)  =  3.4500E-l.4  *  exp(  1300. 0/T) 
k(  89)  =  3  .3600E-l.l. 
k(  90)  =  7.l.l.OOE-l.8 
k(  9l.)  = 
l.. OOOOE-l.5 
k(  92)  uses  photo  table  ACROLEIN 
k(  93)  = 
l..4900E-l.9 
l..0700E-l.l.  *  exp( 
k(  94)  = 
549. O/T) 
k(  95)  =  3. 2300E-l.l.  *  exp ( 
-975.0/T) 
k(  96)  =  7.2900E-l.5  *  exp(  -l.136.0/T) 

{8.l.OOOOE-12} 
{l..33359E-l.2} 
{8.l.OOOOE-l.2} 
{7.5l.005E-l.3} 
{l..36000E-06} 
{6.0l.684E-l.2} 
{6.0l.684E-l.2} 
{l..357l.2E-l.2} 
{2.70640E-l.2} 
{3.36000E-l.l.} 
{7.l.l.OOOE-l.8} 
{l.OOOOOE-15} 
{0.00000E+OO} 
{l..49000E-l.9} 
{6.75269E-l.l.} 
{l..22539E-l.2} 
{l..6ll.25E-l.6} 

,  scaled  by  3.60000E-03 

8-41 

,''II' 

,:,1' 

,,'111, 

1
" 

1111!!

EP A/600/R-99/030 

Table 8A-5.  CB4_AQ Mechanism 

[H20] 

+ 

+ 

l}  N02 

--> 

,, 

1 

+ 

0 

--> 

--> 

+  0.890*0 

+  0.110*NO 

0.890*N02 
2.000*N02 

2 .. 000*0H 
H02 
OH 

NO 
N205 
2.000*HN03 

NO 
03 
N02 
NO 
N03 
N02 
N03 
0 
010 
0 
0 

+  hv 
+  [02] 
+  NO 
+  N02
+  N02, 
+  NO 
+  N02 
+  hv  I 
+  hv  I 
[N2] 
+ 
+  [02] 
[H29] 
+ 
+  OH 
+  H02 
+  hv  , 
+  NO 
, 
+  N02, 
+  N02 

--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
+  [02] 
+  [H20]  --> 
--> 

Reaction  List 
>----------------------------------------------------------------------< 
{ 
{  2}  o· 
{  3}  03 
{  4}  0 
{  5}  o 
{  6}  0 
{  7}  03 
{ 
0}  03 
{  9}  03 
{  10}  010 
{  11}  010 
{  12}  010 
{  13}  03 
{  14}  03 
{  15}  N03 
{  16}  N03 
{  17}  N03 
{  18}  N03 
{  19}  N205  + 
{  20}  N205 
+  NO 
{  21}  NO 
+  N02 
{  22}  NO 
+  NO 
{  23}  OH 
{  24}  HONO  +  hv 
{  25}  HONO  +  OH 
{  26}  HONO  +  HONp 
{  27}  OH 
{  28}  OH 
{  29}  H02 
{  30}  H02 
{  31}  PNA 
+  OH 
{  32}  PNA 
+  H02 
{  33}  H02 
+  H02 
{  34}  H02 
{  35}  H202  +  hV  I 
{  36}  H202  +OH, 
{  3 7}  co 
+OH  I 
{  38}  FORM  +  OH 
{  39}  FORM  +  hV  I 
{  40}  FORM  +  hv, 
{  41}  FORM  +  0 
{  42}  FORM  +  N03 
{  43}  AL02  +  0 
I 
{  44}  AL02  +OH, 
+  N03 
{  45}  ALD2 
{  46}  AL02  +  hV  I 

--> 
--> 
+  [H20]  --> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 

N03 
2.000*N02 
2.000*HONO 
HONO 
OH 
N02 
NO 
HN03 
NOJ 
OH 
PNA 
H02 
N02 
H202 
H202 

+  N02 
+  HN03 
+  NO 
+  N02 

HN03 
+  2.000*H02 

--> 
--> 

--> 
--> 

--> 
--> 
--> 

+ 

+ 

+ 

+ 

H02 
H02 
OH 

N02 

N02 

NO 

N02 

N02 

N02 

--> 

--> 

co 
co 

co 

+ 
+ 

+ 

co 
co 

+ 
+ 

2. OOO*OH· 
H02 
H02 
H02 
2.000*H02 
co 
OH 
+ 
HN03 
+ 
C203  + 
C203 
C203  + 
X02 
FORM 
N02 
H02 
PAN 
C203  + 

+ 

·--> 

--> 

+ 

+ 

47}  C203  +NO.: 

,, 

48}  C203  +  N02. 
49}  PAN 
so}  c203  +  C203 
51}  C203  +  H02 

52}  OH 
53}  PAR 

+OH, 

--> 

--> 

--> 
--> 
--> 
--> 

--> 

X02 

+ 

FORM 

N02 

2.000*X02 
0.790*FORM  +  0.790*X02 

+  2.000*FORM  +  2.000*H02 
+  0.790*H02 

+  0.790*0H 
X02 
0.870*X02 

+  0-.110*AL02 

+  0.210*PACO 
H02 
+ 
+  0.130*X02N  +  0.110*H02 
·+  0. 760*ROR 
- 0.110*PAR 

FORM  + 

Table 8A-5.  CB4_AQ Mechanism 

EPA/600/R-99/030 

S4}  ROR 

SS}  ROR 
S6}  ROR 
S7}  OLE 

+  N02 
+  0 

SS}  OLE 

+  OH 

59}  OLE 

+  03 

60}  OLE 

+  N03 

61.}  ETH 

+  0 

62}  ETH 

+  OH 

63}  ETH 

+  03 

64)  TOL 

+  OH 

6S}  T02 

+  NO 

66}  T02 
67}  CRES 

+  OH 

68}  CRES 
69}  CRO 
70}  XYL 

+  N03 
+  N02 
+  OH 

71}  OPEN 

+  OH 

72}  OPEN  +  hv 
73}  OPEN  +  03 

74}  MGLY  +  OH 
+  hv 
7S}  MGLY 
76}  ISOP  +  0 

77}  ISOP  +  OH 

78}  ISOP  +  03 

{  79}  ISOP  +  N03 

+  NO 
+  X02 

so}  xo2 
81.}  X02 
82}  X02N  +  NO 
+  OH 
83}  S02 
84}  $02 
+  H02 
as}  xo2 
86}  X02N  +  H02 
87}  X02N  +  X02N 
88}  X02N  +  X02 
89}  ISPD  +  OH 

--> 

--> 
--> 
--> 

--> 

--> 

--> 

--> 

--> 

--> 

--> 

--> 

--> 
--> 

--> 
--> 
--> 

--> 

--> 
--> 

--> 
--> 
--> 

--> 

--> 

--> 

--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 

l..l.OO*ALD2 
- 2.l.OO*PAR 
H02 
~TR 

+  0 .960*X02 
+  0.940*H02 
+  0.040*X02N.  +  0.020*ROR 

0.630*ALD2  +  0.380*H02 

+  0.280*X02 

+  0.300*CO 
+  0.220*PAR 

+ 

+  0.200*FORM  +  0.020*X02N 
+  0.200*0H 
FORM  + 
-
H02 
+  0.740*FORM  +  0.330*CO 
+  0.220*X02 
+  O.l.OO*OH 

ALD2 
PAR 

X02 

+ 

O.SOO*ALD2 
+  0.440*H02 
+  0.200*FACD  +  0.200*AACD  -
+  0.090*X02N  + 
-
PAR. 
+ 
+  0.700*X02 
+ 
+  0.300*0H 
+  l..S60*FORM  + 

0.9l.O*X02 
ALD2 
FORM 

+  l.. 700*H02 
X02 

+ 

PAR 
FORM 
N02 
co 

H02 

+  0.420*CO 

+  0.120*H02 

+  0.360*CRES  +  0.440*H02 

+  0.900*H02 

+  0.900*0PEN 

+  0.220*ALD2 
FORM 
+  0.400*FACD 

O.OSO*X02 
+  O.S60*T02 
0.900*N02 
+  0.100*NTR 
CRES 
0.400*CRO 

+  0.300*0PEN 

CRO 
NTR 
0.700*H02 

H02 
+ 
+  0.600*X02 

+ 

HN03 

+  0.600*H02 

+  0.200*CRES 
+  0.300*T02 
+  2.000*H02 

+  O.SOO*X02 
+  O.SOO*MGLY  +  l..l.OO*PAR 

+  2.000*CO 

+ 

X02 
C203  + 
C203 
+ 

FORM 
H02 

+ 

co 

0.030*ALD2  +  0.620*C203  +  0.700*FORM 

+  O.OSO*OH 

+  0.690*CO 
+  0.030*X02 
+  0.200*MGLY 
+  0.760*H02 
C203 
X02 
+ 
C203  + 
H02 

0.7SO*ISPD  +  O.SOO*FORM 

co 
+ 
+  0.2SO*X02 
+  0.2SO*C203  +  0.2SO*PAR 
0.9l.2*ISPD  +  0.629*FORM  +  0.99l.*X02 

+  0.2SO*H02 

+  0.912*H02 

+  0.088*X02N 

0. 6.SO*ISPD  +  0.600*FORM  +  0.200*X02 
+  0.200*C203 
+  0.066*CO 
X02 
+ 
+  O.SOO*ALD2 

+  0.066*H02 
+  0.1SO*ALD2  +  0,.3SO*PAR 
0.200*ISPD  +  O.SOO*NTR 
+  0.200*N02 

+  0.266*0H 

+  O.SOO*H02 
+  2.400*PAR 
N02 

NTR 
SULF  + 
S'OL.F 
UMHP 

H02 

l..56S*PAR 
+  O.S03*H02 
+  0.273*ALD2  +  0.498*C203 

+  O.l.67*FORM  +  0.7l.3*X02 
+  0.334*CO 

+  O.l.68*MGLY 


Table 8A-S.  CB4  AQ Mechanism 
{  90}  ISPD  +  03 

--> 

{  91}  ISPD  +  N03 

{  92}  ISPD  +  h'lf 

{  93}  ISOP  +  N02 

0.114*C203  +  0.150*FORM  +  0 .. 850*MGLY 

+  0.154*H02 
+  0.020*ALD2  +  0.360*PAR 

+  0.268*0H 

+  0.064*X02 
+  0.225*CO 

,,--> 

--> 

+  0.925*H02 
+  0.643*CO 
+  0.075*C203  +  0.075*X02 

0.357*ALD2  +  0.282*FORM  +  1. 282*PAR 
+  O.!l50*NTR 
+  0.075*HN03 
+  0.067*ALD2  +  0.900*FORM 
+  1.033*H02 

+  0.700*X02 

0.333*CO 

+  0.832*PAR 
+  0.967*C203 

--> 

0.200*ISPD  +  O.BOO*NTR 

+  O.BOO*H02 
+  2 AOO*PAR 

+  0.200*NO 

+ 
+  0.800*ALD2 

X02 

>-----------------~--------------------------------~-------------------< 

,  scaled  by  1.00000E+OO 

Rate  Expression 

I 

" 

I 

n  =  1.00 

n  =  1.00 

k( 
k( 

k( 
k( 
k( 

k( 

1)  uses  photo  table  N02_CBIV88 
2)  is  a  falloff  expression  using: 
=  6.0000E"'.34  *  (T/300)**(-2.~0) 
kO 
k~nf =  2.8000E~12  *  (T/~OO)**(  o.~Ol 
F  =  0.60, 
3)  =  1.BOOOE-12  *  exp(  -1370.0/T) 
4)  =  9.3000E-12 
5)  is  a  falloff  expression  using: 
=  9.0000E~32  *  (T/300)**(-2.00) 
kO 
kinf  =  2.2000E~ll  *  (T/300)**(  0.00) 
F  =  0.60, 
6)  is  a  falloff  expression  using:· 
=  9.0000E~32  *  (T/300)**(-1.SO~ 
kO 
kinf  =  3.0000E~ll  *  (T/300)**(  0.00) 
F  =  0.60, 
7)  = 
8)  uses  photo  table  N02_CBIV88 
9)  uses  photo  table  0301D_CBIVBB 

k( 
k( 
k( 
k(  10)  =  l.BOOOE-11  *  exp( 
k(  11)  =  3.2000E-11  •exp( 
k(  12)  =  2.2000E-10 
k(  13)  =  1.6000E-12  *exp( 
k (  14)  =  1. 4000E-14  *  exp ( 
k(  15)  uses  photo  table  N02_CBIV88 
k(  16)  =  1.3000E-ll  *  exp( 
250.0/T) 
k(  17)  =  2.5000E-14  *  exp(  -1230.0/T) 
k(  18)  is  a  falloff  expression  using: 

l.2000E-13  *  exp(  -2450.0/T) 

-940.0/T) 
-580. O/T) 

107.0/T) 
67.0/T) 

n  =  1.00 

I 

,  scaled  by  5.30000E-02 
,  scaled  by  1.00000E+OO 

,  scaled  by  3.39000E+Ol 

Rate  Constant 

{O.OOOOOE+oo} 
{1.37387E-14} 

{1.81419E-14} 
{9.30000E-12} 
{1.57527E-12} 

{l.6637SE-i

12} 

{3.22581E-17} 
{O.OOOOOE+OO} 
{O.OOOOOE+OO} 
{2.57757E-11} 
{4.00676E"'.ll} 
{2.20000E-10} 
{6.826SOE-14}  " 
{1.99920E-15} 
{ 0. OOOOOE+OO}  " 
{3.00BOSE-11} 
{4.03072E-16} 
{1.26440E-12} 

11
1

11

:

· 

''I"' 
'1"11 
"" 

{l.30000E-21} 
{4.36029E-02} 
{l.95397E:38} 
{4.39999E.:.40} ::: 
{6 .69701E-12} .. 

{O.OOOOOE+oo} 
{6.60000E-12} 
{l.OOOOOE-20} 
{l.14885E-ll} 

=  2.2000E-3o  *  !T(300l**(-4.30l 
ko 
kinf  =  1.5000E-12  *  (T/300)**(-0.50) 
F  =  0.60, 

. 
n  =  1.00  . 

r·' 
k(  19)  =  1.3000E-21 
k(  20)  = k(  18)  I  Keq,  where  Keq  =  2.700E-27  *  exp(  11000.0/T) 
k(  21)  =  3.3000E-39  *exp( 
k(  22)  =  4.4000E-40 
k(  23)  is  a  falloff  expression  using: 

530.0/T) 

. 

=  6.7000~-31  *  (~/30d)**(-3.30) 
kO 
kinf  =  3.0000,-11  *  (T/300)**(-1.00) 
F  =  0.60, 

n  =  1.00 

k(  24)  uses  photo  table  N02_CBIVBB 
k(  25)  =  6.6000E-12 
k(  26)  =  1.0000E-20 
k(  27)  is  a  falloff  expression  using: 

ko 
=  2.6oOoE-30  *  <T/3oo)**(-3.2ol 
kinf  =  2.4000E:-11  *  (T/300)**(-1.30) 

' 

,  scaled  by  1.97500E-Ol 

Table 8A-5.  CB4_AQ Mechanism 

EPN600/R-99/030 

k(  28)  is  a  special  rate  expression  of  the  form: 

(1  +  k3[M]/k2l},  where 

n  =  1.00 

F  =  0.60, 
k  = ko  +  {k3[M] 
kO  =  7.2000E-15  *  exp( 
785.0/T) 
k2  =  4.1000E-16  *  exp(  1440.0/T) 
k3  =  1.9000E-33  *  exp( 
725.0/T) 
k(  29)  =  3.7000E-12  *  exp( 
240.0/T) 
k(  30)  is  a  falloff  expression  using: 

I 

=  2.3000E-31  *  (T/300)**(-4.60) 
kO 
kinf  =  4.2000E-12  *  (T/300)**(  0.20) 
F 

n  =  1.00 

0.60, 
= k(  30)  I  Keq,  where  Keq  =  2.100E-27  *  exp(  10900.0/T) 

{1.47236E-13} 

{8.27883E-12} 
{l.48014E-12} 

{9.17943E-02} 
{4.65309E-12} 
{2.79783E-12} 
{6.23927E-30} 
{O.OOOOOE+OO} 
{1.65514E-12} 
{2.40000E-13} 
{1.00000E-11} 
{O.OOOOOE+OO} 
{0.00000E+OO} 
{l.65275E-13} 
{6.30000E-16} 
{4.38753E-13} 
{l.61972E-ll} 
{2.5C°OOOE-15} 
{o.OOOOOE+OO} 
{1. 90766E-11} 
{9.41356E-12} 
{4.23268E-04} 
{2.SOOOOE-12} 
{6.SOOOOE-12} 
{3.54242E-Ol} 
{8.lOOOOE-13} 
{2.19325E+03} 
{ 1. 60000E+03} 
{1.SOOOOE-11} 
{4.04572E-12} 
{2.82173E-11} 
{1.19778E-l 7} 
{7.70000E-15} 
{7.01080E-13} 
{7.94340E-12} 
{1.89105E-18} 
{6.18715E-12} 
{8.10000E-12} 
{4.20000E+OO} 
{4.lOOOOE-11} 
{2.20000E-11} 
{1.40000E-11} 
{2.50901E-11} 
{3.00000E-11} 
{o.oooooE+oo} 
{1.00858E-17} 
{1. 70000E-11} 
{O.OOOOOE+OO} 
{3.60000E-ll} 
{9.97368E-11} 
{1.28512E-17} 
{6.73819E-13} 
{8.10000E-12} 

3.1000E-12  *  exp( 
l.5000E-13  *  (1.0  +  0.6*Pressure) 
1. OOOOE-11 

2.5000E-15 

-986.0/T) 
250.0/T) 

uses  photo  table  ALD_CBIV88 

uses  photo  table  HCHOrad_CBIV88 
uses  photo  table  HCHOmol  CBIV88 
3.0600E-11  *  exp(  -15SO.O/T) 
6.3000E-16 

-180.0/T) 
3.4900E-11  *  exp( 
380.0/T) 
2.6300E-12  *  exp( 
2.0000E+16  *  exp(-13500.0/T) 
2.5000E-12 
6.5000E-12 

1.3000E-12  *  exp( 
380.0/T) 
5.9000E-14  *  exp(  1150.0/T) 
2.2000E-38  *  exp(  5800.0/T) 
uses  photo  table  HCHOmol_CBIV88 
-187.0/T) 

c 
k(  31) 
k(  32) 
k(  33) 
k(  34) 
k(  35) 
k  (  36) 
k(  37)  = 
k(  38) 
k(  39) 
k(  40) 
k(  41) 
k(  42) 
k(  43)  =  1.2000E-11  *  exp( 
k(  44)  =  7.0000E-12  *  exp( 
k(  45) 
k(  46) 
k(  47) 
k(  48) 
k(  49) 
k(  50) 
k(  51) 
k(  52)  =  1.1000E+02  *  exp(  -1710.0/T) 
k(  53)  =  8.1000E-13 
1.0000E+15  *  exp(  -8000.0/T) 
k(  54) 
k(  55) 
1.6000E+03 
k(  56) 
1. 5000E-11 
-324.0/T) 
1.2000E-11  *  exp( 
k(  57) 
5.2000E-12  *  exp( 
504.0/T) 
k(  58) 
1.4000E-14  *  exp(  -2105.0/T) 
k(  59) 
7.7000E-15 
k(  60) 
k(  61) 
1.0000E-11 
2.0000E-12 
k(  62) 
1.3000E-14 
k(  63) 
k(  64) 
2.1000E-12 
k(  65) 
8.1000E-12 
4.2000E+OO 
k(  66) 
k(  67) 
4.1000E-11 
k(  68)  ~  2.2000E-11 
k(  69) 
1.4000E-11 
k(  70) 
1.7000E-11  *  exp( 
3.0000E-11 
k(  71) 
k(  72) 
k(  73) 
k(  74) 
k(  75)  uses  photo  table  HCHOrad_CBIV88 
k(  76)  =  3.6000E-11 
k(  77) 
k(  78) 
k(  79)  "' 
k(  80) 

2.5400E-11  *  exp( 
407.6/T) 
7.8600E-15  *  exp(  -1912.0/T) 
3.0300E-12  *exp( 
-448.0/T) 
8.1000E-12 

uses  photo  table  HCHOrad_CBIV88 
-500.0/T) 

5.4000E-17  *  exp( 
1. 7000E-11 

*  exp( 
*  exp( 
*  exp( 
*  exp( 

-792.0/T) 
411. O/T) 
-2633.0/T) 
322.0/T) 

116. O/T) 

,  scaled  by  2.55000E-01 

,  scaled  by  1.00000E+oo 
,  scaled  by  l.OOOOOE+OO 

,  scaled  by  l.OOOOOE+OO 

,  scaled  by  9.04000E+OO 

,  scaled  by  9.64000E+OO 

I 

160 .O/T) 

Table 8A-5.  CB4_AQ Mechanism 
k(  81)  =  1.7000E-14  *exp(  1300. O/T) 
k(  82)  =  8.lOOOE-12 
k(  83)  =  4.3900E-13  *  exp( 
..  1.3600E-06 
k(  84) 
k(  85)  =  7.6700E-14  *  exp(  1300. O/T) 
k(  86)  =  7.6700E-14  *  exp(  1300. O/T) 
k(  87)  =  1.7300E-14  *  exp(  1300.0/T) 
..  3.4500E-14  *exp(  1300.0/T) 
k(  88) 
..  7.llOOE-18 
k(  89)  =  3.3600E-1l 
k(  90) 
k(  91)  =  1. OOOOE-15 
k(  92)  uses  photo  table  ACROLEIN 
k(  93)  =  1.4900E-19 

"'"' 

{1.33359E-12} 
{8.lOOOOE-12} 
{7.51005E-13} 
{1.36000E-06} 
{6.01684E-12} 
{6.01684E-12} 
{1.35712E-12} 
{2.70640E-12} 
{3.36000E-1l} 
{7.llOOOE-18} 
{1. OOOOOE-15} 
{O.OOOOOE+OO} 
{1.49000E-19} 

,  scaled  by  3.~0000E-03 

==ma===m======•===~========~,~==~=====•=================2=================•••==• 

,, 
'11'1 

Table 8A-6.  CB4_AE_AQ Mechanism 

EP A/600/R-99/030 

1}  N02 

+ 

0 

+  0.890*0 

+  0.110*NO 

NO 
N2os· 
2.000*HN03 

3}  03 
4}  0 
s}  o 
6}  0 
7}  03 
8}  03 
9}  03 

NO 
03 
N02 
NO 
N03 
N02 
N03 
o 
010 
0 
0 

2.000*0H 
H02 
OH 

0.890*N02 
2.000*N02 

+  hv 
+  [02] 
+  NO 
+  N02 
+  N02 
+  NO 
+  N02 
+  hv 
+  hv 
+  [N2] 
+  [02] 
+  [H20] 
+  OH 
+  H02 
+  hv 
+  NO 
+  N02 
+  N02 
+ 

[H20] 

Reaction  List 
>--------------------------~-------------------------------------------------------< 
{ 
{  2}  0 
{ 
{ 
{ 
{ 
{ 
{ 
{ 
{  10}  010 
{  11}  010 
{  12}  010 
{  13}  03 
{  14}  03 
{  15}  N03 
{  16}  N03 
{  17}  N03 
{  18}  N03 
{  19}  N205 
{  20}  N205 
{  21}  NO 
{  22}  NO 
{  23}  OH 
{  24}  HONO 
{  25}  HONO 
{  26}  HONO 
{  27}  OH 
{  28}  OH 
{  29}  H02 
{  30}  H02 
{  31}  PNA 
{  32}  PNA 
{  33}  H02 
{  34}  H02 
{  35}  H202 
{  36}  H202 
{  37}  CO 
{  38}  FORM 
{  39}  FORM 
{  40}  FORM 
{  41}  FORM 
{  42}  FORM 
{  43}  ALD2 
{  44}  ALD2 
{  45}  ALD2 
{  46}  ALD2 

--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
·--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 

N03 
2.000*N02 
2.000*HONO 
HONO 
OH 
N02 
NO 
HN03 
N03 
OH 
PNA 
H02 
N02 
H202 
H202 

+  OH 
+  H02 
+  H02 
+  hv 
+  OH 
+  OH 
+  OH 
+  hv 
+  hv 
+  0 
+  N03 
+  0 
+  OH 
+  N03 
+  hv 

+NO 
+  N02 
+NO 
+  hv 
+  OH 
+  HONO 
+  N02 
+  HN03 
+  NO 
+  N02 

2.000*0H 
H02 
H02 
H02 
2.000*H02 

+ 
HN03 
+  2.000*H02 

+  [02] 
+ 

[H20] 

+ 

+ 

+ 

+ 

+ 

+ 

CO 
CO 

H02 
H02 
OH 

NO 

N02 

N02 

N02 

N02 

N02 

CO 
CO 

CO 

+  [H20] 

47}  C203 

+  NO 

48}  C203 
49}  PAN 
so}  c203 
51}  C203 

52}  OH 
53}  PAR 

54}  ROR 

+  N02 

+  C203 
+  H02 

+  OH 

--> 

--> 
--> 
--> 
--> 

--> 
--> 

--> 

+ 
+ 

+ 
+ 
+ 

+ 
+ 

+ 

+ 

X02 

+ 

FORM 

N02 

+ 
+  2.000*FORM 
+  0.790*X02 
+  0.210*PACD 
FORM 
+ 
+  O.l30*X02N 
+  0.760*ROR 
+  0.960*X02 
+  0.040*X02N 

+  2.000*H02 
+  0.790*H02 

H02 
+ 
+  0.1lO*H02 
- O.llO*PAR 
+  0.940*H02 
+  0.020*ROR 

CO 
OH 
HN03 
C203 
C203 
C203 
X02 
FORM 
N02 
H02 
PAN 
C203 
2.000*X02 
0.790*FORM 

+ 

+ 

+  0.790*0H 
X02 
0.870*X02 

+  O.llO*ALD2 
1.lOO*AL02 
- 2.lOO*PAR 

Table 8A-6.  CB4_AE_AQ,Mechanism 

I 

SS}  ROR 
56}  ROR 
57}  OLE 

58}  OLE 

S9}  OLE 

60}  OLE 

61}  ETH 

62}  ETH 

63}  ETH 

64}  TOL 

6S}  T02 

66}  T02 
67}  CRES 

68}  CRES 
69}  CRO 
70}  XYL 

71}  OPEN 

72}  OPEN 
73}  OPEN 

74}  MGLY 
7S}  MGLY 
76}  ISOP 

I 

+  N92 
+  o, 

'I 

+  OH I 
+  o~ 

I 

+  N03 

+  o' 
I 
+  OH I 
+  03 

I 

+  Oi:i 

I 
+  NO 

+  Oi:i 

I 

+  N03 
+  N92 
+  Oi:i 

I 

+  01;1 

+  hv 
+  03 

+  OH 

+  hy 
+  0 

77}  ISOP 

+  OH 

78}  ISOP 

+  03 

80}  X02 
Bl}  X02 
82}  X02N 
83}  $02 
84}  $02 
BS}  X02 
86}  X02N 
87}  X02N 
88}  X02N 
89}  ISPD 

+  NO 
+  X02 
+  NO 
+  OJ:! 

I 

+  H02 
+  H02 
+  X02N 
+  x92 
+  OH 

{  90}  ISPD 

+  o~ 

{  79}  ISOP 

+  N93 

--> 

--> 
--> 
--> 

--> 

-~> 

H02 
NTR 

0.630*ALD2 

+  0.300*CO 
+  0.220*PAR 
FORM 
H02 

+ 

O.SOO*ALD2 
+  0.440*H02 
+  0.200*FACD 

--> 

--> 

--> 

--> 

--> 

--> 

--> 
--> 

--> 
--> 
--> 

+ 

0.9lO*X02 
ALD2 
FORM 
+  l.700*H02 
X02 

+  o:220*ALD2 
FORM 
+  0.400*FACD 

0.080*X02 
+  O.S60*T02 
0.900*N02 
+  0.100*NTR 
CRES 
0.400*CRO 

+  0.300*0PEN 

CRO 
NTR 
0,700*H02 

+  O.SOO*MGLY 
+ 

XYLAER 
X02 
C203 
C203 
0.030*ALD2 

+ 

--> 

--> 
--> 

+  0.030*X02 
+  0.760*H02 
X02 
C203 
0.7SO*ISPD 

+  0. 250*H02 

0.912*ISPD 

+  0.9l2*H02 

--> 
--> 
--> 

--> 

--> 

0.6SO*I~PD 

+  0.066*H02 
+  0.1!:>0*ALD2 
0.200*ISPD 

+  0.800*H02 
+  2.400*PAR 
N02 

NTR 
SULF 
SULF 
UMHP 

--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 

l.S6S*PAR 
+  O.S03*H02 
+  0.273*ALD2 
-->  O.ll4*C203 

8-48 

+  0.380*H02 
+  0.200*FORM 
+  0.200*0H 
+ 

ALD2 
PAR 

+  0.740*FORM 
+  0.220*X02 
+  0.200*AACD 
+  0.090*X02N 

PAR 
+  0.700*X02 
+  0.300*0H 
+  1.560*FORM 

+  0.280*X02 
+  0.020*X02N 

+ 

X02 

+  0.330*CO 
+  O.lOO*OH 

+ 
+ 
+ 

+ 

PAR 
FORM 
N02 
co 

H02 

+  0.420*CO 

+  0. l20*H0,2 

+  0.360*CRES 
+ 
+  0.900*H02 

TOLAER 

+ 
H02 
+  0.600*X02 
+ 
+ 

CSLAER 
HN03 

+  0.440*H02 

+  0.900*0PEN 

+  0.600*H02 

+ 

CSLAER 

+  O.SOO*X02 
+  1.100*PAR 

+  0.200*CRES 
+  0.300*T02 

FORM 
H02 

+  2.000*CO 
+ 
+ 
+  0.620*C203 
+  0.690*CO 
+  0.200*MGLY 
C203 
+ 
+ 
H02 
+  0.500*FORM 
+  0.250*C203 
+  0.629*FORM 
+  0.088*X02N 
+  0.600*FORM 
+  0.266*0H 
+  0.3SO*PAR 
+  O.SQO*NTR 
+  0.200*N02 

+  2.000*H02 

co 

+ 
+  0.700*FORM 
+  O.OBO*OH 

co 
+ 
+  0.250*X02 
+  0.250*PAR 
+  0.991*X02 

+  0.200*X02 
+  0.200*C203 
+  0.066*CO 
x92 
+ 
+  0.800*ALD2 

+ 
+ 

H02 
SULAER 

+ 

SULAER 

+  0.167*FORM 
+  0.334*CO 
+  0.498*C203 
+  O.l50*FORM 

+  0.7l3*X02 
+  O.l.68*MGLY 

+  0.850*MGLY 

Table 8A-6.  CB4_AE_AQ Mech~ism. 

{  91}  ISPD 

+  N03 

--> 

+  0.154*H02 
+  0.020*ALD2 
0.357*ALD2 

+  0.925*H02 
+  0. 075*C203 

{  92}  ISPD 

+  hv 

--> 

0.333*CO 

{  93}  ISOP 

+  N02 

94}  TERP 
95}  TERP 
96}  TERP 

+  OH 
+  N03 
+  03 

--> 

--> 
--> 
--> 

+  O.B32*PAR 
+  0.967*C203 
0.200*ISPD 

+  0.800*H02 
+  2.400*PAR 

TERPAER  + 
TERPAER  + 
TERPAER  + 

OH 
N03 
03 

EPA/600/R-99/030 

+  0.26B*OH 
+  0.360*PAR 
+  0.2B2*FORM 
+  0.643*CO 
+  0.075*X02 
+  0.067*ALD2 
+  1. 033*H02 

+  0.064*X02 
+  0.225*CO 
+  l.2B2*PAR 
+  O.B50*NTR 
+  0.075*HN03 
+  0.900*FORM 
+  0.700*X02 

+  0.800*NTR 
+  0 .. 200*NO 

+ 
+  0.800*ALD2 

X02 

>--------------------------------------------------------------------------~-------< 

,  scaled  by  l.OOOOOE+OO 

Rate  Constant 

{O.OOOOOE+OO} 
{l.37387E-14} 

{l.81419E-14} 
{9.30000E-12} 
{1.57527E-12} 

{1.66375E-12} 

{3.22581E-17} 
{O.OOOOOE+OO} 
{O.OOOOOE+OO} 
{2.57757E-11} 
{4.00676E-11} 
{2.20000E-10} 
{6.B2650E-14} 
{l.99920E-15} 
{O.OOOOOE+OO} 
{3.00805E-ll} 
{4.03072E-16} 
{l.26440E-12} 

{l.30000E-21} 
{4.36029E-02} 
{l.95397E-38} 
{4.39999E-40} 
{6.69701E-12} 

{o.oooooE+oo} 
{6.GOOOOE-12} 
{1.00000E-20} 
{1.14BB5E~ll} 

,  scaled  by  5.JOOOOE-02 
'  scaled  by  l.OOOOOE+OO 

,  scaled  by  3.39000E+Ol 

,  scaled  by  l.97500E-Ol 

8~49 

Rate  Expression 

1)  uses  photo  table  N02_CBIV8B 
2)  is  a  falloff  expression  using: 

n  =  1.00 

=  6.0000E-34  *  (T/300)**(-2.30) 
kO 
kinf  =  2.8000E-12  *  (T/300)**(  0.00) 
F  =  0.60, 
3)  = 
4)  =  9.3000E-12 
5)  is  a  falloff  expression  using: 

l.8000E-12  *  exp(  -1370.0/T) 

=  9.0000E-32  *  (T/300)**(-2.00) 
kO 
kinf  =  2.2000E-ll  *  (T/300)**(  0.00) 
F  =  0.60, 

n  =.  1.00 

k( 
k( 

k( 
k( 
k( 

k( 

6)  is  a  falloff  expression  using: 

n  =  1.00 

=  9.0000E-32  *  (T/300)**(-1.50) 
kO 
kinf  =  3.0000E-11  * (T/300)**(  0.00) 
F  =  0.60, 
7)  =  1.2000E-13  *exp(  -2450:0/T) 
8)  uses  photo  table  N02_CBIVBB 
9)  uses  photo  table  0301D_CBIVBB 

k( 
k( 
k( 
k(  10)  = 
l.BOOOE-11  *  exp( 
k(  11)  =  3.2000E-ll  *exp( 
k(  12)  =  2.2000E-10 
k( 
k( 
k( 
k( 
k( 
k( 

13)  = 
-940.0/T) 
14)  = 
-580.0/T) 
. 
15)  uses  photo  table  N02_CBIVBB 
16)  =  1.3000E-11  *  exp( 
250.0/T) 
17)  =  2.5000E-14  *  exp(  -1230.0/T) 
18)  is  a  falloff  expression  using: 
kO 
kinf  = 
F  =  0.60, 

=  2.2000E-30  *  (T/300)**(-4.30) 
l.5000E-12  *  (T/300)**(-0.50) 

l.6000E-12  *  exp( 
l.4000E-14  *  exp( 

107.0/T) 
67.0/T) 

n  =  1.00 

l.3000E-21 

k(  19)  = 
k(  20)  = k(  18)  I  Keq,  where  Keq  =  2.700E~27  *exp(  11000.0/T) 
k(  21)  =  3.3000E-39  *  exp( 
k(  22)  =  4.4000E-40 
k(  23)  is  a  falloff  expression  using: 

530.0/T) 

0.60, 

=  6.7000E-31  *  (T/300)**(-3.30) 
kO 
kinf  =  3.0000E-11  *  (T/300)**(-1.00) 
F  = 
k(  24) 
k(  25) 
k(  26) 
k(  27) 

is  a  falloff  expression  using: 

uses  photo  table  N02_CBIVB8 

6.6000E-12 
l.OOOOE-20 

n  =  1.00 

EPA/600/R-99/030 

Table 8A-6.  <;B4_AE_AQ Mechanism 

I 

= 

2.6000E-30  *  (T/300)**(-3.20) 
kO 
kinf  =  2.4000E-11  *  (T/300)**<-1.30) 
F  =  0.60, 

n  ~  1.00 

k(  28)  is  a  special  rate  expression  of  the  form: 

(1  +  k3[M]/k2)},  where 

/ 

k  =  kO  +  {k3[MJ 
kO  =  7.2000E-i5  *  exp( 
785.0/T) 
k2  =  4.1000E-l6  *  exp(  1440.0/T) 
k3  =  l.9000E-J3  *  exp( 
725.0/Tl 
k(  29)  =  3.7000E-12  *exp( 
k(  30) 

240.0/T) 
i.s  a  fallC)ff  expression  using: 
=  2.3ocici•-i1  *  .(T/300)**(-4.60) 
kO 
kinf  =  4.2000E-12  *  (T/300)**(  o.20J 
F  =  0.60, 

n  ~  '1.00  ,,,, .. ,,, 

l.3000E-12  *exp( 

l.OOOOE-11 

-986.0/T) 
250.0/T) 

,  scaled  by  l.OOOOOE+OO 

,  scaled  by  2.55000E-01 

,  scaled  by  l.OOOOOE+OO 
,  scaled  by  l.OOOOOE+OO 

k(  31)  =  k(  30)  I  Keq,  where  Keq  =  2.lOOE-27  *  exp(  10900.0/T) 
k(  32)  = 
380.0/T) 
k(  33)  =  5.9000E-14  *  exp(  1150.0/T) 
k(  34)  = 
2.2000E-38  *  exp(  5800.0/T) 
k(  35)  uses  photo  table  HCHOmol_CBIV88 
k(  36)  =  3.lOOOE-12  *exp( 
-187.0/T) 
k(  37)  =  l.5000E-13  *  (1.0  +  0.6*Pressure) 
k(  38)  = 
k(  39)  uses  photo  table  HCHOrad_CBIV88 
k(  40)  uses  photo  table  HCHOmol_CBIV88 
k(  41)  =  3.0000E-11  *exp(  -1550.0/T) 
k(  42)  =  6.3000E;l6 
k(  43)  =  l.2000E-ll  *  exp( 
k(  44)  =  7.0000E-12  *  exp( 
k(  45)  =  2.5000E-15 
k(  46)  uses  photo  table  ALD_CBIV88 
k(  47)  =  3.4900E-ll  *  exp( 
-180.0/T) 
k(  48)  =  2.6300E-12  *  exp( 
380.0/T) 
k(  49)  =  2.0000E+l6  *  exp(-13500.0/T) 
k(  50) 
k(  51) 
k(  52) 
k(  53) 
k(  54) 
k(  55) 
k(  56) 
k(  57) 
k(  58) 
k(  59) 
k(  60) 
k(  61) 
k(  62) 
k(  63) 
k(  64) 
k(  65) 
k(  66) 
k(  67) 
k(  68) 
k(  69) 
k(  70) 
k(  71) 
k  (  72) 
k(  73) 
k(  74) 
k(  75)  uses  photo  table  HCHOrad_CBIV88 
k(  76)  =  3.6000E-ll 
k(  77) 
k  (  78) 

2.5000E-12 
6.5000E-12 
l.lOOOE+02  *  exp(  -1710.0/T) 
8.lOOOE-13 
l.OOOOE+l5  *  exp(  -8000.0/T) 
l.6000E+03 
1. 5000E-ll 
-324. O/T) 
l.2000E-ll  *  exp( 
504.0/T) 
5.2000E-12  *  exp( 
l.4000E-14  *  exp(  -2105.0/T) 
7.7000E-15 
l.OOOOE-11  *  exp( 
2.0000E-12  *  exp( 
l.3000E-14  *  exp( 
2.lOOOE-12  *  exp( 
8.lOOOE-12 
4.2000E+OO 
4.lOOOE-11 
2.2000E-ll 
1.4000E-ll 
l.7000E-ll  *  exp( 
3.0000E-11 

uses  photo  table  HCHOrad_CBIV88 
-500.0/T) 

2.5400E-ll  *  exp( 
407.6/T) 
7.8600E-15  *  exp(  -1912.0/T) 

-792. O/T) 
411. O/T) 
-2633.0/T) 
322.0/T) 

5.4000E-17  *  exp( 
l.7000E-ll 

,  scaled  by  9.04000E+OO 

,  scaled  by  9.64000E+OO 

116.0/T) 

8-50 

,,,,11,,1111111, 

:111111 

{1.47236E-13} 

{8.27883E-12} 
{1.48014E~l2} 

{9.17943E-02} 
{4.65309E-12} 
{2.79783E-12} 
{6.23927E-30} 
{O.OOOOOE+OO} 
{1.65514E-12} 
{2.40000E-13} 
{1.00000E-11} 
{O.OOOOOE+oo} 
{O.OOOOOE+OO} 
{1. 6527SE-13} 
{6.30000E-16} 
{4.38753E-13} 
{1. 61972E-11} 
{2.50000E-15} 
{O.OOOOOE+OO} 
{1.90766E-11} 
{9.41356E-12} 
{4.23268E-04} 
{2.50000E-12} 
{6.50000E-12} 
{3.54242E-01}, 
{8.lOOOOE-13} 
{2.19325E+03} 
{l.60000E+03} 
{l.50000E-1J.} 
{4.04572E-12} 
{2.82173E-11} 
{1. 19778E-17}  "'' 
{7.70000E-15}•' 
{7.01080E-13} 
{7.94340E-12} 
{ 1. 89105E .. ::: .. 18} 
{6.18715E:.12}',;,  ., 
{8.lOOOOE-12} 
{4.20000E+oo} 
{4.l.OOOOE-11} 
{2. 20000E-11} HI· 
{1.40000E-11} 
{2.50901E-11} 
{3.00000E-J.J.} 
{O.OOOOOE+OO} 
{1.00858E-17} 
{1.70000E-11} 
{O.OOOOOE+OO} 
{3.60000E-l.l} 
{9.97368E-1J.} 
{1.28512E-17} 

Table 8A-6.  CB4_AE_AQ Mechanism 

EP A/600/R-99/030 

8.lOOOE-12 
l.7000E-14  *  exp(  1300.0/T) 

-448.0/T) 

160.0/T) 

k(  79)  =  3.0300E-12  *exp( 
{6.73819E-13} 
k(  80)  = 
{8.lOOOOE-12} 
k(  81)  = 
{1.33359E-12} 
k(  82)  =  8.lOOOE-12 
{8.lOOOOE-12} 
k(  83)  =  4.3900E-13  *  exp( 
{7.51005E-13} 
k(  84)  =  1.3600E-06 
{1.36000E-06} 
k(  85)  =  7.6700E-14  *  exp(  1300.0/T) 
{6.0l684E-12} 
k(  86)  =  7.6700E-14  *  exp(  13 00. O/T) 
{6.01684E-12} 
k(  87)  = 
l.7300E-14  *  exp(  1300. O/T) 
{1.35712E-12} 
k(  88)  =  3.4500E-14  *  exp(  1300. O/T) 
{2.70640E-12} 
k(  89)  =  3.3600E-ll 
{3.36000E-11} 
k(  90)  =  7.llOOE-18 
{7.llOOOE-18} 
k(  91)  =  1. OOOOE-15 
{l.OOOOOE-15} 
k(  92)  uses  photo  table  ACROLEIN 
{O.OOOOOE+OO} 
k(  93)  = 
l.4900E-19 
{l.49000E-19} 
l.0700E-ll  *  exp( 
k(  94)  = 
{6.75269E-11} 
k(  95)  =  3.2300E-ll  *exp( 
{1.22539E-12} 
{1.61125E-16} 
k(  96)  " 
=============================================================================== 

549 .O/T) 
-975.0/T) 
7.2900E-15  *exp(  -1136.0/T) 

,  scaled  by  3.60000E-03 

Table 8A-7.  RADM2 and RADM2_AQ Mechanisms 

• 

I 

9}  H202 

NO 

NO 
N02 
N02 

03P 

+ 

+ 
+ 
+ 

+ 

Reaction  List 
>----------------------------------------------------------------------< 
+  hv  ' 
1 }  N02 
{ 
+  hv 
2}  03 
{ 
+  hv 
3}  03 
{ 
4 }  HONO  +  hv 
{ 
{  s}  HN03  +  hv 
{  6)  HN04  +  hv 
+  hv 
{  7)  N03 
+  hv 
{  8)  N03 
{ 
+  hv 
{  10}  HCHO  +  hv 
+  hv 
{  11}  HCHO 
+  hv 
{  12}  ALO 
+  hv 
{  13}  OPl 
+  hv 
{  14)  OP2 
+  hv 
{  15}  PAA 
{  16}  KET 
+  hv 
+  hv 
{  17}  GLY 
+  hv 
{  18}  GLY 
+  hv 
{  19}  MGLY 
{  20}  DCB 
+  hv 
{  21)  ONIT  +  hv 

03 P 
OlD 
03P 
HO 
HO 
H02 
NO 
N02 
2.000*HO 
CO 
Ho'2 
M02 
HCHO 
ALD 
M02 
AC03 

- - > 
--> 
--> 
- - > 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 

0.130*HCHO  +  l.870*CO 
0.450*HCHO  +  l.SSO*CO 
H02 

+  0.800*H02 
+ 
+ 
+ 

CO 
TC03 
H02 

+ 
+  0.020*AC03 
+  0.800*KET 

H02 
H02 
H02 
H02 
HO 
ETHP 

CO 
CO 
HO 
HO 

+ 
+ 
+ 
+ 
+ 
+ 

+ 
+ 
+ 
+ 

{  22}  03P 
'{  23}  03P 
{  24}  OlD 
{  25}  OlD 
{  26}  OlD 
{  27}  03 
{  28}  03 
{  29}  03 
{  30}  H02 
{  31}  H02 
(  32)  HN04 
{  33}  H02 
{  34)  H02 
{  35}  H202 
{  36}  NO 
{  37}  NO 
{  3 8}  03 
{  39}  N03 
{  40}  N03 
{  41}  N03 
{  42}  N03 
{  43)  N205 
{  44)  N205 
{  45}  HO 
{  46}  HO 
{  47}  HO 
{  48}  HO 
{  49}  HO 
{  so}  co 
{  51}  HO 
{  52}  ETH 
{  53}  HC3 

54}  HCS 
ss}  HC8 
56}  OL2 
57}  OLT 

[H20] 

+ 
[M] 
+  N02 
[N2J 
. + 
+  [02J 
+ 
+NO  ' 
+  HO 
+  H02 
+  NO 
+  N02, 

+  H02 
+  H02 
+  H<? 
+  HO 
+  NO 
+  N02, 
+NO  I 
+  N02
+  H02 
+  N02 

I 

1 

[H20] 

+ 
+  N02: 
+  HN03 
I 
+  HNOf 
+  H02 
I 
+  S02 
+  HO 

+  HO 
+  HO 

+  HO 
+  HO 
+  HO 
+  HO 

+  [02] 

+  [02] 

--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
+  [H20]  --> 
.--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 

--> 
--> 
--> 
--> 

+ 

AC03 
0.980*H02 
0.200*ALD 
N02 
03 
NO 
03P 
03P 

+ 

+ 

HO 

N02 

2.000*HO 
N02 
H02 
HO 
N02 
HN04 
H02 
H202 
li202 
H02 
HONO 
2.000*N02 
N03 
2.000*N02 

NO 
HN,03 
N205 
N02 

+ 

+ 

N02 

N03 

·2. OOO*HN03 
HN03 
N03 
N02 

+ 

H02 

SULF 
H02 
M02 
ETHP 
0.830*HC3P 

+  0.075*ALD 

+  0.1'70*H02 
+  0.025*KET 
HC5P  +  0.250*X02 
HC8P  +  0.7SO*X02 
OL2P 
OLTP 

8-52 

+  0.009*HCHO 

Table 8A-7.  RADM2 and RADM2_AQ Mechanisms 

EP A/600/R-99/030 

+  0.250*CSL 
+  0.170*CSL 
+  0.900*X02 

+  0.250*H02 
+  0.170*H02 
+  0.900*TC03 

+ 

co 

+  2.000*CO 
co 
+ 

+  0.500*HCHO 
+  0.500*ALD 

+  0.500*HO 
+  0.500*HO 

+ 

X02 

+ 
+ 

+ 

N03 
N02 

N02 

OLIP 
0.750*TOLP 
0.830*XYLP 
0.100*H02 
CSL 
H02 
AC03 
KETP 
H02 
AC03 
TC03 

0.500*M02 
0.500*HC3P 
AC03 
HCHO 
HC3P 
OLTP 
PAN 
AC03 
TPAN 
TC03 
HCHO 
0.750*ALD 

N02 
+ 
H02 
+ 
+  0.250*KET 
+  0.036*0NIT  +  0.964*N02 
+  0.690*KET 
+  0.920*H02 
+  1.060*KET 
+  0.240*0NIT  +  0.760*N02-
H02 

0.380*ALD 
+  0.920*N02 
0.350*ALD 

1.600*HCHO  + 

N02 

+ 
+  0.090*HCHO 
+  0.964*H02 
+  O.OSO*ONIT 

+  0.040*HCHO 
+  0.760*H02 
+ 
N02 

+ 

+  0.200*ALD 
ALD 
N02 
H02 
+  0.100*KET 
M02 
N02 

+ 

HCHO 

+ 

H02 

+  1.450*ALD 
+ 
N02 
+ 
N02 
+  0.920*H02 

+  0.280*HCHO 

+  0.890*GLY 

+  0.110*MGLY  +  0.050*AC03  +  0.950*CO 
+  2.000*X02 
N02 
+  0.160*GLY 
N02 
+  0.806*DCB 
.  ALD 

H02 
+ 
+  0.700*DCB 
+ 
H02 

+  0.170*MGLY 

+  0.450*MGLY 

H02 
N02 
ALD 
HN03 
HN03 
H02 
AC03 
TC03 
XN02 

N02 
+ 
H02 
+ 
+  2.000*N02 
co 
+ 

+  2.000*CO 
co 
+ 

+  0.500*CSL 

+  HO 
{  58}  OLI 
+  HO 
{  59}  TOL 
+  HO 
{  60}  XYL 
+  HO 
{  61}  CSL 
+  HO 
{  62}  CSL 
+  HO 
{  63}  HCHO 
+  HO 
{  64}  ALD 
+  HO 
{  65}  KET 
+  HO 
{  66}  GLY 
{  67}  MGLY  +  HO 
+  HO 
{  68}  DCB 
+  HO 
{  69}  OP1 
+  HO 
{  70}  OP2 
+  HO 
{  71}  PAA 
+  HO 
{  72}  PAN 
{  73}  ONIT  +  HO 
+  HO 
{  74}  ISO 
{  75}  AC03 
+  N02 
{  76}  PAN 
{  77}  TC03 
{  78}  TPAN 
+  NO 
{  79}  M02 
{  so}  HC3P  +  NO 

+  N02 

81}  HC5P  +  NO 

82}  HCSP  +  NO 

83}  OL2P  +  NO 

84}  OLTP 

+  NO 

85}  OLIP  .+NO 

86}  AC03 
+  NO 
87}  TC03  +  NO 

88}  TOLP  +  NO 

89}  XYLP  +  NO 

{  90}  ETHP 
{  91}  KETP 
{  92}  OLN 
{  93}  HCHO 
{  94}  ALD 
{  95}  GLY 
{  96}  MGLY 
{  97}  DCB 
{  98}  CSL 
{  99}  OL2 
{100}  OLT 
{101}  OLI 
{102}  ISO 
{103}  OL2 

+  NO 
+  NO 
+  NO 
+  N03 
+  N03 
+  N03 
+  N03 
+  N03 
+  N03 
+  N03 
+  N03 
+  N03 
+  N03 
+  03 

{104}  OLT 

+  03 

--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 

--> 

--> 

--> 

--> 

--> 

--> 
--> 

--> 

--> 

--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 

--> 

+ 
+ 
+ 
+ 
+ 
+ 
+ 
+ 
+ 

MGLY 
HCHO 
H02 
AC03 
HN03 
HN03 
HN03 
HN03 
OLN 
OLN 
OLN 
OLN 
HCHO 
+  0.120*H02 

0.530*HCHO 
+  0.200*0RA1 
+  0.220*M02 

8"."53 

{105}  OLI 

+  03 

--> 

0.180*HCHO 

+  0.400*0RA1 

+  0.420*CO 

+  0,. 500*ALD 
+  0.200*0RA2 
.f.  0.100*HO 
+  0.720*ALD 

+  0.330*CO 
+  0.230*H02 

+  0.100*KET 

Table 8A-7.  RADM2 and RADM2  AQ Mechanisms 

{106}  ISO 

+  03 

{107}  H02 
{108}  H02 
{109}  H02 
{110}  H02 
{111}  H02 
{112}  H02 
{113}  H02 
{114}  H02 
{115}  H02 
{116}  H02 
{117}  H02 
{118}  H02 
{119}  H02 
{120}  H02 
{121}  M02 
{122}  M02 
{123}  M02 

+  M02 
+  ETHP 
+  HC3P 
+  HC5P 
+  HC8J? 
+  OL21\' 
+  OLTP 
+  OLII\' 
+  KETP 
+  ACO~ 
+  TOLP 
+  XYLJ? 
+  TCO~ 
+  OLN 1 
+  M02, 
+ETH!? 
+  HC31;' 

I 

{124}  M02 

+  HCSP 

{125}  M02 

+  HC8lf' 

{126}  M02 
{127}  M02 
{128}  M02 

{129}  M02 
{130}  M02 

+  OL2Ji' 
+·  OLTJi' 
+  OLI!f' 

+  KETP 
+  ACOf 

{131}  M02 

+  TOL!f' 

{132}  M02 

+  XYL!f' 

{133}  M02 

+  TC03 

{134}  M02 

+  OLN, 

{135}  ETHP 

+  AC03 

{136}  HC3P 

+  AC03 

{137}  HCSP 

+  ACO~ 

{138}  HC8P  +  AC03 

{139}  OL2P  +  AC03 

{140}  OLTP  +  AC03 

{141}  OLIP 

+  AC0;3 

{142}  KETP 

+  ACO~ 

{143}  AC03 
{144}  AC03 

I 
+  AC0;3 
+  TOLP 

i 

--> 

--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 

--> 

--> 

--> 
--> 
--> 

--> 
--> 

--> 

--> 

--> 

--> 

--> 

--> 

--> 

--> 

--> 

--> 

--> 

--> 

--> 
--> 

+  0.230*CO 
+  0.260*H02 

0.5~0*HCHO 
+  0.200*0RA1 
+  0.22°0*M02 
OPl 
OP2 
OP2 
OP2 
OP2 
OP2 
OP2 
OP2 
OP2 
PAA 
OP2 
OP2 
OP2 
ONIT 
1.500*HCHO 
0.750*HCHO 
0.840*HCHO 

+  0.060*0RA1 
+  0.140*HO 
+  0.500*ALD 
+  0.200*0RA2 
+  O.lOO*HO 

+  0.290*0RA2 
+  0.310*M02 
+  0.330*CO 
+  0.230*H02 

+ 
H02 
+ 
H02 
+  0.770*ALD 

+  0.750*ALD 
+  0.260*KET 

H02 

0.770*HCHO  +  0.410*ALD 

+  0.7SO*KET 

H02 

0.800*HCHO  +  0.460*ALD 

+  1.390*KET 

+ 

+ 

+ 

H02 

1.550*HCHO  +  0.3SO*ALD 
1.250*HCHO  +  0.7SO*ALD 
0.890*HCHO  +  0.725*ALD 

+ 
+ 
+ 

H02 
H02 
H02 

+  O.SSO*KET 

0.750*HCHO 
HCHO 
+  0.500*0RA2 
HCHO 
+  0.700*DCB 
HCHO 
+  2.000*H02 

0 ... 590*HCHO 
+  O.SOO*ORA2 
+  0.475*CO 

1. 750*HCHO 

+ 

N02 
ALD 

+  0.750*MGLY 
+  0.500*H02 

H02 
+ 
+  O.SOO*M02 

+  0.170*MGLY 
+  2.000*H02 
+  0.45o*l'1GLY 

+  0.160*GLY 

+  0.806*DCB 

+  0.445*GLY 
+  0.025*AC03 
X02 
+ 
+  0.500*H02 

+  0. 055*MGLY 
+  0.460*H02 

+ 

ALD 

+  0.500*H02 

+  O.SOO*M02 

+  O.SOO*ORA2 
0.770*ALD 
+  0.500*M02 
0.410*ALD 
+  0.500*M02 
0.460*ALD 
+  0.500*M02 

+  0.260*KET 
+  O.SOO*ORA2 
+  0.750*KET 
+  O.SOO*ORA2 
+  1.390*KET 
+  O.SOO*ORA2 
O.BOO*HCHO  +  0.600*ALD 

+  0.500*H02 

+  O.SOO*H02 

+  O.SOO*H02 

+  0.500*H02 

+  0.500*M02 
ALD 
+  O.SOO*M02 
0.725*ALD 
+  0.500*H02 

+  0.500*0RA2 
+  O.SOO*HCHO  +  O.SOO*H02 
+  O.SOO*ORA2 
+  0.550*KET 
+  0.500*M02 
MGLY  +  0.500*H02 

+  0.140*HCHO 
+  O.SOO*ORA2 
+  O.SOO*M02 

+  0.500*0RA2 

2.000*M02 
M02 

+  0.170*MGLY 

+  0.160*GLY 

8-54 

Table 8A-7.  RADM2 and RADM2_AQ Mechanisms 

{145}  AC03 

+  XYLP 

{146}  AC03 

+  TC03 

{147}  AC03 

+  OLN 

+  0.700"DCB 
M02 
H02 
M02 

+ 

+ 
+  0.450*MGLY  +  0.806*DCB 

H02 

+  0.920*H02 

+  0.890*GLY 

+  0 .110•'MGLY  +  0.05Q*AC03  +  0.950*CO 
+  2. OOO•'X02 

+ 

HCHO  + 
N02 

ALD 
+  0.500*M02 
2. OOO'•HCHO  +  2.000*ALD 

+  0.500*0RA2 

--> 
--> 

--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 

+  2.000*N02 

OP2 
HCHO  + 
M02 

{148}  OLN 
{149}  X02 
{150}  X02 
{151}  X02 
{152}  X02 
{153}  X02 
{154}  XN02 
{155}  XN02 
{156}  XN02 
{157}  XN02 
{158}  XN02 
>----------------------------------------------------------------------< 

+  OLN 
+  H02 
+  M02 
+  AC03 
+  X02 
+  NO 
+  N02 
+  H02 
+  M02 
+  AC03 
+  XN02 

N02 
ONIT 
OP2 
HCHO  + 
M02 

H02 

H02 

'  scaled  by  1.00000E+OO 
,  scaled  by  1.00000E+OO 
'  scaled  by  1.00000E+OO 
'  scaled  by  1.00000E+OO 
'  scaled  by  l.OOOOOE+OO 
'  scaled  by  1.00000E+OO 
'  scaled  by  l.OOOOOE+OO 
'  scaled  by  1.00000E+OO 
'  scaled  by  1·. OOOOOE+OO 
'  scaled  by  l.OOOOOE+OO 
,  scaled  by  l.OOOOOE+OO 
'  scaled  by  1.00000E+OO 
'  scaled  by  l.OOOOOE+OO 
'  scaled  by  1.00000E+OO 
'  scaled  by  1.00000E+OO 
'  scaled  by  l.OOOOOE+OO 
,  scaled  by  1.00000E+OO 
'  scaled  by  1.00000E+OO 
'  scaled  by  1.00000E+OO 
'  scaled  by  1.00000E+OO 
'  scaled  by  1.00000E+OO 

Rate  Expression 
Rate  Constant 
====c=======c====================c============================================= 
k(  1)  uses  photo  table  N02_RADM88 
{O.OOOOOE+OO} 
k(  2)  uses  photo  table  0301D_RADM88 
{O.OOOOOE+OO} 
k( 
3)  uses  photo  table  0303P_RADM88 
{O.OOOOOE+OO} 
k(  4)  uses  photo  table  HONO_RADM88 
{O.OOOOOE+OO} 
k( 
5)  uses  photo  table  HN03_RADM88 
{O.OOOOOE+OO} 
6)  uses  photo  table  HN04_RADM88 
k( 
{O.OOOOOE+oo} 
7)  uses  photo  table  N03NO_RADM88 
k( 
{O.OOOOOE+OO} 
k( 
8)  uses  photo  table  N03N02_RADM88 
{O.OOOOOE+OO} 
k( 
9)  uses  photo  table  H202_RADM88 
{O.OOOOOE+oo} 
k(  10)  uses  photo  table  HCHOmol_RADM88 
{O.OOOOOE+OO} 
k(  11)  uses  photo  table  HCHOrad_RADM88 
{O.OOOOOE+OO} 
k(  12)  uses  photo  table  ALD_RADM88 
{O.OOOOOE+OO} 
k(  13)  uses  photo  table  MHP_RADM88 
{O.OOOOOE+OO} 
k(  14)  uses  photo  table  HOP_RADMBB 
{O.OOOOOE+OO} 
k(  15)  uses  photo  table  PAA_RADM88 
{O.OOOOOE+oo} 
k(  16)  uses  photo  table  KETONE_RADM88 
{O.OOOOOE+OO} 
k(  17)  uses  photo  table  GLYform_RADM88 
{O.OOOOOE+OO} 
k(  18)  uses  photo  table  GLYmol_RADMBB 
{O.OOOOOE+OO} 
k(  19)  uses  photo  table  MGLY_RADMBB 
{O.OOOOOE+OO} 
k(  20)  uses  photo  table  UDC_RADM88 
{O.OOOOOE+OO} 
k(  21)  uses  photo  table  ORGNIT_RADM88 
{O.OOOOOE+OO} 
k(  22)  =  6.0000E-34  *  (T/300)**(-2.30) 
{6.09302E-34} 
120.0/T) 
k(  23)  =  6.5000E-12  *  exp( 
{9.72293E-12} 
k(  24)  =  1.8000E-11  *  exp( 
110.0/T) 
{2.60365E-11} 
k(  25)  =  3.2000E-11  *exp( 
70.0/T) 
{4.04730E-11} 
k(  26)  =  2.2000E-10 
{2.20000E-10} 
k(  27)  =  2.0000E-12  *  exp(  -1400.0/T) 
{ 1. 82272E-14} 
k(  28)  = 
l.6000E-12  *  exp( 
-940.0/T) 
{6.82650E-14} 
k(  29)  =  1.1000E-14  *  exp( 
-500.0/T) 
{2.05452E-15} 
k(  30)  =  3.7000E-12  *exp( 
{8.27883E-12} 
240.0/T) 
k(  31)  is  a  falloff  expression  using: 
{1.39058E-12} 

=  1. BOOOE-31  *  (T/300)**(-3.20) 
kO 
kinf  =  4.7000E-12  *  (T/300)**(-l.40) 
F  =  0.60, 

n  =  1. 00 

k(  32)  =  k(  31)  I  Keq,  where  Keq  =  2.lOOE-27  *  exp(  10900.0/T) 
k(  33)  is  a  special  rate  expression  of  the  form: 

{8.62399E-02} 
{3.01634E-12} 

k  =kl+  k2[MJ,  where 

Table 8A-7.  RADM2 and RADM2_AQ Mechani~ms 

' I 
I 

kl  =  2.2000E-13  *  exp( 
l.9000E-33  *  exp( 
k2  = 

I 

620.0/T) 
980.0/T) 

k(  34)  is  a  special  rate  expression  of  the  form: 

{6.7890SE-30j 

k  =kl+  k2[Ml;  where 
kl  =  3.0BOOE-J4  *  exp(  2820.0/T) 
k2  =  2.6600E-S4  *  exp(  3180.0/Tl 
k(  3S)  =  3.3000E-12  *exp( 
-200.0/T) 
k(  36)  is  a  falloff  expression  using: 

=  7.ooooE-31  *  !T/300)**(-2.60) 
l.SOOOE-11  *  (T/300)**(-0.SO) 

kO 
kinf  = 
F  =  0.60, 

I 

n  ~  1.00 

k(  37)  =  3.3000E-39  *  exp( 
l.4000E-13  *  exp( 
k(  38)  = 
k(  39)  = 
l.7000E-ll  *  exp( 
k(  40)  =  2.SOOOE-14  *  exp( 
k(  41)  = 
k(  42)  is  a  falloff  expression  using: 

S30. O/T) 
-2SOO.O/T) 
lSO.O/T) 
-1230.0/T) 

2.SOOOE-12 

=  2.2000E-3o  *  !T/300)**(-4.30) 
l.SOOOE-12  *  (T/300)**(-0.SO) 

kO 
kinf  = 
F  =  0.60, 

I 

n  ~  1.00 

k(  43)  =  k(  42)  I  Keq,  where  Keq  = 
k(  44)  =  2.0000E-21 
k(  4S)  is  a  falloff  expression  using: 

kO 
=  2.6000E-30  *  (T/300)**(-3.20) 
kinf  =  2.4000E-11  *  !T/300)**(-1.30) 
F  =  0.60, 

n  =  1.00 

l.lOOE-27  *  exp(  11200.0/T) 

k(  46)  is  a  special  rate  expression  of  the  form: 

k  = kO  +  {k3[M]  I 
kO  =  7.2000E-is  *exp( 
7BS.O/T) 
k2  =  4.1000E-l6  *  exp(  1440.0/T) 
k3  = 
72S.O/T) 

l.9000E-33  *  exp( 

(1  +  k3[M]/k2J},  where 

380.0/T) 
k(  47)  = 
l.3000E-12  *  exp( 
230.0/T) 
k(  48)  =  4.6000E-ll  *  exp( 
k(  49)  is  a  falloff  expression  using: 

=  3.00QOE-31  *  (T/300)**(-3.30) 
l.SOOOE-12  *  (T/300)**(  0.00) 

kO 
kinf  = 
F  =  0.60, 

n  =  1.00 

l.SOOOE-13  *  (1.0  +  0.6*Pressure) 

-S40.0/T) 
-380.0/T) 
-380.0/T) 
411.0/T) 
S04.0/T) 
549.0/T) 
322.0/T) 
116.0/T) 

k(  SO)  = 
k(  Sl)  =  2.8300E+Ol  *  (T/300)**(  2.00)  *exp(  -1280.0/T) 
k(  S2)  =  1.2330E-12  *  (T/300)**(  2.00)  *exp( 
-444.0/T) 
l.S900E-ll  *  exp( 
k(  S3)  = 
k(  S4)  = 
l.7300E-ll  *  exp( 
k(  SS)  =  3.6400E-ll  *  exp( 
k(  S6)  =  2.lSOOE-12  *  exp( 
k(  S7)  =  S.3200E-12  *  exp( 
k(  SB)  =  1.0700E-ll  *exp( 
k(  S9)  =  2.lOOOE-12  *  exp( 
k(  60)  =  l.8900E-ll  *  exp( 
k(  61)  =  4.0000E-11 
k(  62)  =  9.0000E:-01  *  k(  61) 
k(  63)  =  9.0000E-12 
k(  64)  =  6.8700E-12  *exp( 
l.2000E-ll  *  exp( 
k(  6S)  = 
k(  66)  = 
l.lSOOE-11 
k(  67)  = 
l.7000E:-ll 
k(  68)  =  2.BOOOE-11 
l.OOOOE-11 
k(  69)  = 
k(  70)  =· 
l.OOOOE-11 
k(  71)  = 
l.OOOOE-11 
k(  72)  =  6.16SOE-13  *  (T/300)**(  2.00)  *exp( 
k(  73)  = 

2S6.0/T) 
-74S.O/Tl 

l.SSOOE-11  *  exp( 

-S40.0/T) 

-444.0/T) 

8-56 

{l.68671E-12} 
{4.87144E-12} 

{l.95397E::_38}. 
{3.18213E-17} 
{2.Bl225E-ll} 
{4.03072E-16} 
{2.SOOOOE-12} 
{1.26440E-12} 

{5.47034E-02} 
{2.00000E-21} 
{l.1488SE-ll} 

{1.47236E-l3} 

{4.65309E-12} 
{9.95294E-ll} 
{ 8. BB848E-13}  ·:: 

{2.40000E-13} 
{3.80672E-Ol} 
{2.74210E-13} 
{2.S9669E-12} 
{4.83334E-12} 
{l.01696E-ll} 
{8.53916E-12} 
{2.BB684E-ll} 
{6.75269E-ll} 
{6.1871SE-12} 
{2.78943E-ll}. 
{ 4. OOOOOE-11} .... 
{3.60000E-ll} 
{9.00000E-12} 
{1. 62197E-ll} 
{9.8S020E-13} 
{1. lSOOOE-11} 
{l.70000E-ll} 
{2.BOOOOE-11} 
{1. OOOOOE-11} 
{l.OOOOOE-11} 
{l. OOOOOE-11} 
{l.3710SE-13} 
{2.53137E-12};. 

Table 8A-7.  RADM2 and RADM2_AQ Mechanisms 
k(  74)  =  2.5500E-ll  *  exp( 
409,0/T) 
k(  75)  =  2.8000E-12  *  exp( 
181.0/Tl 
k(  76)  =  l.9500E+l6  *  exp(-13543.0/T) 
k(  77)  =  4.7000E-12 
k(  78)  =  l.9500E+l6  *  exp(-13543.0/T) 
k(  79)  =  4.2000E-12  *  exp( 
180.0/Tl 
k(  80)  =  4.2000E-12  *  exp( 
180.0/T) 
k(  81)  =  4.2000E-12  *  exp( 
180.0/Tl 
k(  82)  =  4.2000E-12  *  exp( 
180.0/T) 
180.0/T) 
k(  83)  =  4.2000E-12  *  exp( 
k(  84)  =  4.2000E-12  *  exp( 
180.0/Tl 
k(  85)  =  4.2000E-12  *  exp( 
180.0/T) 
k(  86)  =  4.2000E·12  *  exp( 
180. O/'l') 
k(  87)  =  4.2000E-12  *  exp( 
180. O/'l') 
k(  88)  =  4.2000E-12  *  exp( 
180.0/T) 
k(  89)  =  4.2000E-12  *  exp( 
180.0/T) 
k(  90)  =  4.2000E-12  *  exp( 
180.0/T) 
k(  91)  =  4.2000E-12  *  exp( 
180.0/T) 
k(  92)  =  4.2000E-12  *  exp( 
180. O/T) 
k(  93)  =  6.0000E-13  *  exp(  -2058.0/Tl 
k(  94)  =  1.4000E-12  *  exp(  -1900.0/T) 
k(  95)  =  6.0000E-13  *  exp(  -2058.0/T) 
k(  96)  =  1.4000E-12  *  exp(  -1900.0/T) 
k(  97)  =  l.4000E-12  *  exp(  -1900.0/Tl 
k(  98)  =  2.2000E-ll 
k(  99)  =  2.0000E-12  *  exp(  -2923.0/T) 
k(lOO)  = 
l.OOOOE-11  *  exp(  -1895.0/T) 
k(lOl)  =  3.2300E·ll  *  exp( 
-975.0/T) 
k(l02)  =  5.8100E-13 
k(103)  =  1.2000E-14  *exp(  -2633.0/T) 
k  (104)  =  l.3200E-14  *  exp(  -2105.0/T) 
k(105)  =  7.2900E-15  *  exp(  -1136.0/T) 
k(106)  =  l.2300E-14  *exp(  -2013.0/T) 
k(l07)  =  7.7000E-14  *  exp(  1300. O/T) 
k(108)  =  7.7000E-14  *  exp(  1300.0/T) 
k(l09)  =  7.7000E-14  *exp(  1300.0/T) 
k (110)  =  7.7000E-14  *  exp(  1300.0/T) 
k(lll)  =  7.7000E-14  *  exp(  1300.0/T) 
k (112)  =  7.7000E-14  *  exp(  1300. O/T) 
k(113)  =  7.7000E-14  *  exp(  1300. O/T) 
k(114)  =  7.7000E-14  *  exp(  1300. O/T) 
k(115)  =  7.7000E-14  *  exp(  1300. O/T) 
k(ll6)  =  7.7000E-14  *  exp(  1300.0/T) 
k(ll7)  =  7.7000E-14  *  exp(  1300.0/T) 
k (118)  =  7.7000E-14  *  exp(  1300.0/T) 
k(119)  =  7.7000E-14  *  exp(  1300. O/T) 
k  (120)  =  7.7000E-14  *  exp(  1300. O/T) 
k  (121)  =  1.9000E-13  *  exp( 
220.0/T) 
k  (122)  =  l.4000E-13  *  exp( 
220.0/T) 
k(l23)  =  4.2000E-14  *  exp( 
220.0/Tl 
k  (124)  =  3.4000E-14  *  exp( 
220.0/T) 
k (125)  =  2.9000E-14  *  exp( 
220,0/T) 
k (126)  = 
220.0/T) 
l.4000E-13  *  exp( 
k (127)  = 
220.0/T) 
l.4000E-13  *  exp( 
k (128)  =  1.7000E-14  *  exp( 
220.0/T) 
k(129)  =  1.7000E-14  *  exp( 
220.0/T) 
k  (130)  =  9.6000E-13  *  exp( 
220.0/T) 
l.7000E-14  *  exp( 
k  (131)  = 
220.0/T) 
k  (132)  = 
l.7000E-14  *  exp( 
220. 0/'l'l 
k(133)  =  9.6000E-13  *  exp( 
220.0/T) 
k(134)  =  l.7000E-14  *  exp( 
220. O/T) 

8-57 

{1.00601E-10} 
{5.13974E-12} 
{3.57235E-04} 
{4.70000E-12} 
{3.57235E-04} 
{7.68378E-12} 
{7.68378E-12} 
{7.68378E-12} 
{7.68378E-12} 
{7.68378E-12} 
{7.68378E-12} 
{7.68378E-12} 
{7.68378E-12} 
{7.68378E-12} 
{7.68378E-12} 
{7.68378E-12} 
{7.68378E-12} 
{7.68378E-12} 
{7.68378E-12} 
{6.01030E-16} 
{2.38307E-15} 
{6.01030E-16} 
{2.38307E-15} 
{2.38307E-15} 
{2.20000E-11} 
{1.09940E-16} 
{ 1. 73099E-14} 
{1.22539E-12} 
{5.81000E-13} 
{1. 74559E-18} 
{1.12933E-17} 
{l.61125E-16} 
{l.43295E-17} 
{6.04038E-12} 
{6.04038E-12} 
{6.04038E-12} 
{6.04038E-12} 
{6.04038E-12} 
{6.04038E-12} 
{6.04038E-12}. 
{6.04038E-12} 
{6.04038E-12} 
{6.04038E-12} 
{6.04038E-12} 
{6.04038E-12} 
{6.04038E-12} 
{6.04038E-12} 
{3.97533E-13} 
{2.92919E-13} 
{8.78758E-14} 
{7.11376E-14} 
{6.06762E-14} 
{2.92919E-13} 
{2.92919E-13} 
{3.55688E-14} 
{3.55688E-14} 
{2.00859E-12} 
{3.55688E-14} 
{3.55688E-14} 
{2.00859E-12} 
{3.55688E-14} 

',II"  'II 

11 

II 

I 

Table 8A-7.  RADM2 and RADM2_AQ Mechanisms 
k(l.35)  =  3.4000E-l.3  *  exp( 
k(l.36)  = 
l..OOOOE·l.3  *  exp( 
k(l.37)  =  8.4000E-l.4  *  exp( 
k (l.38)  =  7.2000E-l.4  *  exp( 
k(l.39)  =  3.4000E-l.3  *exp( 
k(l.40)  =  3.4000E-l.3  *  exp( 
k(l.4l.)  =  4.2000E-l.4  *  exp( 
k(l.42)  =  4.2000E-l.4  *  exp( 
l..l.900E-l.2  *  exp( 
k(l.43)  = 
k(l.44)  =  4.2000E-l.4  *  exp( 
k(l.45)  =  4.2000E-l.4  *  exp( 
k(l.46)  = 
l..l.900E-l.2  *  exp( 
k(l.47)  =  4.2000E-l.4  *  exp( 
k(l.48)  =  3.6000E-l.6  *  exp( 
k(l.49)  =  7.7000E-l.4  *  exp{ 
l..7000E-l.4  *  exp( 
k(l.50)  = 
k(l.5l.)  =  4.2000E-l.4  *  exp( 
k(l.52)  =  3.6000E-l.6  *  exp( 
k(l.53)  =  4.2000E-l.2  *  exp( 
k(l.54)  =  4.2000E-l.2  *  exp( 
k(l.55)  =  7.7000E-l.4  *  exp( 
k(l.56)  = 
l.7000E-l.4  *  exp( 
k(l.57)  =  4.2000E-l.4  *  exp( 
k(l.58)  =  3.6000E-l.6  *exp( 
=================:======~=.~1.~~=:;================='.===•======.=====m•m:•i=f.,,~m=•mm=csi,~r:· ,11, ,  

{7.l.l.376E-l.3} 
{2.09228E-l.3}  '' 
{ l.. 75752E-l.3} 
{ J.. 50644E.:.J.3}  11 
{7 .l.l.376E·l.3}  !' 
{7.l.l.376E-l.3} 
{8.78758E~l.4} 
{8.78758E-l.4} 
{2.4898l.E-l.2} 
{ 8. 78758E·l.4}  ... 
{8.78758E·l.4} 
{2.4898l.E-l.2} 
{8.78758E-l.4} 
{7.5322l.E-l.6} 
{6.04038E-l.2} 
{3.55688E-l.4} 
{8.78758E-14} 
{7. 5322l.E·l.6}  1 'II'" 
{7.68378E-l.2} 
{7.68378E-l.2} 
{6.04038E-l.2}  11111 
{3.55688E-l.4} 
{8.78758E-14} 
{7.53221E-16} 

220.0/T) 
220.0/T) 
220.0/T) 
220.0/T) 
220.0/T) 
220.0/T) 
220.0/T) 
220. O/T) 
220.0/T) 
220.0/T) 
220.0/T) 
220.0/T) 
220.0/T) 
220.0/T) 
l.300. O/T) 
220.0/T) 
220.0/T) 
220.0/T) 
l.80. O/T) 
180.0/T) 
l.300. O/T) 
220.0/T) 
220. O/T) 
220.0/T) 

1 'il 

'',,;11 

I 

I 

I 

Table 8A-8.  RADM2_AE and RADM2_AE_AQ Mechanisms 

Reaction  List 
>-----------------.-----------------------------------------------------------------< 

+ 

NO 

1)  N02 
2)  03 
3}  03 
4}  HONO 
S}  HN03 
6}  HN04 
7)  N03 
8)  N03 
9)  H202 
10)  HCHO 
11)  HCHO 
12)  ALD 
13}  OP1 
14)  OP2 
15)  PAA 
16)  KET 
17}  GLY 
18}  GLY 
19)  MGLY 
20)  DCB 
21)  ONIT 

+  hv 
+  hv 
+  hv 
+  hv 
+  hv 
+  hv 
+  hv 
+  hv 
+  hv 
+  hv 
+  hv 
+  hv 
+  hv 
+  hv 
+  hv 
+  hv 
+  hv 
+  hv 
+  hv 
+  hv 
+  hv 

"+ 

(02] 

+  [H20] 

+ 

(02] 

22)  03P 
23)  03P 
24)  01D 
25)  01D 
26}  01D 
27}  03 
28)  03 
29)  03 
30)  H02 
31)  H02 
32)  HN04 
33}  H02 
34)  H02 
35}  H202 
36)  NO 
37)  NO 
38)  03 
39)  N03 
40)  N03 
41}  N03 
42)  N03 
43)  N205 
44)  N205 
45)  HO 
46)  HO 
47)  HO 
48)  HO 
49)  HO 
so}  co 
51)  HO 
52)  ETH 
53)  HC3 

54)  HCS 
ss}  HC8 
56)  OL2 
57)  OLT 

[H20] 

+ 
[M] 
+  N02 
+  [N2] 
+  (02] 
+ 
+  NO 
+  HO 
+  H02 
+  NO 
+  N02 

+  H02 
+  H02 
+  HO 
+  HO 
+  NO 
+  N02 
+  NO 
+  N02 
+  H02 
+  N02 

[H20] 

+ 
+  N02 
+  HN03 
+  HN04 
+  H02 
+  802 
+  HO 

+  HO 
+  HO 

+  HO 
+  HO 
+  HO 
+  HO 

--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 

--> 
--> 
--> 
--> 

--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 

+ 

03P 
01D 
03P 
HO 
HO 
H02 
NO 
N02 
2.000*HO 
co 
H02 
M02 
HCHO 
ALD 
M02 
AC03 
0.130*HCHO 
0.4SO*HCHO 
AC03 
0.980*H02 
0.200*ALD 
N02 
03 
NO 
03P 
03P 

2.000*HO 
N02 
H02 
HO 
N02 
HN04 
H02 
H202 
H202 
H02 
HONO 

2.000*N02 
N03 
2.000*N02 

NO 
HN03 
N205 
N02 

2.000*HN03 
HN03 
N03 
N02 

SULF 
H02 
M02 
ETHP 
0.830*HC3P 

+  0.075*ALD 
HCSP 
HC8P 
OL2P 
OLTP 

8.:.59 

+ 
+ 
+ 

+ 

NO 
N02 
N02 

03P 

H02 
H02 
H02 
H02 
HO 
ETHP 

+ 
+ 
+ 
+ 
+ 
+ 
+  1:870*CO 
+  1.SSO*CO 
+ 
H02 
+  0.020*AC03 
+  O.BOO*KET 

+ 
+ 
+ 
+ 

co 
co 
HO 
HO 

+  0.800*H02 
co 
+ 
+ 
TC03 
+ 
H02 

+ 

+ 

+ 

+ 

+ 

HO 

N02 

N02 

N03 

H02 

+ 

SULAER 

+  0.170*H02 
+  0.02S*KET 
+  0.2SO*X02 
+  0.750*X02 

+  0.009*HCHO 

+ 

HC8AER 

Table 8A-8.  RADM2  AE and RADM2  AE  AQ Mechanisms 

' 

·~ 

-

I 
I 

-

--> 
--> 

CLIP 
O. 750*'.l"OLP 

.+ 
+  0.250*CSL 

OLIAER 

+  0.250*H02 

,,·111111 

11·,1111 

TOLAER 

0.830*XYLP 

XYLAER 

+  O.l.70*CSL 

+  O.l.70*HQ2 

O.l.OO*H02 

+  0.900*X02 

+  0.900*TC<;l3 

{  58}  OLI 
{  59}  TOL 

60}  XYL 

+  HO 
+  HO 

+  HO 

61.}  CSL 

+  Hp 

{  62}  CSL 
{  63}  HCHO 
{  64}  ALD 
{  65}  KET 
{  66}  GLY 
{  67}  MGLY 
{  68}  DCB 
{  69}  OPl. 
{  70}  OP2 
{  71}  PAA 
{  72}  ?AN 
{  73}  ONIT 
{  74}  ISO 
{  75}  AC03 
{  76}  PAN 
{  77}  TC03 
{  78}  TPAN 
{  79}  M02 
{  so}  HC3P 

{  Bl.}  HC5P 

+  HO 
+,HO 
+  HO 
+  HP 
+  HO 
+  HO 
+  HO 
+  HO 
+  HO 
+  HO 
+  Hp 
+  ~p 
+  Hp 
+  N02 

I 

+  Np2 

+  NO 
+  NO 

+  NO 

82}  HCBP 

+  NO 

83}  OL2P 

84}  OLTP 

+  NO 

' 

+  ~o 

85}  OLIP 

+  l~O 

86}  AC03 
87}  TC03 

' 

+  ~o 
+  NO 

88}  TOLP 

89}  XYLP 

{  90}  ETHP 
{  91.}  KETP 
{  92}  OLN 
{  93}  HCHO 
{  94}  ALD 
{  95}  GLY 
{  96}  MGLY 
{  97}  DCB 
{  98}  CSL 

{  99}  OL2 
{l.00}  OLT 
{l.Ol.}  OLI 
{l.02}  ISO 
{l.03}  OL2 

t 

l\iO 

+  l\iO 

+  N:O 
+  l\iO 
+  l\iO 
+  l'!03 
+  N:03 
+  N:03 
+  ~03 
+  ~03 
+  l'!03 

,. 

+  l'!03 
+  l'f03 
+  1i03 
+  1'!'03 
+  q3 

+ 

+ 

+ 

--> 

--> 

--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 

CSLAER 
CSL 
H02 
AC03 
KETP 
H02 
1).C03 
TC03 

0.500*M02 
0.500*HC3P 
AC03 
HCHO 
Hc:JP 
P:LTP 
J?llN 
AC03 
'TPAN 
TC03 
HCHO 
0.750*ALD 

+  0.036*0NIT 

--> 

--> 

0.380*ALD 
+  0.920*N02 
0.350*ALD 

+  0.240*0NIT 
l.. 600*HCHO 
+  0.20.0~ALD 
ALD 
N02 
H02 
.+  O.l.OO*KET 
!>102 
N02 

.+ 

--> 

-->. 

--> 

-->. 
--> 

. +  0. l.l.O*MGLY 

~~> 

--> 

--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 

--> 
--> 
--> 
-.-> 
.--> 

+  2.000*X02 
N,02 
+  O.l.60*GLY 
N02 
+  0.806*DCB 
ALD 
MGLY 
HCHO 
H02 
AC,P3 
HN03 
HN03 
HN03 
HN03 

+  0.500*CSLAER 

OLN 
OLN 
OLN 
OLN 
HCHO 
+  O.l.20*H02 

8-60 

+ 

co 

+  2.000*CO 
co 
+ 

+  0.500*HCHO 
+  0.500*ALD 

+  O.SOO*HO 
+  O.SOO*HO 

+ 
+ 

+ 

N03 
N02 

N02 

N02 
+ 
+ 
H02 
+  0.250*KET 
+  0.964*N02 
+  0.690*KET 
+  0.920*H02 
+  l.. 060*KET 
+  0.760*N02 
+ 
H02 

+ 

X02 
,,, 

:1': 
'""':1 

N02 

+ 
+  0.090*HCHO 
+  0.964*H02 
+  0.080*0NIT 

+  0.040*HCHO 
+  0.760*H02 
+ 
NQ2 

+ 

HCHO 

+ 

H02 

+  0.2110·~£,!"0 

+  0.890*GLY 
+  0.950*CO 

+  O.l.?O*f1<;,:;LY 

+  0.450*MGLY 

+ 
N02 
+ 
H02 
+  2.000*N02 
co 
+ 

+  2.000*CO 
co 
+ 

+  0.500*CSL 

+  l..450*ALD 
+ 
N,P2 
+ 
N02 
+  0.920*H02 
+  0.050*AC03 

+ 
H02 
+  0.700*DCB 
+ 
H02 

+ 
+ 
+ 
+ 
+ 
+ 
+ 
+ 
+ 

+ 

H02 
N02 
ALD 
HN03 
HN03 
H02 
AC03 
TC03 
XN02 

OLIAER 

+  0.400*0RAl. 

+  0.420*CO 

'"I' 

:111i,11:1:;.' 

,11 

;1 

'',111, 

Table 8A-8.  RADM2_AE and RADM2~AE_AQ Mechanisms 

EP N600/R-99/030 

{104}  OLT 

+  03 

{105}  OLI 

+  03 

{106}  ISO 

+  03 

{107}  H02 
{108}  H02 
{109}  H02 
{110}  H02 
{111}  H02 
{112}  H02 
{113}  H02 
{114}  H02 
{115}  H02 
{116}  H02 
{117}  H02 
{118}  H02 
{119}  H02 
{120}  H02 
{121}  M02 
{122}  M02 
{123}  M02 

+  M02 
+  ETHP 
+  HC3P 
+  HC5P 
+  HC8P 
+  OL2P 
+  OLTP 
+  OLIP 
+  KETP 
+  AC03 
+  TOLP 
+  XYLP 
+  TC03 
+  OLN 
+  M02 
+  ETHP 
+  HC3P 

{124}  M02 

+  HCSP 

{125}  M02 

+  HC8P 

{126}  M02 
{127}  M02 
{128}  M02 

{129}  M02 
{130}  M02 

+  OL2P 
+  OLTP 
+  OLIP 

+  KETP 
+  AC03 

{131}  M02 

+  TOLP 

.  {132}  M02 

+  XYLP 

{133}  M02 

+  TC03 

{134}  M02 

+  OLN 

{135}  ETHP 

+  AC03 

{136}  HC3P 

+  AC03 

{137}  HC5P 

+  AC03 

{138}  HC8P 

+  AC03 

{139}  OL2P 

+  AC03 

{140}  OLTP 

+  AC03 

{141}  OLIP 

+  AC03 

+ 

+ 

+ 

H02 

0.770*HCHO 

+  0.410*ALP 

+  0.750*KET 

H02 

0,800*HCHO 

+  0.460*ALD 

+  1.390*KET 

H02 

+  O.SOO*ALD 
+  0,200*0RA2 
+  0.lOO•HO 
+  0.720*ALD 
+  0.060*0RA1 
+  0.140*HO 

+  0,500*ALD 
+  0.200*0RA2 
+  O.lOO*HO 

+  0.330*CO 
+  0,230*H02 

+  O.lOO*KET 
+  0.290*0RA2 
+  0.310*M02 

+  0.330*CO 
+  0.230*H02 

H02 
+ 
H02 
+ 
+  0,770*ALD 

+  0.750*ALD 
+  0.260*KET 

+  0,350*ALD 
+  0.7SO*ALP 
+  0.725*ALD 

+ 
+ 
+ 

H02 
H02 
H02 

+  0.7SO*MGLY 
+  O.SOO*HO~ 

H02 
+ 
+  O.SOO*M02 

+  O.l,70*MGLY 
+  2.000•H02 
+  0,450*MGJ;,Y 

+  0.160*GLY 

+  0.806*PCB 

+  0.445*GLY 
+  0.025*ACQ3 
X02 
+ 
+  O.SOO*H02 

+  0. 055*MG;i:..Y 
+  0.460*H02 

+ 

ALD 

+  Q.SOO*H02 

+.  0. SOO*M02 

+  0,260*KET 
+  O.SOO*ORA2 
+  0 .. 750*KJ;lT 
+  O,SOO*ORA2 
+  1,390*KET 
+  0,500*0RA2 
+  0,600*ALD 
+  0.500*0RA2 
+  O.SOO*HCHO 
+  0,SOO*ORA2 
+  O.SSO*I<ET 

+  0,SOO*H02 

+  0.500*H02 

+  O.SOO*H02 

+  O.SOO*H02 

+  O,SOO*H02 

+  0.140*HCHO 

--> 

--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 

--> 

--> 

--> 
--> 
--> 

--> 
--> 

--> 

--> 

--> 

--> 

0.530*HCHO 
+  0.200*0RA1 
.+  0.220*M02 

--> 

0,180*HCHO 

+  o.23o•co 
+  0,260*H02 
+ 

OLIAi;:R 

0.530*HCHO 
+  0.200*0RA1 
+  0.220*M02 
OP1 
OP2 
OP2 
OP2 
OP2 
OP2 
OP2 
OP2 
OP2 
PAA 
OP2 
OP2 
OP2 
ONIT 
1.500*HCHO 
0,750*HCHO 
O. 840*HCHO. 

1. 550*HCHO 
1.250*HCHO 
0,890*HCHO 

+  0.550*KET 

0.7SO*HCHO 
HCHO 
+  O.SOO*ORA2 
HCHO 
+  0.700*PCB 
.HCHO 

+  2,000*H02 

0.500*HCHO 
+  O.SOO*ORA2 
+  0.475-l<CO 

--> 

1.7SO*HCHO 

--> 

--> 

--> 

--> 

+ 

N02 
ALP 

+  0.500*0RA2 

0.770*ALD 
+  0,500*M02 
0.4iO*ALD 
+  0.500*M02 
0.460*ALD 
+  o.::.oo•Mo2 

--> 

0.800*HCHO 

+  0.500*M02 
ALP 
+  0.500*M02 
0.725*ALD 

--> 

--> 

Table 8A-8.  RADM2_AE and RADM2_AE_AQ Mechanisms 

I 

{142}  KETP 

' 

+  AC03 

(143}  AC03 
{144}  AC03 

' 

+  ~C03 
+  °l'.OLP 

{145}  AC03 

' 

+  ~p 

{146}  AC03 

' 

+  TC03 

(147}  AC<;l3 

1 

+  qLN 

--> 

--> 
--> 

--> 

--> 

+  0.500*H02 

MGLY 
+  0.500*0RA2 

2.000*M02 
M02 
+  0.700*DCB 
M02 
H02 
M02 

+ 

+  O.l:J.O*MGLY 
+  2.000*X02 

--> 

+ 

HCHO 
N02 

+  0.500*M02 
+  0.500*H02 

+  0.500*0RA2 
+  O.SOO*M02 

+  0.170*MGLY 
+ 
+  0.450*MGLY 

H02 

+  0.160*GLY 

+  0.806*DCB 

+  0.920*H02 
+  0.050*AC03 

+  0.890*GLY 
+  o.9~~·c9 

+ 
ALD 
+  0.500*M02 
+  2.000*ALD 

+  O.SOO*ORA2 

+  2.000*N02 

'" 

2.000*HCHO 

.. , 

I 

+ 

H02 

{14e}  o~ 
(149}  X02 
{150}  X02 
{151}  X02 
{152}  X02 
{153}  X02 
{154}  XN02 
{155}  XN02 
(156}  XN02 
(157}  XN02 
{158}  xN02 
(159}  TERP 
(160}  TERP 
{161}  TERP 
>--------~----------------~--------------------------------------------------------< 

+q~ 
+  J102 
.+  Mo2 
+  AC03 
+  ~02 
+  1'f0 
+  N02 
+  1102 
+  1102 
+  AC03 
+  *o2 
+  HO 
+  1'l'03 
+  03 

--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 

TERPAER  + 
TERPAER  + 
TERPAER  + 

OP2 
HCHO 
M02 

N02 
ONIT 
OP2 
HCHO 
M02 

+ 

H02 

HO 
N03 
03 

Rate  Constant 
Rate  Expression 
mmmm•=======•===~====r=======m;:a;:a;::;::;::;::=ci=;:z;:;:;::=====·:;:========-====o::a===-ss••m••cs•••lill:lm•• 
,  scaled  by  l.OOOOOE+OO 
{ 0. OOOOOE.+00} ,··, 
k(  1)  uses  photo  table  N02_RADM88 
{ 0. OOOOOE+OO}  , ,, 
,  scaled  by  l.OOOOOE+OO 
k( 
2)  uses  photo  table  0301D_RADMBB 
,  scaled  by  1.00000E+OO 
{O.OOOOOE+OO} 
k(  3)  uses  photo  table  0303P_RADM8B 
,  scaled  by  1.00000E+OO 
{o.oooooE+oo} 
k(  4)  uses  photo  table  HONO_RADM88 
,  scaled  by  l.OOOOOE+OO 
{ 0. OOOOOE+OO}'' 
5)  uses  photo  table  HN03_RADMBB 
k( 
,  scaled  by  l.OOOOOE+OO 
{o.oooooE+oo} 
6)  uses  photo  table  HN04_RADMBB 
k( 
,  scaled  by  l.OOOOOE+OO 
k( 
7)  uses  photo  table  N03NO_RADM88 
{O.OOOOOE+oo} 
,  scaled  by  l.OOOOOE+OO 
{o.oooooE+oo} 
8)  uses  photo  table  N03N02_RADM88 
k( 
,  scaled  by  l.OOOOOE+OO 
{o.ooooo:s:+oo} 
9)  uses  photo  table  H202_RADM88 
k( 
,  scaled  by  l.OOOOOE+OO 
{O.OOOOOE+OO} 
k(  10)  uses  photo  table  HCHOmol_RADMBB 
{ 0. OOOOOE+OO}  ··· 
k(  11)  uses  photo  table  H~Orad_RADMBB  ,  scaled  by  1.00000E+OO 
,  scaled  by  1.00000E+OO 
k(  12)  uses  photo  table  ALD_RADMBB 
{ 0. OOOOOE+OO} "' 
(O.OOOOOE+OO} 
,  scaled  by  1.00000E+OO 
k(  13)  uses  photo  table  MHP_RADMBB 
{0.00000E+OO} 
,  scaled  by  1.00000E+OO 
k(  14)  uses  photo  table  HOP_RADMBB 
(O.OOOOOE+oo} 1 
,  scaled  by  1.00000E+OO 
k(  15)  uses  photo  table  PAA_RADM88 
,  scaled  by  l.OOOOOE+OO 
{O.OOOOOE+OO} 
k(  16)  uses  photo  table  KETONE_RADMBB 
{O.OOOOOB+oo} 
,  scaled  by  1.00000E+OO 
k(  17)  uses  photo  table  GLYform_RADMBB 
,  scaled  by  1.00000E+OO 
(O.OOOOOB+OO} 
k(  18)  uses  photo  table  GLYmol_RADMBB 
{O.OOOOOE+OO} 
,  scaled  by  1.00000E+OO 
k(  19)  uses  photo  table  MGLY_RADMBB 
{o.ooooo:s:+oo} 
,  scaled  by  1.00000E+OO 
k(  20)  uses  photo  table  UDC_RADMBB 
{ 0. OOOOOB+OO}  ' 
,  scaled  by  1.00000E+OO 
k(  21)  uses  photo  table  ORGNIT_RADMB8 
k(  22)  =  6.0000E-34  *  (T/300)**(-2.30) 
{6.09302B-34} 
120.0/T) 
k(  23)  =  6.5000E-12  *  exp( 
{9.72293E-12} 
{2.60365E-11} 
110.0/T) 
.. 
k(  24) 
1.BOOOE-11  *  exp( 
{4.04730B·l.1} 
70.0/T) 
k(  25) 
..  3.2000E-11  *  exp( 
{2.20000B-10} 
k(  26)  =  2.2000E-10 
{1.82272E-14} 
k(  27)  =  2.0000E-12  *  exp(  -1400.0/T) 
k(  28)  =  1.6000E-12  *  exp( 
(6.82650B-14} 
-940.0/T) 
k(  29)  =  1.lOOOE-14  *  exp( 
{2.05452E·l5} 
-500.0/T) 

••• 

i 

! 

1,"' 
I• 

Table 8A-8.  RADM2_AE and RADM2_AE_AQ Mechanisms 

k(  30) 
k(  31.)  is 

240.0/T) 
3.7000E-12  *exp( 
a  falloff  expression  using: 

{8.27883E-l.2} 
{l..39058E-12} 

EPA/600/R.-99/030 

kO 
kinf  = 
F  =  0.60, 

1.8000E-31  *  CTi300)**(-3.20) 
4.7000E-12  *  (T/300)**(-1.40) 

n  =  1.00 

k(  32)  =  k(  31)  I  Keq,  where  Keq  = 
k(  33)  is  a  special  rate  expression 

2.lOOE-27  *  exp(  10900.0/T) 

of  the  form: 

{8.62399E-02} 
{3.01634E-12} 

k  =kl+  k2(M],  where 
kl.  =  2.2000E-13  *  exp( 
k2  =  1.9000E-33  *  exp( 

620.0/T) 
980.0/T) 

k(  34)  is  a  special  rate  expression  of  the  form: 

{6.7890SE-30} 

k  =kl+  k2(MJ,  where 
kl=  3.0800E-34  *exp(  2820.0/T) 
k2  =  2.6600E-54  *exp(  3180.0/T) 

k(  35)  =  3.3000E-12  *  exp( 
-200.0/T) 
k(  36)  is  a  falloff  expression  using: 

=  7.0000E-31.  *  (T/300)**(-2.60) 
1.SOOOE-11  *  (T/300)**(-0.50) 

kO 
kinf  = 
F  =  0.60, 

n  =  1.00 

k(  37)  =  3.3000E-39  *  exp( 
k(  38)  =  1.4000E-13  *  exp( 
k(  39)  =  1.7000E-11  *  exp( 
k(  40)  =  2.SOOOE-14  *  exp( 
k(  41)  = 
k(  42)  is  a  falloff  expression  using:· 

530.0/T) 
-2500.0/T) 
150.0/T) 
-1230.0/T) 

2.SOOOE-12 

kO 
=  2.2000E-30  *  (T/300)**(-4.30) 
kinf  =  1.SOOOE-12  *  (T/300)**(-0.50) 
F  =  0.60, 

n  =  1.00 

k(  43)  =  k(  42) 
k(  44)  =  2.0000E-21 
k(  45)  is  a  falloff  expression  using: 

/  Keq,  where  Keq  = 

l.lOOE-27  *  exp(  l.l.200.0/T) 

kO 
=  2.6000E-30  *  (T/300)**(-3.20) 
kinf  =  2.4000E-11  *  (T/300)**(-1.30) 
F  =  0.60, 

n  =  1.00 

k(  46)  is  a  special  rate  expression  of  the  form: 

(1  +  k3[M]/k2J},  where 

k  =  kO  +  {k3[M]  I 
kO  =  7.2000E-15  *  exp( 
785.0/T) 
k2  =  4.lOOOE-16  *  exp(  1440.0/T) 
k3  =  1.9000E-33  *  exp( 
725.0/Tl 
380.0/T) 
k(  47)  =  1.3000E-12  *.exp( 
k(  48)  =  4.6000E-11  *  exp( 
230.0/T) 
k(  49)  is  a  falloff  expression  using: 

=  3.0000E~31  *  (T/300)**(-3.30) 
1.SOOOE-12  *  (T/300)**(  0.00) 

kO 
kinf  = 
F  =  0.60, 

n  =  1.00 

k(  SO)  =  1.SOOOE-13  *  (1.0  +  0.6*Pressure) 
k(  51)  =  2.8300E+Ol  *  (T/300)**(  2.00)  *exp(  -1280.0/T) 
k(  52)  =  1.2330E-12  *  (T/300)**(  2.00)  *exp( 
-444.0/T) 
k(  53)  =  1.5900E-11  *  exp(  .  -540.0/T) 
k(  54)  =  1.7300E-ll  *exp( 
-380.0/T) 
-380.0/T) 
k(  55)  =  3.6400E-11  *exp( 
411.0/T) 
k(  56)  =  2.lSOOE-12  *exp( 
504.0/T) 
k(  57)  =  5.3200E-12  *exp( 
549.0/T) 
k(  58)  =  1.0700E-11  *exp( 
k(  59)  =  2.lOOOE-12  *exp( 
322.0/T) 
k(  60)  =  1.8900E-11  *  exp( 
116.0/T) 
k(  61)  =  4.0000E-11 
k(  62)  =  9.0000E-01  *  k(  61) 
k(  63)  =  9.0000E-12 
k(  64)  =  6.8700E-12  *  exp( 
l.2000E-11  *  exp( 
k(  65)  = 

256.0/T) 
-745.0/T) 

8-63 

{1. 68671.E-12} 
{4.87l.44E-12} 

{1.95397E-38} 
{3.18213E-17} 
{2.81225E-11} 
{4.03072E-16} 
{2.SOOOOE-12} 
{1.26440E-12} 

{S.47034E-02} 
{2.00000E-21} 
{1.1488SE-11} 

{1.47236E-13} 

{4.65309E-12} 
{9.95294E-11} 
{8.88848E-l.3} 

{2.40000E-13} 
{3.80672E-Ol} 
{2.74210E-13} 
{2.59669E-12} 
{4.83334E-12} 
{1.01696E-11} 
{8.539l.6E-l.2} 
{2.88684E-11} 
{6.75269E-11} 
{6.1871.SE-12} 
{2.78943E-11} 
{4.00000E-11} 
{3.60000E-11} 
{9.00000E-12} 
{1.62197E-11} 
{9.85020E-13} 
-444.0/T) 

Table 8A-8.  RADM2_AE and RADM2_AE_AQ Mechanisms 
k(  66)  =  l.1500E-ll 
k(  67)  =  1.7000E-ll 
k(  68)  =  2.8000E-ll 
k(  69)  =  1.0000E-11 
k(  70)  =  1.0000E-11 
k(  71)  =  1.0000E-11 
k(  72)  =  6.1650E-13  *  (T/300) ** (  2. 00)  *  exp( 
k(  73)  =  1.5500E-ll  *  exp( 
-540.0/T) 
k(  74)  =  2.5500E-ll  *  exp( 
409.0/T) 
k(  75)  =  2.8000E-12  *  exp( 
181. O/T) 
k(  76)  =  1.9500E+l6  *  exp(-13543.0/T) 
k(  77)  =  4.7000E-12 
k(  78)  =  1.9500E+l6  *  exp(-13543.0/T) 
k(  79)  =  4.2000E-12  *  exp( 
180.0/T) 
k(  80)  =  4.2000E-12  *  exp( 
180.0/T) 
k(  81)  =  4.2000E-12  *  exp( 
180.0/T) 
k(  82)  =  4.2000E-12  *  exp( 
180.0/T) 
k(  83)  =  4.2000E-12  *  exp( 
180. O/T) 
k(  84)  =  4.2000E-12  *  exp( 
180.0/T) 
k(  85)  =  4.2000E-12  *  exp( 
180.0/T) 
k(  86)  =  4.2000E-12  *  exp( 
180.0/T) 
k(  87)  =  4.2000E-12  *  exp( 
180.0/T) 
k(  88)  =  4.2000E-12  *  exp( 
180.0/T) 
k(  89)  =  4.2000E-12  *  exp( 
180,0/T) 
k(  90)  =  4.2000E-12  *  exp( 
180. O/T) 
k(  91)  =  4.2000E-12  *  exp( 
180.0/T) 
k(  92)  =  4.2000E-12  *  exp( 
180.0/T) 
k(  93)  =  6.0000E-13  *  exp(  -2058.0/T) 
k(  94)  =  1.4000E-12  *  exp(  -1900.0/T) 
k(  95)  =  6.0000E-13  *exp(  -2058.0/T) 
k(  96)  =  l.4000E-12  *  exp(  -1900.0/T) 
l.4000E-12  *  exp(  -1900.0/T) 
k(  97) 
k(  98) 
2.2000E-ll 
k(  99)  =  2.0000E-12  *  exp(  -2923.0/T) 
k(lOO)  =  1.0000E-11  *  exp(  -1895.0/T) 
k(l01)  =  3.2300E-ll  *  exp( 
-975.0/T) 
k(102)  =  5.8100E-13 
k(103)  =  1.2000E-14  *  exp(  -2633.0/T) 
k(l04)  =  1.3200E-l.4  *  exp(  -2105.0/T) 
k(lOS)  =  7.2900E-15  *  exp(  -1136.0/T) 
k(106)  =  1.2300E-14  *exp(  -2013.0/T) 
k(l.07)  =  7.?000E-14  *  exp(  1300. O/T) 
k(108)  =  7.7000E-14  *  exp(  1300.0/T) 
k(109)  =  7.7000E-14  *  exp(  1300. O/T) 
k(llO)  =  7.7000E-14  *  exp(  1300.0/T) 
k(ll.l.)  =  7.7000E-14  *  exp(  1300. O/T) 
k(112)  =  7.7000E-14  *  exp(  1300.0/T) 
k(l.13)  =  7.7000E-14  *  exp(  1300. O/T) 
k(114)  =  7.7000E-14  *  exp(  1300.0/T) 
k(115)  =  7.7000E-14  *  exp(  1300. O/T) 
k(116)  =  7.7000E-14  *  exp(  1300.0/T) 
k(117)  =  7.7000E-14  *  exp(  1300.0/T) 
k(llB)  =  7.7000E-14  *  exp(  1300.0/T) 
k (l.19)  =  7.7000E-14  *  exp(  1300.0/T) 
k(120)  =  7.7000E-14  *  exp(  1300. O/T) 
k(l21)  =  1.9000E-13  *  exp( 
220. O/T) 
220.0/T) 
k(122)  =  1.4000E-13  *  exp( 
220.0/T) 
k(123)  =  4.2000E-14  *  exp( 
k(124)  =  3.4000E-14  *exp( 
220.0/T) 
220.0/T) 
k(125)  =  2.9000E-14  *  exp( 
k(126)  =  1.4000E-13  *  exp( 
220.0/T) 

I 
I 
I 

c 

c 

' 

{l.15000E-ll} 
{1.70000E-11} 
{2.80000E-ll} 
{1.00000E-11} 
{1.00000E-11} 
{1.00000E-11} 
{l.37105E-13} 
{2.53137E-12} 
{1.00601E-10} 
{5.13974E-12} 
{3.57235E-04} 
{4.70000E-12} 
{3.57235E-04} 
{7.68378E-12} 
{7.68378E-12} 
{7.68378E-12} 
{7.68378E-12} 
{7.68378E-12} 
{7.68378E-12} 
{7.68378E-12} 
{7.68378E-12} 
{7.68378E-12} 
{7 .68378E-12} 
{7.68378E-12} 
{7.68378E-12} 
{7.68378E-12} 
{7.6837BE-12} 
{6.0l.030E-l.6} 
{2.38307E-l.5} 
{6.01030E-16}, 
{2.38307E-15} 
{2.38307E-15} 
{2.20000E-11} 
{l. 09940E-16} 
{1.73099E-14} 
{1.22539E-12} 
{5.8l.OOOE-l.3} 
{1.74559E-1B} 
{l.12933E-17} 
{1.6l.l.25E-16} 
{1.43295E-17} 
{6.04038E-12} 
{6.0403BE-12} 
{6.04038E-12} 
{6.04038E-12} 
{6.04038E-12} 
{6.04038E-12} 
{6.04038E-l.2} 
{6.04038E-12} 
{6.04038E-12} 
{6.04038E-12} 
{6.04038E-12} 
{6.04038E-12} 
{6.04038E-12} 
{6.0403BE-12} 
{3.97533E-13} 
{2.92919E-13} 
{B.78758E-14} 
{7.11376E-14} 
{6.06762E-14} 
{2.92919E-13} 

Table 8A-8.  RADM2_AE and RADM2_AE_AQ Mechanisms 
k(127)  =  1.4000E-13  *  exp( 
220.0/T) 
k(128)  =  1. 7000.E-14  *  exp ( 
220.0/T) 
k(129)  =  1.7000E-14  *exp( 
220.0/T) 
k(130)  =  9.6000E-13  *  exp( 
220.0/T) 
k(131)  =  1.7000E-14  *  exp( 
220.0/T) 
k(132)  =  1.7000E-14  *  exp( 
220.0/T) 
k(l33)  =  9.6000E-13  *  exp( 
220.0/T) 
k.(134)  =  1.7000E-14  *  exp( 
220. O/T) 
k(135)  =  3.4000E-13  *exp( 
220.0/T) 
k(136)  =  1.0000E-13  *  exp( 
220.0/T) 
k  (137)  =  8.4000E-14  *  exp( 
220.0/T) 
k(138)  =  7.2000E-14  *  exp( 
220.0/T) 
k(139)  =  3.4000E-13  *  exp( 
220.0/T) 
k(140)  = '3.4000E-13  *exp( 
220.0/T) 
k  (141)  =  4.2000E-14  *  exp( 
220.0/T) 
k(l42)  =  4.2000E-14  *  exp( 
220.0/T) 
k(l43)  = 
l.1900E-12  *  exp( 
220.0/T) 
k(144)  =  4.2000E-14  *  exp( 
220.0/T) 
k(145)  =  4.2000E-14  *  exp( 
220.0/T) 
k(146)  = 
l.1900E-12  *  exp( 
220.0/T) 
k(147)  =  4.2000E-14  *  exp( 
220. O/T) 
k.(148)  =  3.GOOOE-16  *  exp( 
220.0/T) 
k(149)  =  7.7000E-14  *  exp(  1300.0/T) 
k(150)  =  1.7000E-14  *exp( 
220.0/T) 
k.(151)  =  4.2000E-14  *  exp( 
220.0/T) 
k(l52)  =  3.6000E-16  *exp( 
220.0/T) 
k(153)  =  4.2000E-12  *  exp( 
180.0/T) 
k(154)  =  4.2000E-12  *  exp( 
180.0/T) 
k(lSS)  =  7.7000E-14  *  exp(  1300.0/T) 
k(156)  =  1.7000E-14  *  exp( 
220.0/T) 
k(157)  =  4.2000E-14  *  exp( 
220.0/T) 
k(l58)  =  3.6000E-16  *  exp( 
220.0/T) 
k(159)  =  1.0000E+OO  *  k(  58) 
k(160)  =  1.0000E+OO  *  k.(101) 
k(161)  =  1.0000E+OO  *  k(lOS) 

{2.92919E-13} 
{3.55688E-14} 
{3.55688E-14} 
{2.00859E-12} 
{3.55688E-14} 
{3.55688E-14} 
{2.00859E-12} 
{3.55688E-14} 
{7.11376E-13} 
{2.09228E-13} 
{l.75752E-13} 
{ 1. 50644E-13} 
{7.11376E-13} 
{7 .. 11376E-13} 
{8.78758E-14} 
{8.78758E-14} 
{2.48981E-12} 
{8.78758E-14} 
{8.78758E-14} 
{2.48981E-12} 
{8.78758E-14} 
{7.53221E-16} 
{6.04038E-12} 
{3.55688E-14} 
{8.78758E-14} 
{7.53221E-16} 
{7.68378E-12} 
{7.68378E-12} 
{6.04038E-12} 
{3.55688E-14} 
{8.78758E-14} 
{7.53221E-16} 
{6.75269E-11} 
{1.22539E-12} 
{1.61125E-16} 

======================================================a=============cm=====~=== 

Table 8A-9.  RADM2_CIS1  and RADM2_CISl_AQ Mechanisms 

II 

l}  N02 

+ 

+ 
+ 
+ 

+ 

Reaction  List 
>- - - - - - - - - - - --- - - -1- - - - - - -.;:- - - -·- - - -- ------- - - - - - -.---- - - ---- - - - - - -- ------ -----:"1~--~,,,;.-:--------<  '·II 
{ 
{  2}  03 
{  3}  03 
{  4}  HONO 
{  s}  HN03 
{  6}  HN04 
7}  N03 
{ 
8}  N03 
{ 
{ 
9}  H202 
{  10}  HCHO 
{  11}  HCHO 
{  12}  ALD 
{  13}  OPl 
{  14}  OP2 
{  15}  PAA 
{  16}  KET 
{  17}  GLY 
{  18}  GLY 
{  19}  MGLY 
{  20}  DCB 
{  21}  ONIT 

,  03P 
OlD 
03P 
HO 
HO 
H02 
NO 
N02 
2.000*HO 
CO 
H02 
M02 
HCHO 
ALD 
M02 
AC03 
O.l30*HCHO 
0.4SO*HCHO 
~CQ3 

+  hv 
+  hv 
+  hv 
+  hv 
+  hv 
+  hv 
+  hv 
+  ~v 
+  hv 
+  hv 
+  hv 
+  hv 
+  hv 
+  hv 
+  hv 
+  hv 
+  hv 
+  hv 
+  hv 
+  hv 
+  ~v 

H02 
H02 
H02 
H02 
HO 
ETHP 

+ 
+ 
+ 
+ 
+ 
+ 
+  l.870*CO 
+  l.ssp•co 
+ 
HQf 
+  0.02!l~AC03 
+  O.BOO*KET 

--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
-->· 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 

+  O.BOO*H02 
co 
;j; 
T<;:03 
:I: 
H02 
+ 

NO 

NO 
N02 
N02 

03P 

+ 
+ 
t, 
+ 

co 
co 
HO 
HO 

''11,, 

,,,, 

d·il' 

+  0.009*HCHO 

+ 

+ 

+ 

+ 

HO 

N02 

N02 

N03 

+ 

H02 

+  O.l70*H02 
+  0.025*KBT 
+  o.2so•xo2 
+  0.7SO*X02 

03P 
{  22} 
03P 
{  23} 
OlD 
{  24} 
OlD 
{  25} 
OlD 
{  26} 
03 
{  27} 
{  28}  03 
{  29}  03 
{  30}  H02 
H02 
{  31} 
HN04 
{  32} 
H02 
{  33} 
H02 
{  34} 
H202 
{  35} 
NO 
{  36} 
{  37}  NO 
{  38}  03 
{  39}  N03 
N03 
{  40} 
N03 
{  41} 
N03 
{  42} 
N205 
{  43} 
N205 
{  44} 
{  45}  HO 
{  46}  HO 
{  47}  HO 
{  48}  HO 
{  49}  HO 
{  so}  co 
{  51}  HO 
{  52}  ETH 
{  53}  HC3 

54}  HCS 
ss}  HC8 
56}  OL2 
57}  OLT 

I 

+  [M] 
+  ~O:;? 
+  (N2] 
+  [02] 
+  [H20] 
+  NO 
+  HO 
+  H02 
+  NO 
+  N02 

+  H02 
·+  H02 
+  HO 
+  HO 
+  ~o 
+  ~02 
+  NO 
+  ~02 
+  H02 
+  N02 

[H20] 

+ 
+  ,N02 
+  .HN03 
+  HN04 
+  H02 
+  ,S02 
+  HO 

+  HO 
+  HO 

+  HO 
+,HO 
+,HO 
+  HO 

I 

+ 

0.980*H02 
0.200*ALD 
N02 
03 
NO 
03P 
03P 

2.000*HO 
N02 
H02 
HO 
N02 
HN04 
H02 
H202 
H202 
H02 
HONO 
2.000*N02 
N03 
2.000*N02 

NO 
HN03 
N205 
N02 

2.000*HN03 
HN03 
N03 
N02 

SULF 
H02 
M02 
ETHP 
O.B30*HC3P 

+  [02] 

+  [H20] 

t 

[02] 

--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 

+  0.075*ALD 
HCSP 
HC8P 
OL2P 
OLTP 

--> 
--> 
--> 
--> 

Table SA-9.  RADM2_CIS1  and RADM2_CIS1_AQ Mechanisms 

EP A/600/R-99/030 

{  58}  OLI 
{  59}  TOL 
{  60}  XYL 
{  61}  CSL 
{  62}  CSL 
{  63}  HCHO 
{  64}  ALD 
{  65}  KET 
{  66}  GLY 
{  67}  MGLY 
{  68}  DCB 
{  69}  OP1 
{  70}  OP2 
{  71}  PAA 
{  72}  PAN 
{  73}  ONIT 
{  74}  AC03 
{  75}  PAN 
{  76}  TC03 
{  77}  TPAN 
{  78}  M02 
{  79}  HC3P 

so}  HC5P 

81}  HCBP 

82}  OL2P 

83}  OLTP 

84}  OLIP 

85}  AC03 
86}  TC03 

87}  TOLP 

88}  XYLP 

{  89}  ETHP 
{  90}  KETP 
{  91}  OLN 
{  92}  HCHO 
{  93}  ALD 
{  94}  GLY 
{  95}  MGLY 
{  96}  DCB 
{  97}  CSL 
{  98}  OL2 
{  99}  OLT 
{100}  OLI 
{101}  OL2 

{102}  OLT 

+  HO 
+  HO 
+  HO 
+  HO 
+  HO 
+  HO 
+  HO 
+  HO 
+  HO 
+  HO 
+  HO 
+  HO 
+  HO 
+  HO 
+  HO 
+  HO 
+  N02 

+  N02 

+  NO 
+  NO 

+  NO 

+  NO 

+  NO 

+  NO 

+  NO 

+  NO 
+  NO 

+  NO 

+  NO 

+  NO 
+  NO 
+  NO 
+  N03 
+  N03 
+  N03 
+  N03 
+  N03 
+  N03 
+  N03 
+  N03 
+  N03 
+  03 

+  03 

{103}  OLI 

+  03 

OLIP 
0.750*TOLP 
0.830*XYLP 
0.100*H02 
CSL 
H02 
AC03 
KETP 
H02 
AC03 
.TC03 
0.500*M02 
0.500*HC3P 
AC03 
HCHO 
HC3P 
PAN 
AC03 
TPAN 
TC03 
HCHO 
0.750*ALD 

+  0.036*0NIT 

0.3BO*ALD 
+  0. 920*N02 
0.350*ALD 

+  0.240*0NIT 
1.600*HCHO 

+ 

+  0,200*ALD 
ALD 
N02 
H02 
+  0.100*KET 
M02 
N02 

--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 

--> 

--> 

--> 

--> 

~-> 

-->. 
--> 

--> 

--> 

+  0.110*MGLY 
+  2,000*X02 
N02 
+  0.160*GLY 
N02 
+  0.806*DCB 
ALD 
MGLY 
HCHO 
H02 
AC03 
HN03 
HN03 
HN03 
HN03 
OLN 
OLN 
OLN 
HCHO 
+  0.120*H02 

--> 
--> 
-->. 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 

--> 

0. 530*.HCHO 
+  0,200*0RA1 
+  0.220*M02 

--> 

0.180*HCHO 

.+  0.230*CO 
+  0.260*H02 

8-67 

+  0.250*H02 
+  0.170*H02 
+  0.900*TC03 

+.  0.250*CSL 
+  0.170*CSL 
+  0:900*X02 

+ 

co 

+  2.000*CO 
co 
+ 

+  0.500*HCHO 
+  0.500*ALD 

+  0.500*HO 
+  0.500*HO 

+ 
+ 

+ 

N03 
N02 

N02 

N02 
+ 
+ 
H02 
+  0.250*KET 
+  0.964*N02 
+  0.690*KET 
+  0.920*H02 
+  1.060*KET 
+  0.760*N02 
+ 
H02 

+ 

X02 

N02 

+ 
.+  0. 090*HCHO 
+  0.964*HQ2 
+  0.080*0NIT 

+  0.040*HCHO 
+  0.760*H02 
+ 
N02 

+ 

HCHO 

+ 

H02 

+  1. 450*ALD. 
N02 
+ 
+ 
N02 
+  0.920*H02 
+  0.050*AC03 

H02 
+ 
+  0.700*DCB 
H02 
+ 

+ 
+ 
+ 
+ 
+ 
+ 
+ 
+ 
+ 

H02 
N02 
ALD 
HN03 
HN03 
H02 
AC03 
TC03 
XN02 

+  0,280*HCHO 

+  0.890*GLY 
+  0.950*CO 

+  0.170*MGLY 

+  0 .450*MGLY 

+ 
N02 
+ 
H02 
+  2.000*N02 
co 
+ 

+  2.000*CO 
co 
+ 

+  0.500*CSL 

+  0.400*0RA1 

+  0.420*CO 

+  0.500*ALD 
+  0.200*0RA2 
+  0.100*HO 
+  0.720*ALD 
+  0,060*0RA1 
+  0.140*HO 

+  .0.330*CO 
+  0.230*H02 

+  0.100*KET 
. +  0. 290*0RA2 
+  0.310*M02 

Table 8A-9.  RADM2_CISI  and RADM2_CISI_AQ Mechanisms 

I. 

OPl 
OP2 
OP2 
OP2 
OP2 
OP2 
OP2 
OP2 
OP2 
PAA 
OP2 
OP2 
OP2 
ONIT 
1.500~HCH0 
0.750*HCHO 
0. 840*JiC.HO 

H02 

+ 
H02 
+ 
H02 
+  0,770*ALD 

0.770*HCHO 

+  0.410*ALD 

H02 

1111 

,,

1111"' 

+  a . 7!fo•ALI> 
+  0.260*KET 
:,,,,,;,, 
+  0,750*KET· 

:::11;: 

',1 

'! 

,,. 

'11'1 

o.0oo•HCHO 

+  0.460*11,LD 

+  1.390*KET 

H02 

:,11111:: 

111: 

11111'111 

+  0.3SO*ALD 
+  0.750*ALD 
+  0.725*ALD 

+ 
+ 
+ 

'ii' 

H02 
H02 
H02 

+  0.7SO*MGLY 
+  o.soo•Ho2 

+ 
H02 
+  o.soo•Mo2 

+  0.170*MGLY 
+  2.000*H02 
+  0 ,450*MGLY 

+  0.44S*GLY 
+  0.02S*AC03 
+ 
X02 
+  o.soo•Ho2 

+  o,soo•Ho2 

+  0.2~0*KET 
+  o.soo•oRA2 
+  0.750*KET 
+  O.SOO*ORA2 
+  l.390*KET 
+  O.!;iOO*ORA2 
+  0.600*ALD 
+  O.SOO*ORA2 
+  o.soo•HCHO 
+  o.soo•ORA2 
+  o.sso•KET 
+  O.SOO*M02 
+  Q.SOO*H02 

1
1';,":'iWI' 
'1

+  0.160*GLY 

,111 

+  0.806*DCB 

,,,1·:1::·:1 

+  o.oss•MGLY 
+  0.460*H02 

1:111'1111• 

'II 

+ 

ALD 

t.  o. s~.o•Mo2 

"':  o.soo•Ho2 

+  o.soo•Ho2 

111',' 

11 

+  O.SOO*H02 

+  o.soo•Ho2 

+  o.soo•Ho2 

+  0.140*HCHO 
+  o.soo•oRA2 
,+  0, §OO*M02 

+  0.170*MGLY 
+ 
+  0.4SO*MGLY 

HC;?2 

+  0.160*GLY 

+  O.B06*DCB 

+  0.920*H02 
+  o.oso•AC03 

+  0.890*GLY 
+  0.9SO*CO 

{104}  H02 
{105}  H02 
{106}  H02 
{107}  H02 
{108}  H02 
{109}  H02 
{110}  H02 
{111}  H02 
{112}  H02 
{113}  H02 
{114}  H02 
{115}  H02 
{116}  H02 
{117}  H02 
{118}  M02 
{119}  M02 
{120}  M02 

+  M02 
+  ETHP 
+  HC3P 
+  HC5P 
+  HC8P 
+  OL2P 
+  OLTP 
+  OLIP 
+  KETP 
+  AC03 
+  TOLP 
+  XYLP 
+  TC03 
+  OLN 
+  M02 
+  ETHP 
+  HC3P 

{121}  M02 

+  HC5P 

{122}  M02 

+  HC8P 

{123}  M02 
{124}  M02 
{125}  M02 

{126}  M02 
{127}  M02 

+  OL2P 
+  OLTP 
+  O;LIP 

+  KETP 
+  AC03 

{128}  M02 

+  TOLP 

{129}  M02 

+  XYLP 

{130}  M02 

+  TC03 

-;--> 
--> 
--> 

-~> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 

--> 

--> 

--> 
--> 
--> 

--> 
--> 

--> 

--> 

--> 

+ 

+ 

+ 

1.550*H.CHO 
1.250*HCHO 
0.890*HCHO 

+  o.5so•KET 
0.750*HCHO 
HCHO 
+  0.500*0RA2 
HCHO 
+  0.700*DCB 
HCHO 

+  2.000*H02 

o.500•HCHO 
+  o.5oo•oRA2 
+  0.47S*CO 

{131}  M02 

+  OLN 

- - > 

1. 7SO*HCHO 

{132}  ETHP 

+  }\.C03 

{133}  HC3P 

+  AC03 

{134}  HC5P 

+  AC03 

{135}  HC8P 

+  AC03 

{136}  OL2P 

+  AC03 

{137}  OLTP 

+  AC03 

{138}  OLIP 

+  AC03 

{139}  KETP 

+  AC03 

{140}  AC03 
{141}  AC03 

+  AC03 
+  TOLP 

{142}  AC03 

+  XYI,,P 

{143}  AC03 

+  TC03 

--> 

--> 

--> 

--> 

--> 

--> 

--> 

--> 

--> 
--> 

--> 

--> 

+ 

N02 
ALD 

+  Q,500*0RA2 

0,770*ALD 
+  O.SOO*M02 
0,410*ALD 
+  O.SOO*M02 
0.469*ALD 
+  0,SOO*M02 

o.0oo•HCH0 

+  0,500*M02 
ALD 
+  O.SOO*M02 
0.725*ALD 
+  o.soo•Ho2 

MGLY 
+  o.500•0RA2 

2.000*M02 
M02 
+  0.700*DCB 
M02 
H02 
M02 

+ 

+  o.11o•MGLY 

8-68 

Table 8A-9.  RADM2_CIS1  and RADM2_CISl_AQ Mechanisms 

{144}  AC03 

+  OLN 

{145}  OLN 
{146}  X02 
{147}  X02 
{148}  X02 
{149}  X02 
{150}  X02 
{151}  XN02 
{152}  XN02 
{153}  XN02 
{154}  XN02 
{155}  XN02 
{156}  ISO 
{157}  ISO..:_R02 

+  OLN 
+  H02 
+  M02 
+  AC03 
+  X02 
+  NO 
+  N02 
+  H02 
+  M02 
+  AC03 
+  XN02 
+  HO 
+  NO 

{158}  ISO_R02  +  H02 
{159}  ISO_R02  +  AC03 

{160}  ISO_R02  +  M02 
+  03 
{161}  ISO 

{162}  ISO 

+  03P 

{163}  ISO 
{164}  ISON_R02  +  NO 

+  N03 

{165}  ISON_R02  +  H02 
{166}  ISON_R02  +  AC03. 

{167}  ISON_R02  +  M02 

{168}  ISOPROD  +  HO 
+  NO 
{169}  IP_R02 

{170}  IP_R02 
{171}  IP_R02 

+  H02 
+  AC03 

{172}  IP_R02 

+  M02 

{173}  ISOPROD  +  03 

{174}  ISOPROD  +  hv 

{175}  ISOPROD  +·N03 

+  2.000*X02 
HCHO 
N02 

+ 

2.000*HCHO 

OP2 
HCHO 
M02 

N02 
ONIT 
OP2 
HCHO 
M02 

+ 
ALD 
+  0.500*M02 
+  2.000*ALD 

+ 

H02 

+  0.500*0RA2 

+  2.000*N02 

+ 

H02 

0;088*0NIT 

ISO_R02  +  0.079*X02 
+  0.912*N02 

+  0.912*ISOPROD  +  0.629*HCHO 

+  0.912*H02 

OP2 
0.500*H02 

+ 

ISO PROD 

+  0.500*M02 

+  0.500*0RA2 

0.500*HCHO 
0.600*HCHO 

+  0.500*H02 
+  0.650*ISOPROD  +  0.390*0RA1 
+  0.070*H02 
+  0.200*AC03 
0.750*ISOPROD  +  0.250*AC03 

+  0.070*CO 
+  O.l50*ALD 
+  0.250*HCHO 

+  0.270*HO 
+  0.200*X02 

+ 

ISOPROD 

--> 

--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 

--> 
--> 

--> 
--> 

--> 

--> 
--> 

--> 
--> 

+  0.250*M02 

ISON_R02 
N02 
+  0.800*H02 

ONIT 

0.500*H02 
ALD 

+ 

+ 

--> 

0.500*HCHO 
ONIT 
-->·  0.500*AC03 
--> 

N02 
+  0;550*ALD 
+  0. 340*MGLY 

--> 
--> 

--> 

--> 

--> 

--> 

OP2 
0.500*H02 
+  0.500*ALD 

0.500*HCHO 

+  O.SOO*KET 

0.268*HO 
+  0.054*M02 
+  0.146*HCHO 
+  0.850*MGLY 
0.970*AC03 
+  0.200*HCHO 
+  0.033*KET 
0.075*AC03 
+  o·.282*HCHO 
+  0.925*H02 

+  0.800*ALD 
+  0.200*ISOPROD  +  0.200*N02 

+  0.800*0NIT 

+  0.500*M02 
+ 
+  0.500*H02 

ONIT 

+  0.500*IP_R02 
+ 
+  0.250*HCHO 
+  0.630*KET 

H02 

+  0.500*M02 
+  0.500*KET 
+  0.500*H02 

+  0.100*H02 
+  0.070*X02 
+  0.020*ALD 
+  0.090*KET 
+  0.333*H02 
+  0.333*CO 

+  0.075*HN03 
+  0.925*0NIT 
+  0.925*X02 

+  0.500*0RA2 

+ 

ALD 

+  0.200*X02 
+  o'.590*CO 
+  0.080*GLY 

+  0.500*0RA2 

+  0.500*ALD 

+  0.114*AC03 
+  0.155*CO 
+  O.OlO*GLY 
+  0.462*0RA1 
+  0.700*M02 
+  0.067*ALD 

+  0.643*CO 
+  0.282*ALD 

>----------------------------------------~-----------------------------------------------< 

Rate  Expression 

k(  1)  uses  photo  table  N02_RADM88 
k(  2)  uses  photo  table  0301D~RADM88 
k(  3)  uses  photo  table  0303P_RADM88 

'  scaled  by  l.OOOOOE+OO 
'  scaled  by  l.OOOOOE+OO 
'  scaled  by  l.OOOOOE+OO 

Rate  Constant 

{o.oooooE+oo} 
{O.OOOOOE+oo} 
{O.OOOOOE+OO} 

Table 8A-9.  RADM2  CISl and RADM2  CISl _AQ Mechruiisnis 

-

k(  4)  uses  photo  table  HONO_RADM88 
5)  uses  photo  table  HN03_RADM88 
k( 
6)  uses  photo  table  HN04_RADM88 
k( 
7)  uses  photo  table  N03NO_RADM88 
k( 
8)  uses  photo  table  N03N02_RADM88 
k( 
9)  uses  photo  table  H202_RADM88 
k( 

-
'  scaled  by  1.00000E+OO 
'  scaled  by  1.00000E+OO 
'  scaled  by  1.00000E+OO 
. scaled  by  1.00000E+OO 
'  scaled  by  1.00000E+OO 
. scaled  by  1.00000E+OO 
k(  10)  uses  photo  table  HCHOmol~RADM88  . scaled  by  1.00000E+OO 
k(  11)  uses  photo  table  HCHOrad_RADMBB  . scaled  by  1.00000E+OO 
. scaled  by  1.00000E+OO 
. scaled  by  1.00000E+OO 
. scaled  by  1.00000E+OO 
. scaled  by  l.OOOOOE+OO 
. scaled  by  l.OOOOOE+OO 
k(  17)  uses  photo  table  GLYform_RADMB8  . scaled  by  1.00000E+OO 
. scaled  by  l.OOOOOE+OO 
. scaled  by  l.OOOOOE+OO 
. scaled  by  l.OOOOOE+OO 
. scaled  by  1.00000E+OO 

k(  12)  uses  photo  table  ALD_RADM88 
k(  13)  uses  photo  table  MHP_RADMBB 
k(  14)  uses  photo  table  HOP_RADM88 
k(  15)  uses  photo  table  PAA_RADM88 
k(  16)  uses  photo  table  KETONE_RADMBB 

k(  18)  uses  photo  table  GLYmol_RADMBB 
k(  19)  uses  photo  table  MGLY_RADMB8 
k(  20)  uses  photo  table  UDC_RADMBB 
k(  21)  uses  photo  table  ORGNIT_RADMBB 
k(  22)  =  6.0000E-34  *  (T/300)**(-2.30) 
k(  23)  = 
6.SOOOE-12  *  exp( 
k(  24)  =  1.8000E-11  *  exp( 
k(  25)  =  3.2000E-ll  *  exp( 
k(  26)  =  2.2000E-10 
k(  27)  =  2.0000E-12  *  exp(  -1400.0/T) 
k(  28)  =  1.6000E-12  *  exp( 
-940.0/T) 
k(  29)  =  l.lOOOE-14  *  exp( 
-500.0/T) 
k(  30)  =  3.7000E-12  *  exp( 
240. O/T) 
k(  31)  is  a  fallof~  expression  using: 

120. O/T) 
110.0/T) 
70.0/T) 

=  1. 8000El31  *  (T/300) ** (-3. 20) 
kO 
kinf  =  4.7000E-12  *  (T/300) ** (-1.40) 
F  =  0.60, 

n  =  1.00 

I. 

{O.OOOOOE+OO} 
{O.OOOOOE+OO} 
{O.OOOOOE+OO} 
{o.oooooE+oo} 
{O.OOOOOE+OO} 
{O.OOOOOE+OO} 
{O.OOOOOE+OO} 
{O.OOOOOE+OO} 
{O.OOOOOE+OO} 
{O.OOOOOE+OO} 
{O.OOOOOE+oo} 
{0.00000E+OO} 
{O.OOOOOE+oo} 
{O.OOOOOE+OO} 
{O.OOOOOE+OO} 
{O.OOOOOE+OO} 
{O.OOOOOE+OO} 
{O.OOOOOE+OO} 
{6.093028-34~ 
{9.72293E-12 
{2.6036SE-11} 
{4.04730E-11} 
{2.20000E-10} 
{l.82272E-14} 
{6.826SOE-14} 
{2.05452E-15} 
{B.27883E-12} 
{1.39058E-12} 

{8.62399E-02} 
{3.01634E-12} 

{6.78905E-30} 

" 

{1.68671E-:J..2} 
{4.87144E-12} 

{1.95397E-38} 
{3.18213E-17} 
{2.8122SE-11} 
{4.03072E-16} 
{2.SOOOOE-12} 
{l.26440E-12} 

{S.47034E-02} 
{2.00000E-21} 
{1.1488SB-11} 

{l.47236E-13} 

k(  32)  = k(  31)  I  Keq,  where  Keq  =  2.lOOE-27  *  exp(  10900.0/T) 
k(  33)  is  a  specia~  rate  expression  of  the  form: 

k  =kl+  k2[M],  ,where 
kl  =  2.2000E-13  *  exp( 
k2  =  i.9000E:-33  *"exp( 

620.0/T) 
980.0/T) 

k(  34)  is  a  special  rate  expression  of  the  form: 

k  =kl+  k2[M],:where 
kl  =  3.0800E-3~  *  exp(  2820. O/T) 
k2  =  2.6600E-54  *  exp(  3180. O/T) 
k(  35)  =  3.3000E-12  *exp( 
-200.0/T) 
k(  36)  is  a  falloff  expression  using: 

=  7.0000E~31  *  (T/300)**(-2.60) 
kO 
kinf  =  1~SOOOE".:11  *  CT/300) ** (-0. SO) 
F  =  0.60, 

n  =  1.00 

k(  37)  =  3.3000E-39  *  exp( 
530. O/Ti 
k(  38)  =  1.4000E-13  *  exp(  -2500.0/Tl 
150.0/T) 
l.7000E-ll  *  exp( 
k(  39)  = 
2.SOOOE-14  *  exp(  -1230.0/T) 
k(  40)  = 
k(  41)  = 
2.SOOOE-12 
k(  42)  is  a  falloff  expression  using: 

=  2.2opo~-3o  *  (T/300)**(-4.30) 
kO 
kinf  =  1. SOOOE-12  *  cl'/300) ** c-o.soJ 
F  =  0.60, 

n  =  1. 00 

' 

k(  43)  =  k(  42)  I  Keq,  where  Keq  =  l.lOOE-27  *  exp(  11200.0/T) 
k(  44)  =  2.0000E-21 
k(  45)  is  a  falloff  expres~ion using: 

=  2.6000Ej~30  *  (T/300)**(-3.20) 
kO 
kinf  =  2.4000E-ll  *  CT/JOO)** (-1.30) 
F  =  0.60, 

n  =  1.00 

I 

k(  46)  i•  •  speciil  rate  expreooion  of  the  fo~' 

Table SA-9.  RADM2_CISI  and RADM2_CISI_AQ Mechanisms 

EPA/600/R-99/030 

(1  +  k3[M]/k2)},  where 

k  = kO  +  {k3[M]  I 
kO  =  7.2000E-15  *exp( 
785.0/T). 
k2  =  4.1000E-16  *  exp(  1440.0/T) 
k3  =  1.9000E-33  *  exp( 
725.0/T) 
k(  47)  =  1.3000E-12  *exp( 
3.80.0/T) 
k(  48)  =  4.6000E-1i  *  exp( 
230.0/T) 
k(  49)  is  a  falloff  expression  using: 

=  3.0000E-31  *  (T/300)**(-3.lO) 
kO 
kinf  =  1.SOOOE-12  *  (T/300)**(  0.00) 
F  =  0.60, 

n  =  1.00 

· 

256.0/T) 
-745.0/T) 

-S40.0/T) 
-380 ..  0/T) 
-380.0/T) 
411.0/T) 
504.0/T) 
549.0/T) 
322.0/T) 
116.0/T) 

k(  SO)  =  1.SOOOE-13  *  (1.0  +  0.6*Pressure) 
k(  S1)  =  2.B300E+01  *  (T/300)**(  2.00)  *exp( 
k(  S2)  =  1.2330E-12  *  (T/300)**(  2.00)  *exp( 
k(  S3)  =  1.S900E-11  *  exp( 
k(  S4)  =  1.7300E-11  *exp( 
k(  SS)  =  3.6400E-11  *  exp( 
k(  S6)  =  2.1SOOE-12  *  exp( 
k(  57)  =  5.3200E-12  *  exp( 
k(  58)  =  1.0700E-l1  *exp( 
k(  S9)  =  2.1000E-12  *exp( 
k(  60)  =  1.8900E-11  *  exp( 
k(  61)  =  4.0000E-11 
k(  62)  =  9.0000E-01  *  k(  61) 
k(  63)  =  9.0000E-12 
k(  64)  =  6.8700E-12  *  exp( 
k(  6S)  =  1.2000E-11  *  exp( 
k(  66)  =  1.1500E-11 
k(  67)  =  1.7000E-11 
k(  68)  =  2.800QE-11 
k(  69)  =  1.0000E-11 
k(  70)  =  1.0000E-11 
k(  71)  =  1.0000E-11 
k(  72)  =  6.16SOE-13  *  (T/300)**(  2.00)  *exp( 
-540.0/T) 
1.SSOOE-11  *  exp( 
k(  73)  = 
k(  74)  =  2.BOOOE-12  *  exp( 
181.0/T) 
k(  75)  =  1.9SOOE+16  *  exp(-13543.0/T) 
k(  76)  =  4.7000E-12 
k(  77)  =  1.9500E+16 
k(  78)  =  4.2000E-12 
k(  79)  =  4.2000E-12 
k(  80)  =  4.2000E-12 
k(  81)  =  4.2000E-12 
k(  82)  =  4.2000E-12 
k(  83)  =  4.2000E-12 
k(  84)  =  4.2000E-12 
k(  85)  =  4.2000E-12 
k(  86)  =  4.2000E-12 
k(  87)  =  4.2000E-12 
k(  88)  =  4.2000E-12 
k(  89)  =  4.2000E-12 
k(  90)  =  4.2000E-12 
k(  91)  =  4.2000E-12 
k(  92)  =  6.0000E-13 
k(  93)  =  1.4000E-12 
k(  94)  =  6.0000E-13 
k(  95)  =  1.4000E-12 
k(  96)  =  1.4000E-12 
k(  97)  =  2.2000E-11 
k(  98)  =  2.0000E-12  *  exp( 
k(  99)  =  1.0000E-11  *  exp( 
k(100)  =  3.2300E-11  *exp( 

*  exp(-13543.0/T) 
180. O/T) 
*  exp ( 
*  exp( 
180.0/T) 
180.0/T) 
*exp( 
180. O/T) 
*  exp ( 
180. O/Tl 
*  exp ( 
180.0/T) 
*  exp( 
*exp( 
180.0/T) 
180.0/T) 
*  exp( 
180.0/T) 
*  exp( 
180.0/T) 
*  exp( 
180.0/T) 
*  exp( 
*exp( 
180.0/T) 
180.0/T) 
*exp( 
*exp( 
180.0/T) 
*  exp(  -2058.0/T) 
*  exp(  -1900.0/T) 
*  exp(  -2058.0/T) 
*  exp(  -1900.0/T) 
*  exp (  -1900. O/Tl 

-2923.0/T) 
-1895.0/T) 
-975.0/T) 

-1280.0/T) 
-444.0/T) 

-444 .O/T) 

{4.6S309E-12} 
{9.95294E-11} 
{8.8884BE-13} 

{2.40000E-13} 
{3.80672E-01} 
{2. 74210E-13} 
{2.S9669E-12} 
{4.83334E-12} 
{1.01696E-11} 
{B.53916E-12} 
{2.88684E-11} 
{6.75269E-11} 
{6.18715E-12} 
{2.78943E-11} 
{4.00000E-11} 
{3.60000E-11} 
{9.00000E-12} 
{1.62197E-11} 
{9.85020E-13} 
{1.15000E-11} 
{1. 70000E-11} 
{2.80000E-11} 
{1.00000E-11} 
{1.00000E-11} 
{1.00000E-11} 
{1.3710SE-13} 
{2. S313 7E-12} 
{5.13974E-12} 
{3.57235E-04} 
{4.70000E-12} 
{3.S7235E-04} 
{7.68378E-12} 
{7.6837BE-12} 
{7.6837BE-12} 
{7.68378E-12} 
{7.6837BE-12} 
{7.6837BE-12} 
{7.6837BE-12} 
{7.68378E-12} 
{7.68378E-12} 
{7.68378E-12} 
{7.6837BE-12} 
{7.6837BE-12} 
{7.6837BE-12} 
{7.6837BE-12} 
{6.01030E-16} 
{2.38307E-15} 
{6.01030E-16} 
{2.38307E-15} 
{2.38307E-15} 
{2.20000E-11} 
{1.09940E-16} 
{1. 73099E-14} 
{1.22539E-12} 

Table 8A-9.  RADM2_CIS1  and RADM2_CIS1_AQ Mechanisms 

k(lOl)  =  1.2000E-14  *exp(  -2633.0/T) 
k(102)  =  1.3200E-14  *  exp(  -2105.0/T) 
k(l03)  =  7.2900E-15  *  exp(  -1136.0/T) 
k(104)  =  7.7000E-14  *  exp(  1300. O/T) 
k(lOS)  =  7. ?OOOE-14  *  exp<.  1300.0/T) 
k(106)  =  7.?000E-14  *exp(  1300. O/T) 
k(107)  =  7.7000E-14  *  exp(  1300. O/T) 
k(108)  =  7.7000E-14  *  exp(  1300.0/T) 
k(109)  =  7.?000E-14  *  exp(  1300.0/T) 
k(110)  =  7.7000E-l4  *  exp(  1300. O/T) 
k(111)  =  7.7000E-14  *  exp(  1300. O/T) 
k(112)  =  7.7000E-14  *  exp(  1300. O/T) 
k(113)  =  7.?000E-14  *  exp(  1300 .O/T) 
k(l14)  =  7.?000E-14  *  exp(  1300.0/T) 
7.7000E-14  *  exp(  1300. O/T) 
k(115)  = 
k(116)  =  7.7000E-l4  *  exp(  1300. O/T) 
k(117)  =  7.7000E-l4  *  exp(  1300. O/T) 
k (118)  =  1.9000E-13  *  exp( 
220.0/T) 
k(ll9)  =  1.4000E-13  *  exp( 
220.0/T) 
k(120)  =  4.2000E-14  *  exp( 
220.0/T) 
k(121)  =  3.4000E-14  *exp( 
220.0/T) 
k(122)  =  2.9000E-14  *  exp( 
220.0/T) 
k(123)  =  1.4000E-13  *  exp( 
220.0/T) 
k(l24)  =  1.4000E-13  *exp( 
220.0/T) 
k(125)  =  1.7000E-14  *  exp( 
220.0/T) 
k(126)  =  1.7000E-14  *  exp( 
220.0/T) 
k(127)  =  9.GOOOE-13  *  exp( 
220.0/T) 
k(128)  =  1.7000E-14  *  exp( 
220.0/T) 
k(129)  =  1.7000E-14  *  exp( 
220.0/T) 
k (130)  =  9.GOOOE-13  *  exp( 
220.0/T) 
k(131)  =  1.?000E-14  *  exp( 
220.0/T) 
k(132)  =  3.4000E-13  *exp( 
220. O/T) 
k(133)  =  1.0000E-13  *exp( 
220.0/T) 
k(134)  =  8.4000E-14  *  exp( 
220.0/T) 
k (135)  =  7.2000E-14  *  exp( 
220. O/T) 
k(136)  =  3.4000E-13  *  exp( 
220.0/T) 
k(137)  =  3.4000E-13  *.exp( 
220.0/T) 
k(138)  =  4.2000E-14  *  exp( 
220.0/T) 
k(139)  =  4.2000E-14  *  exp( 
220.0/T) 
k(140)  =  1.1900E-12  *  exp( 
220.0/T) 
k(141)  =  4.2000E-14  *  exp( 
220.0/T) 
k(142)  =  4.2000E-14  *  exp( 
220. O/T) 
k(l43)  =  1.1900E-12  *  exp( 
220.0/T) 
k(144)  =  4.2000E-14  *  exp( 
220.0/T) 
k(145)  =  3.GOOOE-16  *  exp( 
220. O/T) 
k(146)  =  7.?000E-14  *  exp(  1300.0/T) 
k(147)  =  1.?000E-14  *  exp( 
220.0/T) 
k(148)  =  4.2000E-14  *  exp( 
220.0/T) 
k(149)  =  3.GOOOE-16  *exp( 
220.0/T) 
k(lSO)  =  4.2000E-12  *  exp( 
180.0/T) 
k(lSl)  =  4.2000E-12  *  exp( 
180.0/T) 
k(152)  =  7.7000E-14  *  exp(  1300. O/T) 
k(153)  =  1.7000E-14  *  exp( 
220. O/T) 
k(154)  =  4.2000E~14  *  exp( 
220.0/T) 
k(lSS)  =  3.6000E-16  *  exp( 
220. O/T) 
k(156)  =  2.5400E-11  *  (T/300)**(  1.00)  *  exp( 
407.6/T) 
k(157)  =  4.2000B-12  *  (T/300)**(  1.00)  *  exp( 
181.2/T) 
k(158)  =  7.7000E-14  *  (T/300) ** (  1. 00)  *  exp(  1298.3/T) 
k(159)  =  8.4000E-14  *  (T/300)**(  1.00)  *  exp( 
221.4/T) 
k(160)  =  3.4000E-14  *  (T/300) ** (  1. 00)  *  exp( 
221.4/T) 
k(161)  =  7.8600E-15  *  (T/300)**(  1.00)  *  exp(  -1912.2/T) 

I 

I 
I 

8-72 

{1.74559B-18} 
{1.12933E-17} 
{1.6112SE-16} 
{6.04038E-12} 
{6.04038E-12} 
{6 .0403BE-J.2} '""I"" 
{6.04038E-12}  . 
{6.0403BE-12} 
{6.0403BE-12} 
{6.04038E-12} 
{6.04038E-12} 
{6.04038E-12} 
{6.0403BE-12} 
{6.04038E-12} 
{6.04038E-12} 
{6.04038E-12} 
{6.0403BE-12} 
{3.97533E-13}  I .. 
{2.92919E-13} 
{B.7875BE-14} 
{7.ll376E-14) 
{6.06762E-14} 
{2.92919E-13} 
{2.92919E-13} 
{3 .SS68BE-14}  I 
{3.55688E-14} 
{2.00859E-12} 
{3.55688E-14} 
{3.55688E-14} 
{2.00859E-12} 
{3.556BBE-14} 
{7.11376E-13} 
{2.09228E-13} 
{1.75752E-13} 
{1. 50644E-13} 
{7.11376E-13} 
{7.11376E-13} 
{B.78758E-14} 
{B.78758E-14} 
{2.48981E-12} 
{8.78758E-14} 
{B.7875BE-14} 
{2.48981E-12} 
{8.7875BE-14} 
{7.53221E-16}  J 
{6.0403BE-12} 
{3.55688E-14} 
{B.7875BE-14} 
{7.53221E-16} 
{7.6837BE-12} 
{7.6837BE-12} 
{6.0403BE-12} 
{3.55688E-14} 
{B.7875BE-14} 
{7.53221E-16} 
{9.90719E-11} 
{7.66335E·12} 
{S.9659BE-12}' 
{ 1. 75402E-13} 
{7.09961E-14} 
{1.27569E-17} 

I h ' ~ ! 11 ' 

Table 8A-9.  RADM2_CIS1  and RADM2_CISl_AQ Mechanisms 
k(l62)  =  3.6000E-11 
k(163)  =  3.0300E-12  *  (T/300)**(  1.00)  *  exp( 
-447.9/T) 
k(164)  =  4.2000E-12  *  (T/300)**(  1.00)  *  exp( 
181.2/T) 
k(l65)  =  7.7000E-14  *  (T/300)**(  1.00)  *  exp(  1298.3/T) 
k(l66)  =  8.4000E-14  *  (T/300)**(  1.00)  *  exp( 
221. 4/'l') 
k(l67)  =  3.4000E-14  *  (T/300)**(  1.00)  *  exp( 
221.4/T) 
k(l68)  =  3.3600E-ll 
k(l69)  =  4.2000E-12  *  (T/300)**(  1.00)  *  exp( 
181.2/T) 
k(170)  =  7.7000E-14  *  (T/300)**(  1.00)  *  exp(  1298.3/T) 
k(l7l)  =  8.4000E-14  *  (T/300) ** (  1. 00)  *  exp ( 
221.4/Tl 
k(l72)  =  3.4000E-14  *  (T/300)**(  1.00)  *exp( 
221.4/T) 
k(l73)  =  7.llOOE-18 
k(l74)  uses  photo  table  ACROLEIN 
k(l75)  =  l.OOOOE-15 

{3.60000E-11} 
{6.69552E-13} 
{7.66335E-12} 
{5.96598E-12} 
{1.75402E-13} 
{7.09961E-14} 
{3.36000E-ll} 
{7.66335E-12} 
{S.96598E-12} 
{1.75402E-13} 
{7.09961E-14} 
{7.llOOOE-18} 
{o.oooooE+oo} 
{ 1. OOOOOE-15} 
======c=====~=c==================================c======ne====a===========c==== 

,. 

,  scaled  by  3.60000E-03 


:1111111' 

1:1;, 

'l·,1l1:il:.1111.1:, 
II' 

l'::i• 

:'11' 

1
111,

1
!!:11 

1·

':::1111:111 

EP A/600/R-99/030 

Table 8A-10.  RADM2_CIS1~AE and RADM2_CIS1_AE_AQ Mechanisms 

I 

Reaction  List 

I' 

,,I 

· 

' 

,,,,', 

1i·: 

' 

+ 

NO 

>------------------,--------.-------------.-------------------------------------------------< 
l.}  N02 
{ 
2}  03 
{ 
3}  03 
{ 
{ 
4}  HONO 
{  S}  HN03 
{  6}  HN04 
7}  N03 
{ 
{ 
8}  N03 
{ 
9}  H202 
{  l.O}  HCHO 
{  l.l.}  HCHO 
{  l.2}  ALD 
{  l.3}  OPl. 
{  l.4}  OP2 
{  l.S}  PAA 
{  l.6}  KET 
{  l.7}  GLY 
{  l.8}  GLY 
{  l.9}  MGLY 
{  20}  DCB 
{  2l.}  ONIT 

+ 
+ 
+ 
+ 
+ 
+ 
+  l. 870*CO 
+  l.SSO*CO 
+ 
H02 
+  0.020*AC03 
+  0.800*KET 

+  hv 
+  hv; 
+  hv: 
+  hv 
+  hv: 
+  hv 
+  hv 
+  hv 
+  h'{ 
+  hv 
+  hv 
+  hv 
+  hv 
+  hv 
+  hv 
+  hv 
+  hv 
+  hv 
+  hv 
+  hv 
·+  hy 

--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 

H02 
H02 
H02 
H02 
HO 
ETHP 

co 
co 
HO 
HO 

+  0.800*H02 
co 
+ 
+ ,,, 
+ 

H02 

I  T,'70~ 

,,, 

,, 

NO 
N02 
N02 

+ 
+ 
+ 
+ 

-~> 
--> 

+ 
+ 
+ 

+ 

03P 

'11111111 

',ii, 

''I,, 

''1111 

+ 

+ 

+ 

+ 

HO 

N02 

N02 

N03 

+ 

H02 

',''11 

+ 

;1,·, 

,,,,11 

SULAER 

+  O.l.70*H02 
+  0.02S*KET 
+  0.2SO*X02 
+  0.750*X02 

t  O.Qp9*~CHO 

+ 

HC8ABR 

03P 
OlD 
03P 
HO 
HO 
H02 
NO 
N02 
2.000*HO 
co 
H02 
,.M02 
HCHO 
ALD 
M02 
AC03 
O.l30*HCHO 
0.4SO*HCHO 
AC03 
0.980*H02 
0.200*ALD 
N02 
03 
NO 
03P 
03P 

2.000*HO 
N02 
H02 
HO 
N02 
HN04 
H02 
H202 
H202 
H02 
HONO 

2.000*N02 
N03 
2.000*N02 

NO 
HN03 
Nios 
N02 

2.000*HN03 
HN03 
N03 
N02 

SULF 
H02 
M02 
ETHP 
0.830*HC3P 
+  0. 07S*ALD' 
HCSP 
HC8P 
OL2P 
OLTP 

--> 
--> 
-->' 
--> 

8-74 

+ 

+  [02] 

+  [H20] 

+  (02] 

--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 

{  22}  03P 
{  23}  03P 
{  24}  Ol.D 
{  2S}  Ol.D 
{  26}  Ol.D 
{  27}  03 
{  28}  03 
{  29}  03 
{  30}  H02 
{  3l.}  H02 
{  32}  HN04 
{  33}  H02 
{  34}  H02 
{  3S}  H202 
{  36}  NO 
{  37}  NO 
{  38}  03 
{  39}  N03 
{  40}  N03 
{  4l.}  N03 
{  42}  N03 
{  43}  N20S 
{  44}  N20S 
{  4S}  HO 
{  46}  HO 
{  47}  HO 
{  48}  HO 
{  49}  HO 
{  so}  co  . 
{  Sl.}  HO 
{  S2}  ETH 
{  S3}  HC3 

{  S4}  HCS 
{  SS}  HC8 
{  S6}  OL2 
{  S7}  OLT 

I 

+ 
[M] 
+  N02 
+  [N2] 
+  [02] 
+  [H20] 
+  NP 
+  Hp 
+  H02 
+  NO 
+  N02 

+  H02 
+  Hp2 
+  HP 
+  Hp 
+  Np 
+  Np2 
+  NO 
+  N,02 
+  H02 
+  N02 

+  [H20] 
+  ~02 
+  HN03 
+  HN04 
I.,  I 
+  H02 
+  S02 
+  HO 

I 

+  HO 
+  HO 

+  HO 
+  HO 
+  HO 
+  ¥0 

Table 8A-10.  RADM2  CISl  AB.and RADM2  CISl  AE_AQ Mechanisms 

EPN600/R-99/030 

+ 

+ 

+ 

OLIP 
0.7SO*TOLP 

+ 
+  0.250*CSL 

OLIAER 

+  0.2SO*H02 

TOLAER 

O.B30*XYLP 

+  0.170*CSL 

+  0.170*H02 

XYLAER 

0.100*H02 

+  0.900*X02 

+  0.900*TC03 

CSLAER 
CSL 
H02 
AC03 
KETP 
H02 
AC03 
TC03 

+ 

co 

+  2.000*CO 
co 
+ 

--> 
--> 

--> 

--> 

--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 

--> 

--> 

--> 

--> 

--> 

--> 
--> 

--> 

--> 

--> 
--> 
--> 
--> 
--> 
--> 
--> 
·-> . 
--> 

O.SOO*M02 
O.SOO*HC3P 
AC03 
HCHO 
HC3P 
PAN 
AC03 
TPAN 
TC03 
HCHO 
0.7SO*ALD 

+  0.036*0NIT 

0.3BO*ALD 
+  0.920*N02 
0.350*ALD 

+  0.240*0NIT 
1.600*HCHO 

+ 

+  0.200*ALD 
ALD 
N02 
H02 
+  0.100*KET 
M02 
N02 

+  0.110*MGLY 
+  2.000*X02 
N02 
+  O.J.60*GLY 
N02 
+  O,B06*DCB 
ALD 
MGLY 
HCHO 
H02 
AC03 
HN03 
HN03 
HN03 
HN03 

+  O.SOO*CSLAER 

--> 
--> 
--> 
--> 

--> 

OLN 
OLN 
OLN 
HCHO 
+  0.120*H02 

0.530*HCHO 
+  0.200*0RA1 

8-75 

{  SB}  OLI 
{  59}  TOL 

60}  XYL 

61}  CSL 

62}  CSL 
63}  HCHO 
64}  ALD 
65}  KET 
66}  GLY 
67}  MGLY 
6B}  DCB 
69}  OP1 
70}  OP2 
71}  PAA 
72}  PAN 
73}  ONIT 
74}  ACOJ 
75}  PAN 
76}  TC03 
77}  TPAN 
7B}  M02 
79}  HC3P 

BO}  HCSP 

B1}  HCBP 

B2}  OL2P 

B3}  OLTP 

+  HO 
+HO 

+  HO 

+  HO 

+  HO 
+  HO 
+  HO 
+  HO 
+  HO 
+  HO 
+  HO 
+  HO 
+  HO 
+  HO 
+  HO 
+  HO 
+  N02 

+  N02 

+  NO 
+  NO 

+  NO 

+  NO 

+  NO 

+  NO 

B4}  CLIP 

+  NO 

BS}  AC03 
B6}  TC03 

+  NO 
+  NO 

B7}  TOLP 

BB}  XYLP 

B9}  ETHP 
90}  KETP 
91}  OLN 
92}  HCHO 
93}  ALD 
94}  GLY 
95}  MGLY 
96}  DCB 
97}  CSL 

{  9B}  OL2 
{  99}  OLT 
{100}  OLI 
{101}  OL2 

+  NO 

+  NO 

+  NO 
+  NO 
+  NO 
+  N03 
+  N03 
+  N03 
+  N03 
+  N03 
+  N03 

+  N03 
+  N03 
+  N03 
+  03 

{102}  OLT 

+  03 

+  O.SOO*HCHO 
+  O.SOO*ALD 

+  O.SOO*HO 
+  O.SOO*HO 

+ 
+ 

+ 

N03 
N02 

N02 

N02 
+ 
+ 
H02 
+  0.250*KET 
+  0.964*N02 
+  0.690*KET 
+  0.920*H02 
+  1.060*KET 
+  0.760*N02 
+ 
H02 

+ 

X02 

N02 

+ 
+  0.090*HCHO 
+  0.964*H02 
+  O.OBO*ONIT 

+  0.040*HCHO 
+  0.760*H02 
+ 
N02 

+ 

HCHO 

+ 

H02 

+  1.450*ALD 
N02 
+ 
+ 
N02 
+  0.920*H02 
+  O.OSO*AC03 

H02 
+ 
+  0.700*DCB 
+ 
H02 

+ 
+ 
+ 
+ 
+ 
+ 
+ 
+ 
+ 

H02 
N02 
ALD 
HN03 
HN03 
H02 
AC03 
TC03 
XN02 

+  0.2BO*HCHO 

+  O.B90*GLY 
+  0.9SO*CO 

+  0.170*MGLY 

+  0.450*MGLY 

N02 
+ 
+ 
H02 
+  2.000*N02 
co 
+ 

+  2.000*CO 
co 
+ 

+  O.SOO*CSL 

+ 
+  0.400*0RA1 

OLIAER 

+  0.420*CO 

+  O.SOO*ALD 
+  0.200*0RA2 

+  0.330*CO 
+  0.230*H02 

I 

I 

,I 

Table SA-10.  RADM2  CISl_AE and RADM2_CIS1_AE_AQ Mechanisms 

, 

,,, 

,, 

,, 

{103}  OLI 

I 

+  O~ 

{104}  H02 
{105}  H02 
{106}  H02 
{107}  H02 
{108}  H02 
{109}  H02 
{110}  H02 
{111}  H02 
{ 112}  H02 
{113}  HO~ 
{114}  H02 
{115}  H02 
{116}  H02 
{117}  H02 
{118}  M02 
{119}  M02 
{120}  M02 

{121}  M02 

{122}  M02 

{123}  M02 
{124}  M02 
{125}  M02 

{126}  M02 
{127}  M02 

I 

+  Mp2 
+  EtHP 
+  HC3P 
+  H~5P 
+  H~8P 
+  OL2P 
+  OLTP 
+  O~IP 
+  iq;:TP 
+  11f03 
+  ~pLP 
+  x,yLP 
+  T~03 
+  O;r,.N 
+  Mp2 
+  E,:rHP 
+  H~3P 

I 

+  H~5P 

I 

+  H,C8P 

+  0~2P 
+  OLTP 
+  o~IP 

+  iq;:TP 
+  AC03 

{128}  M02 

+  TOLP 

{129}  M02 

{130}  M02 

+  XYLP 

+  TC03 

{131}  M02 

+  ~LN 

{132}  ETHP 

+  AC03 

{133}  HC3P 

+  AC03 

{134}  HCSP 

{135}  HC8P 

{136}  OL2P 

+  ~C03 

I 

+  AC03 

: 

+  ~C03 

{137}  OLTP 

+  AC03 

{138}  OLIP 

+  AC03 

: 

, 

{139}  KETP 

+  ~C03 

{140}  AC03 
{141}  AC03 

, 

+  AC03 
+  IOL!? 

I 
I 

--> 

--> 
--> 
--> 
~-> 
--> 
--> 
--> 
--> 
- - > 
--> 
--> 
•-> 
--> 
--> 
--> 
--> 
--> 

--> 

--> 

--> 
--> 
--> 

--> 
--> 

--> 

--> 

--> 

+  0.220*M02 

0.180*HCHO 

+  0.230*CO 
+  0.260*H02 
+ 

OLIAER 
OP1 
OP2 
OP2 
OP2 
OP2 
OP2 
OP2 
OP2 
0,!?2 
P~ 
OP2 
OP2 
OP2 
ONIT 
1.500*?CHO 
0.750*HCHO 
0.840*HCHO 

+ 

+ 

+ 

H02 

0.770*HCHO 

H02 

0.800*HCHO 

H02 

1.550*HCHO 
1.250*HCHO 
0.890*HCHO 

+  0.550*KET 

0.750*HCHO 
HCHO 
+  0.500*0RA2 
HCHO 
+  0.700*DCB 
HCHO 
+  2.000*H02 

0.500*HCHO 
+  0.500*0RA2 
+  0.475*CO 

--> 

--> 

+ 

1.750*HCHO 

N02 
ALD 

+  0.500*0RA2 

--> 

--> 

--> 

0.770*ALD 
+  0.500*M02 
0.410*ALD 
+  0. SOO*M02 
0.460*ALD 
+  O.SOO*M02 

--> 

0.800*HCHO 

+  O.SOO*M02 
ALD 
+  0. SOO*M02 
0.725*ALD 
+  0.500*H02 
MGLY 
+  O.SOO*ORA2 
2.000*M02 
M02 

--> 

--> 

--> 

--> 
--> 

+  0.100*HO 
+  0.720*ALD 
+  0.060*0RA;t 
+  0.140*HO 

+  0.100*KET 
+  0.2,!l()*ORA2 
+  0.310*M02 

+ 
H02 
+ 
H02 
+  0.770*ALD 

"' 

+  0.750*ALD 
+  0.260*KBT 

+  0.410*ALD 

+  0.750*KBT 

+  0.460*ALD 

+  1.390*KET 

+  0.350*ALD 
+  0.750*ALD 
+  0.72,,5*ALD 

+ 
+ 
~ 

H02 
H02 
H02 

+  0.750*MGLY 
+  0.500*H02 

+ 
H02 
+,  O.SQP*M<!>2 

+  0.170*MGLY 
+  2.000*H02 
+  0.450*MGLY 

+  0.160*GLY 

+  0.806*DCB 

+  0.445*GLY 
+  0.025*AC03 
+ 
X02 
+  O.SOO*H02 

+  O.OSS*MGLY 
+  0.460*H02 

+ 

ALO 

+  O.SOO*H02 

+  O.SOO*M02 

+  0.260*KET 
+  O.SOO*ORA2 
+  0.7SO*KET 
+  0. SOO*ORA2 
+  1.390*KET 
+  O.SOO*OW 
+  0.600*ALD 
+  0.500*0RA2 
+  O.SOO*HCHO 
+  0. s6o•oRA2 
+  0.550*KET 
+  0.500*M02 
+  O.SOO*H02 

+  0.500*H02 

+  O.SOO*H02 

+  O.SOO*H02 

+  O.SOO*H02 

+  O.SOO*H02 

+  O.l40*HCHO 
+  O.SOO*ORA2 
+  O.SOO*M02 

+  O.l70*MGLY 

+  O.l60*GLY 

Table 8A-10.  RADM2  CISl  AE and RADM2  CIS 1 _AE_AQ Mechanisms 

{J.42}  AC03 

+  XYLP 

{J.43}  AC03 

+  TC03 

{J.44}  AC03 

+  OLN 

+  OLN 
{ J.45}  OLN 
+  H02 
{ J.46}  X02 
+  M02 
{J.47}  X02 
+  AC03 
{ J.48}  X02 
+  X02 
{J.49}  X02 
+  NO 
{J.50}  X02 
+  N02 
{J.51}  XN02 
+  H02 
{J.52}  XN02 
+  M02 
{J.53}  XN02 
+  AC03 
{J.54}  XN02 
+  XN02 
{155}  XN02 
+  HO 
{J.56}  TERP 
+  N03 
{J.57}  TERP 
+  03 
{J.58}  TERP 
+  HO 
{J.59}  ISO 
{J.60}  ISO_R02  +  NO 

{J.61}  ISO_R02  +  H02 
{J.62}  ISO_R02  +  AC03 

{J.63}  ISO_R02  +  M02 
{J.64}  ISO 

+  03 

{J.65}  ISO 

+  03P 

{J.66}  ISO 
{J.67}  ISON_R02  +  NO 

+  N03 

{J.68}  ISON_R02  +  H02 
{J.69}  ISON_R02  +  AC03 

{J.70}  ISON_R02  +  M02 

{J.71}  ISOPROD  +  HO 
+  NO 
{J.72}  IP_R02 

{J.73}  IP_R02 
{J.74}  IP_R02 

+  H02 
+  AC03 

{J.75}  .IP_R02 

+  M02 

{J.76}  ISOPROD  +  03 

{J.77}  ISOPROD  +  hv 

{J.78}  ISOPROD  +  N03 

+  0.700*DCB 
M02 
H02 
M02 

+ 

+  O.J.J.O*MGLY 
+  2.000*X02 

+ 

HCHO 
N02 

2.000*HCHO 

OP2 
HCHO 
M02 

N02 
ONIT 
OP2 
HCHO 
M02 

+ 
+  0.450*MGLY 

H02 

+  0.806*DCB 

+  0.920*H02 
+  0.050*AC03 

+  0.890*GLY 
+  0.950*CO 

+ 
ALD 
+  0.500*M02 
+  2.000*ALD 

+ 

H02 

+  0.500*0RA2 

+  2.000*N02 

+ 

H02 

TERPAER  + 
TERPAER  + 
TERPAER  + 
ISO  R02  +  0.079*X02 
+  0'. 9J.2*N02 

HO 
N03 
03 

0.088*0NIT 

+  0.9l.2*H02 

+  0.9J.2*ISOPROD  +  0.629*HCHO 

OP2 
0.500*H02 

+ 

ISOPROD 

+  0.SOO*M02 

+  0.500*0RA2 

0.500*HCHO 
0.600*HCHO 

+  O.SOO*H02 
+  0.650*ISOPROD  +  0.390*0RAJ. 
+  0. 070*H02 
+  0.200*AC03 
0.750*ISOPROD  +  0.250*AC03 

+  0.070*CO 
+  O.J.50*ALD 
+  0.250*HCHO 

+  0.270*HO 
+  0.200*X02 

+ 

ISOPROD 

+  0.800*ALD 
+  0.200*ISOPROD  +  0.200*N02 

+  0.800*0NIT 

+  0.500*M02 
+ 
+  0.500*H02 

ONIT 

+  0.500*IP  R02 
+ 
+  0.250*HCHO 
+  0.630*KET 

H02 

+  0.500*M02 
+  0.500*KET 
+  0.500*H02 

+  O.J.OO*H02 
+  0.070*X02 
+  0.020*ALD 
+  0.090*KET 
+  0.333*H02 
+  0.333*CO 

+  0.075*HN03 
+  0.925*0NIT 
+  0.925*X02 

+  0.500*0RA2 

+ 

ALD 

+  0.200*X02 
+  0.590*CO 
+  0.080*GLY 

+  0.500*0RA2 

+  O.SOO*ALD 

+  O.J.J.4*AC03 
+  O.J.55*CO 
+  0.010*GLY 
+  0.462*0RAJ. 
+  0.700*M02 
+  0.067*ALD 

+  0.643*CO 
+  0.282*ALD 

--> 

--> 

--> 

--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 

--> 
--> 

--> 
--> 

--> 

--> 
--> 

--> 
--> 

--> 

--> 
--> 

--> 
--> 

+  0.250*M02 

ISON_R02 
N02 
+  0.800*H02 

ONIT 

0.500*H02 
ALD 

0.500*HCHO 
ONIT 
0.500*AC03 

+ 

+ 

N02 
+  0.550*ALD 
+  0.340*MGLY 

OP2 
0.500*H02 
+  0.500*ALD 

--> 

0.500*HCHO 

--> 

--> 

--> 

+  O.SOO*KET 
0.268*HO 
+  0.054*M02 
+  O.J.46*HCHO 
+  0.850*MGLY 
0.970*AC03 
+  0.200*HCHO 
+  0.033*KET 
0.075*AC03 
+  0,282*HCHO 
+  0.925*H02 

8-77 

1,,,, 

EPA/600/R-99/030 

Table 8A-10.  RADM2_CIS1_AE and RADM2_CISl_AE_AQ Mechanisms 
>----------------------------------------------------------------------------------------< 

Rate  Expression 

Rate  Constant 

========~====~c====c==========================c===================c=====m====== 

,  scaled  by 
,  scaled  by 
,  scaled  by 
,  scaled  by 
,  scaled  by 
,  scaled  by 
,  scaled  by 
,  scaled  by 
,  scaled  by 
,  scaled  by 
,  scaled  by 
,  scaled  by 
,  scaled  by 
,  scaled  by 
,  scaled  by 
,  scaled  by 
,  scaled  by 
,  scaled  by 
,  scaled  by 
,  scaled  by 
,  scaled  by 

l.OOOOOE+OO 
l.OOOOOE+OO 
l.OOOOOE+OO 
l.OOOOOE+OO 
l.OOOOOE+OO 
l.OOOOOE+OO 
l.OOOOOE+OO 
l.OOOOOE+OO 
1.00000E+OO 
1.00000E+OO 
1.oooooE+oo 
1. OOOOOE+OO 
l.OOOOOE+OO 
l.OOOOOE+OO 
l.OOOOOE+OO 
l.OOOOOE+OO 
l. OOOOOE+OO 
l.OOOOOE+OO 
1.00000E+OO 
1.00000E+OO 
1.00000E+OO 

k( 
l)  uses  photo  table  N02_RADM88 
k( 
2)  uses  photo  table  03010  RADM88 
k(  3)  uses  photo  table  0303P-RADM88 
k(  4)  uses  photo  table  HONO_RAoM88 
5)  uses  photo  table  HN03_RADM88 
k( 
6)  uses  photo  table  HN04_RADM88 
k( 
k( 
7)  uses  photo  table  N03NO  RADM88 
8)  uses  photo  table  N03N02_RADM88 
k( 
k( 
9)  uses  photo  table  H202_RADM88 
k(  10)  uses  photo  table  HCHOmol_RADM88 
k(  11)  uses  photo  table  HCHOrad_RADM88 
k(  12)  uses  photo  table  ALD_RADM88 
k(  13)  uses  photo  table  MHP_RADM88 
k(  14)  uses  photo  table  HOP_RADM88 
k(  15)  uses  photo  table  PAA_RADM88 
k(  16)  uses  photo  table  KETONE_RADM88 
k(  17)  uses  photo  table  GLYform_RADM88 
k(  18)  uses  photo  table  GLYmol_RADM88 
k(  19)  uses  photo  table  MGLY_RADM88 
k(  20)  uses  photo  table  UDC_RADM88 
k(  21)  uses  photo  table  ORGNIT  RADM88 
k(  22)  =  6.0000E-34  *  (T/300);*(-2.30) 
k(  23)  =  6.5000E-l2  *exp( 
120.0/T) 
k(  24)  = 
l.8000E-11  *  exp( 
110.0/T) 
k(  25)  =  3.2000E-11  *exp( 
70.0/T) 
k(  26)  =  2.2000E-10 
k(  27)  =  2.0000E-12  *  exp(  -1400.0/T) 
k(  28)  =  1.6000E-12  *  exp( 
-940.0/T) 
k(  29)  =  1.lOOOE-14  *  exp( 
-500.0/T) 
k(  30)  =  3.?000E-12  *exp( 
240.0/T) 
k(  31)  is  a  falloff  expression  using: 

=  l.0oooi-31  *  (T/300)**(-3.20) 
kO 
kinf  =  4.7000E~12  *  (T/300)**(-1.40) 
F  =  0.60, 

n  =  1:00 

•• 

I 

, 

k(  32)  =  k(  31)  I  Keq,  where  Keq  =  2.100E-27  *  exp(  10900.0/T) 
k(  33)  is  a  special  ·rate  expression  of  the  form:. 

k  = kl  +  k2 [MJ,'  where 
··· 
kl  =  2.2000E-13  *  exp( 
k2  = 
l.9000E-33  *  exp( 

·· 

620.0/T) 
980.0/T) 

k(  34)  is  a  special  rate  expression  of  the  form: 

k  =kl+  k2[M],'  where 
kl  =  3.0800E-34  *  exp(  2820.0/T) 
k2  =  2.6600E-54  *  exp(  3180.0/T) 
k(  35)  =  3.3000E-12  *exp( 
-200.0/T) 
k(  36)  is  a  falloff  expression  using: 

0.60, 

n  =  1.00 

• .  

ko  =  7.oopoE-31  *  (~/300)**(-2.60) 
kinf  ~  1.5000~-11 *  (~/300)**(-0.50) 
F  = 
k(  37) 
k(  38) 
k(  39) 
k(  40) 
k(  41) 
k(  42) 
2.2000E-3o  *  (T/300)**(-4.30) 
kO 
kinf  =  1.5000E-12  *  (T/300)**(-0.50) 

3.3000E-39  *  exp( 
l.4000E-13  *  exp( 
l.?OOOE-11  *  exp( 
2.5000E-14  *exp( 
2.5000E-12 

530.0/T) 
-2500.0/T) 
150.0/T) 
-1230.0/T) 

is  a  falloff  expression  using: 

I 

8-78 

!11! 

I 

{O.OOOOOE+OO} 
{o.oooooE+oo} 
{o.oooooE+oo} 
{o.oooooE+oo} 
{o.oooooE+oo} 
{o.oooooE+oo} 
{0.00000E+OO} 
{0.00000E+OO} 
{O.OOOOOE+OO} 
{O.OOOOOE+oo} 
{O.OOOOOE+OO} 
{O.OOOOOE+OO} 
{ 0. OOOOOE+OO} 
{O.OOOOOE+oo} 
{O.OOOOOE+OO} 
{o.oooooE+oo} 
{O.OOOOOE+OO} 
{0.00000E+OO} 
{O.OOOOOE+OO} 
{o.oooooE+oo} 
{O.OOOOOE+oo} 
{6.09302E-34} 
{9.72293E-12}' 
{2.60365E-11} 
{4.04730E-11} 
{2.20000E-10} 
{l. 82272E-14} 
{6.82650E-14} 
{2.05452E-15} 
{8.27883E-12} 
{l.39058E-12} 

{8.62399E-02} 
{3.01634B-l2} 

{6.78905E-30} 

{l.6867lE-12} 
{4.87144E-l2} 

{l.95397E-38} 
{3.18213E-l7} 
{2.81225E-1l} 
{4.03072E-l6} 
{2.50000E-l2} 
{l.26440E-l2} 

Table 8A-10.  RADM2  CISl_AE and RADM2_CIS1_AE_AQ Mechanisms 

EP A/600/R-99/030 

F  =  0.60, 

n  =  1.00 

k(  43)  = k(  42)  I  Keq,  where  Keg  =  l.lOOE-27  *  exp(  11200.0/T) 
k(  44)  =  2.0000E-21 
k(  4S)  is  a  falloff  expression  using: 

k(  46)  is  a  special  rate  expression  of  the  form: 

n  =  1.00 

=  2.6000E-30  *  (T/300)**(-3.20) 
kO 
kinf  =  2.4000E-ll  *  (T/300)**(-1.30) 
F  =  0.60, 
k  = kO  +  {k3[M) 
kO  =  7.2000E-1S  *  exp( 
78S.O/T) 
k2  =  4.lOOOE-16  *  exp(  1440.0/T) 
k3  =  1.9000E-33  *  exp( 
72S.O/Tl 
k(  47)  =  l.3000E-12  *  exp( 
380.0/T) 
k(  48)  =  4.6000E-11  *  exp( 
230.0/T) 
k(  49)  is  a  falloff  expression  using: 

/ 

(1  +  k3[MJ/k2J},  where 

0.60, 

n  =  1.00 

256.0/T) 
-74S.O/T) 

-S40.0/T) 
-380.0/T) 
-380.0/T) 
411.0/T) 
S04.0/T) 
S49.0/T) 
322.0/T) 
116.0/T) 

kO  =  3.0000E-31  *  (T/300)**(-3.30) 
kinf  =  1.SOOOE-12  *  (T/300)**(  0.00) 
F  = 
k(  SO) 
k(  Sl) 
k(  S2) 
k(  S3) 
k(  S4) 
k(  SS) 
k(  S6) 
k(  S7) 
k(  S8) 
k(  S9) 
k(  60) 
k(  61) 
k("  62) 
k(  63) 
k(  64)  = 
k(  6S) 
k(  66) 
k(  67) 
k(  68) 
k(  69) 
k(  70) 
k(  71) 
k(  72) 
k(  73) 
k(  74) 
k(  7S) 
k(  76) 
k(  77) 
k(  78) 
k(  79) 
k(  80) 
k(  81) 
k(  82) 
k(  83)  = 
k(  84) 
k(  8S) 
k(  86) 
k(  87) 
k(  88) 
k(  89)  = 
k(  90)  = 
k(  91) 
k(  92) 

l.SOOOE-13  *  (1.0  +  0.6*Pressure) 
2.8300E+Ol  *  (T/300)**(  2.00)  *  exp(  -1280.0/T) 
1.2330E-12  *  (T/300)**(  2.00)  *exp( 
-444.0/T) 
1.S900E-11  *  exp( 
1.7300E-11  *  exp( 
3.6400E-11  *exp( 
2.lSOOE-12  *  exp( 
S.3200E-12  *  exp( 
l.0700E-ll  *  exp( 
2.lOOOE-12  *  exp( 
1.8900E-ll  *  exp( 
4.0000E-11 
9.0000E-01  *  k(  61) 
9.0000E-12 
6.8700E-12  *  exp( 
l.2000E-11  *  exp( 
l.lSOOE-11 
l.7000E-11 
2.8000E-11 
1.0000E-11 
1. OOOOE-11 
1. OOOOE-11 
6.16SOE-13  *  (T/300)**(  2.00)  *exp( 
-540.0/Tl 
l.5500E-ll  *  exp( 
2.8000E-12  *  exp( 
181.0/T) 
l.9500E+l6  *  exp(-13S43.0/Tl 
4.7000E-12 
l.9500E+16  *  exp(-13S43.0/T) 
180.0/T) 
4.2000E-12  *  exp( 
4.2000E-12  *  exp( 
180.0/T) 
180.0/T) 
4.2000E-12  *  exp( 
180.0/T) 
4.2000E-12  *  exp( 
4.2000E-12  *  exp( 
180.0/T) 
180.0/T) 
4.2000E-12  *  exp( 
4.2000E-12  *  exp( 
180.0/T) 
180.0/Tl 
4.2000E-12  *  exp( 
180.0/Tl 
4.2000E-12  *  exp( 
4.2000E-12  *  exp( 
180.0/T) 
4.2000E-12  *  exp( 
180.0/T) 
180.0/T) 
4.2000E-12  *  exp( 
180.0/T) 
4.2000E-12  *  exp( 
4.2000E-12  *  exp( 
180.0/T) 
6.0000E-13  *  exp(  -2058.0/T) 

-444.0/T) 

{S.47034E-02} 
{2.00000E-21} 
{1.14885E-11} 

{1.47236E-13} 

{4.65309E-12} 
{9.95294E-ll} 
{8.88848E-13} 

{2.40000E-13} 
{3.80672E-01} 
{2.74210E-13} 
{2.59669E-12} 
{4.83334E-12} 
{1.01696E-11} 
{8.S3916E-12} 
{2.88684E-ll} 
{6.75269E-11} 
{6.18715E-12} 
{2.78943E-11} 
{4.00000E-11} 
{3.60000E-11} 
{9.00000E-12} 
{l.62197E-11} 
{9.8S020E-13} 
{l.15000E-11} 
{1. 70000E-11} 
{2.80000E-11} 
{1.00000E-11} 
{l.OOOOOE-11} 
{1.00000E-11} 
{1.3710SE-13} 
{2.53137E-12} 
{S.13974E-12} 
{3.57235E-04} 
{4.70000E-12} 
{3.57235E-04} 
{7.68378E-:12} 
{7.68378E-12} 
{7.68378E-12} 
{7.68378E-12} 
{7.68378E-12} 
{7,68378E-12} 
{7.68378E-12} 
{7.68378E-12} 
{7.68378E-12} 
{7.68378E-12} 
{7.68378E-12} 
{7.68378E-12} 
{7.68378E-12} 
{7.68378E-12} 
{6.01030E-16} 

Table 8A-10.  RADM2_CIS1_AE and RADM2_CISI_AE_AQ Mechanisms 
k(  93)  =  1.4000E-12  *  exp(  -1900.0/T) 
k(  94)  =  6.0000E-13  *  exp(  -2058.0/T) 
k(  95)  =  1.4000E-12  *  exp(  -1900.0/T) 
k(  96)  =  1.4000E-12  *  exp(  -1900.0/T) 
k(  97)  =  2.2000E-11 
k(  98)  =  2.0000E~12  *  exp(  -2923.0/T) 
k(  99)  =  1.0000E-11  *  exp(  -1895.0/T) 
k(100)  =  3.2300E-11  *  exp( 
-975.0/T) 
k(101)  =  1.2000E~14  *  exp(  -2633.0/T) 
k(102)  =  l.3200E-14  *  exp(  -2105.0/T) 
k(103)  =  7.2900E-15  *  exp(  -1136.0/T) 
k(104)  =  7.7000E-14  *  exp(  1300. O/T) 
k(105)  =  7.7000E-14  *  exp(  1300. O/T) 
k(l06)  =  7.7000E-14  *  exp(  1300. O/T) 
k(l07)  =  7. 7000E-14  *  exp(·  1300.0/T) 
k(108)  =  7.7000E-14  *  exp(  1300. O/T) 
k(109)  =  7.7000E~l4  *  exp(  1300. O/T) 
k(llO)  =  7.7000E-14  *  exp(  1300.0/T) 
k(111)  =  7.7000E-14  *  exp(  1300 .O/T) 
k(l12)  =  7.7000E~14  *  exp(  1300. O/T) 
k(l13)  =  7.7000E-14  *  exp(  1300. O/T) 
k(l14)  =  7.7000E-14  *  exp(  1300. O/T) 
k(l15)  =  7.7000E-14  *  exp(  1300.0/T) 
k(l16)  =  7.7000E-14  *  exp(  1300. O/T) 
k(l17)  =  7.7000E-14  *  exp(  1300.0/T) 
k(l18)  = 
220.0/T) 
l.9000E-13  *  exp( 
k (l.19)  =  1.4000E-13  *  exp( 
220. O/T) 
k(120)  =  4.2000E-14  *  exp( 
220.0/T) 
k(121)  =  3.4000E-14  *  exp( 
220.0/T) 
k(122)  =  2.9000E-14  *  exp( 
220.0/T) 
k(l23)  = 
220,0/T) 
l.4000E-13  *  exp( 
k(124)  =  1.4000E-13  *  exp( 
220.0/T) 
220.0/T) 
k(125)  =  1.7000E-14  *  exp( 
k(l26)  =  1.7000E-14  *  exp( 
220.0/T) 
k(l27)  =  9.GOOOE-13  *  exp( 
220. O/T) 
k(128)  =  1.7000E-14  *exp( 
220.0/T) 
k(129)  =  1.7000E-14  *  exp( 
220.0/T) 
k(130)  =  9.6000E-13  *  exp( 
220.0/T) 
220.0/T) 
k (131)  =  1.7000E-14  *  exp( 
k(132)  =  3.4000E-13  *exp( 
220.0/T) 
k (133)  =  1.0000E-13  *  exp( 
220.0/T) 
k(l34)  =  8.4000E-14  *  exp( 
220.0/T) 
k(135)  =  7.2000E-14  *  exp( 
220.0/T) 
k(136)  =  3.4000E-13  *  exp( 
220.0/T) 
k(137)  =  3.4000E-13  *  exp( 
220.0/T) 
k(l38)  =  4.2000E-14  *  exp( 
220.0/T) 
k(139)  =  4.2000E-14  *  exp( 
220.0/T) 
k(l40)  =  1.1900E-12  *  exp( 
220 .O/T) 
k(141)  =  4.2000E-14  *  exp( 
220. O/T) 
k(l42)  =  4.2000E-14  *  exp( 
220 .O/T) 
k(143)  =  1.1900E-12  *  exp( 
220. O/T) 
k(l44)  =  4.2000E-14  *  exp( 
220 .O/T) 
k(145)  =  3.6000E~16  *exp( 
220.0/T) 
k(146)  =  7.7000E-14  *  exp(  1300.0/T) 
k(147)  =  1.7000E-14  *  exp( 
220.0/T) 
k(148)  =  4.2000E~14  *  exp( 
220.0/T) 
220.0/T) 
3.GOOOE-16  *exp( 
k(149)  = 
k(150)  =  4.2000E-12  *  exp( 
180.0/T) 
k(151)  =  4.2000E-12  *  exp( 
180.0/T) 
k(152)  =  7.7000E-14  *  exp(  1300.0/T) 
k(153)  =  l.7000E-14  *  exp( 
220.0/T) 

{2.38307E-15} 
{6.01030E-16} 
{2.38307E-15} 
{2.38307E::,15} 
{2.20000E-11},, 
{1.09940E-16} 
{1.73099E-14} 
{1.22539E-12} ,, 
{1.74559E-18} 
{1.12933E-17} 
{1.61125E-16} 
{6.04038E-12} 
{6.04038E-12} 
{6.04038E-12} 
{6.04038E-12} 
{6.04038E-12}"'' 
{6.04038E-12} 
{6.04038E-12} 
{6.04038E-12} 
{6.04038E-12} 
{6.04038E-12} 
{6.04038E-12} 
{6.04038E-12} 
{6.04038E-12} 
{6.040J8E-12} 
{3.97533E-13} 
{2.92919E-13}, 
{ 8. 78758E-14} ·• 
{7.l.1376E-14} "' 
{ 6. 06762E-14}  ' 
{2.92919E-13} 
{2.92919E-13} 
{3. 55688E-14}  1
{3.55688E-14} 
{2.00859E-12} ··' 
{3 .55688E-14}  !" 
{3.55688E-14} 
{2.00859E-12} 
{3.55688E-14} 
{7.11376E-13} 
{2.09228E-13}  ,. 
{1.75752E-13} 
{1.50644B-13} 
{7.l.1376E-13} 
{7.l.1376E-13} 
{8.78758E-14} 
{8.78758E-14} 
{2.48981E-12} 
{8.78758E-14}' 
{8.78758E-14} 
{2.48981E-12} 
{8.78758E-14} 
{7.53221E-16} 
{6.04038E-12}, 
{3 .55688E-14}  · 
{8.78758E-14} 
{7.53221E-16} 
{7.68378E·12} 
{7.68378E-12} 
{6.04038E-12} 
{3.55688E-14} 

" 

Table 8A-10.  RADM2  CISl~AE and RADM2~CISl_AE_AQ Mechanisms 

EP A/600/R-99/030 

{8.78758E-14} 
{7.53221E-16} 
{6.75269E-11} 
{1.22539E-12} 
{1.61125E-16} 
{9.90719E-11} 
{7.66335E-12} 
{5.96598E-12} 
{1.75402E-13} 
{7.09961E-14} 
{1.27569E-17} 
{3.60000E-11} 
{6.69552E-13} 
{7.66335E-12} 
{5.96598E-12} 
{1. 75402E-13} 
{7.09961E-14} 
{3 .36000E-11} 
{7.66335E-12} 
{5.96598E-12} 
{1. 75402E-13} 
{7.09961E-14} 
{7.llOOOE-18} 
{O.OOOOOE+OO} 
{1.00000E-15} 

220.0/T) 
220.0/T) 

4.2000E-14  *  exp( 
3.6000E-16  *exp( 
l.OOOOE+OO  *  k(  58) 
l.OOOOE+OO  *  k(lOO) 
l.OOOOE+OO  *  k(l03) 
2.5400E-ll  *  (T/300)**( 
4.2000E-12  *  (T/300)**( 
7.7000E-14  *  (T/300)**( 
8.4000E-14  *  (T/300)**( 
3.4000E-14  *  (T/300)**( 
7.8600E-15  *  (T/300)**( 
3.6000E-11 

k(l54) 
k(l55) 
k(l56) 
k(l57) 
k(l58) 
k(l59) 
k(l60) 
k(l61) 
k(l62) 
k(l63) 
k(l64) 
k(l65) 
k(l66)  =  3.0300E-12  * 
k(l67) 
4.2000E-12  * 
k(l68)  =  7.7000E-14  * 
k(l69)  =  8.4000E-14  * 
k(l70) 
3.4000E-14  * 
k(l71) 
3.3600E-11 
k(l72) 
4.2000E-12  * 
k(l73) 
7.7000E-14  * 
k(l74) 
8.4000E-14  * 
k(l75) 
3.4000E-14  * 
k(l76) 
7.llOOE-18 
k(l77)  uses  photo  table  ACROLEIN 
k(l78)  =  l.OOOOE-15 

(T/300) ** ( 
(T/300) ** ( 
(T/300) ** ( 
(T/300) ** ( 
(T/300) ** ( 

(T/300) ** ( 
(T/300) ** ( 
(T/300) ** ( 
(T/300) ** ( 

1. 00) 
1. 00) 
1. 00) 
1. 00) 
1. 00) 
1.00) 

*  exp( 
*  exp( 
*  exp( 
*  exp( 
*  exp( 
*  exp( 

407.6/T) 
181.2/T) 
1298.3/T) 
221.4/T) 
221.4/Tl 
-1912.2/Tl 

1. 00) 
1. 00) 
1. 00) 
1. 00) 
1. 00) 

*  exp( 
*  exp( 
*  exp( 
*  exp( 
*  exp( 

-447.9/Tl 
181.2/T) 
1298.3/T) 
221.4/T) 
221.4/T) 

1.00) 
1.00) 
1.00) 
1.00) 

*  exp( 
*  exp( 
*  exp( 
*  exp( 

181.2/T) 
1298.3/T) 
221.4/T) 
221.4/T) 

,  scaled  by  3.60000E-03 

Table 8A-1 l.  RADM2_CIS4 and RADM2_CIS4_AQ Mech~~ms 

I 

R~action List 

I 

..  .  .. 

. 

. 

. 

. 

., 

. 

., 

+ 

NO 

+ 
+ 
+ 

. 
.. ,., 

>------------~---~--------------------------·-~-----------------~------------------------< 
l}  N02 
{ 
2 }  03 
{ 
3}  03 
{ 
4}  HONO 
{ 
s}  HN03 
{ 
6}  HN04 
{ 
{ 
7}  N03 
{  a}  N03 
{ 
9}  H202 
{  10}  HCHO 
{  11}  HCHO. 
{  12}  ALD 
{  13}  OPl 
{  14}  OP2 
{  lS}  PAA 
{  16}  KET 
{  17}  GLY 
{  18}  GLY 
{  19}  MGLY 
{  20}  DCB 
{  21}  ONIT 

+ 
+ 
+ 
+ 
+ 
+ 
+  1.s1o•co 
+  i.sso•co 
+ 
H02 
+  0.020*AC03 
+  O.SOO*KET 

--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
-~> 
--> 
--> 
--> 
--> 
--> 
--> 

+  0.80D*H02 
co 
+ 
+ 
TC03 
+ 
H02 

H02 
H02 
H02 
H02 
HO 
BTHP 

co 
co 
HO 
HO 

NO 
N02 
N02 

+ 
+ 
+ 
+ 

03P 

+ 

1 1':11, 

03P 
010 
03P 
HO 
HO 
H02 
NO 
N02 
2.ooo•Ho 
CO 
H02 
M02 
HCHO 
ALO 
~02 
AC03 
0.130*HCHO 
0.4SO•HCHO 
AC03 
0.980*H02 
0.200*ALD 
N02 
03 
NO 
,03P 
03P 

+ 

+  hv 
+  hv 
+  hv 
+  hv 
+  hv 
+  hv 
+  hv 
+  hv 
+  hv 
+  hv 
+  ~v 
+  hv 
+  hv 
+  ~v 
+  ~v 
+  hv 
+  hv 
+  hv 
+  hv 
+  hv 
+  hv 
' 
+ 
[ 1
M] 
I 
+  N02 
+  cl:.i21 
+  c'o2J 
+  cli201 
+  N,O 
+  HO 
+  Jio2 
I 
+  NO 
I 
+  N02 

I 

I 

I 

I 

I 

+  H02 
+  H02 
+  HO 
+  HO 
+  NO 
+  N02 
+  NO 
+  N02 
+  H02 
+  N02 

I 

I 

I 

I 

+  [H20] 
+  N02 
+  HN03 
+~Oji 
+  H02 
+  S02 
+  HO 
I 
+  Hp 
+  Hp 
+  Hp 
+  HO 
I 
+  HO 
+  llf 
I 

I 

{  22}  03P 
{  23}  03P 
{  24}  010 
{  2S}  OlD 
{  26}  OlD 
{  27}  03 
{  28}  03 
{  29}  03 
{  30}  H02 
{  31}  H02 
{  32}  HN04 
{  33}  H02 
{  34}  H02 
{  3S}  H202 
{  36}  NO 
{  37}  NO 
{  38}  03 
{  39}  N03 
{  40}  N03,, 
{  41}  N03 
{  42}  N03 
{  43}  N20S 
{  44}  N20S 
{  4S}  HO 
{  46}  HO 
{  47}  HO 
{  48}  HO 
{  49}  HO 
{  so}  co 
{  Sl}  HO 
{  S2}  ETH 
{  S3}  HC3 

{  S4}  HCS 
{  SS}  HC8 
{  S6}  OL2 
{  S7}  OLT 

+  [02] 

+  [H20] 

+  [02] 

--> 
--> 
--> 
--> 
--> 
-•> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
-·> 
--> 
--> 
·-> 
--> 
--> 

--> 
--> 
--> 
--> 

2 •. 000*HO 

N02 
H02 
HO 
N02 
HN04 
H02 
H202 
H202 
H02 
HONO 

2.000*N02 
N03 
2.000*N02 
~o 
HN03 
N20S 
N02 

2.000*HN03 
HN03 
N03 
N02 

SULF 
802 
M02 
ET.l:lP 
0.830•HC3P 
+  0.075*ALD 
,.  HcSP 
HC8P 
OL2P 
OLTP 

8-.82 

+ 

+ 

+ 

+ 

HO 

N02 

N02 

N03 

'11111 

+ 

H02 

+  O.l.70*H02 
+  0.02S*KET 
+  o.2so•xo2 
+  <i.7SO*X02 

+  0.009*HCHO 

11111":1 

+  0.250*CSL 
+  0.170*CSL 
+  0.900*X02 

+ 

co 

--> 
--> 
--> 
--> 
--> 
--> 

Table 8A-1 l.  RAD1:f2_CIS4. and RADM2_CIS4_AQ Mechanisms: 
{  58}  OLI 
{  59}  TOL 
{  60}  XYL 
{  61}  CSL 
{  62}  CSL 
{  63}  HCHO 
{  64}  ALD 
{  65}  KET 
{  66}  GLY 
{  67}  MGLY 
{  68}  DCB 
{  69}  OP1 
{  70}  OP2 
{  71}  PAA 
{  72}  PAN 
{  73}  ONIT 
{  74}  AC03 
{  75}  PAN 
{  76}  TC03 
{  77}  TPAN 
{  78}  M02 
{  79}  HC3P 

OLIP 
0.750*TOLP 
0.830*XYLP 
0.100*li02 
CSL 
H02 
AC03 
I<ETP 
H02 
AC03 
TC03 
0.500*M02 
0.500*HC3P 
AC03 
HCHO 
HC3P 
PAN 
AC03 
TPAN 
TC03 
HCHO 
0.750*ALD 

+  HO 
+  HO 
+  HO 
+  HO 
+  HO 
+  HO 
+  HO 
+  HO 
+  HO 
+  HO 
+  HO 
+  HO 
+  HO 
+  HO 
+  HO 
+  HO 
+  N02 

--:~ 

--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--::· 
--> 
--::-

+  2.000*CO 
co 
+ 

+  N02 

+  NO 
+  NO 

+ 
+ 

+ 

+  0.500*HCHO 
+  0.500*ALD 

N03 
N02 

N02 

N02 
+ 
+ 
H02 
+  0.250*KET 
+  0.964*N02 
+  0.690*I<ET 
+  0.920*H02 
+  1.060*I<ET 
+  0.760*N02 
+ 
H02 

EP A/600/R·99/030 

+  0.250*H02 
+  0.170*H02 
+  0.900*TC03 

+  0.500*HO 
+  0.500*HO 

+ 

X02 

N02 

+ 
+  0.090*HCHO 
+  0.964*H02 
+  O.OSO*ONIT 

+  0.040*HCHO 
+  0.760*H02 
+ 
N02 

so}  HC5P 

81}  HCSP 

82}  OL2P 

83}  OLTP 

84}  OLIP 

85}  AC03 
86}  TC03 

87}  TOLP 

88}  XYLP 

{  89}  ETHP 
{  90}  I<ETP 
{  91}  OLN 
{  92}  HCHO 
{  93}  ALD 
{  94}  GLY 
{  95}  MGLY 
{  96}  DCB 
{  97}  CSL 
{  98}  OL2 
{  99}  OLT 
{100}  OLI 
{101}  OL2 

+  NO 

+  NO 

+  NO 

+  NO 

+  NO 

+  NO 
+  NO 

+  NO 

+  NO 

+  NO 
+  NO 
+  NO 
+  N03 
+  N03 
+  N03 
+  N03 
+  N03 
+  N03 
+  N03 
+  N03 
+  N03 
+  03 

{102}  OLT 

+  03 

{103}  OLI 

+  03 

--> 

--> 

- -> 

--> 

--> 

--> 
--> 

--:-

--:-

--:-
--:-
--> 
--:-
--:-
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 

--> 

--> 

+  0.036*0NIT 

·0.380*ALD 
+  0.920*N02 
0.350*ALD 

+ 

+  0.240*0NIT 
1. 600*HCHO 
+  0.200*ALD 
ALD 
N02 
H02 
+  0.100*KET 
M02 
N02 

+  0.110*MGLY 
+  2.000*X02 
N02 
+  0.160*GLY 
N02 
+  ·o.S06*DCB 
ALD 
MGLY 
HCHO 
H02 
AC03 
HN03 
HN03 
HN03 
HN03 
OLN 
OLN 
OLN 
HCHO 
+  0.120*H02 

0.530*HCHO 
+  0.200*0RA1 
+  0.220*M02 

0.180*HCHO 

+·  ·0.230*CO 
+  ·a. 260*H02 

8~83 

+ 

HCHO 

+ 

H02 

+  1.450*ALD 
+ 
N02 
+ 
N02 
+  0.920*H02 
+  0.050*AC03 

+ 
H02 
+  0.700*DCB 
+ 
H02 

+ 
+ 
+ 
+ 
+ 
+ 
+ 
+ 
+ 

H02 
N02 
ALD 
HN03 
HN03 
H02 
AC03 
TC03 
XN02 

+  0.280*HCHO 

+  0.890*GLY 
+  0.950*CO 

+  0.170*MGLY 

+  0.450*MGLY 

+ 
N02 
+ 
H02 
+  2.000*N02 
co 
+ 

+  2.000*CO 
co 
+ 

+  0.500*CSL 

+  0.400*0RA1 

+  0.420*CO 

+  0.500*ALD 
+  0.200*0RA2 
+  0.100*HO 
+  0.720*ALD 
+  0.060*0RA1 
+  0.140*HO 

+  0.330*CO 
+  0.230*H02 

+  0.100*I<ET 
+  0.290*0RA2 
+  0. 310*M02 

Table 8A-1 l.  RADM2  CIS4 and RADM2  CIS4  AQ Mecl!am,~ros , 

I 

Ii' 

1

11,:1

: 

+ 
H02 
+ 
H02 
+  0.770*ALD 

+  0.750*ALD 
+  0.260*KET 

+  0.410*ALD 

+  0.750*KET 

O.BOO*HCHO 

+  0.460*ALD 

{104}  H02 
{105}  H02 
{106}  H02 
{107}  H02 
{108}  H02 
{109}  H02 
{110}  H02 
{111}  H02 
{112}  H02 
{113}  H02 
{114}  H02 
{115}  H02 
{116}  H02 
{117}  H02 
{118}  M02 
{119}  M02 
{120}  M02 

{121}  M02 

{122}  M02 

{123}  M02 
{124}  M02 
{125}  M02 

: {126}  M02 
.{127}  M02 

{128}  M02 

{129}  M02 

{130}  M02 

,, 

I 

I 

J 
,11, 

' 
+  M02 
+  ETHP 
+  ¥c3P 
+  HC5P 
+  HCBP 
+  OL2P 
+  ?LTP 
+  OLIP 
+  KETP 
+  AC03 
+  TOLP 
+  XYLP 
+  TC03 
+  OLN 
+  ~02 
+  ~THP 
+  HC3P 

'I''' 

I 

I 

., 

,, 

:1 

I 

I 

I 

+  HCSP 

I 

+  ¥CSP 

I 

+  ?L2P 
+  ?LTP 
+  ?LIP 

+  ~TP 
+  AC03 

I 

I 

I 

+  'f'OLP 

I 

+  XYLP 

I 

+  'f'C03 

{131}  M02 

+  OLN 

{132}  ETHP 

+  AC03 

{133}  HC3P 

+  AC03 

{134}  HC5P 

+  AC03 

{135}  HCBP 

{136}  OL2P 

{137}  OLTP 

{138}  OLIP 

{139}  KETP 

{140}  AC03 
{141}  AC03 

{142}  AC03 

{143}  AC03 

+  AC03 

, 

+  ~C03 

I 

+  ~C03 

I 

+  ~C03 

+  AC03 

I 

I 

I 

+  ~C03 
+  'f OLP 

I 

+  ¥-YLP 

I 

+  ':1'C03 

--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 

--> 

--> 

--> 
--> 
--> 

--> 
--> 

--> 

--> 

--> 

--> 

--> 

--> 

--> 

--> 

--> 

--> 

--> 

--> 

--> 
--> 

--> 

--> 

OPl 
OP2 
OP2 
OP2 
OP2 
OP2 
OP2 
OP2 
OP2 
PAA 
OP2 
OP2 
OP2 
ONIT 
l.500*HCHO 
0.750*HCHO 
0.840*HCHO 

H02 

0.770*HCHO 

H02 

+ 

+ 

+ 

H02 

l.550*HCHO 
l.250*HCHO 
0.890*HCHO 

+  0.550*KET 
0.750*HCHO 
HCHO 
+  0.500*0RA2 
HCHO 
+  0.700*DCB 
HCHO 

+  2.000*H02 

0.500*HCHO 
+  0.500*0RA2 
+  0.475*CO 

+ 

l.750*HCHO 

N02 
ALD 

+  0.500*0RA2 
0.770*ALD 
+  0.500*M02 
0.410*ALD 
+  0.500*M02 
0.460*ALD 
+  0.500*M02 

O.SOO*HCHO 

+  0.500*M02 
ALD 
+  0.50~*M02 
0.725*ALD 
+  0.500*H02 

MGLY 
+  o.soo*oRA2 

2.000*M02 
M02 
+  0.700*DCB 
M02 
H02 
M02 

+ 

+  O.llO*MGLY 

8-84 

+  0.350*ALD 
+  0.750*ALD 
+  0.725*ALD 

+  0.750*MGLY 
+  0.500*~02 

+  0.170*MGLY 
+  2.000*H02 
+  0 .450*MGLY 

+  0.44S*GLY 
+  0.025*AC03 
X02 
+ 
+  0.500*H02 

+  0.500*H02 

+  0. 26.0*KET 
+  0,500*0RA2 
+  0.750*KET 
+  0. 500*0RA2 
+  1.390*KET 
+  0.500*0RA2 
+  0.600*ALD 
+  0.500*0RA2 
+  0. 500*HC,i0 
+  0.500*0RA2 
+  0.550*KET 
+  o·.500*M02 
+  0.500*H02 

+  1. 390*KET 

+ 
+ 
+ 

+ 

H02 
H02 
H02 

H02 
O.SOO*M02 

1:1111

": 

Ill", 

+  0. i'6o•GLY 

+  0.806*DCB 

+  O.OSS*MGLY 
+  0.460*H02 

+ 

ALO 

''::::ii; 

+  O.SOO*M02 

+  o. s .. !l0*H02 

+  O.SOO*H02 

+  O.SOO*H02 

+  O.SOO*H02 

t  .. o. !:jOO*HQ2 

+ o. i'.•o•Hca'o 
+  o. scfo•oRA2 
+  O.SOO*M02 

+  0.170*MGLY 
+ 
+  0.4SO*MGLY 

H02 

+  0.160*GLY 

+  0.806*DCB 

+  0.920*H02 
+  O.OSO*AC03 

+  0.890*GLY 
+  0 •.. 9 .. SO*CO 

: i 11 ~ ! i " 

1'11' 

Table 8A-l 1.  RADM2_CIS4 and RADM2_CIS4_AQ Mechanisms 

{144}  AC03 

+  OLN 

+  OLN 
{145}  OLN 
+  H02 
{146}  X02 
+  M02 
{147}  X02 
+  AC03 
{148}  X02 
+  X02 
{149}  X02 
+  NO 
{150}  X02 
+  N02 
{151}  XN02 
+  H02 
{152}  XN02 
+  M02 
{153}  XN02 
+  AC03 
{154}  XN02 
+  XN02 
{155}  XN02 
+  HO 
{156}  ISO 
{157}  ISO_R02  +  NO 

{158}  ISO_R02  +  H02 
{159}  ISO_R02  +  AC03 

{160}  ISO_R02  +  M02 

{161}  ISO 

+  03 

+  2.000*X02 

+ 

HCHO 
N02 

2.000*HCHO 

OP2 
HCHO 
M02 

N02 
ONIT 
OP2 
HCHO 
M02 

ALO 
+ 
+  0.500*M02 
+  2.000*ALD 

+ 

H02 

+  0.500*0RA2 

+  2.000*N02 

+ 

H02 

--> 

--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 

ISO  R02 

0.088*0NIT 

+  0.079*X02 
+  0.912*N02 

+  0.362*ISOPROO  +  0.230*MACR 
+  0.629*HCHO 

+  0.079*X02 

--> 
--> 

OP2 
0.500*H02 

+  0.500*M02 

--> 

--> 

+  0.362*ISOPROO  +  0.230*MACR 
+  0.629*HCHO 
0.500*HCHO 
+  0.230*MACR 
0.600*HCHO 
+  0.390*0RA1 
+  0.070*CO 
+  0.150*ALO 

+  0.500*H02 
+  0.320*MVK 
+  0.390*MACR 
+  0.270*HO 
+  0.200*X02 
+  0.100*ISOPROO 

+  0.912*H02 
+  0.320*MVK 

+  0.500*0RA2 
+  0.320*MVK 

+  0.362*ISOPROO 
+  0.629*HCHO 
+  0.160*MVK 
+  0.070*H02 
+  0.200*MC03 

{162}  ISO 

+  03P 

--> 

0.750*ISOPROO  +  0.250*MC03 

+  0.250*HCHO 

{163}  ISO 
{164}  ISON_R02  +  NO 

+  N03 

{165}  ISON_R02  +  H02 
{166}  ISON_R02  +  AC03 

{167}  ISON_R02  +  M02 

+  HO 
{168}  MACR 
{169}  MACR_R02  +  NO 

{170}  MACR_R02  +  H02 
{171}  MACR_R02  +  AC03 

{172}  MACR_R02  +  M02 

{173}  MACR 

+  03 

{174}  MACR 

+  hv 

{175}  MACR 

+  N03 

{176}  MVK 
{177}  MVK_R02 

+  HO 
+  NO 

{178}  MVK_R02 
{179}  MVK  R02 

+  H02 
+  AC03 

--> 
--> 

--> 
--> 

--> 

--> 
--> 

--> 
--> 

--> 

+  0.250*M02 

ISON  R02 
N02 
+  0.800*H02 

ONIT 

0.500*H02 
ALO 

+ 

0.500*HCHO 
+  0.500*0NIT 
0.500*MC03 

N02 
+  0.840*CO 
OP2 
0.500*H02 
+  0.840*KET 
+  0.150*MGLY 
0.650*HCHO 

+  0.840*CO 

--> 

0.630*0RA1 

--> 

+  0.110*CO 
+  0.100*AC03 
0.660*H02 

+  0.670*HCHO 
+  0.340*X02 

+  0.800*ALO 
+  0.200*ISOPROO  +  0.200*N02 

+  0.800*0NIT 

+  0.500*M02 
+ 
+  0.500*H02 

ONIT 

+  0.500*0RA2 

+  0.500*ALO 

+  0.500*MACR_R02 
+ 
+  0.150*HCHO 

H02 

+  0.840*KET 
+  0.150*MGLY 

+  0.500*M02 
+  0.840*CO 

+  0.500*0RA2 
+  0.150*HCHO 

+  0.500*H02 
+  0.150*MGLY 
+  0.210*HO 
+  0.200*HCHO 

+  0.840*KET 

+  0.110*H02 
+  0.100*X02 

+  0.330*MC03 
+  0.670*AC03 

+  0.670*CO 
+  0.340*HO 

--> 

0.500*MC03 

+  0.500*H02 

+  0.500*HN03 
+  0.500*0NIT 

+  O.SOO*CO 
+  0.500*X02 

--> 
--> 

--> 
--> 

MVK_R02 
N02 

+  0.700*AC03 
+  0.300*H02 
OP2 
0.500*H02 

+  0.700*ALO 
.+  0.300*HCHO 

+  0.700*X02 
+  0. 300*MGLY 

+  1.200*M02 

+  0.500*0RA2 

Table 8A-11.  RADM2_CIS4 and RADM2_CIS4_AQ Mechanisms 

I 
' 

"'' 

,,; 

"", 

' 

' 

' 
I" 

1

' 

', 

'I 

{180}  MVK_R02 

I +  M02 

I 

{181}  MVK 

+  03 

I 

I 

+  0.700*ALD 

--> 

0.800*HCHO 

+  0.700*M02 

--> 

0.670*0RA1 

+  O.llO*CO 
+  0.050*X02 

+  0.300*HCHO 
+  0.500*H02 
+  0.300*MGLY 
+  0.160*HO 
+  0. 950*MGLY 
+  0. 050*AC03  ' 

+  0.300*MGLY 
+  0.700*ALD 

+  O.llO*H02 
+  O.lOO*HCHO 

{182}  MVK 

+  hv 

--> 

0.700*ISOPROD  +  0.700*CO 

+  0.300*M02 

{183}  MPAN 
{184}  MC03 
{185}  MC03 
{186}  MC03 
{187}  MC03 
{188}  MC03 
{189}  MC03 
{190}  ISOPROD 
{191}  IP_R02 

{192}  IP_R02 
{193}  IP_R02 

{194}  IP_R02 

{195}  ISOPROD 

I 

I +  NO 
I +  N02 
+  ho2 
+  M02 
+  AC03 
+  MC03 
I +  HO 
+  NO 

I 

I 

I +  H02 
+  AC03 

,, 

I 

+  M02 

+  03 

{196}  ISOPROD 

I +  hv 

I 

,, 

I 

I 

I 

I 

I 

I 

I 

--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 

--> 
--> 

+  0.300*MC03 
MC03 
N02 
MPAN 
PAA 

2.250*HCHO 
2.000*M02 
2.000*M02 
0. 313*AC03 

N02 
+  0.270*ALD 
+  0.210*MGLY 

OP2 
O.SOO*H02 
+  0.500*ALD 

--> 

0.500*HCHO 

+  O.SOO*KET 

--> 

0.476*HO 

+  0.237*AC03 
+  0.218*HCHO 
+  0.03l*GLY 

--> 

1. 216*CO 

+  0.216*KET 

+ 
+ 

N02 
HCHO 

+ 

AC03 

+  0.500*H02 
HCHO 
+ 
+  2.000*HCHO 
+  0.687*IP_R02 
+ 
+  0.030*HCHO 
+  0.700*KET 

H02 

+  0.500*M02 

+  0.610*CO 
+  0.180*GLY 

+  0.500*M02 
+  0.500*KET 
+  0.500*H02 

1 '  

,, 

' 

'""'I 

+  O.SOO*ORA2 
,,p·, 
+  0.500*ALD 

,,, 

+  0.072*H02 
+  0.100*X02 
+  0.062*ALD 
+  0.653*MGLY 
+  0.434*ALD 
+  l.216*H02 
+  0.332*HCHO 
+ 

H02 

+  0.168*M02 
+  0.243*CO 
+  0.278*KBT 
+  0.044*0RA1 
+  0.350*HCHO 
+  0.784*AC03 
+  0.332*ALD 
X02 
+ 

'""' 

{197}  ISOPROp 
>----------------------------------------------------------------------------------------< 

0.668*CO 

ONIT. 

+  N03 

--> 

+ 

I 

I 

==c==ccc==•=m====7==========~~========~======c==========a=========~•=•==~x=•••• 

Rate  Expression 

k(  1)  uses  photo  table  N02_RADM88 
k(  2)  uses  photo  table  0301D_RADM88 
k(  3)  uses  photo  table  0303P_RADM88 
k(  4)  uses  photo  table  HONO_RADM88 
5)  uses  photo  table  HN03_RADM88 
k( 
k( 
6)  uses  photo  table  HN04_RADM88 
k( 
7)  uses  photo  table  N03NO_RADM88 
k( 
8)  uses  photo  table  N03N02_RADM88 
k( 
9)  uses  photo  table  H202_RADM88 
k(  10)  uses  photo  table  HCHOmol_RADM88 
k(  11)  uses  photo  table  HCHOrad_RADM88 
k(  12)  uses  photo  table  ALD_RADM88 
k(  13)  uses  photo  table  MHP_RADM88 
k(  14)  uses  photo,table  HOP_RADM88 
k(  15)  uses  photo  table  PAA  RADM88 
k(  16)  uses  photo.table  KETONE_RADM88 
k(  17)  uses  photo  table  GLYform_RADM88 
k(  18)  uses  photo  table  GLYmol_RADM88 
k(  19)  uses  photo  t~ble MGLY_RADM88 
k(  20)  uses  photo  table  UDC_RADM88 
k(  21)  uses  photo  table  ORGNIT_RADM88 
k(  22) 
k(  23)  =  6.5000E-12  *  exp( 
k(  24)  = 
l.8000E-ll  *  exp( 

120. O/T) 
110. O/T) 

6.0000E-34  *  (T/300)**(-2.30) 

c 

,  scaled  by  l.OOOOOE+OO 
,  scaled  by  l.OOOOOE+OO 
,  scaled  by  l.OOOOOE+OO 
,  scaled  by  l.OOOOOE+OO 
,  scaled  by  l.OOOOOE+OO 
,  scaled  by  l.OOOOOE+OO 
,  scaled  by  l.OOOOOE+OO 
,  scaled  by  l.OOOOOE+OO 
,  scaled  by  l.OOOOOE+OO 
,  scaled  by  l.OOOOOE+OO 
,  scaled  by  l.OOOOOE+OO 
,  scaled  by  l.OOOOOE+OO 
,  scaled  by  l.OOOOOE+OO 
,  scaled  by  l.OOOOOE+OO 
,  scaled  by  l.OOOOOE+OO 
,  scaled  by  l.OOOOOE+OO 
,  scaled  by  l.OOOOOE+OO 
,  scaled  by  l.OOOOOE+OO 
,  scaled  by  l.OOOOOE+OO 
,  scaled  by  l.OOOOOE+OO 
,  scaled  by  l.OOOOOE+OO 

Rate  Constant 

1
11111111 

{o.oooooE+oo} 
{O.OOOOOE+OO} 
{ 0. OOOOOE+OO}  I 1111',, 
{O.OOOOOE+OO} 
{O.OOOOOE+OO} 
{O.OOOOOE+OO} 
{O.OOOOOE+OO} 
{O.OOOOOE:f-00} 
{ 0. OOOOOE.\.oo}  : 
{O.OOOOOE+OO} 
{o.OOOOOE+oo} 
{O.OOOOOE+OO} 
{O.OOOOOE+OO} 
{o.ooooos+oo} 
{o.oooooE+oo} 
{O.OOOOOE+OO}  ,, 
{O.OOOOOE+OO} 
{O.OOOOOE+OO} 
{o.oooooE+oo}' 
{ 0. OOOOOE+OO}  , 
{O.OOOOOE+OO} 
{6.09302E-34} 
{9.72293E-12} 
{2. 60365E-11} 

8-86 

'! 

Table 8A-l l.  RADM2_CIS4 and RADM2_CIS4_AQ Mechanisms 

70.0/T) 

k(  25)  =  3.2000E-11  *exp( 
k(  26)  =  2.2000E-10 
k(  27)  =  2.0000E-12  *  exp(  -1400.0/T) 
-940. O/T) 
k(  28)  =  1.6000E-12  *  exp( 
-500.0/T) 
k(  29)  =  1.lOOOE-14  *  exp( 
k  (  30)  =  3.7000E-12  *  exp( 
240. O/T) 
k(  31)  is  a  falloff  expression  using: 

=  1.8000E-31  *  (T/300)**(-3.20) 
kO 
kinf  =  4.7000E-12  *  (T/300)**(-1.40) 
F  =  0.60, 

n  =  1. 00 

k(  32)  =  k(  31)  I  Keq,  where  Keq  =  2.100E-27  *  exp(  10900.0/T) 
k(  33)  is  a  special  rate  expression  of  the  form: 

k  =kl+  k2[M],  where 
kl  =  2.2000E-13  *  exp( 
k2  =  1.9000E-33  *  exp( 

620. O/T) 
980.0/T) 

k(  34)  is  a  special  rate  expression•of  the  form: 

k  =kl+  k2[M],  where 
kl  =  3.0800E-34  *  exp(  2820.0/T) 
k2  =  2.6600E-54  *  exp(  3180. O/T) 

k(  35)  =  3.3000E-12  *  exp( 
k(  36)  is  a  falloff  expression  using: 

-200.0/T) 

=  7.0000E-31  *  (T/300)**(-2.60) 
kO 
kinf  =  1. 5000E-ll  *  (T/300) ** (-0. 50) 
F  =  0.60, 

n  =  1. 00 

k(  37)  =  3.3000E-39  *  exp( 
530.0/T) 
k  (  38)  =  1.4000E-13  *  exp(  -2500.0/T) 
150.0/T) 
k(  39)  =  1.7000E-11  *  exp( 
k(  40)  =  2.5000E-14  *exp(  -1230.0/T) 
k(  41)  =  2.5000E-12 
k(  42)  is  a  falloff  expression  using: 

=  2.2000E-30  *  (T/300)**(-4.30) 
kO 
kinf  =  1. 5000E-12  *  (T/300)**(-0.50) 
F  =  0.60, 

n  =  1.00 

k(  43)  =  k(  42)  I  Keq,  where  Keq  =  1.100E-27  *  exp(  11200.0/T) 
k(  44)  =  2.0000E-21 
k(  45)  is  a  falloff  expression  using: 

kO 
=  2.6000E-30  *  (T/300)**(-3.20) 
kinf  =  2.4000E-11  *  (T/300)**(-1.JO) 
F  =  0.60, 

n  =  1.00 

k(  46)  is  a  special  rate  expression  of  the  form: 

I 

k  =  kO  +  {k3[MJ 
kO  =  7.2000E-15  *  exp( 
785.0/T) 
k2  =  4.lOOOE-16  *  exp(  1440.0/T) 
k3  =  1. 9000E-33  *  exp ( 
725 .. O/T) 

(1  +  k3[MJ/k2)},  where 

380.0/T) 
k(  47)  =  1.3000E-12  *exp( 
k(  48)  =  4.6000E-11  *  exp( 
230.0/TJ 
k(  49)  is  a  falloff  expression  using: 

kO 
=  3.0000E-31  *  (T/300)**(-3.30) 
kinf  =  1.5000E-12  *  (T/300)**(  0.00) 
F  =  0.60, 

n  =  1.00 

k(  50) 
k(  51) 
k(  52) 
k(  53) 
k(  54) 
k(  55) 
k(  56) 
k(  57) 
k(  58) 
k(  59) 
k(  60) 

1.5000E-13  *  (1.0  +  0.6*Pressure) 
2.8300E+Ol  *  (T/300)**(  2.00)  *exp( 
1.2330E-12  *  (T/300)**(  2.00)  *exp( 
1.5900E-11  *  exp( 
1.7300E-11  *  exp( 
3.6400E-11  *exp( 
2.1500E-12  *  exp( 
5.3200E-12  *  exp( 
1.0700E-11  *  exp( 
2.lOOOE-12  *exp( 
1.8900E-11  *  exp( 

-540.0/TJ 
-380.0/T) 
-380.0/T) 
411.0/T) 
504.0/T) 
549.0/T) 
322.0/T) 
116.0/TJ 

-1280.0/T) 
-444.0/T) 

{4.04730E-11} 
{2.20000E-10} 
{1.82272E-14} 
{6.82650E-14} 
{2.05452E-15} 
{8.27883E-12} 
{1.39058E-12} 

{8.62399E-02} 
{3.01634E-12} 

{6.78905E-30} 

{ 1. 68671E-12} 
{4.87144E-12} 

{1.95397E-38} 
{3.18213E-17} 
{2.81225E-11} 
{4.03072E-16} 
{2.50000E-12} 
{1.26440E-12} 

{5.47034E-02} 
{2.00000E-21} 
{1.14885E-U} 

{1.47236E-13}, 

{4.65309E-12} 
{9.95294E-11} 
{8.88848E-13} 

{2.40000E-13} 
{3.80672E-01} 
{2.74210E-13} 
{2.59669E-12} 
{4.83334E-12} 
{1.01696E-11} 
{8.53916E-12} 
{2.88684E-11} 
{6.75269E-11} 
{6.18715E-12} 
{2.78943E-11} 

8-87 


I 

I 

,111:' 

-444 .O/T) 

256.0/T) 
-745.0/T) 

Table 8A-1 l.  RADM2_CIS4 and RADM2_CIS4_AQ Mech,~sms 
k(  61)  =  4.0000E-11 
k(  62)  =  9.0000E-01  *  k(  61) 
k(  63)  =  9.0000E-12 
k(  64)  =  6.8700E-12  *  exp( 
k(  65)  =  1.2000E-11  *  exp( 
k(  66)  =  1.lSOOE-11 
k(  67)  =  l. 7000E-11 
k(  68)  =  2. 8000E.-11 
k(  69)  = 
l.OOOOE,-11 
k(  70)  =  l. OOOOE-11 
k(  71)  =  l. OOOOE-11 
k(  72)  =  6.1650E-13  *  (T/300)**(  2.00)  *  exp( 
k(  73)  =  1.5500E-11  *  exp( 
-540.0/T) 
181. 0/T) 
k(  74)  =  2.8000E-12  *  exp( 
k(  75)  =  1.9500E+16  *  exp(-13543.0/T) 
k(  76)  =  4.7000E-12 
k(  77)  =  1.9500E+l6  *  exp(-13543.0/T) 
k(  78)  =  4.2000E-12  *  exp( 
180.0/T) 
k(  79)  =  4.2000E-12  *  exp( 
180.0/T) 
k(  80)  =  4.2000E-12  *  exp( 
180.0/T) 
k(  81)  =  4.2000E-12  *  exp( 
180.0/T) 
k(  82)  =  4.2000E-12  *  exp( 
180.0/T) 
180.0/T) 
k(  83)  =  4.2000E-12  *  exp( 
180.0/T) 
k(  84)  =  4.2000E-12  *  exp( 
k(  85)  =  4.2000E-12  *  exp( 
180.0/T) 
k(  86)  =  4.2000E-12  *  exp( 
180.0/T) 
180.0/T) 
k(  87)  =  4.2000E-12  *  exp( 
k(  88)  =  4.2000E-12  *  exp( 
180.0/T) 
180.0/T) 
k(  89)  =  4.2000E-12  *  exp( 
k(  90)  =  4.2000E-12  *  exp( 
180.0/T) 
k(  91)  =  4.2000E-12  *  exp( 
180.0/T) 
k(  92)  =  6.0000E-13  *  exp(  -2058.0/T) 
k(  93)  =  1.4000E-12  *  exp(  -1900.0/T) 
k(  94)  =  6.0000E-13  *  exp(  -2058.0/T) 
k(  95)  =  1.4000E-12  *  exp(  -1900.0/T) 
k(  96)  =  1.4000E-12  *  exp(  -1900.0/T) 
k(  97)  =  2.2000E-11 
k(  98)  =  2. OOOOE,-12  *  exp (  -2923. O/T) 
k(  99)  =  1.0000E-11  *  exp(  -1895.0/T) 
k(100)  =  3.2300E-ll  *  exp( 
-975. O/T) 
k(l01)  = 
l.2000E-14  *  exp(  -2633.0/T) 
k(102)  =  1.3200E-14  *  exp(  -2105.0/T) 
k(103)  =  7.2900E-15  *  exp(  -1136.0/T) 
k(104)  =  7.7000E-14  *  exp(  1300. O/T) 
k(l05)  =  7.7000E-14  *  exp(  1300. O/T) 
k(106)  =  7.7000E-14  *  exp(  1300. O/T) 
k(l07)  =  7.7000E-14  *  exp(  1300. O/T) 
k(l08)  =  7.7000E-14  *exp(  1300.0/T) 
k(l09)  =  7.7000E-14  *  exp(  1300. O/T) 
k(llO)  =  7.7000E-14  *  exp(  1300. O/T) 
lJOO. O/T) 
k(111)  =  7.7000E-14  *  exp( 
k(l12)  =  7.7000E-14  *  exp(  1300 .O/T) 
k(113)  =  7.7000E-14  *  exp(  1300.0/T) 
k(114)  =  7.7000E-14  *  exp(  1300.0/T) 
k(l15)  =  7.7000E-14  *  exp(  1300.0/T) 
k(l16)  =  7.7000E-l4  *  exp(  1300. O/T) 
k(117)  =  7.7000E-14  *  exp( 
· 1300. O/T) 
k (118)  =  1.9000E-13  *  exp( 
220.0/T) 
k(ll9)  =  1.4000E-13  *  exp( 
220.0/T) 
k(120)  =  4.2000E-14  *  exp( 
220.0/T) 
220.0/T) 
k(121)  =  3.4000E-14  *exp( 

{4.00000E~11} "' 
{3.60000E-11}, 
{9.00000E-12} 
{1.62197E-11} 
{9.85020E-13} 
{1.15000E-11}' 
{1.70000E-11} 
{2.80000E-11} 
{1.00000E-11} 
{1. OOOOOE-11} 
{1.00000E-11} ,,, 
{1.37105E-13}  '' 
{2.53137E-12} 
{5.13974E-12} :: 
{3.57235E-04} 
{4.70000E-12)" 
{3.57235E-04} 
{7.68378E-12} 
{7.68378E-12} 
{7 .68378E-12} ii;, 
{7.68378E:-12} 
{7.68378E-12} 
{7.68378E-12} 
{7.68378E-12} 
{7.68378E-12}" 
{7.6837BE-12} 
{7.6837BE-12} 
{7.68378E-12} 
{7.68378E-12} 
{7.68378E-12} 
{7.68378E-12}' 
{ 6. 01030E-16} .,• 
{2.38307E-15} 
{6.01030E-16} 
{2.38307E-15} 
{2.38307E-15} 
{2 .20000B-11} "" 
{1.09940J;:;-16} 
{1.73099E-14} 
{1.22539E-12} .,, 
{1. 74559E-18} 
{1.12933E-17} 
{1.61125E-16} 
{6.04038E-12} .. 
{6.04038B-12},, 
{6.04038E-12} 
{ 6. 04 03 8E-12} !!11::1 
{6.04038E-12} 
{6.04038E-12} 
{6.04038B-12} 
{6.04038E-12} 
{ 6. 04038E-12} 
{6.04038E-12} 
{6.04038E-12} 
{6.04038E-12} 
{6.0403BE-12} ,, 
{6.04038E-12} 
{3.97533E-13} 
{2. 92919E-13} ,,, 
{8.78758E-14} 
{7.11376E-14} 

8-88 


Table 8A-l 1.  RADM2_CIS4 and RADM2_CIS4_AQ Mechanisms 
k(122)  =  2.9000E-14  *  exp( 
220.0/T) 
k(123)  =  1.4000E-13  *  exp( 
220.0/T) 
k(124)  =  1.4000E-13  *  exp ( 
220. O/T) 
k(125)  =  1.7000E-14  *  exp( 
220.0/T) 
k(126)  =  1.7000E-14  *  exp( 
220.0/T) 
k(127)  =  9.6000E-13  *  exp( 
220.0/T) 
k(128)  =  1.7000E-14  *  exp( 
220.0/T) 
k(129)  =  1.7000E-14  *  exp( 
220.0/T) 
k(130)  =  9.6000E-13  *  exp( 
220.0/T) 
k(131)  =  1.7000E-14  *  exp( 
220.0/T) 
k(132)  =  3.4000E-13  *exp( 
220.0/T) 
k(133)  =  1.0000E-13  *  exp( 
220.0/T) 
k(134)  =  8.4000E-14  *  exp( 
220.0/T) 
k(135)  =  7.2000E-14  *  exp( 
220.0/T) 
k(136)  =  3.4000E-13  *exp( 
220.0/T) 
k(137)  =  3.4000E-13  *exp( 
220.0/'r) 
k(138)  =  4.2000E-14  *  exp( 
220.0/T) 
k(139)  =  4.2000E-14  *  exp( 
220.0/T) 
k(140)  =  1.1900E-12  *  exp( 
220.0/T) 
k(141)  =  4.2000E-14  *  exp( 
220. O/T) 
k(142)  =  4.2000E-14  *  exp( 
220.0/T) 
k(143)  =  1.1900E-12  *  exp( 
220. O/T) 
k(144)  =  4.2000E-14  *  exp( 
220.0/T) 
k(145)  =  3.6000E-16  *  exp( 
220.0/T) 
k(146)  =  7.7000E-14  *  exp(  1300. O/T) 
k(147)  =  1.7000E-14  *  exp( 
220.0/T) 
k(148)  =  4.2000E-14  *  exp( 
220.0/T) 
k(149)  =  3.6000E-16  *  exp( 
220. O/T) 
k(150)  =  4.2000E-12  *  exp( 
180.0/T) 
k(151)  =  4.2000E-12  *  exp( 
180.0/T) 
k(152)  =  7.7000E-14  *  exp(  1300.0/T} 
k(153)  =  1.7000E-14  *  exp( 
220.0/T} 
k(154)  =  4.2000E-14  *  exp( 
220.0/T) 
220. O/T) 
k(155)  =  3.6000E-16  *exp( 
k(156)  =  2.5400E-11  *  (T/300)**(  1.00)  *exp( 
407.6/T) 
k0.57)  =  4.2000E-12  *  (T/300) ** (  1.00)  *  exp( 
181,2/T) 
k(158)  =  7.7000E-14  *  (T/300)**(  1.00)  *exp(  1298.3/T) 
k(159)  =  8.4000E-14  *  (T/300)**(  1.00)  *  exp( 
221.4/T) 
k(160)  =  3.4000E-14  *  (T/300)**(  1.00)  *exp( 
221.4/T) 
k(161)  =  7.8600E-15  *  (T/300)**(  1.00)  *  exp(  -1912.2/T) 
k(162)  =  3.6000E-11 
k(163)  =  3.0300E-12  *  (T/300)**(  1.00)  *  exp( 
-447.9/T) 
k(164)  =  4.2000E-12  *  (T/300) ** (  1. 00)  *  exp ( 
181.2/T) 
k(165)  =  7.7000E-14  *  (T/300)**(  1.00)  *  exp(  1298.3/T) 
k(166)  =  8.4000E-14  *  (T/300)**(  1.00)  *  exp( 
221.4/T) 
k(167)  =  3.4000E-14  *  (T/300)**(  1.00)  *  exp( 
221.4/T) 
k(168)  =  1.8600E-11  *  (T/300)**(  1.00)  *exp( 
176 .1/T) 
k(169)  =  4.2000E-12  *  (T/300)**(  1.00)  *  exp( 
181.2/T) 
k(170)  =  7.7000E-14  *  (T/300)**(  1.00)  *  exp(  1298.3/T) 
k(171)  =  8.4000E-14  *  (T/300)**(  1.00)  *  exp( 
221.4/T) 
221.4/T) 
k(172)  =  3.4000E-14  *  (T/300)**(  1.00)  *  exp( 
k(173)  =  1.3600E-15  *  (T/300)**(  1.00)  *exp(  -2113.5/T) 
k(174)  uses  photo  table  ACROLEIN 
k(175)  =  1.SOOOE-12  *  (T/300)**(  1.00)  *  exp(  -1726.0/T) 
k(176)  =  4.1400E-12  *  (T/300)**(  1.00)  *  exp( 
452.9/T) 
k(177)  =  4.2000E-12  *  (T/300)**(  1.00)  *  exp( 
181.2/'r) 
k(178)  =  7.7000E-14  *  (T/300)**(  1.00)  *  exp(  1298.3/T) 
k(179)  =  8.4000E-14  *  (T/300)**(  1.00)  *  exp( 
221.4/T) 
k(180)  =  3.4000E-14  *  (T/300)**(  1.00)  *  exp( 
221.4/T) 
k(181)  =  7.5100E-16  *  (T/300)**(  1.00)  *  exp(  -1519.7/T) 
k(182)  uses  photo  table  ACROLEIN 

{6.06762E-14} 
{2.92919E-13} 
{2.92919E-13} 
{3.55688E-14} 
{3.55688E-14} 
{2.00859E-12} 
{3.55688E-14} 
{3.SS688E-14} 
{2.00859E-12} 
{3.55688E-14} 
{7.11376E-13} 
{2.09228E-13} 
{1. 75752E-13} 
{1.S0644E-13} 
{7.11376E-13} 
{7.11376E-13} 
{8.78758E-14} 
{8.78758E-14} 
{2.48981E-12} 
{8.78758E-14} 
{8.78758E-14} 
{2.48981E-12} 
{8.78758E-14} 
{7.53221E-16} 
{6.04038E-12} 
{3.55688E-14} 
{8.78758E-14} 
{7.53221E-16} 
{7.68378E-12} 
{7.68378E-12} 
{6.04038E-12} 
{3.55688E-14} 
{8.78758E-14} 
{7.53221E-16} 
{9.90719E-11} 
{7.66335E-12} 
{S.96598E-12} 
{1.75402E-13} 
{7.09961E-14} 
{1.27569E-17} 
{3.60000E-11} 
{6.69552E-13} 
{7.66335E-12} 
{5.96598E-12} 
{1.75402E-13} 
{7.09961E-14} 
{3.33618E-11} 
{7.66335E-12} 
{5.96598E-12} 
{1. 75402E-13} 
{7.09961E-14} 
{1.12330E-18} 
{O.OOOOOE+OO} 
{4.54753E-15} 
{1.87990E-11} 
{7.66335E-12} 
{5.96598E-12} 
{1. 75402E-13} 
{7.09961E-14} 
{4 .54966E-18}. 
{O.OOOOOE+OO} 

,  scaled  by  3.60000E-03 

,  scaled  by  1.11000E-02 

8-89 


i 

"'  ,1,, 

'11111'', 

'•,:;;,, 

Table 8A-l 1.  RADM2_CIS4 and RADM2_CIS4_AQ Mechanisms 
k(183)  =  1.6000E+16  *  (T/300)**(  1.00)  *  exp(-13486.0/Tl 
k(184)  =  4.2000E-12  *  (T/300)**(  1.00)  *  exp( 
181.2/T) 
k(l85)  "  2.8000E-12  *  (T/300)**(  1.00)  *  exp( 
181.2/T) 
k(l86)  ..  7.7000E-14  *  (T/300) ** (  1. 00)  *  exp(  1298.3/T) 
k(187)  =  9.6000E-13  *  (T/300)**(  1.00)  *  exp( 
221.4/T) 
k(188)  =  1.1900E-12  *  (T/300)**(  1.00)  *  exp( 
221.4/T) 
k(l89)  =  l.1900E-12  *  (T/300)**(  1.00)  *  exp( 
221.4/T) 
k(190)  =  3.3600E-11 
k(l,91) 
c 
k(l92)  • 
k(l93)  c 
k(194) 
c 
k(195)  =  7.1100E-18 
k(196)  uses  photo  table  ACROLEIN 
k(197)  =  1.0000E-13 

{3. s2s36E,:04 > "· 
{7.66335E-12} 
{S.10890E-12} 
{S.96598E-12} 
{2.00460E-12}  ..... 
{2. 484 86E-12} 
{2 .48486E-12} ,,,;;, 
{3. 36000E-11} '1111
{7.6633SE-12} 
{5.96598E-12}  · 
{1.75402B-13} 
{7.099618-14} 
{7.11000E::-18} 
{O.OOOOOE+oo} 
{1.00000E::-13} 
amam•====mcm==a~=========~======c~================•====•===~==z=•====aZXs•~•••• 

4.2000E-l.2  *  (T/300) ** (  1. 00)  *  exp( 
181,2/Tl 
7,7000E-14  *  (T/300)**(  1.00)  *  exp(  1298.3/T) 
8.4000E-14  *  (T/300)**(  1.00)  *  exp( 
221,4/Tl 
3.4000E-14  *  (T/300)**(  1.00)  *exp( 
221.4/Tl 

,  scaled  by  3.60000E-03 

I 

I 

m11 

1, 

~, 

' 

111111111 

111 

1ill!:· 

111"' 

:',,,1 

111111,, 

''I,," 

8-90 

Table 8A-12.  RADM2  CIS4  AE and RADM2  CIS4 AE  AQ Mechanisms 
. 

. 

. 

. 

.  . 

-

-

.-

-

EP A/600/R-99/030 

NO 

+ 

+ 
+ 
+ 

+ 

--> 
--> 
--> 
--> 
--> 
--> 
--> 
-··> 
--> 
-··> 
--> 
_ .. > 

Reaction  List 
>---------~----- .... -----~------------------------------------------------------------------< 
{ 
l}  N02 
{  2}  03 
{  3}  03 
{  4}  HONO 
{  5}  HN03 
{  6}  HN04 
{  7}  N03 
{ 
8}  N03 
{  9}  H202 
{  10}  HCHO 
{  11}  HCHO 
{  12}  ALD 
{  13}  OPl 
{  14}  OP2 
{  15}  PAA 
{  16}  KET 
{  17}  GLY 
{  18}  GLY 
{  19}  MGLY 
{  20}  DCB 
{  21}  ONIT 

+ 
+ 
+ 
'+ 
+ 
+ 
+  l.870*CO 
+  l,SSO*CO 
H02 
+ 
+  0.020*AC03 
+  0.800*KET 

+  hv  · 
+  hv· 
+ hv 
+  hv 
+  hv 
+  hv  · 
+  hv 
+  hv· 
+  hv 
+  hv 
+  hv 
+·hv 
+·hv 
+  hv 
+  hv 
+  hv 
+  hv 
+  hv 
+  hv 
+  hv 
+  hv 

+  0.800*H02 
co 
+ 
TC03 
+ 
H02 
+ 

--> 
-·-> 
--> 
--> 
_,,> 
-·-> 
-·r> 
--;> 
--> 

H02 
H02 
H02 
H02 
HO 
ETHP 

co 
- co 
HO 
HO 

NO 
N02 
0 N02 

+ 
+ 
+ 
+ 

03P 

03P 
OlD 
03P 
HO 
HO 
H02 
NO 
N02 
2.000*HO 
co 
H02 
M02 
HCHO 
ALD 
M02 
AC03 
0.130*HCHO 
0.4SO*!iCHO 
AC03 
0.980*H02 
0.200*ALD 
N02 
03 
NO 
03P 
03P 

2.000*HO 
N02 
H02 
HO 
N02 
HN04 
H02 
H202 
H202 
H02 
HONO 
2.000*N02 
N03 
2.000*N02 

+ 

NO 
HN03 
N205 
N02 

2.000*HN03 
HN03 
N03 
N02 

SULF 
H02 
M02 
ETH!? 
0.83Q*HC31? 
+  0.075*ALD 
HCSI? 
HC81? 
OL2P 
OLTI? 

8-91 

+  [02] 

+  [H20] 

+  [02] 

{  22}  03P 
{  23}  03P 
{  24}  OlD 
{  25}  OlD 
{  26}  OlD 
{  27}  03 
{  28}  03 
{  29}  03 
{  30}  H02 
{  31}  H02 
{  32}  HN04 
{  33}  H02 
{  34}  H02 
{  35}  H202 
{  36}  NO 
{  37}  NO 
{  38}  03 
{  39}  N03 
{  40}  N03 
{  41}  N03 
{  42}  N03 
{  43}  N205 
{  44}  N20S 
{  45}  HQ 
{  46}  HO 
{  47}  HO 
{  48}  HO 
{  49}  HO 
{  so}  co 
{  51}  HO 
{  52}  ETH 
{  53}  HC3 

54}  HCS 
SS}  HC8 
S6}  OL2 
57}  OLT 

+ 
[M] 
+  N02 
+  [N2] 
+  [02] 
+  [H20] 
+  NO 
+  HO 
+  H02 
+  NO 
+  N02 

+  H02 
+  H02 
+  HO 
+  HO 
+  NO 
+  N02 
+  NO 
+  N02 
+  H02 
+  N02 

+  [H20] 
+  N02 
+  HN03 
+  HN04 
+  H02 
+  SQ2 
+  HO 

+  HO 
+  HO 

+  HO 
+  HO 
+  HO 
+  HO 

--> 
--> 
--> 
--> 
--> 
--> 
--> 
-·> 
--> 
--> 
--> 
--> 
--> 
-·> 
--> 
--::. 
--> 
--> 
--> 
--::. 
--> 
--> 
-~> 
--> 
--> 
--> 
--> 
--> 
--:? 
--> 
--> 
--> 

--> 
-,-> 
,..,..=!> 
--> 

+ 

+ 

+ 

+ 

+ 

HO 

N02 

N02 

N03 

H02 

+ 

SULAER 

+  0.170*H02 
+  0.025*KET 
+  0.250*X02 
+  0.750*X02 

+  0,009*HCHO 

+ 

HC8AER 

'lh 

Table 8A-12.  RADM2_CIS4_AE and RADM2_CIS4_AE_AQ Mechanisms ... 

OLIP 
0.750*TOLP 

+ 
+  0.250*CSL 

OLIAER 

+  0.2SO*H02 

TOLAER 

0.830*XYLP 

+  0.170*CSL 

+  0.170*H02 

XYLAER 

.0.100*H02 

+  0.900*X02 

{  58}  OLI 
{  59}  TOL 

60}  XYL 

61}  CSL 

{  62}  CSL 
{  63}  HCHO 
{  64}  ALD 
{  65}  KET 
{  66}  GLY 
{  67}  MGLY 
{  68}  DCB 
{  69}  OP1 
{  70}  OP2 
{  71}  PAA 
{  72}  P.IJN 
{  73}  ONIT 
{  74}  AC03 
{  75}  PAN 
{  76}  TC03 
{  77}  '.!;'PAN 
{  78}  M02 
{  79}  HC3P 

so}  .. !iGSP 

81}  HCBP 

82}  OL2P 

83}  OLTP 

84}  OLIP 

as}  AC03 
86}  TC03 

87}  TOLP 

88}  XYLP 

89}  ETHP 
90}  KETP 
91}  OLN 
92}  HCHO 
93}  ALD 
94}  GLY 
95}  MGLY 
96}  DCB 
97}  CSL 

{  98}  OL2 
{  99}  OLT 
{100}  OLI 
{101}  OL2 

+  HO 
+HO 

+  HO 

+  f!O 

+  HO 
+  fiO 
+  HO 
+  fiO 
;HO 
+ 
+  fiO 
+  ;1m 
+  f!O 
+  fiO 
+  f!O 
+  fl() 
+  f!O 
+  ;t'l'02 

I 

+  .:i-m2 

+  ,NO 
+  ,NO 

+  !"0 

+  ,NO 

+  ;tm 
+  ro 
+  ro 
+  ,NO 
+  ro 

I 

+  ,NO 

I 

+  ~m 
+  ro 
+  ;t'!O 
+  .NO 
+  N03 
+  ,N03 
+  .N03 
+  ,N03 
+  N03 
+  ,N03 

1

I 
N03 
+ 
+  ,N03 
+  ,N03 
+  ,03 

{102}  OLT 

+  ,03 

,,11111' 

11111' 

I 

+ 

+ 

+ 

--> 
--> 

--> 

--> 

.--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 

CSLAER 
CSL 
H02 
AC03 
KETP 
H02 
AC03 
TC03 

O.SOO*M02 
O.SOO*HC3P 
AC03 
HCHO 
HC3P 
PAN 
AC03 
TPAN. 
TC03 
HCHO 
0.7SO*ALD 

--> 

--> 

--> 

--> 

--> 

--> 
--> 

--> 

--> 

--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 

--> 
--> 
--> 
--> 

--> 

+  0.036*0NIT 

p.3BO*Aip 
+  0.920*N02 
o.3SO*ALD 

,.•1,,, 

' 

' 

+  0.240*0NIT 
1.600*HCHO 

+ 

+  0.200*ALD 
ALD 
N02 
H02 
+  O.lOO*KET 
M02 
N02 

+  0.110*MGLY 
+  2. OOO* .. X02 
N02 
+  0.160*GLY 
N02 
+  0.806*DCB 
ALD 
MGLY 
HCHO 
H02 
AC03 
HN03 
HN03 
HN03 
HN03 

+  O.SOO*CSLAER 

OLN 
OLN 
OLN 
HCHO 
+  0,120*H02 

0.530*HCHO 
+  0.200*0RA1 

8-92 

1.':: 

+  0.900*TC03 

11111111.11 

+  O.SOO*HO 
+  0.~90*HO 

I I ; 11 I ~ 

' I : " 

+ 

X02 

N02 

+ 
+  0.090*HCHO 
+  0.964*H02 
t  O.OBO*ONI~ 
iii'", 
+  0.040*HCHO 
+  o:760*H02 
N02 
+ 

.:111·'·: 
''II, 

:1 1•1' 

' 

'' 

11

1

1

·

1'1, 

".111 
%'1'• 

11•:::11111 

+ 

co 

+  2.000*CO 
co 
+ 

+  O.SOO*HCHO 
+  O.SOO*ALD 

+ 
+ 

+ 

N03 
N02 

N02 

N02 
+ 
lio2 
+ 
+  0.2SO*KET 
+  0.964*N02 
+  0.690*KET 
+  0.920*H02 
+  1. OGO*KET 
+  0.760*N02 
+ 
H02 

'1'1•' 

' 

+ 

HCHO 

+ 

H02 

+  1.4SO*ALD 
N02 
+ 
+ 
N02 
+  0.920*H02 
+  O.OSO*AC03 

H02 
+ 
+  0.700*DCB 
+ 
H02 

+ 
+ 
+ 
+ 
+ 
+ 
+ 
+ 
+ 

H02 
N02 
ALD 
HN03 
HN03 
H02 
AC03 
TC03 
XN02 

+  o.2SO*HCHO 

+  0.890*GLY 
+  0.9SO*CO, 

+  0.170*MGLY 

+  0.450*MGLY 

N02 
+ 
+ 
H02 
+  2.000*N02 
co 
+ 

+  2.000*CO 
co 
+ 

+  O.SOO*CSL 

+ 
+  0.400*0RA1 

OLIAER 

+  0.420*CO 

+  O.SOO*ALD 
+  0.200*0RA2 

+  0.330*CO 
+  0,230*HQ2 

Table SA-12.  RADM2_CIS4_AE and RADM2_CIS4_AE_AQ Mechanisms 

. 

. 

. 

. 

EP N600/R-99/030 

{103}  OLI 

+  03 

+  0.220*M02 
0,180*HCHO 

--> 

+  0.230*CO 
+  0.260*H02 
+ 

OLIAER 
OP1 
OP2 
OP2 
OP2 
OP2 
OP2 
OP2 
OP2 
OP2 
PAA 
OP2 
OP2 
OP2 
ONIT 
1.500*HCHO 
0.750*HCHO 
0.840*HCHO 

+  0.100*HO 
+  0. 720*ALD 
+  0.060*0RA1 
+  0.140*HO 

+  0.100*KET 
+  0.290*0RA2 
+  0.310*M02 

H02 
+ 
H02 
+ 
+  0.770*ALD 

+  0. 750*ALD 
+  0.260*KET 

H02 

0.770*HCHO 

+  0.410*ALD 

+  0.750*KET 

H02 

0.800*HCHO 

+  0.460*ALD 

+  1.390*KET 

+  0.350*ALD 
+  0.750*ALD 
+  0.725*ALD 

+ 
+ 
+ 

H02 
H02 
H02 

+  0. 750*MGLY 
+  0.500*H02 

H02 
+ 
+  0.500*M02 

+  0.170*MGLY 
+  2.000*H02 
+  0.450*MGLY 

+  0.160*GLY 

+  0.806*DCB 

+  0.445*GLY 
+  0.025*AC03 
X02 
+ 
+  0.500*H02 

+  0.055*MGLY 
+  0.460*H02 

+ 

ALD 

+  0.500*H02 

+  0.500*M02 

+  0.260*KET 
+  0.500*0RA2 
+  0.750*KET 
+  0.500*0RA2 
+  1.390*KET 
+  0.500*0RA2 
+  0.600*ALD 
+  0.500*0RA2 
+  0.500*HCHO 
+  0.500*0RA2 
+  0.5SO*KET 
+  O.SOO*M02 
+  O.SOO*H02 

+  0.500*H02 

+  0.500*H02 

+  0.500*H02 

+  0.500*H02 

+  0.500*H02 

+  0.140*HCHO 
+  O.SOO*ORA2 
+  O.SOO*M02 

+  0.170*MGLY 

+  0.160*GLY 

{104}  H02 
{105}  H02 
{106}  H02 
{107}  H02 
{108}  H02 
{109}  H02 
{110}  H02 
{111}  H02 
{112}  H02 
{113}  H02 
{114}  H02 
{115}  H02 
{116}  H02 
{117}  H02 
{118}  M02 
{119}  M02 
{120}  M02 

+  M02 
+  ETHP 
+  HC3P 
+  HC5P 
+  HC8P 
+  OL2P 
+  OLTP 
+  OLIP 
+  KETP 
+  AC03 
+  TOLP 
+  XYLP 
+  TC03 
+  OLN 
+  M02 
+  ETHP 
+  HC3P 

{121}  M02 

+  HC5P 

{122}  M02 

+  HC8P 

{123}  M02 
{124}  M02 
{125}  M02 

{126}  M02 
{127}  M02 

+  OL2P 
+  OLTP 
+  OLIP 

+  KETP 
+  AC03 

{128}  M02 

+  TOLP 

{129}  M02 

+  XYLP 

{130}  M02 

+  TC03 

{131}  M02 

+  OLN 

{132}  ETHP 

+  AC03 

{133}  HC3P 

+  AC03 

{134}  HC5P 

+  AC03 

{135}  HC8P 

+  AC03 

{136}  OL2P 

+  AC03 

{137}  OLTP 

+  AC03 

{138}  CLIP 

+  AC03 

{139}  KETP 

+  AC03 

{140}  AC03 
{141}  AC03 

+  AC03 
+  TOLP 

--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 

--> 

--> 

--> 
--> 
--> 

--> 
--> 

--> 

--> 

--> 

+ 

+ 

+ 

H02 

1,550*HCHO 
1,250*HCHO 
0.890*HCHO 

+  0.550*KET 

0.750*HCHO 
HCHO 
+  0.500*0RA2 
HCHO 
+  0.700*DCB 
HCHO 

+  2.000*H02 

0.500*HCHO 
+  0.500*0RA2 
+  0.47S*CO 

--> 

i.750*HCHO 

--> 

--> 

--> 

... -> 

+ 

N02 
ALD 

+  0.500*0RA2 
0.770*1\LD 
+  0.500*M02 
0.410*ALD 
+  O.SOO*M02 
0.460*ALD 
+  O.SOO*M02 

--> 

0.800*HCHO 

+  O.SOO*M02 
ALD 
+  0.500*M02 
0. 725*ALD 
+  O.SOO*H02 

MGLY 
+  O,SOO*ORA2 
2.000*M02 
M02 

--> 

--> 

--::· 

--> 
--> 

8-93 

Table SA-12.  RADM2_CIS4_AE and RADM2_CIS4_AE_AQ Mechanisms 

I 

{142}  AC03 

+  lFYLP 

{143}  AC93 

+  TC03 

{144}  AC03 

+  OLN 

{145}  OLN 
+  9LN 
{146}  X02 
+  JiO~ 
{147}  X02 
+  M02 
+  AC03 
{148}  X02 
+  xo2 
{149}  X02 
+  NO 
{150}  X02 
{151}  XN02 
+  1l702 
{152}  XN02 
+  Ji02 
+  M02 
{153}  XN02 
+  AC03 
{154}  XN02 
+  XN02 
{155}  XN02 
+  HO 
{156}  TERP 
+  l,'l03 
{157}  TERP 
+  03 
{158}  TERP 
+  HO 
{159}  ISO 
{160}  ISO_R02  +  NO 

I' 
{161}  ISO_R02  +  Ji02 
{162}  ISO_R02  +  AC03 

I 

{163}  ISO_R02  +  M02 

' 

{164}  ISO 

+  03 

{165}  ISO 

+  p3P 

{166}  ISO 
{167}  ISON_R02  +  NO 

+  N03 

' 

{168}  ISON_R02  +  H02 
{169}  ISON_R02  +  AC03 

I 

{170}  ISON_R02  +  ~02 

+  HO 
{171}  MACR 
{172}  MACR_R02  +NO 

{173}  MACR_R02  +  H02 
{174}  MACR_R02  +  AC03 

{175}  MACR_R02  +  ~02 

{176}  MACR 

+  03 

{177}  MACR 

+  hv 

+  0.700*DCB 
M02 
H02 
M02 

+ 

+  O.l10*MGLY 
+  2.000*X02 
HCHO 
N02 

+ 

2.000*HCHO 

OP2 
HCHO 
M02 

N02 
ONIT 
OP2 
HCHO 
M02 

+ 
+  0 .450*MGLY 

H02 

+  0.920*H02 
+  O.OSO*AC03 

+ 
ALD 
+  0.500*M02 
+  2.000*ALD 

+ 

H02 

+ 

H02 

TERPAER  + 
TERPAER  + 
TERPAER  + 
ISO_R02  +  0.079*X02 
+  0.9l2*N02 

HO 
N03 
03 

O.OBB*ONIT 

--> 

--> 

--> 

--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 

+  0.362*ISOPROD  +  0.230*MACR 
+  0.629*HCHO 

+  0.079*XQ2 

' I ' '  

--> 
--> 

OP2 
O.SOO*H02 

+  O.SOO*M02 

--:> 

--> 

+  0.362*ISOPROD  +  0.230*MACR 
+  0.629*HCHO 
O.SOO*HCHO 
+  0.239*MACR 
0.600*HCHO 
+  0.390*0RAl 
+  0.070*CO 
+  O.l50*ALD 

+  0.500*H02 
+  0.320*~ 
+  0.390*MACR 
+  0.270*HO 
+  0.200*X02 
+  O.lOO*ISOPROD 

+  0.806*DCB 

+  0.890*GLY 
+  o.9so•co 

I  lh 

+  0.500*0RA2 

+  2.000*N02 

+  0.912*H02 
+  0.320*MVK 

111::11 

":  O.~~O*ORA2 
+  0.320*MVK 

""1'

111 

'•,i[I 

+  0.362*ISOPROD 
+  0.629*HCHO 
+  0.160*MVK 
+  0.070*H02 
+  0.200*MC03 

I 

111, 

--> 

0.750*ISOPROD  +  0.250*MC03 

+  0.2SO*HCHO 

--> 
--> 

--> 
--> 

--> 

--> 
--> 

--> 
--> 

--> 

--> 

+  0.2SO*M02 

ISON_R02 
N02 
+  O.BOO*H02 

ONIT 

O.SOO*H02 
ALO 

+ 

O.SOO*HCHO 
+  O.SOO*ONIT 
O.SOO*MC03 

N02 
+  0.840*CO 
OP2 
0.500*H02 
+  0.840*KET 
+  0.150*MGLY 
0.6SO*HCHO 

+  0.840*CO 

0.630*0RA1 

+  O.llO*CO 
+  o.lOO*AC03 

--> 

0.660*H02 

+  0.670*HCHO 
+  0.340*X02 

8-94 

+  O.SOO*ALD 
+  0.200*ISOPROD  +  0.200*N02 

+  O.SOO*ONIT 

+  O.SOO*M02 
+ 
+  O.SOO*H02 

ONIT 

+  O.SOO*ORA2 

+  O.SOO*ALD 

+  O.SOO*MACR_R02 
+ 
+  O.lSO*HCHO 

H02 

+  O.SOO*M02 
+  0.840*CO 

+  O.SOO*H02 
+  O.lSO*MGLY 
+  0.2lO*HO 
+  0.200*HCHO 

+  O.B40*KET 
+  O.lSO*MGLY 

111111 

+  O.SOO*ORA2 
+  0.150*HCHO 

+  O.B<lO*KBT 

+  O.ll0*H02 
+  0.100*X02 

+  0.330*MC03 
+  0.670*AC03 

+  0.670*CO 
+  0.340*HO 

Table 8A-12.  RADM2_CIS4_AE and RADM2_CIS4_AE_AQ Mechanisms 

EP A/600/R-99/030 

{178}  MACR 

+  N03 

{179}  MVK 
{180}  MVK_R02 

+  HO 
+  NO 

{181}  MVK_R02 
{182}  MVK_R02 

+  H02 
+  AC03 

{183}  MVK_R02 

+  M02 

{184}  MVK 

+  03 

{185}  MVK 

+  hv 

{186}  MPAN 
{187}  MC03 
{188}  MC03 
{189}  MC03 
{190}  MC03 
{191}  MC03 
{192}  MC03 
{193}  ISO PROD  +  HO 
+  NO 
{194}  IP_R02 

+  NO 
+  N02 
+  H02 
+  M02 
+  AC03 
+  MC03 

{195}  IP  R02 
{196}  IP::::R02 

+  H02 
+  AC03 

{197}  IP_R02 

+  M02 

{198}  ISOPROD  +  03 

{199}  ISOPROD  +  hv 

--> 
--> 
--> 

--> 
--> 
--> 
--> 

--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 
--> 

--> 
--> 
--> 
--> 

--> 
--> 

+ 

+  0.300*MC03 
MC03 
N02 
MPAN 
PAA 

2.250*HCHO 
2.000*M02 
2.000*M02 
0.313*AC03 

N02 
+  0.270*ALD 
+  0.210*MGLY 

OP2 
O.SOO*H02 
+  O.SOO*ALD 

O.SOO*HCHO 

+  0.SOO*KET 
0.476*HO 

+  0.237*AC03 
+  0.218*HCHO 
+  0.03l*GLY 

l.216*CO 

+  0.216*KET 

O.SOO*MC03 

+  O.SOO*H02 

+  O.SOO*HN03 
+  O.SOO*ONIT 

+  O.SOO*CO 
+  0.500*X02 

MVK  R02 
N02 

+  0.700*AC03 
+  0.300*H02 
OP2 
O.SOO*H02 
+  0.700*ALD 
O.SOO*HCHO 

+  0.700*M02 

0.670*0RA1 

+  O ..  llO*CO 
+  0.050*X02 

+  0.700*ALD 
+  0.300*HCHO 

+  0.700*X02 
+  0.300*MGLY 

+  1.200*M02 
+  0.300*HCHO 
+  0.500*H02 
+  0.300*MGLY 
+  0.160*HO 
+  0. 950*MGLY 
+  0.050*AC03 

+  0.500*0RA2 
+  0.300*MGLY 
+  0.700*ALD 

+  0.110*H02 
+  O.lOO*HCHO 

0.700*ISOPROD  +  0.700*CO 

+  0.300*M02 

+ 
+ 

N02 
HCHO 

+ 

AC03 

+  0.500*H02 
HCHO 
+ 
+  2.000*HCHO 
+  0.687*IP_R02 
+ 
+  0.030*HCHO 
+  0.700*KET 

H02 

+  0.500*M02 

+  0.610*CO 
+  0.180*GLY 

+  0.500*M02 
+  O.SOO*KET 
+  0.SOO*H02 

+  O.SOO*ORA2 

+  O.SOO*ALD 

+  0.072*H02 
+  0.100*X02 
+  0.062*ALD 
+  0.653*MGLY 
+  0.434*ALD 
+  1.216*H02 
+  0. 332*HCHO 
+ 

H02 

+  0.168*M02 
+  0.243*CO 
+  0.278*KET 
+  0.044*0RA1 
+  0.3SO*HCHO 
+  0.784*AC03 
+  0.332*ALD 
X02 
+ 

.  {200}  ISOPROD  +  N03 
>----------------------------------------------------------------------------------------< 

0.668*CO 

ONIT 

Rate  Constant 
Rate  Expression 
============================================================================cc= 
{O.OOOOOE+OO} 
k(  1)  uses  photo  table  N02_RADM88 
{O.OOOOOE+OO} 
k(  2)  uses  photo  table  0301D_RADM88 
k( 
3)  uses  photo  table  0303P_RADM88 
{O.OOOOOE+oo} 
{o.OOOOOE+Oo} 
k(  4)  uses  photo  table  HONO_RADM88 
k(  5)  uses  photo  table  HN03_RADM88 
{o.OOOOOE+Oo} 
{O.OOOOOE+OO} 
6)  uses  photo  table  HN04_RADM88 
k( 
{O.OOOOOE+OO} 
7)  uses  photo  table  N03NO_RADM88 
k( 
k( 
{O.OOOOOE+OO} 
8)  uses  photo  table  N03N02_RADM88 
{O.OOOOOE+oo} 
k(  9)  uses  photo  table  H202_RADM88 
k(  10)  uses  photo  table  HCHOmol_RADM88 
{O.OOOOOE+oo} 
{o.oooooE+oo} 
k(  11)  uses  photo  table  HCHOrad_RADM88 
{O.OOOOOE+OO} 
k(  12)  uses  photo  table  ALD_RADM88 
{O.OOOOOE+oo} 
k(  13)  uses  photo  table  MHP_RADM88 
{O.OOOOOE+OO} 
k(  14)  uses  photo  table  HOP_RADM88 
{o.OOOOOE+Oo} 
k(  15)  uses  photo  table  PAA_RADM88 
k(  16)  uses  photo  table  KETONE_RADM88 
{O.OOOOOE+OO} 

'  scaled  by  1.00000E+OO 
'  scaled  by  1.00000E+OO 
'  scaled  by  l.OOOOOE+OO 
'  scaled  by  1.00000E+OO 
'  scaled  by  1.00000E+OO 
,  scaled  by  1,00000E+OO 
'  scaled  by  1.00000E+OO 
'  scaled  by  1.00000E+OO 
'  scaled  by  1.00000E+OO 
'  scaled  by  1.00000E+OO 
'  scaled  by  1.00000E+OO 
'  scaled  by  1.00000E+OO 
'  scaled  by  1.00000E+OO 
,  scaled  by  1.00000E+OO 
'  scaled  by  1.00000E+OO 
'  scaled  by  1.00000E+OO 

Table 8A-12.  RADM2_CIS4_AE and RADM2_CIS4_AE_AQ .Mechanism$ 

1 

1
11

:

:11 

,  scaled  by 
,  scaled  by 
,  scaled  by 
,  scaled  by 
,  scaled  by 

l.OOOOOE+OO 
l.OOOOOE+OO 
l.OOOOOE+OO 
l.OOOOOE+OO 
l.OOOOOE+OO 

uses  photo  table  GLYform_RADM88 
uses  photo  table  GLYmol_RADM88 
uses  photo  table  MGLY_RADM88 
uses  photo  table  UDC_RADM88 
uses  photo  table  ORGNIT_RADM88 

k(  17) 
k(  18) 
k(  19) 
k(  20) 
k(  21) 
k(  22) 
6.0000E-34  *  (T/300)**(-2.30) 
6.5000E-12  *  exp( 
k(  23) 
k(  24) 
l.8000E-ll  *  exp( 
3.2000E-ll  *  exp( 
k(  25)  = 
k(  26) 
2.2000E-10 
k(  27) 
2.0000E-12  *  exp(  -1400.0/Tl 
l.6000E-12  *  exp( 
-940.0/T) 
k(  28)  = 
k(  29) 
-500.0/T) 
l.lOOOE-14  *  exp( 
k(  30) 
3.7000E-12  *exp( 
240.0/Tl 
k(  31)  is  a  falloff  expression  using: 

120.0/T) 
110.0/T) 
70.0/T) 

l.8000E-31  *  (T/300)**(-3.20) 
kO 
kinf  =  4.7000~-12  *  (T/300)**(-1.40) 
F  =  0.60, 

n  •  1.00 

I 

k(  32)  = k(  31) 
k(  33)  is  a  special  rate  express~on of  the  form: 

/  Keq,  where  Keq  =  2.lOOE-27  *  exp(  10900.0/T) 

k  =  kl  +  k2 [Ml  ',  where  '  "' 
kl  =  2.2000E-l3  *  exp( 
k2  = 
l.9000E-33  *  exp( 

620.0/T) 
980.0/T) 

k (  34)  is  a  speci

al  rate  expression  of  the  form: 
1

k  =kl+  k2[M],  where 
kl  =  3.0800E-34  *  exp(  2820.0/T) 
k2  =  2.6600E-S4  *exp(  3180.0/T) 

-200.0/T) 
k(  35)  =  3.3000E-12  *exp( 
k(  36)  is  a  falloff  expres~ion using: 

kO 
=  7.0000E-31  *  (T/300)**(-2.60) 
kinf  =  1.5000~-ll  *  (Tf300)**(-0.50) 
F  =  0.60, 

n  =  1.00 

k(  37)  =  3.3000E-39  *  exp( 
k(  38)  = 
l.4000E-13  *  exp( 
k(  39)  = 
l.7000E-ll  *  exp( 
k(  40)  =  2.5000E-14  *  exp( 
k(  41)  =  2.5000E-12 
k(  42)  is  a  falloff  expression  using: 

530. O/T) 
-2500.0/Tl 
150.0/Tl 
-1230.0/Tl 

-

2.2oodE-30  *  (T/300)**(-4.30) 
kO 
kinf  =  l.500~E-12  *  (T/300)**(-0.50) 
F  =  0.60, 

n  ~  1.00 

k(  43)  = k(  42)  I  Keq,  where  Keq  = 
k(  44)  =  2.0000E-21 
k(  45)  is  a  falloff  expression  using: 

l.lOOE-27  *  exp(  11200.0/T) 

k~  =  2.6000E-30  *  (T/300)**(-3.20) 
kinf  =  2.400~E-ll  *  (T/300)**(-1.30) 
F  =  0.60, 

n  =  1.00 

k(  46)  is  a  special  rate  expression  of  the  form: 

(1  +  k3[M]/k2)),  where 

I 

785.0/T) 
4 .. lOOOE-16  *  exp(  1440. O/T) 
725.0/Tl 

k  =  kO  +  {k3[M] 
kO  =  7.2000E-15  *  exp( 
k2  = 
k3  =  1.9000E~33  *exp( 
380.0/Tl 
k(  47)  =  1.3000E-12  *  exp( 
k(  48)  =  4.6000E-ll  *exp( 
230.0/T) 
k(  49)  is  a  falloff  expression  using: 

=  3.oooriE-31  *  (T/300l**(-3.3ol· 
ko 
kinf  =  l.5000E-12  *  (T/300)**(  o.oo) 
F  =  0.60, 

n  =  1.00 

' 

I 

k(  50) 
k(  51) 
k(  52) 

l.5000E-13  *  (l.O  +  0.6*Pressurel 
2.8300E+Ol  *  (T/300)**(  2.00)  *exp(  -1280.0/T) 
-444.0/T) 
l.2330i-12  * 

(T/300)**(  2.00)  *exp( 

' 

,:11111 

{O.OOOOOE+OO}  ·' 
{o.oooooE+oo} 
{ 0. OOOOOE+OO},  ,, 
{O.OOOOOE+oo} 
{O.OOOOOE+OO} 
{6.09302E-34} 
{9.72293E-12} 
{2.60365E-ll} 
{4.04730E-ll} 
{2.20000E-10}  ::, 
{l.82272E-14} 
{6.82650E-l4} 
{2.05452E-15} 
{8.27883E-12} 
{1.39058E-12} 

{8.62399E-02} 
{3. 01634E-12}  :: 

{6.7890SE-30} 

{1.68671E-l2}  ,,, 
{4.87144E-12} 

{1.95397E-38} 
{3.18213E-17} 
{2.81225E-11} 
{4.03072E-16} 
{'2.SOOOOE-12} 
{l.26440E-12} 

{5.47034E-02}' 
{2.00000E-21} 
{l.14885E-ll} :: 

{l.47236E-l3}' 

1

1 1
'"

1, 

{4.65309E-l.2} 
{9.95294E-ll} 
{ 8. 88848~-l.3} :111 

., 

{2.40000E-l.3} 
{3.80672E-Ol.} 
{2.742l.OE-l.3} 

I 

8-96 

Table 8A-12.  RADM2_CIS4_AE and RADM2_CIS4_AE_AQ Mechanisms 
-S40.0/T) 
-380.0/T) 
-380.0/T) 
411. O/T) 
S04. O/T) 
549. O/T) 
322. 0/T) 
116. 0/T) 

2S6. O/T) 
-74S.O/T) 

-540.0/T) 
l.SSOOE-11  *  exp( 
181. 0/T) 
2.BOOOE-12  *  exp( 
1.9SOOE+16  *  exp(-13S43.0/T) 

k(  S3)  =  1.S900E-11  *  exp( 
k(  S4)  =  1.7300E-ll  *exp( 
k(  SS)  =  3.6400E-11  *  exp( 
2.1SOOE-12  *  exp( 
k(  S6)  = 
k(  S7)  =  S.3200E-12  *  exp( 
k(  58)  =  1.0700E-ll  *  exp( 
k(  S9)  =  2.lOOOE-12  *  exp( 
k(  60)  =  1.8900E-ll  *  exp( 
k(  61)  =  4.0000E-11 
k  (  62)  =  9.0000E-01  *  k(  61) 
k(  63)  =  9.0000E-12 
k  (  64)  =  6.8700E-12  *exp( 
l.2000E-ll  *  exp( 
k(  6S)  = 
l.1500E-ll 
k(  66)  = 
k(  67)  =  1. 7000E-ll 
k  (  68)  =  2.8000E-11 
k(  69)  =  1. OOOOE-11 
k(  70)  =  1.0000E-11 
k(  71)  =  1. OOOOE-11 
k(  72)  =  6.16SOE-13  *  (T/300)**(  2.00)  *exp( 
k(  73)  = 
k(  74)  = 
k(  7S)  = 
k(  76)  =  4.7000E-12 
k(  77)  =  1.9SOOE+l6  *  exp(-13S43.0/T) 
180.0/T) 
k(  78)  =  4.2000E-12  *  exp( 
180.0/T) 
k(  79)  =  4.2000E-12  *  exp( 
180.0/T) 
k(  BO)  =  4.2000E-12  *  exp( 
k  (  81)  =  4.2000E-12  *  exp( 
180.0/T) 
180.0/T) 
k(  82)  =  4.2000E-12  *  exp( 
180.0/T) 
k(  83)  =  4.2000E-12  *exp( 
180.0/T) 
k(  84)  =  4.2000E-12  *  exp( 
180. O/T) 
k(  BS)  =  4.2000E-12  *exp( 
180.0/T) 
k(  B6)  =  4.2000E-12  *  exp( 
k(  87)  =  4.2000E-12  *  exp( 
180.0/T) 
180.0/T) 
k(  BB)  =  4.2000E-12  *  exp( 
180.0/T) 
k(  89)  =  4.2000E-12  *  exp( 
180.0/T) 
k(  90)  =  4.2000E-12  *  exp( 
180.0/T) 
k(  91)  =  4.2000E-12  *  exp( 
k(  92)  =  6.0000E-13  *exp(  -2058.0/T) 
k(  93)  =  1.4000E-12  *  exp(  -1900.0/T) 
k(  94)  =  6.0000E-13  *  exp(  -2058.0/T) 
k(  9S)  =  1.4000E-12  *  exp(  -1900.0/T) 
l.4000E-12  *  exp(  -1900.0/T) 
k(  96)  = 
k(  97)  =  2.2000E-11 
k(  98)  =  2.0000E-12  *exp(  -2'923.0/T) 
k(  99)  =  1.0000E-11  *  exp(  -1895.0/T) 
-975.0/T) 
k(lOO)  =  3.2300E-ll  *exp( 
k(101)  =  1.2000E-14  *exp(  -2633.0/T) 
k(102)  =  1.3200E-14  *  exp(  -2105.0/T) 
k(103)  =  7.2900E-15  *  exp(  -1136.0/T) 
k(104)  =  7.7000E-14  *  exp(  1300.0/T) 
k(10S)  =  7.7000E-14  *  exp(  1300.0/T) 
k(l06)  =  7.7000E-14  *  exp(  1300.0/T) 
k(l07)  =  7.7000E-14  *  exp(  1300.0/T) 
k(l08)  =  7.7000E-14  *  exp(  1300.0/T) 
k(l09)  =  7.7000E-14  *  exp(  1300.0/T) 
k(llO)  =  7.7000E-14  *  exp(  1300.0/T) 
k(lll)  =  7.7000E-14  *  exp(  1300.0/T) 
k(112)  =  7.7000E-14  *  exp(  1300.0/T) 
k(l13)  =  7.7000E-14  *exp(  1300.0/T) 

-444.0/T) 

{2.S9669E-12} 
{4.83334E-12} 
{1. 01696E-11}. 
{8.S3916E-12} 
{2.88684E-ll} 
{6.7S269E-11} 
{6.1871SE-12} 
{2. 78943E-11} 
{ 4 .. OOOOOE-11} 
{3.60000E-11} 
{9.00000E-12} 
{1. 62197E-ll} 
{9.85020E-13} 
{1.lSOOOE-11} 
{1. 70000E-11} 
{2.80000E-11} 
{1.00000E-11} 
{1. OOOOOE-11} 
{1.00000E-11} 
{ 1. 3 710SE-13} 
{2.S3137E-12} 
{S.13974E-12} 
{3.S723SE-04} 
{4.70000E-12} 
{3.S723SE-04} 
{7.68378E-12} 
{7.6837BE-12} 
{7.6B378E-12} 
{7.6837BE-12} 
{7.6B37BE-12} 
{7.6837BE-12} 
{7.6B37BE-12} 
{7.6B37BE-12} 
{7.68378E-12} 
{7.68378E-12} 
{7.68378E-12} 
{7.6837BE-12} 
{7.68378E-12} 
{7.6B378E-12} 
{6.01030E-16} 
{2.38307E-1S} 
{6.01030E-16} 
{2.3B307E-1S} 
{2.38307E-1S} 
{2.20000E-11} 
{1.09940E-16} 
{1. 73099E-14} 
{1.22S39E-12} 
{ 1. 74SS9E-18} 
{1.12933E-17} 
{1.6112SE-16} 
{6.04038E-12} 
{6.04038E-12} 
{6.04038E-12} 
{6.04038E-12} 
{6.04038E-12} 
{6.04038E-12} 
{6.04038E-12} 
{6.04038E-12} 
{6.04038E-12} 
{6.04038E-12} 

111111:.:r .. :. 

;i:. 

1 

"!,11111:11

Table 8A-12.  RADM2  CIS4_AE and RADM2_CIS4_AE_AQ Mechanisms 
k(114)  =  7.7000E-14  *  exp(  1300. O/T) 
k(115)  =  7.7000E-14  *  exp(  1300. O/T) 
k(ll.6)  =  7.7000E-14  *  exp(  1300. O/T) 
k(ll.7)  =  7.7000E-14  *  exp(  1300. O/T) 
k(118)  =  1.9000E-13  *  exp( 
220.0/T) 
k(119)  =  1.4000E-13  *  exp( 
220.0/T) 
k(l.20)  =  4.2000E-14  *  exp( 
220.0/T) 
k(121)  =  3.4000E-14  *  exp( 
220. O/T) 
k(l.22)  =  2.9000E-14  *  exp( 
220.0/T) 
k(l.23)  =  1.4000E-13.*  exp( 
220. O/T) 
k(l.24)  =  1.4000E-13  *  exp( 
220.0/T) 
k(l.25)  = 
l.7000E-14  *  exp( 
220.0/T) 
k(l.26)  =  1.7000E-14  *  exp( 
220.0/T) 
k(l.27)  =  9.6000E-13  *  exp( 
220.0/T) 
k(l.28)  =  1.7000E-14  *  exp( 
220.0/T) 
k(l.29)  =  l.7000E-14  *  exp( 
220.0/T) 
220.0/T) 
k  (130)  =  9.6000E-13  *  exp( 
k(l.31)  =  1.7000E-14  *  exp( 
220.0/T) 
k(132)  =  3.4000E-13  *  exp( 
220.0/T) 
k(l.33)  =  1.0000E-13  *  exp( 
220. O/T) 
k(l.34)  =  8.4000E-14  *  exp( 
220.0/T) 
k  (135)  =  7.2000E-14  *  exp( 
220.0/T) 
k(l.36)  =  3.4000E-13  *  exp( 
220. O/T) 
k(l.37)  =  3.4000E-13  *  exp( 
220.0/T) 
k  (138)  =  4.2000E-14  *  exp( 
220.0/T) 
k(l.39)  =  4.2000E-14  *  exp( 
220. O/T) 
k(l.40)  =  l.l900E-12  *  exp( 
220.0/T) 
k(l.41)  =  4.2000E-14  *  exp( 
220.0/T) 
k(l.42)  =  4.2000E-14  *  exp( 
220.0/T) 
k(l.43)  = 
220.0/T) 
l.1900E-12  *  exp( 
k(l.44)  =  4.2000E-14  *  exp( 
220.0/T) 
k(l.45)  =  3.6000E-16  *  exp( 
220.0/T) 
k(l.46)  =  7.7000E-14  *  exp(  1300.0/T) 
k(l.47)  =  1.7000E-14  *  exp( 
220.0/T) 
k(l.48)  =  4.2000E-14  *  exp( 
220.0/T) 
k(l.49)  =  3.6000E-16  *exp( 
220.0/T) 
k(l.50)  =  4.2000E-12  *  exp( 
180.0/T) 
k(151)  =  4.2000E-12  *  exp( 
180.0/T) 
k(152)  =  7.7000E-14  *exp(  1300.0/T) 
k(l.53)  = 
220.0/T) 
l.7000E-14  *  exp( 
k(l.54)  =  4.2000E-14  *  exp( 
220.0/T) 
k(l.55)  =  3.6000E-16  *exp( 
220.0/T) 
k(l.56)  = 
k(l.57)  = 
k(lSB)  = 
k(l.59)  =  2.5400E-ll  *  (T/300)**(  1.00)  *  exp( 
407.6/T) 
k(l.60)  =  4.2000E-12  *  (T/300)**(  1.00)  *exp( 
181.2/T) 
k(161)  =  7.7000E-14  *  (T/300)**(  1.00)  *  exp(  1298.3/T) 
k(l.62)  =  B.4000E-14  *  (T/300) ** (  1. 00)  *  exp( 
221.4/T) 
k(163)  =  3.4000E-14  *  (T/300)**(  1.00)  *exp( 
221.4/T) 
k(l.64)  =  7.B600E-15  *  (T/300) ** (  1. 00)  *  exp(  -1912.2/T) 
k(l.65)  =  3.6000E-11 
k(l66)  =  3.0300E-12  *  (T/300)**(  1.00)  *exp( 
-447.9/T) 
k(l.67)  =  4.2000E-12  *  (T/300) ** (  l. 00)  *  exp( 
181.2/T) 
k  (168)  =  7.7000E-14  *  (T/300)**(  1.00)  *exp(  1298.3/T) 
k(l.69)  =  8.4000E-14  *  (T/300)**(  1.00)  *  exp( 
221.4/T) 
k(l.70)  =  3.4000E-14  *  (T/300)**(  1.00)  *exp( 
221.4/T) 
k(l.71)  =  l. B600E-11  *  (T/300) ** (  1.00)  *  exp( 
176.1/T) 
k(l.72)  =  4.2000E-12  *  (T/300)**(  1.00)  *  exp( 
181.2/T) 
k(l73)  =  7.7000E-14  *  (T/300)**(  1.00)  *  exp(  1298.3/T) 
k(l.74)  =  B.4000E-14  * 
221.4/T) 

{6.04038E-12} 
{6.04038E-l.2}, 
{6.04038E-12} 
{6.04038E-12} 
{3.97533E-13} 
{2.92919E-13} 
{8.78758E-14} 
{7.11376E-::14} 
{6.06762E-14} 
{2.92919E-13} 
{2.92919E-::13} 
{3.55688E:::i4}: 
{3.55688E-l.4} 
{2.00859E-12} 
{3.55688E-l4} 
{3.55688E-l.4} 
{2.00859E-l.2} 
{3.55688E-l.4} 
{7.11376E-l.3} 
{2.09228E-13} 
{l. 75752E-13} 
{l.50644E-l3} 
{7.11376E-13} 
{ 7 .113 76E:: .. 13} 
{ 8. 78758E-14}, 
{8.78758E-14} 
{2.48981E-12} 
{ 8. 7.8758E .. : .. l4} 
{ 8. 78758E .. :-14} 
{2.48981E-l2}. 
{8.78758E-l.4}. 
{7.53221E-16} 
{6.04038E-12} 
{3.55688E-l.4} 
{8.78758E-14} 
{7.53221E:::16}  "'I 
{7 .6B378E-12} 
·· 
{7.6B378E-12} 
{6.04038E:-12} 
{3 .5568BE-:l4} :I]'! 
{ B. 78758E:..14}  ' 
{7.53221E-16} 
{6.75269B-11} 
{1,22539E:-l2} 
{l.61125B-16}  ·· 
{9.90719E-11} 
{7.66335E-12} 
{5.96598E-12}  " 
{l. 75402E-13} 
{7.09961E-14} 
{1.27569E-i7} 
{3.60000E-11} 
{6.69552E-13} 
{7.66335E-12} 
{S.9659BE:::12} 
{1.15402E::.13} ,. 
{7.09961E-14} 
{3.33618E-11} 
{7.66335E-12} 
{5.9659BB-12} 
{1. 75402E-l3} 

l.OOOOE+OO  *  k(  SB) 
l.OOOOE+OO  *  k(lOO) 
l.OOOOE+OO  *  k(l03) 

,,,1111 

'II 
":I• 

''1111 

,!::'::;111 
,,,,:Ill 

(T/300)**(  1.00)  *  exp( 

I 

8-98 

·i·1' 

11·1 '' 

Table 8A-12.  RADM2_CIS4_AE and RADM2_CIS4:._AE_AQ Mechanisms 

,  scaled  by  3.60000E-03 

,  scaled  by  1.llOOOE-02 

k(l75)  =  3.4000E-14  *  (T/300)**(  1.00)  *  exp( 
221.4/T) 
{7.09961E-14} 
k(l76)  =  l.3600E-15  *  (T/300)**(  1.00)  *  exp(  -2113.5/T) 
{1.12330E-18} 
k(177)  uses  photo  table  ACROLEIN 
{O.OOOOOE+OO} 
k(l78)  =  l.5000E-12  *  (T/300)**(  1.00)  *  exp(  -1726.0/T) 
{4.54753E-15} 
k(l79)  =  4.1400E-12  *  (T/300)**(  1.00)  *  exp( 
452.9/T) 
{l.87990E-ll} 
k(l80)  =  4.2000E-12  *  (T/300)**(  1.00)  *  exp( 
181.2/T) 
{7.66335E-12} 
k(181)  =  7.7000E-14  *  (T/300) ** (  l. 00)  *  exp{  1298 .3/T) 
{5.96598E-12} 
k(l82)  =  8.4000E-14  *  (T/300)**(  l.00)  *  exp( 
221.4/T) 
{1. 75402E-13} 
k(l83)  =  3 .4000E-14  *  (T/300)**(  l.00)  *  exp( 
221.4/T) 
{7.09961E-14} 
k(l84)  =  7.5100E-16  *  (T/300)**(  1.00)  *exp(  -1519.7/T) 
{4.54966E-18} 
k(185)  uses  photo  table  ACROLEIN 
{O.OOOOOE+oo} 
k(186)  = 
l.6000E+l6  *  (T/300)**(  1.00)  *  exp(-13486.0/T) 
{3.52536E-04} 
k(l87)  =  4.2000E-12  *  (T/300)**(  1.00)  *  exp( 
181.2/T) 
{7.66335E-12} 
k(188)  =  2.8000E-12  *  (T/300)**(  1.00)  *  exp( 
181.2/T) 
{S.10890E-12} 
k(l89)  =  7.7000E-14  *  (T/300)**(  1.00)  *  exp (  1298. 3/T) 
{5.96598E-12} 
k(190)  =  9.6000E-13  *  (T/300)**(  1.00)  *  exp( 
221.4/T) 
{2.00460E-12} 
k(191)  = 
221.4/T) 
l.1900E-12  *  (T/300)**(  1.00)  *  exp{ 
{2.48486E-12} 
k(192)  = 
l.1900E-12  *  (T/300)**(  1.00)  *  exp{ 
{2.48486E-12} 
221.4/T) 
k(l93)  =  3.3600E-ll 
{3.36000E-l.l} 
k(l94)  =  4.2000E-12  *  (T/300)**(  l.00)  *  exp( 
{7.66335E-12} 
{5.96598E-12} 
k(l95)  c 
{1. 75402E-13} 
k(196)  =  8.4000E-14  *  (T/300) ** (  1. 00)  *  exp( 
k(l97)  =  3.4000E-14  *  (T/300)**{  1.00)  *  exp{ 
{7.09961.E-14} 
k(l98)  =  7.llOOE-18 
{7.llOOOE-18} 
{O.OOOOOE+oo} 
k{l99)  uses  photo  table  ACROLEIN 
k(200)  =  1.0000E-13 
{l.OOOOOE-13} 
=============================================================================== 

181.2/T) 
7.7000E-14  *  (T/300)**(  1.00)  *  exp(  1298 .3/T) 
221.4/T) 
221.4/T) 

,  scaled  by  3.60000E-03 


PLUME-IN-GRID TREATMENT OF MAJOR POINT SOURCE EMISSIONS 

Chapter 9 
============

EP A/600/R-99/030 

N. V. Gillani 

Earth System Science Laboratory 
University of Alabama in Huntsville 

Huntsville,  Alabama 35899 

James M. Godowitch" 

Atmospheric Modeling Division 

National Exposure Research Laboratory 
U.S.  Environmental Protection Agency 

Research Triangle Park, North Carolina 27711 

ABSTRACT 

A plume-in-grid (PinG) technique has been developed to more realistically treat the dynamic and 
chemical processes impacting selected, major point source pollutant plumes in the Community 
Multiscale Air Quality (CMAQ) modeling system.  The principal science algorithms include a 
Plume Dynamics Model (PDM) and a Lagrangian reactive plume code.  The PDM processor 
simulates plume rise,  horizontal and vertical plume growth, and transport of each plume section 
during the subgrid scale phase.  It generates a data file  of this information for use by the PinG 
module.  In contrast to the traditional Eulerian grid modeling method of instantly mixing the 
emissions from each point source into an entire grid cell volume, the PinG module simulates the 
relevant physical and chemical processes during a subgrid scale phase which allows each plume 
section to expand in a realistic manner and to evolve chemically.  The PinG module is fully 
integrated into the CMAQ Chemical Transport Model (CCTM) in order to utilize the grid 
concentrations as boundary conditions and it provides a feedback of the plume pollutants to the 
grid model concentration field  at the proper time and grid location.  The technical approaches and 
the model formulation of the relevant processes treated by this plume-in-grid approach are 
described.  The capabilities and limitations of the initial version of PinG are also discussed and 
selected results from a test application for a single point source are briefly described. 

. 

. 
On assignment from the National Oceanic and Atmospheric Administration, U.S.  Department of Commerce. 
Corresponding author address: James M.  Godowitch, MD-80, Research Triangle Park, NC 27711.  E-mail: 
jug@hpcc.epa.gov 

PLUME-IN-GRID ~,;REATMENT OF MAJOR POINT SOURCE EMISSIONS 

9.1 

Introduction 

Significant emissions of anthropogenic nitrogen oxides (NO,J and sulfur oxides (SO,J are released 
from individual elevated point sources into the atmosphere at various levels.  These major point 
source emissions are distributed throughout the U.S.  The physical dimensions of their plumes are 
relatively small initially and expand at finite growth rates.  This diffusion-limited nature of plumes 
is in sharp contrast to the traditional method applied in Eulerian photochemical grid modeling, 
which has been to uniformly and instantly mix point source emissions into the entire volume of a 
model grid cell.  Depending on the meteorological conditions, however, pollutant plumes may 
require up to several hours to grow to the typical size of a regional model grid cell.  Since the 
horizontal grid resolution of regional scale domains for Eulerian models has generally been 20-~p 
km or greater, a real-world pollutant plume may remain a subgrid scale feature at current regional 
model grid resolutions for a substantial time period and considerable distance after release.  Thus, 
the widely-used grid modeling approach inadequately treats subgrid scale plume transport and 
diffusion. 

There are also important implications on the chemical processes in models due to the inability of 
large grid cells to adequately resolve a major point source plume.  As a real-world plume 
gradually grows, it concurrently evolves chemically as it entrains surrounding ambient air often 
richer in volatile organic compounds (VOCs).  However, these dynamic and chemical processes 
of plumes are neglected when large point source emissions are instantly diluted into large grid 
cells with other anthropogenic area emissions, which may actually be separated spatially from a  ;; 
plume.  The effect is that the simultaneous availability ofNOx and VOC's in a large grid cell 
prematurely initiates rapid photochemistry leading to distortion in the spatial and temporal 
features of secondary species concentrations.  This overdilution of point source emissions and the 
subsequent distortion of chemical processes contribute to model uncertainty.  Consequently, it has 
been recognized that a realistic,  subgrid scale modeling approach is needed which simulates the 
relevant physical and chemical processes impacting this notable class of large point source 
emissions,  and in particular, that has the capability of properly resolving the spatial '~cale of 
plumes and their growth. 

There are approaches which have been applied in attempts to resolve fine scale emissions in 
regional grid models.  These have included uniform, nested grid modeling (Odman and Russell, 
1991; Chang et al.,  1993), non-uniform grid modeling (Mathur et al.,  1992), and the plume-in- .. 
grid modeling (PinG) technique. The nested grid (telescoping) modeling approach employs the,,, 
same Eulerian model and simulations are performed with progressively finer-mesh grid sizes 
· ' 
within a domain to better resolve small scale emission features.  While an advantage of this 
approach is the use of a single model algorithm,  a disadvantage is the successively higher 
computational burden as the grid cell size is reduced in order to resolve major ~mi§~ion source~,,: 
Efforts to implement and apply the plume-in-grid technique, in particular, have been performed by 
Seigneur et al.  (1983) in a version of the Urban Airshed Model (UAM-P ARIS), by Morris et al. 
(1992) in the UAM-V model,  by Kumar and Russell (1996) in the Urban-Regional Model (URM), 
and by Myer et al.  (1996) in the SAQM (SARMAP Air Quality Model) model.  Briefly,  each of 
these PinG efforts simulate multiple plumes or puffs in a domain with no interaction between 
individual plumes.  Seigneur et al.  (1983) employed a rectangular plume cross-section divided into 
vertically well-mixed plume cells exhibiting varying widths to maintain equal pollutant mass 
among the cells.  It was applied to an urban domain with a 4 km grid cell size.  The other efforts 
employ an elliptical plume section divided into concentric rings,  except for the Kumar and Russell 
(1996) PinG.  Plume material in an outermost elliptic ring or shell is sequentially transferred to the 
grid model as it attains the grid size.  In the treatment by Kumar and Russell, the plume was 
returned to the grid model after one hour.  The general result of applications from these PinG 
implementations was that noticeable differences were found  primarily within or near the grid cells 
containing the major point sources and negligible impact was found far downwind.  This finding is 
to be expected since these formulations seemed to focus on the plume-core chemistry only in an 
early phase of plume chemical evolution with the feedback of plume pollutants occurring rather 
quickly to the grid model. 

A cooperative research and development effort was undertaken to design and implement a plume(cid:173)
in-grid (PinG) capability in the Models-3  CMAQ Chemical Transport Model (CCTM) in order to 
address the need for an improved approach to treat major point source emissions.  The current 
PinG approach has been designed to be suitable for the largest, isolated point source emissions 
with grid resolutions of regional modeling domains, where the sub grid scale error in the 
representation of these sources is  expected to be greatest without a PinG treatment.  An 
important consideration is to be able to spatially resolve a pollutant plume and to adequately 
simulate physical expansion so that the chemical evolution can occur gradually. 
Therefore, the objectives with this PinG technique are to provide an improved characterization of 
the near-source pollutant field  from the subgrid scale plume concentrations and to also generate 
better regional pollutant concentrations downwind due to the feedback of the PinG concentrations 
to the gridded domain.  Consequently, when the PinG approach is applied to the largest point 
source emissions in .a regional,  coarse-grid domain, improved initial and boundary conditions are 
anticipated for use with subsequent simulations for a subdomain of the same grid resolution or for 
fine-mesh nested domains that also need the regional gridded concentration fields. 

In this chapter, the conceptual design of the PinG approach is discussed.  The key modeling 
components are a Plume Dynamics Model (PDM) and a Lagrangian reactive plume model  ___  . 
designated as the PinG module since it is fully integrated and coupled with the CCTM Eulerian 
grid model.  The PDM has been developed to serve as a processor program to generate plume 
dimensions,  plume position information and related parameters needed by the PinG module.  The 
descriptions of the mathematical formulations and numerical techniques contained in these 
modeling components are also presented.  Their solutions form the basis of the physical-chemical 
simulations of sub grid scale plumes as implemented in the principal algorithms of the PinG 
modeling components. 

9.2 

Overview of the Conceptual Framework of the Plume-in-Grid Tre~.~ment 

The PinG technique is intended for the largest point sources, designated as major elevated point 
source emissions (!\1EPSEs),  which are isolated from notable area emission sources.  A complete 
description of the various criteria available to classify a point source as a MEPSE is provided in  .. 
the emission processing system in chapter 4.  In the context of photochemical modeling, the NOX 
emission rate is a useful criterion to classify a major point source as a MEPSE from the thousands 
of individual major point sources in an inventory.  Base~ on a NOx emission rate criterion of 50 
tons/day as a lower limit, Figure 9-1  depicts the group of fewer than 100 MEPSEs in a 36 km 
gridded domain covering the eastern US with emission rates greater than this criterion.  The 
!\1EPSE sources are situated away from major metropolitan emission source areas.  It reveals that 
numerous !\1EPSEs are distributed throughout the Ohio River and Tennessee River valley regions. 
Since the current PinG technique also relies on linear superposition of!\1EPSE plumes for 
determining the impact on grid concentration, the relatively isolated MEPSEs located in these 
remote rural environments also provide for the lowest likelihood of plume-plume interactions. 

An important feature of a PinG treatment is that it must be able to reproduce the various stages in 
the chemical evolution found in a large,  rural point source plume.  Based on daytime experimental 
field  study plume data, Gillani and Wilson (1980) documented three distinct stages, as displayed 
in Figure 9-2, in the chemical evolution of ozone (03) in a pollutant plume from a lllgh NO:c 
source.  The 0 3 data measured across a plume at different downwind distances in Figure 9-2 
illustrate ozone evolution in a large NOx point source plume.  Although NOx was not obtained, it 
would display a similar variation to S02  shown in Figure 9-2.  During the first stage, the relatively 
fresh plume is dominated by primary NOx  emissions and an 0 3 deficit exists in the plume due to 
titration by very high NO concentrations.  The chemistry in stage 1 is mostly inorganic and VOC(cid:173)
limited since !\1EPSE plumes generally ~xhibit low VOC emissions.  The second stage represents 
a transition in the chemistry with rapid production of 03 along the plume edges and some 03 
..... ,, 
recovery in the plume core.  Plume growth from dispersion processes allows for entrainment of 
background air which generally contains a richer supply of ambient voe conc~Qtr~!,ions. 
Consequently, this promotes rapid photochemical 0 3 production which leads to the 
characteristically higher 0 3 concentrations observed at the edges of a plume during this stage. 
Figure 9-2 reveals that stage 2 certainly exhibits considerable subgrid scale plume structure in 
species concentrations.  Therefore, the proper simulation of plume chemistry throughout stage 2 
is a key phase for a realistic,  overall characterization of plume chemical evolution.  In fact,  full 
completion of stage 2 is an important requirement for a chemical criterion during the PinG 
simulation before the plume pollutants are transferred to the grid system.  In stage 3, the plume is 
chemically mature and substantially diluted.  In this mature stage, the broad plume would also 
exhibit a high VOC/NOx  ratio, low NOx  concentrations, and 0 3 concentrations in excess of 
background levels.  In the modeling system, background (boundary) concentrations are provided 
from a CCTM grid cell containing the subgrid scale plume section. 

The chemical evolution,  as described above, for a large !\1EPSE plume in the eastern US generally 
may take up to several hours to reach full  maturity even during the daytime period.  The 
photochemical cycle is strongly influenced by the plume growth rate, particularly the rate of 
horizontal spread, with stage 3 achieved when a typical MEPSE plume attains a width of about 30 
km during the daytime period.  In addition, the time period to reach chemical maturity is also a 
function of the emission rate.  There is a range of emission rates even within a MEPSE group. 
For example, particular MEPSE plume with lower NOx emissions is expected to exhibit a faster 
chemical evolution than a MEPSE with a higher emission rate, assuming other factors being the 
same.  Nevertheless, during the subgrid scale simulation period, the plume may travel a 
·considerable distance downwind (i.e.  sever~ model grid cells) of its source location in the daytime 
planetary boundary layer (PBL) during the summer before reaching a width comparable to the 
grid cell size. 

The conceptual design of the Models-3  PinG is illustrated in Figure 9-3.  PinG components 
simulate the relevant processes impacting the hourly emission rate of all pollutant species during 
the subgrid scale phase and it provides a feedback,  or 11handover 11
,  of the modeled plume species 
concentrations at an appropriate handover time (tw0 )  to the CCTM grid framework.  The PinG 
module operates in a Lagrangian modeling framework to simulate the dynamics and kinetics in a 
moving plume section during the subgrid scale phase whose duration depends primarily upon 
source strength, plume growth rate, chemical composition of the background CCTM grid 
concentrations, and sunlight.  The PinG module simulates the plume processes concurrently 
during the simulation of the CCTM grid model. 

The PinG module contains a series of rectangular plume cross-sections, each of which are 
composed of a contiguous, crosswind array of plume cells with the depth of each cell extending 
vertically from plume bottom to a top height.  As displayed in Figure 9-3a,  the vertical depth of 
the single-layer plume model may be elevated initially, however, it eventually extends from the 
surface to the PBL height(~).  This one-layer plume structure in the initial PinG module also 
presents a limitation under high wind speed shear conditions since this situation cannot be 
modeled adequately.  While strong speed shears are more frequent during the nocturnal period, 
the vertical extent of a plume is also generally confined, which lessens the possible impact of 
speed shear.  Nevertheless, this condition is identified and appropriately handled by the PinG 
components. 

9.3 

Formulation of the Plume-in-Grid Modeling Components 

9.3.1  Description of the Plume Dynamics Model 

The PDM was developed to serve as a processor program in order to provide data needed for the 
CCTM/PinG simulation.  Therefore, the PDM and the PinG module are closely linked through 
the PDM data file.  The key processes simulated by the PDM include plume rise,  plume transport, 
and plume dispersion of each MEPSE plume cross-section.  The PDM also specifies when a 
particular plume section is to be transferred to the grid model based on an indicator flag which 
communicates to the PinG module when this process is to be performed.  The PDM is capable of 
simultaneously treating up to 100 MEPSEs in a single simulation with the impact on 
computational time a function of the number ofMEPSEs simulated.  In addition, the maximum 
simulation period is currently limited to 24 hours.  Therefore, a single simulation of the CCTM 
with PinG is also limited to a 24-hour time period.  ·· 

9.3.1.1 

!I· 

Aspects of Plume Rise of MEPSE Sources 

.,. 

The plume rise treatment implemented in PDM contains the same algorithms applie~ in the 
Emissions-Chemistry Interface Processor (ECIP).  A detailed discussion of the plume rise 
equations and treatment has been provided in section 4.4.2 of chapter 4 on the MEPPS system 
and therefore is not repeated herein. 

' 

( 

The plume rise algo;ithms handle the entire diurnal cycle since plume sections ~e r~leased hou;ly 
throughout the 24 hour cycle.  The temporal variation of the final  effective plume height for 
···· 
hourly MEPSE plume releases is illustrated in Figure 9-4. 
In this case,  a diurnal variation in the 
final  plume height is evident with lower plume rise occurring at night believed to be due in partto 
stronger wind speeds.  The plume height increases during the morning period as the PBL heigh[": 
grows and the relatively high values found in the afternoon display little variation until the end 01f 
the daytime period.  · 

A notable feature ofMEPSE plumes also revealed in Figure 9-4 is the rather significant height  , 
often attained by this class of point sources.  Statistics of the stack parameters .:ffo.mMEPSE an.9 
non-MEPSE groups of major point sources were determined.  A  comparison iggic~ies notable 'liiiilllll~ 
differences in certain stack parameters between these source groups.  The average values from a 
MEPSE group containing 84 stacks compared to the other major point source class containing 
6539 stacks show a stack height of207 m versus 45  m, a stack velocity of20ip/sversus 12.5 · 
mis, a stack diameter of7.5 m versus 2.3  m,  a stack exit temperature of 410° K versus 424° K, 
and a stack exit flow rate of 908 m3/s versus  105  m3/s, respectively.  Clearly,  these results indicate 
why MEPSE plume heights attain higher levels than most point sources.  In general, MEPSE 
stacks are considerably higher and their plumes exhibit greater buoyancy flux due primarily to 
greater physical dimensions which contribute to higher plume rise heights. 

"' 

1
1 
1

1 

11 

''

•• 

9.3.1.2 

Plume Dispersion Methods 

A key aspect of modeling a subgrid scale reactive plume, as noted earlier, is the importance of 
realistically specifying plume dimensions during travel time downwind.  Practical methods have 
been applied in the initial ver~.ion of PI>M to deterw.ine the horizontal and vert\,cal ~~mensions of 
each Lagrangian plume section throughout its life cycle. 

Each rectangular plume cross-section has a width (WP)  and an overall height from plume bottom 
to top denoted by }\ .  The traditional dispersion parameters in the horizontal (cry)  and vertical 
( crz)  have been employed in order to derive these plume dimensions.  In the current version, the 
plume width and plume height values are determined according to 

9-6 

w  =  aa 

p 

y 

Hp  =  hT  - hb 

EP N600/R-99/030 

(9-la) 

(9-lb) 

where a has been set to 3.545 which is obtained from 2(nY\ an adjustment parameter from an 
elliptical shape to the rectangular plume.  The top and bottom heights of each plume cross-section 
are denoted by hT  and hb  , respectively.  The methods used to determine values for the parameters 
in Equations 9-1 a and 9-1 b are discussed next. 

During the plume rise phase,  a plume experiences initial growth due to buoyancy-induced 
turbulence.  To account for this process,  practical methods have been used to determine initial 
values for the dispersion parameters.  The initial value of aY is computed according an expression 
suggested in Irwin (1979), as advanced by Pasquill (1976),  given by 

(J yo  = fl.h/3 . 5 

(9-2) 

In Equation 9-2, the initial value is a function of the plume rise (tl.h) above the stack top. 

Two methods have been installed to prescribe an initial vertical plume thickness.  The widely used 
approach advanced by Briggs (1975) is to define!\, to be equivalent to the amount of plume rise 
(tl.h).  This method can result in a rather thick plume when there is considerable plume rise, 
particularly, at night when experimental evidence suggests nocturnal plumes may be relatively 
thin.  Consequently, an optional approach provided as an experimental alternative has been 
included.  It consists of an empirical form developed by Gillani (1996) which is based on analyses 
of observed plume data taken during a field  study (Gillani et al.,  1981).  His regression analyses 
produced an expression given by 

a  = Ae (-BdT!dz) 
zo 

(9-3) 

where dT/dz is the vertical ambient temperature gradient at the plume centerline height and the 
best-fit values for A and B are 15  and  117, respectively.  A minimum azo value is set to 3 m. 
Then, the initial!\,  is determined from SZOFA times 0 20•  SZOFA is a user-specified input 
parameter for a PDM simulation and it is currently set to 3.545. 

Atmospheric turbulence and wind direction shear contribute to lateral plume growth during travel 
downwind.  During the daytime convective period, the turbulence component is often dominant, 
although directional shear across the PBL also has an important role in contributing to plume 
spread with travel distance.  In contrast, turbulence is generally weak at night, and horizontal 
plume expansion may be dominated by wind direction shear over a plume's depth.  Thus, the 
composite horizontal (lateral) dispersion parameter ( aY ) can be defined by 

'''!! 

1111

'!

2 
2 
ay  = aye  +  ays  +  ayo 

2 

2 

(9-4) 

where the turbulence ( ay1)  and direction shear (a.) terms may both contribute to horizontal plume 
growth after the initial plume spread. 

111111"" 

A general form for ayi can be expressed by 

'111111·11 

aye  = avTJ(TfT.J 

(9-5) 

ilii:lh 

'1111:':111"1" 

,, 

' 

where av is the standard deviation of the lateral wind (v) component, Tis travel time, and 'tL is the 
Lagrangian time scale.  Although various expressions for the function,  f(thJ, have emerged (e.g., 
Draxler,  1976; Irwin,  1983), the following form from Weil (1985; 1988) and applied by others 
(eg.,Venkatram,  1988) has been adopted. 

f  =  (1 

11;111 

(9-6) 

This form is advantageous since it fits dispersion at both the short (t < -i:J and also long travel 
times (t>>-i:J.  Since the Lagrangian time scale is small relative to the pJume sc;:~tio!!,,,travel tim~,,~, 
which are often several hours, the expressions above reveal the familiar relation that a>1  increase.s 
with the square root of travel time.  Therefore, the following form according to Weil (1988) at ..... ·· 
long travel times, which has been examined by Clarke et al.  (1983), is given by  ·· 
"'  · 

·· 

• 

1111, 

,, 

2 
aye  =  2av-r:LT 

2 

(9-7) 

The above equation also displays the square root of time increase for the lateral dispersion 
parameter.  Using modeled meteorological parameters from data files generated by MCIP, 
methods have been incorporated to determine the key parameters needed to solve the above 
expressions for ayi.  Values for av and  'CL  are computed with a set of formulas presented in Hanna 
et al.  (1982) and Hanna (1984), respectively, for various stability conditions based on Monin(cid:173)
Obhukov length (L) limits.  For unstable conditions with L < 0 

... , '""' 

9-8 

av  =  u.(12  - 0.5z/L)ll3 

'CL  = O. l5z/av 

EP N600/R-99/030 

(9-8) 

(9-9) 

where Zj  is the PBL height and u. is the surface friction velocity.  Under stable conditions defined 
by L> 0, 

av  = 1.3u.(1  - zlz) 

1:  = 0.07z la (z/z.)0
L 

v 

I 

5 

·

I 

(9-10) 

(9-11) 

and z is the height of the plume centerline.  For neutral conditions (L =  0),  values are determined 
by 

av  = 1.3e (-2ftlu.) 

'CL  = 0.5z/av(l  +  15/z/u.) 

(9-12) 

(9-13) 

where fis the Coriolis parameter.  Using av and 'CL values, the contribution from the turbulence 
component is computed incrementally from the derivative of Equation 9-7 and solved at each time 
step.  The turbulence term is accumulated with time.  Other semi-empirical methods available in 
PDM provide an alternative set of parameterizations for av as provided by Weil (1988), 
Nieuwstadt( 1984 ),  and Arya( 1984) for the different stability regimes, which may be selected from 
an input option when exercising PDM. 

Wind direction shear due to turning of the wind over the vertical extent of a plume can also 
provide an important contribution to horizontal plume growth.  While turbulence often dominates 
in the daytime PBL, direction shear during the nocturnal period is the principal mechanism for 
lateral plume expansion since turbulence is generally weak.  An expression by Pasquin (1979) has 
been applied for all  conditions to derive the direction shear term and is given by 

2 
ays  = a~8 2.x2 


(9-14) 

where« is 0.03, Xis distance traveled by a plume section over a particular time interval, and A6 
is the wind direction difference (radians) over the vertical extent of the plume.  The shear and 
turbulence terms are combined to solve for the total a/  in Equation 9-4. 

After the initial plume thickness has been determined, the treatment for Oz differs based on 
whether the plume height is above or below the PBL height.  When the plume centerline height is 
above Zj  ,  then the following expression from Gillani (1996) is applied to determine az. 

2 
2 
0 z  = 0 zo 

·

5

(1  +  bT0
) 
(1  +  bT~.s) 

::II, 

(9-15) 

,11111:::1' 

where b is 2.3  and T is travel time.  Equation 9-15 is applied for T < 4 hours.  At longer travel 
times,  a 2  is set to zero for plumes existing above the PBL in the free atmosphere. 

''Ill;,; 

When a plume section is inside the PBL, the parameterization for the vertical plume dispersion 
parameter can be expressed by the same general form as ay1. 

,1111," 

'w 

az  =  aw  T f(Tlt1) 

(9-16) 

As before,  T is the travel time,  and f has the same function~! form as used for ayt although it now 
contains the Lagrangian time scale in the vertical (tLJ·  The standard deviation of the vertical 
wind component (aw) is computed from the following expressions as given by Weil (1988) for 
unstable conditions and from Venkatram et al  (1984) for neutral/stable conditions, respectively. 

aw  = 0.6w. 

(convective  case) 

aw  = 1.3u.(l  - z!z)314 

neutral/stable 

(9-17) 

(9-18) 

The MCIP data files provide values for the fraction velocity (u.), the convective velocity scale 
(w.) and~·  The plume centerline height is represented by z.  The value of't'Lz is computed from 
the following expressions by Hanna et al.  (1982) for unstable and by Venkatram et al.  (1984) for 
neutral/stable conditions. 

't'Lz  =  0.15-'  [l  - e -5zlz,] 

z 
aw 

(unstable) 

(9-19) 


In the latter expression, the length scale (1)  is derived according to Venkatram et al.  (1984). 

An example application of these methods from a PDM simulation for a plume released at night 
from a MEPSE tall stack is shown in Figure 9-5.  It shows the plume remains rather narrow and it 

l 
'tLz  =  CJ 
w 

(neutral/ stable) 

(9-20) 

stays elevated during the night.  However,  once the PBL grows beyond the plume height during 
the morning period, the plume thickness expands to fill  the entire PBL with the plume top height 
matching~ until it reaches a maximum height.  The temporal variation of the plume width for the 
same example case is displayed in Figure 9-6.  It shows that since the plume has a limited vertical 
extent at night, the plume width increases at a relatively slow rate as sufficient direction shear 
existed over the plume depth to cause lateral spreading.  During the daytime, however, horizontal 
plume expansion occurs at a faster rate due to both greater turbulence and shear contributions. 
For a regional grid cell size of 36 km,  the plume width for this release reached the physical grid 
size during the mid-morning hour.  These results and other simulation results obtained from a 
daytime release versus observed values (Godowitch et al.,  1995) provide preliminary evidence 
that these methods give a realistic depiction of the temporal behavior of the magnitudes of plume 
width and depth.  Additional cases have also been exercised, although results are not shown 
herein, in order to assess the robustness and capability of the algorithms for different days.  An 
extensive evaluation of these dispersion methods in PDM is planned against field  study data 
obtained in the vicinity of major point sources in the Nashville, Tennessee area during the 
Southern Oxidant Study experimental period in the summer of 1995. 

9.3.1.3 

Plume Transport 

With the updated plume top and bottom heights,  the mean wind components are determined by 
averaging the winds over the layers spanned by the plume from hb  to hT.  This approach is 
currently applicable because of the single vertical layer structure of the current PinG module.  The 
mean plume transport speed is used to determine an updated plume centerline position over the 
time interval.  In addition, the positions of the plume edges at the bottom and top are also found 
in order to derive grid indices for later use in applying the proper grid cell concentrations for 
boundary conditions of each plume section. 

9.3.2  Formulation of the Plume-in-Grid Module 

9.3.2.1 

Overview of the Plume Conceptual Framework 

The Lagrangian plume model described originally by Gillani (1986) provided the conceptual basis 
for the Models-3  PinG module.  However, the computer algorit~s .in the C~!Mf,,,J:>inG have,, !ii, 
been rewritten to c~ntain up~,,ated methods for the key processes to be describ~.!i in,. a later sect!~n. 

,,1:::11 
''·ill1 
In a modeling framework,  a PinG plume cross-section can be described as a semi-infinite vertical 
slab moving along a Lagrangian trajectory with a mean wind flow.  A plume cross-section is 
considered rectangular with a vertical height (8i,) and a width (WP).  Temporally, plume spread 
in the vertical and horizontal is specified by growth rates dfl/dt and dW/dt, respectively.  A 
plume cross-section is discretized laterally into an array of attached plume cells or pillars with the 
same 8i,  at time t,  as depicted in Figure 9-7.  Each plume section consists of N pl~.me cells 
(currently, N =  I 0) with the width of each cell being equal.  With respect to the plume centerline, 
there are NL cells on the left side and NR  cells to the right side, such that 

,,, 

,II 

WP=  ~LI  WLi  +  ~~ WRi 
N  =NL+  NR 

(9-21) 

Currently, NL= NR  as Land R refer to the cells on the left and right sides,  respectively.  With 
respect to the plume centerline, the right side of the plume section expands to the right and the., 
left side expands to the left.  The width (w;) of each plume cell is given by 

(w)uR  = CY;.1  - Y)uR 

(9-22) 

where y values represent distances from the plume centerline position.  Normalization of the 
plume cell widths is performed such that as the plume expands laterally, each cell width increases 
in the same proportion as the overall plume width.  Thus,  since the individual cell width is 
normalized with respect to the total plume width, the result is a transformed moving crosswind 
gridded array which is invariant with respect to time.  The transformed crosswind 
coordinate ( 11)  of the model is given by 

Tl;  =  Y1 
WP 

(9-23) 

and d11Jdt is zero.  Therefore, although WP  and Y;  are time dependent, T};  remains constant during 
a simulation.  Additionally, although the fractional width of the cells across the plume section in 
the PinG has been prescribed to be equal in the current setup of the module, the algorithms have 
been generalized to allow for unequal plume cell widths and a different number of cells on the l~ft 
and right sides of the plume centerline as described in Gillani (1986). 

9.3.2.2 

Formulation of the Plume Mass Balance Equation 

The relevant processes, as noted in Figure 9-7,  have been incorporated into the plume equation 
for the mass balance of individual species.  They include dilution and entrainment due to vertical 
plume expansion, dilution and entrainment/detrainment due to horizontal plume expansion, lateral 
diffusion,  gas-phase chemistry,  surface removal, and surface emission. 

The subscript i denotes plume cell i (left or right of the plume centerline), subscript j  denotes 
species j, and superscript t denotes a particular time.  Thus,  Cji is the concentration of species j  in 
cell i at time t,  and mji is mass of species j  in cell i at time t.  In the following derivation of the 
terms of the mass balance equation for any species j  in cell i,  the subscript j  is omitted for 
convenience; also,  the equations and terms do not show "L"  or "R"  representing a left or right 
plume cell,  since the equation and terms apply similarly to both sides.  Consequently, consider the 
mass balance of (left or right) cell i (for species j) corresponding to the its expansion during a 
small time interval dt. 

ami  =  (am;)Disp  +  (am;)Em1s  +  (am;)Chem  +  (am;)Dep 

(9-24) 

Now, the following expression is also applicable for the plume cell mass. 

a  = 
m; 

m1 

.' ... d'  -

m1 

.'  =  c.' ... drt'H'.,.d'w'.,.dr  - c.(J'H'W' 
i  P  P 

P 

P 

i 

(9-25) 

Herein the alongwind dimension in the downwind direction (l =  Udt) is prescribed, which is 
determined from the initial mean transport speed (U) over the time interval dt. 

Mathematical expressions are presented in subsequent sections for the updated concentration of 
species j  in cell i due to the action of the individual processes during time interval dt.  In the 
current version of PinG,  only surface emissions after plume touchdown are included in the 
emission term since (non-MEPSE) point-source emissions into grid cells (above the lowest cell 
layer) neighboring the MEPSE plume are released uniformly into the entire emission grid cell and 
impact the MEPSE plume only through the boundary conditions.  Surface removal is due to dry 
deposition at the ground.  Gas-phase chemistry is included with the full  chemical mechanisms of 
the CCTM in the chemistry term.  In the future,  the PinG will be adapted to employ the same 
aerosol module used by the CCTM.  No wet processes are treated in the initial PinG version.  The 
current approach to address limitations in the initial version of PinG is to transfer the plume over 
to the grid solution whenever conditions exist (e.g., precipitation) which the PinG treatment 
cannot adequately accommodate.  This issue will be addressed in more detail in the section on 
plume handover. 

9.3.2.3 

Treatment of Plume Expansion and Diffusion Processes 

Dispersion affects the mass balance of a plume cell as a result of dilution and 
entrainment/detrainment processes related to the lateral and vertical expansion of a plume cros~:-
section during a time interval dt,  as well as mass diffusion which impacts cell c9µc~.ntrat.ions as ...... ,~ 
result of concentration gradients between adjacent cells.  The dispersion processes can be 
expressed by 

(am)n1sp  = (am;)n111E1n  +  (am)Dif 

(9-26) 

;  " 

where the first term on the right side of Equation 9-26 represents the dilution I entrainment I 
detrainment processes and the last term is the eddy diffusion process. 

The relationships developed herein apply to cells on either side of the plume centerline, since the 
only difference occurs in their application when different boundary conditions occur at each edge. 

(ami)DilJEID  = (mtdt  - m/)Dil/EID 

(9-27) 

refers to the change of mass in plume cell i (for any transported species j) during dt as a result of 
dilution and entrainment/detr.~inment.  The changes due to just the horizontal ~d 'X~rtical 
exchange processes can be expressed by 

mrdt  = m/  +  (aml)Latdil/EID +  (am;)Vertdi/IEID 

(9-28) 

iii·' 
where Latdil refers to horizontal (lateral) dilution.  In  practice1 ~he lateral dilu!!.?~'"···· •.. 
entrainment/detrainment term in Equation 9-28 is determined and then the last term is solved. 

::::;:.,,,,.,i 

11, 

The lateral dilution term in Equation 9-28 is given by 

''II 

(am)ia1d111E1n=  1H;cc/+1aY;+1- c/ay) 

However, the following relationship also exists. 

ay1 = 11,awp 

9-14 

11111 

'

(9-29) 

·;1! 

""''',,111 

(9-30) 

since 11  is invariant.  Therefore, Equation 9-29 can be revised to the following form. 

(am)Latdi/IEID=  1H;(11i .. 1c/+1  - 11P/)aWP 

(9-31) 

At this time, (i.e.,  after lateral dilution/entrainment/detrainment) the width of a plume cell is wtd'. 
With the cell widths remaining unchanged,  plume vertical expansion occurs (i.e., in the up and 
down direction for an elevated plume, and up only after plum~ touchdown).  Let Ctdt and Cbt+dt 
denote the concentrations of species j  above and below plume cell i,  respectively, for the elevated 
plume case.  Ca  and Cb  represent the CCTM grid concentrations at t+dt.  Once the plume becomes 
surface-based, only Ca is relevant.  The equation for the vertical dilution term is given by 

(a  ) 
_mj  VertdiYEID=  wi 

I 

t+dt(C t+dtaH 

a 

l+dt 

a  +  Cb  aHb) 

(9-32) 

where the changes in Ha and Hb  denote plume vertical expansion of the upper and lower plume 
boundaries, respectively.  An assumption is made that 

aHa  = aHb  = 0.5aHP 

for an elevated plume cross-section, and after a plume reaches the surface 

aHa  = aHP 
aH  = 0 

b 

are applicable.  Equation 9-32 can be rewritten accordingly as 

(am ) 

_  I 

r+drC r+dr 

i  VertdiYEID- W i 

*  aH p 

where 

cr .. dr=  (C  +  C) 
chdr=  cr,.dr 

* 

a 

b 

* 

a 

(elevated plume) 
(surface-based plume) 

9-15 

(9-33) 

(9-34) 

(9-35) 

(9-36) 

for an elevated plume and a plume bottom at the surface, respectively.  The combination of 
Equations 9-3 1 and 9-3 5 produces the following form. 

,;11, 

(am  1)Di11E1D  = 1H;awp(TJ1..ici~1  - riP/)  +  zaHpw/ .. d'c! .. d' 

(9-37) 

However, by substituting the next expression, 

(a 

).. 

mi Dil/EID 

I 

= cl ... dl!H' ... dt 

p  wi 

1.-d1  - CllH'  t 
pW; 

i 

..  (9-38~ 
1j 

111l

.Ill!" 

,'1111, 

1111111 

and rearranging, the concent~ation after the total dilution/entrainment/detrainment step is. 

• 

H 1  aw 
cl,.dl=  c  1-11 __ ,_w.1.-dt  +  __ P ___ P_( 
11-dl 
H 
p 

w.1 
t.-dt 
H 
p 

t" p 

w. 

I 

I 

I 

t•dl  T}l.,.l 

c.I  -

/1"! 

.C.')  +  __ P_Ct .. dt 

aH 
(1"d( 
H 
p 

··· 
• 
······ 

T}, 

I 

(9-39)  : 

The first term on the right-side is related to the dilution effect and the ne~ two terms are the 

lateral and vertical entrainment/detrainment effects, respectively.  The subsequent expressions are 
also applicable. 

w/=  Y1~1  - y/  = W/TJ;.1  - TJ) 
< 
,,.d, 
w, 
'lli ... l  -
H 1•d1= H 1 +  aH 

TJ; ... 1  - T}i  = 

=  WP 

1 ... d1< 

) 

p 

p 

p 

,,i  WP  +  WP 
)( 
) 

a 

By substituting the above expressions into Equation 9-39, and rearranging gives 

c' .. d' 

i 

= C.1  (HPWP)' 
I  (H  W )1.-d1 

p 

p 

+  --C  + 

aHP 
H 1 ... ddt 
p 

l1"dt 
• 

H;  awp (TJ, ... 1C1~1  - TJP/) 
H1 ... d1  W 
p 

- TJ) 
I 

(TJ 

/Tl 

p 

ii:,,, 

(9-40) 

(9-41) 

However, Equation 9-41  can be simplified and re-written as 

'111111! 

9-16 

=  1 +~ ( (} .. HC~Tdt + 1 +\ ..  [(C/ + . )..: 

W 

111·t-l 

H 

EP A/600/R-99/030 

(11;..iC;~I  - 11;C/)]l 
11 1 

(9-42) 

c.fTdf 

I 

where 

aHP 
).H  =  H 

p 

awp 
)..  = - (cid:173)
w  w 

p 

(9-43) 

When applying Equation 9-42,  certain boundary conditions must be specified.  In particular, if 

i  =  I 
·  N 
l  = 
L 

' 

, 
·  N 
l  = 
R 

Tl;  =  111  =  0 

' 

c 

i·rl  = 

c'Tdt 

bg 

(9-44) 

where Cbgt+dt  and c.i+dt  are the particular grid cell concentrations from the CCTM solution for the 
current time step. 

In the execution of the CCTM/PinG, both the grid-cell and plume-cell concentrations are updated 
by numerical integration of the corresponding mass balance equations from time t to t+dt, where 
dt is the CCTM advection time step (MSTEP).  The sequence is that CCTM performs this 
integration and updates the concentration field  first,  generating ci+di in each grid cell,  before PinG 
is called to do the same.  PinG performs the integration in a fractional step approach; first for 
plume dispersion (step  I) then for the surface emission and removal processes (step 2), and finally 
for plume chemistry (step 3).  The chemistry integration is actually performed in smaller chemistry 
time steps, internally determined for the plume cells by the chemical solver, in sequence, until the 
integration is completed for the time interval dt.  The emission/removal step is implemented in a 
single integration time step.  The dispersion step is performed sequentially in subtime steps until dt 
is reached.  The PinG dispersion time step is constrained by a restriction when applying Equation 
9-42 arising from the fact that, in a given time step, the location after expansion of the inner 
interface of a given plume cell (i.e.  yrd1 cannot pass beyond the location of the outer interface of 
that cell at the start of the ex expansion.  Therefore, the following constraint applies. 

t+dt 

t 

Y; 

:5:  YiTI 

2:5:i:5:NL,R 

(9-45) 

This criterion requires that the following limit for the PinG time step must be satisfied. 

atdisp  ~  (TJ,..i  - Tl)  1 
A.~ 

Tl; 

A.•  -
w- -

1  dW. 
p 
WP -;ft 

It should also be noted that A.w*  is related to Aw according to 

.t..  . = rd'A. ,.,1 
111"°' 
w 

t 

(9-46) 

(9-47) 

(9-48) 

During the model simulation, WP (t) and dWP/dt are provided to the PinG module from the PDM 
data file.  Thus, Aw·  is determined directly,  and Aw can also be computed using the plume widths 
from time t and t+dt. 

The dispersion step is not complete without inclusion of the diffusion term.  The diffusion 
equation of a species concentration for any plume cell i may be expressed by 

aci 
at 

ac, 
= -(K-) 
y  ay 

a 
ay 

where Ky  is the horizontal eddy diffusion coefficient.  It can be expressed by 

K  = _!_~(a2) 
y 
y 

2 dt 

(9-49) 

(9-50) 

By applying the relationship between ay  and WP  in Equation 9-1, the following form for Ky can 
be derived. 

K  = 
y 

w2 
P  ~ • 
--11. 
a2  w 

(9-51) 


Numerical integration of a form like Equation 9-49 is solved with the Crank-Nicholson method in 
which centered differencing is used for both time and space derivatives to solve the diffusion 
equation.  This technique provided stable numerical solutions compared to an explicit method. 
The resulting finite-difference equation is then solved by matrix decomposition of the coefficient(cid:173)
matrix into upper and lower (LU) triangular matrices.  For convenience in setting up the matrix 
form of the finite difference diffusion equation for all  plume cross-section cells, a set of 
simultaneous equations is developed which are written in a vector-matrix form for solving by LU 
decomposition. 

The derivation of the set of equations is provided.  By averaging Equation 9-49 in time to obtain 
ac/at at t+at,  and using center-differencing to solve for a2C/ay2

,  simplification leads to 

k-t-1 

Ci_i[-

Kyat 

(yi+1- y)(yi+I - Y,-1) 

+  c.k ... 1[ 

1+1 

Kat 

y 

) 
(yi+l- yi)(y/+2- Y; 

1  =  c.k 

1-I (y 

i+I- y)(yi+I- Y;-1) 

1 

k-t-1 

]  +Ci  [I+---"-----
(yi+I - y)(yi-t·2- Y;)] 

+ 

Kyat 

] 
(y/+I - yi)(yi+l - Yi-I) 

Kit 

Kat 

y 

+  C/[1  -

K& 

Y 

-

(yi+I - y;)(yi.,.2- Y) 

K& 

Y 

K& 

]  +  C;~1 [ 

] 
CY; ... 1 - Yi)(y;+2- Y) 

Y 

Yi+l - Y;)(y; ... 1- Y;-1) 

where small k is used as a time index for time t,  and k+ 1 represents t+at, i is the index to the left 
edge of plume cell i,  and y is the distance from the new reference position at the left 
background location of the plume cross-section.  By using the relationship that yi= TJiWp,  the 
following relations can be defined. 

(9-52) 

a.=  Kyat _______  _ 

w;  (TJ;d - TJ)(TJ/+l - 'Tl;-!) 

I 

Kat 

w;  CTJ; ... 1- TJ;)(TJ; ... 2- TJ;) 
Yi  =  - - - - - - -

(9-53) 

(9-54) 

P;  = <X;  +  Y; 

(9-55) 

By substituting the above expressions into Equation 9-52, the following formuJa is . .obtained. 

k+ I 

-a.Pi-I  +  (1 +P;)C; 

k+ I 

- yp, .. I  = a.pi-I  +  (1-P;)C,  +  YPi+l 

k-r I 

k 

k 

. 

k 

Equation 9-56 represents a system of simultaneous equations in the form, 

Ax=  b 

' 

(9-56) 

':1111 

(9-57) 

where, x =  (Cik+t  +  ····~+/+ 1  )'and N is the total number of plume cells.  Additionally, the 
expression, A =  I - G,  is defined where A is a square matrix of size (N+ I )x(N+2), a,nd b = 
(I+G)Ck.  In these expressions, I is the identity matrix, and G is a tridiagonal matrix of the form, 
G =  tridiag (a,  p,  y), and is of size (N+2)x(N+2).  Subsequently, the simultaneous system of 
equations given by Equation 9-57 is solved using LU decomposition. 

The boundary conditions are also included in the above system of equations since N+2 is used. 
Appropriate boundary conditions are provided by the CCTM grid concentrations for the right and 
left edges of each plume cross-section.  At left edge boundary,  al= P1 =  y l  and b1  = cl= c~L· '' 
At the right edge boundary,  a.N+2 ,  PN+2,  and  YN+2  are zero which leads to bn+i =  ~+2 =  ~t 

9.3.2.4 

Surface Area Emissions and Dry Deposition 

During the PinG simulation,  surface emissions are injected into individual surface-based plume 
cells.  The surface emissions, contained in layer I  values of the 3-D emissions file which is also 
employed by the CCTM, are used in  all plume cells of a plume cross-section.  For each grid cell, 
there is an emission rate for certain species ( qj).  In particular, a lVIEPSE plume cross-section 
passes over such gridded surface emissions.  Consequently, the change in concentration of plume 
cell i during a time step from surface emissions is· 

a1 
J_k  __ }  --
aci  - 1 t:ix!:iy HP 

q 

(9-58) 

where ~ herein is an appropriate species-specific factor for the conversion of concentration from a 
mass unit to the appropriate volume unit. 

Since the PinG formulation is composed of a single vertical layer,  it was not designed to  have the 
capability to properly ingest other elevated point-source emissions into the MEPSE plume cross(cid:173)
section.  As long as such an along-path, point-source emission remain at a relatively low value, 
the impact on the MEPSE concentration field  is assumed to be felt through background 
entrainment of the expanding MEPSE plume.  If the other point source emission was ingested,  of 
course, such entrained mass is currently dispersed instantaneously throughout the vertical extent 
of the plume.  For this reason, when point-source emissions larger than a critical value are 
encountered by the MEPSE plume, the current logic is to handover the MEPSE plume to the grid 
solution. 

Dry deposition is a sink term and occurs at the bottom of each plume cell based on the deposition 
velocity concept. 

acj I 
a1 

- - vj c/ 
-

H 
p 

(9-59) 

where Ct denotes the concentration of species j  and the species-specific deposition velocity (Vdj) 
values are available from a gridded data file.  The same deposition velocity is applied to all  cells of 
a plume section using the Vd values from the grid cell in which the plume centerline is located. 

9.3.2.5 

Gas-phase Chemistry of Plumes 

A gas-phase chemistry mechanism implemented in the CCTM is also invoked by the PinG module. 
The current mechanisms include the RADM2 and carbon bond (CB-4) chemical mechanisms. 
Details about these chemical mechanisms are provided in section 8.  In addition, there is a 
separate PinG module version for each chemical solver (i.e.,  SMVGEAR and QSSA).  Minor 
revisions were needed in the PinG versions of the solver codes to customize them to deal with the 
plume concentration array whose dimensionality differs from the CCTM gridded concentration 
array.  Nevertheless, the PinG gas photochemistry treatment is identical to that of the CCTM. 
Since only gas-phase plume chemistry has currently been implemented, when conditions 
conducive to extensive aqueous chemistry are encountered, a plume section is transferred to the 
CCTM grid system, as discussed in the handover section below.  Future plans include 
implementation of the existing CCTM aerosol module into PinG so that it also has the capability 
to treat aerosol and  particulate species. 

9.3.2.6 

Plume Initialization 

The initialization of each plume cross-section is the first key procedure performed at the start of 
its simulation.  The PinG initialization of a new MEPSE release occurs when a plume cross(cid:173)
section width reaches a minimum width.  The width criterion is a user-specified variable and it is 
specified for the PDM simulation.  A flag indicator variable in the PDM file communicates to 
PinG when a plume cross-section is ready to be initialized.  The current minimum width for 
initialization of a MEPSE plume section has tentativelybeen set at.2 km.  At initial~ation, it is 
assumed that the lateral concentration distribution across the plume section of the primaiy 
emission species exhibits a Gaussian shape.  For all other species, initial concentrations have been 
set to a machine minimum-value (ie.  1 o-30

· ·•,!I,\ 

). 

The lateral concentration distribution of the primary species in the plume cells (i.e.,''11initial 
condition"  of the plume concentration field)  is given by 

Cy(O)  = "J.-1---exp[ -0.5(yi la )2] 

1 

q. 
UHP  2na.Y  . 

• 
. 

Y. 

... 

I 
., 

(9-60) 

., 

'" 

·l,,,,111111 

where, y•  is (Yi - y0 ), the distance of the outer edge of cell i from the plume centerline, 
and U is the mean transport speed, qj is the MEPSE emission rate of species j, and  ·· 
kj  is the appropriate species specific mass-to-volume conversion factoL 

"I 

11i\' 

:11111 

i 

11 

In PinG,  it is assumed that the MEPSE emissions are at an hourly resolution,  and that we are 
performing plume simulations of hourly releases.  The assumption is made that the emission rate 
(q.;)  remains constant over the hour.  Consequently, at the handover time, the transformed mass 
impacted by the various plume dynamic and chemical processes corresponding to one hour of 
emission is released to the grid solution. 

9.3.2.7 

Methodolog)'.,,,. for Plume Feedback to the Eulerian Grid 

When the subgrid scale phase of a plume section simulation has been completed, the plume 
material is ready for transfer to the CCTM grid.  The total concentration of each species in any' 
plume cell is composed of a component equal to the background concentration, and an additional 
component consisting of the plume concentration, which differs from the background grid level. 
In performing the handover,  the conceptual basis is that only the plume component is related to 
the corresponding MEPSE emissions.  Thus, the feedback is restricted to the plume contributio"n. 
Additionally,  since hourly plume releases are simulated from each MEPSE source in PinG, and 
since the assumption has been made that each such hourly emission remains constant for the full 
hour, the current practice is to handover the contents of a plume section corresponding to a ful! 
hour release.  Thus, for each plume species, 

m  =V(C-C) 

p 

p 

bg 

p 

(9-61) 

where average values for the plume and background grid concentrations are employed.  The 
average plume concentration (CP  ) of each species is determined from all plum~ c~Us.  The 
background grid value (Cbg) represents the average of the CCTM grid-cell concentrations on 
each side of the plume for all appropriate layers over the vertical extent of the plume.  The 
handover plume mass is distributed into the column of cells up to I\ in which the plume centerline 
is ,ocated at the handover time.  The feedback of plume mass represents an adjustment to the 
CCTM grid cell concentrations from an average concentration (Cadj).  From a mass balance 
perspective, 

EP A/600/R-99/030 

C 0 d1V0  = (CP  - Cbg)VP 

where VG is the CCTM grid cell volume.  The plume volume (VP) is determined from 

VP  = WPH/UAt) 

(9-62) 

(9-63) 

where U is the mean horizontal wind  speed, At is a  I-hour interval and UAt corresponds to the 
alongwind dimension (A~) spanned by the plume section.  In a similar fashion,  the grid volume 
impacted by the plume is given by 

V0  = Ax0 Ay 0(Z~  - Z~) 

(9-64) 

where AXcr and AyG are the horizontal grid cell sizes, and ZG1  and Z Gb  are the heights of the top 
and bottom of the model layers spanned by the plume. 

Substituting the above expression into Equation 9-62 yields: 

C-(-C  _HWAx 
p 

·  -C)PP 
p 
G 

adJ-

bg 

17 

(9-65) 

In the initial release version of PinG when plume handover is triggered, an entire hour's worth of 
plume release in its transformed state is transferred to the appropriate column of grid cells during 
a CCTM advection time step.  In the future,  the intention is to incrementally  transfer the same 
plume excess to the impacted grid cells over a one hour period of model time steps.  In this 
manner, the continuous emissions after being treated in PinG would be transferred during a one 
hour period following the handover time. 

PinG simulations are primarily intended for the coarse-grid, regional modeling grid sizes with the 
horizontal resolution (A) of nominally 20-40 km.  Daytime l\ffiPSE plumes reach or are close to 
chemical maturity when the plume width attains these grid sizes.  However, PinG simulations at 
finer grid sizes are possible, however, test runs have not been performed but are needed in order 
to assess the benefits of this approach at urban grid cell sizes.  As the primary purpose of PinG Is 
to improve the subgrid-scale treatment of large point-source plumes, the key handover size ... 
criterion based on plume width relative to grid cell size has been prescribed according to 

w -2  ;::>; 
/::,,. 

Yer 

(9-66) 

The default value for y er is  1. 0.  Therefore, when a plume section width attains the grid cell size, a 
flag indicator variable generated by PDM triggers PinG to perform the handover process. 
Currently, the CCTM system is  operated in a  I-way nesting mode, as multiple nested grids ar~ .. ..not 
performed in a single simulation.  Consequently,  PinG is not equipped to handle ~J:ie movemen~ of 
a plume from a larger to a finer gridded domain within the same simulation. 

11::,.1' 

I 

• 

" 

'I~ 

Ideally,  plume handover also occurs when the plume has also reached chemical maturation when 
concentration differences within the plume become rather small.  A chemical criterion also 
incorporated into PinG involves a default condition recognizing chemical maturation.  It is based 
on an average plume concentration ratio of 0 3 /0x ,where Ox= 0 3+N02  denotes the principal 
oxidant species using concentrations from all cells in a plume section.  This ratio is employed as a 
surrogate indicator of plume chemical age.  The specific chemical maturation criterion is: 

• • •  ,,,,,,,... 

·••··· 

llW 

·,, 

. 

1:,,, 

03 
-==  ;::.;  r 
Q 

chem 

x 

(9-67) 

where rchcm  represents the critical value.  The default value has been set at 0.99.  Tests have 
indicated this value to be a good indicator corresponding to a chemically-mature stage 3 plume. 

The use of 0 3  I Ox  as a surrogate for plume age is not common compared to NOx I NOY  where 
NOY  includes all the reactive oxides of nitrogen.  However, NOjNOy has not been applied as a 
chemical criterion because injection of fresh emissions from large point sources has been observed 
to suddenly decrease the chemical age of the background which leads to "premature" activation of 
the chemical criterion.  Experience from testing with the first chemical criterion has proved it tp 
be more satisfactory. 

·· 

In the initial version of the Models-3  PinG, additional criteria are needed which can also trigger 
plume handover to the Eulerian grid cells.  As the PinG module is upgraded in the future,  the 
these criteria may be avoided. 

111111 

1111111111 

The next two criteria are related to non-l\.1EPSE emissions in the immediate vicinity of a l\.1EPSE 
plume cross-section. 

Urban Criterion 

PinG currently does not have the facility to injest different surface emissions into individual plume 
cells.  Such a condition is likely to be encountered by a l\.1EPSE plume after touch-down when it 
passes over an urban-industrial area with a very inhomogeneous spatial distribution of emissions. 
Gillani and Pleim (1996) have identified such "urban" areas based on the following criterion 
pertaining to the emissions of NOx. 

fq  (NOx)  >-10 12  molecules/cm 2/s 

(9-68) 

This condition denotes a fairly high NOx  surface emission flux  (fq ).  The critical value of 1012 
chosen by Gillani and Pleim (1996) was based on an emission inventory with a horizontal spatial 
resolution of about 20 km.  For such a grid size,  this condition corresponds to an emission rate of 
about 0.3  kg/s.  Thus, the selected "urban" emissions handover criterion is: 

qNOx  2:  0.3  kg/s 

(9-69) 

The above condition must be satisfied to trigger plume section handover, and the plume bottom 
must also be at the ground for this criterion to activate. 

Point-source Emissions Criterion 

The initial PinG version does not possess multiple vertical layer resolution of the plume.  Thus, if 
a plume section entrains the elevated concentration of a primary species in a background grid cell 
from a fresh NOx  emission from a non-l\.1EPSE major point source, such entrained mass is 
instantaneously mixed vertically throughout the l\.1EPSE plume.  If the non-l\.1EPSE point source 
emission is large enough, the related error of its treatment in the l\.1EPSE plume relative to its 
treatment in the gridded solution becomes large.  Thus, it is advantageous to handover  the 
l\.1EPSE plume under this circumstance.  A handover criterion of 3.33 x  10-6  ppm/s has been set 
which corresponds to about 2 ppb/I 0 minutes.  If the new non-MEPSE point-source emissions in 
the immediate vicinity of the l\.1EPSE plume are large enough to raise the average background 
concentration (left/right and vertically-averaged over MEPSE plume height) by more than 2 ppb 
in  I 0 minutes, then handover is also triggered. 

Precipitation Criterion 

PinG has no facility to handle wet removal of the plume.  Consequently, if the total(convective 
and non-convective) precipitation rate in the cell containing the !\.1EPSE centroid exceeds a 
critical value, a plume handover is also triggered.  Currently, the default value of this critical 
precipitation rate is 0.00008 cm/s or about 0.3  cm/hr. 

Excessive Wind-Shear Criterion 

Since the plume treatment is PinG is based on a Lagrangian simulation for a single vertical layer, 
there is no facility to properly treat the effect of wind shear.  When excessive speed wind shear 
over the vertical extent of the plume exceeds a critical value, plume section handover will occur: 
on the basis that the treatment of such wind shear will be better treated in the multi-layer grid 
model. 

' I  

Domain Boundary Criterion 

Finally, a MEPSE plume section is transferred to grid cell in which the. centroid of the MEPSE'is 
located if it is about to exit the gridded domain.  Otherwise the plume conce~tration co~tribution 
cannot be accounted for ifthe plume travels beyond the model domain boundary. 

In all handover cases considered above, the entire MEPSE plume section is transferred.  There is 
a particular condition in which only a top portion of the plume may be handed ov~r1 while the  ,
remaining part of the plume continues to be simulated.  This type of premature partial handover is 
forced because PinG does not possess adequate vertical resolution, and also because the plume 
simulation in PinG is based on a Lagrangian approach.  This condition arises when the plume is 
well-mixed throughout the daytime PBL, and the PBL height decreases significantly along the 
path of the plume, for whatever reason.  In reality,  in such a case, the plume would be split 
between an upper portion above the PBL and a lower  portion remaining within the PBL.  The 
two portions could then experience very diverse stability and flow conditions which cannot be 
accommodated in the current version of PinG. 

;, 

1

The approach is that once the PBL height begins to decrease,  and it decreases by more than  15% 
of the previous Zj, the plume section is handed over.  However, the lower portion continues to be 
simulated.  If the decrease in zi is temporary and  it later begins to incre!lse again, the remaining 
simulated plume would expand vertically just as if it was the full plume.  When Zj  continues to 
decrease, as during the evening transition period, then the partial handover would continue 
incrementally as the PBL decreases by each  15% segment until the nocturnal mixing height is 
reached, at which time the remaining plume is also handed over.  In this manner, l!!nG, does n~,~ 
continue to simulate the well-mixed daytime plume into the night.  This approach avoids the 
Lagrangian simulation of the deep night-time plume which frequently experiences substantial wj9d 
shear conditions related to nocturnal jets and inertial oscillations. 

The situation is different for a fresh "MEPSE release into the nocturnal stable layer above the 
shallow mixing layer.  Such a plume is likely to be thin in the vertical and,  therefore, not very 
likely  experience excessive shearing conditions.  In our Lagrangian approach, therefore, PinG will 
generally simulate fresh nighttime plume sections which do  not experience excessive shear 
because of their limited vertical extent. 

9.3.2.8 

Test Application of the Plume-in-Grid Modeling Approach 

The schematic diagram in Figure 9-8 shows how the PDM and PinG fit into the overall 
Models-3  CMAQ system of science programs.  Since PDM serves as a processor program, it is 
exercised in advance of the CCTM/PinG simulation.  PDM requires the MEPSE stack parameter 
file generated by the MEPPS emissions system,  and a set of meteorological data files prepared by 
MCIP from an l\llM5  simulation.  The details of these input files which are needed to perform a 
PDM simulation are described in the Models-3  user guide (EPA,  1998). 
parameters for the PDM processor are also defined in the user guide. 

Input and output 

The PinG module is an integral part of the CCTM, as depicted in Figure 9-8,  and it is invoked by 
the CCTM driver program along with the other science processes.  In the sequence of processes, 
PinG is called just before the grid model performs the gas-chemistry step.  Consequently, when 
PinG completes a time step, the CCTM driver calls the chemistry to undertake gas(cid:173)
photochemistry on the 3-D gridded array.  When PinG is being exercised, it needs data files 
generated by ECIP, MCIP, PDM and also the MEPSE emission file from l\1EPPS processing. 
The PinG module also generates a plume concentration file containing the species concentrations 
in each plume cell for each plume cross-section.  Since the PinG concentration file is a Models-3 
specific format,  it can be viewed in a visualization software package designed for such data files. 
In addition,  an effort is  planned to visualize both the plume and grid concentrations on the same 
display. 

The plume-in-grid algorithms were exercised for a single JV1EPSE within a 36 km gridded domain. 
The plume cell 0 3  concentrations in  Figure 9-9 are for various times from a selected plume 
section released during the early afternoon.  The PinG module simulated  10 plume cells in this 
plume section, with the concentrations on each edge of the cross-section at various times being 
the CCTM gridded values used as background conditions.  It is evident that the modeled 0 3 
concentrations displays the same chemical stages described earlier.  A significant ozone deficit 
exists in the narrow plume for  1-2 hours after release.  As the plume expanded, the 0 3 
concentration gradually recovers and  exhibits higher 0 3  in some cells outside the plume core of 
the cross-section at  15:30 than the grid value at each edge or in the plume core.  This represents 
stage 2 of plume chemical evolution.  Eventually,  stage 3 was attained as all  plume cell 0 3 
concentrations exceeded the CCTM concentrations on each side of the plume with the maximum 
excess of about  I 0 ppb in this case.  Shortly after  1730 LST,  the last time displayed in Figure 9-9 
for this plume section, it was transferred to the CCTM grid system.  Therefore, this plume section 
was active in the subgrid phase about 5 hours in this case.  Once the feedbeack of a plume section 
occurs, PinG no longer simulates it which reduces computational time. 

The results of this test case and others not described herein are encouraging since they compare 
rather favorably in a qualitative sense with observed concentrations (not shown) aci:oss the sam~. 
"MEPSE plume at about the same time.  Nevertheless, an extensive evaluation of the PinG is 
planned for several case study days with plume data for various species obtained during the 
Southern Oxidant Study 1995 experimental intensive program c:qnduc:ted in the Nashville, 
Tennessee area.  The evaluation will assess the capability of the PinG components to treat 
pollutant plumes and determine the impacts on the regional grid concentrations. 

"'""' 

""""'" 

' 

'!I: 

9.4 

Summary 

,,, 

111111 

A plume-in-grid technique has been developed for use in the Models-3  Community Multiscale Air 
Quality modeling system.  The key algorithms include a plume dynamics Model (PDM) processor 
designed to generate a data file for use in the PinG module simulation.  The PinG module has 
been fully integrated into the CCTM Eulerian grid model to provide a more refined, reali.stic 
treatment of the physical and chemical processes impacting selected major point source emissions 
during a subgrid scale plume phase in a regional model applicatipI1.  The ini.~~~,,,,,rel~,~e version i.~ 
limited to performing gas-phase photochemistry within the plumes.  A future PinG version is 
expected to include an aerosol and particulate modeling capability.  Test simulation results have 
been conducted and qualitative results are encouraging regarding the treatment of plume growth 
and plume concentrations.  However, a rigorous diagnostic evaluation of the various processes is 
planned using the 1995  Southern Oxidant Study-Nashville experimental plume dattj:,  Future 
. 
advancements and refinements of the initial  plume-in-grid algorithms are anticipated and upgraded 
algorithms will be reflected in upcoming releases. 

9.5 

References 

Arya, P.,  1984:  Parametric relations for the atmospheric boundary layer.  Boundary-Layer 
Meteorol.,30, 57-73. 

Briggs, G.A.,  1975: Plume rise predictions.  In:  Lectures on Air Pollution and Environmental 
Impact Analyses, Workshop Proceeding, Boston, MA,  1975, pp  59-111. 

Chang, J.S., K.H.  Chang, and S.  Jin,  1993:  Two-way and one-way nested SARMAP air 
quality model.  International Conf.  on Regional Photochemical Measurement &  Modeling 
Studies, November 8-12,  San Diego, CA,  A&\VMA, Pittsburgh, PA. 

''' 

·· 

Clarke, J.F., J.  Ching, J.M.  Godowitch,  1983: Lagrangian and eulerian time scales 
relationships and plume dipsersion from the Tennessee Plume Study.  Sixth Symp.  on 
Turbulence and Diffusion, March 22-25,  1983, Amer.  Meteorol.  Soc., Boston, MA. 

Draxler, RR,  1976: Determination of atmospheric diffusion parameters. Atmos. Environ.,  10, 
99-105. 

EPA,  1998: Models-3  Volume 9b:  User Manual, EPA-600/R-98/069b, U.S.  Environmental 
Protection Agency, Research Triangle Park, NC 277 I I. 

Gillani?  N.V. and W.E. Wilson,  1980: Formation and  transport of ozone and aerosols in 
power plant plumes.  Ann.  N. Y.  Acad.  Sci., 338, 276-296. 

Gillani,  N. V.,  S.  Kohli,  and W.E. Wilson,  1981:  Gas-to-particle conversion of sulfur in 
power plant plumes:  I: Parameterization of the conversion rate for moderately polluted 
ambient conditions.  Atmos.  Environ.,  15,  2293-2313. 

Gillani, N.V.  and J.  E.  Pleim,  1996:  Sub grid scale features of anthropogenic emissions of 
NOx and VOC in the context of regional eulerian models.  Atmos. Environ., 30, 2043-
2059. 

Gillani,  N.V.,  1986:  Ozone Formation in pollutant plumes:  A reactive plume model with 
arbitrary crosswind resolution.  U.S.  Environmental Protection Agency, EPA-600/3-86-051, 
Research Triangle Park, NC,  85  pp. 

Gillani,  N. V.,  1996:  Personal communication. 

Godowitch, J.M.,  J.  Ching,  and  N.V.  Gillani,  1995: A treatment for Lagrangian transport and 
diffusion of subgrid scale plumes in  an eulerian grid framework.  Eleventh Symp.  on 
Boundary Layers &  Turb., March 27-31, Charlotte, NC,  Amer. Meteorol.  Soc., Boston, 
MA, 86-89. 

Hanna,  S.R., G.A.  Briggs, and RP. Hasker,  1982:  Handbook on atmospheric diffusion,  U.S. 
DOE, DOE/TIC-11223, DE82002045, National Technical Info.  Center, Springfield, VA. 

Hanna,  S.R.,  1984: Applications in air pollution modeling,  Chap.  7,  Atmos.  Turb.  &  Air Poll. 
Modeling, Ed. F.T.M. Nieuwstadt and H.  van Dop, D.  Reidel Publishing Co., Kluwer 
Academic Publishers, Hingham, MA. 

Hicks, B.B.,  1985: Behavior of turbulence statistics in  the convective boundary layer.  J.  of 
Clim.  and Applied Meteorology.  24,  607-614. 

Irwin, J.S.,  1979:  Scheme for estimating dispersion parameters as a function of release height, 
EPA-600/4-79-062, Research Triangle Park, NC.,  56  pp. 

Irwin, J.S.,  1983: Estimating plume dispersion - a comparison of several sigma schemes.  1. 
Clim.  And Appl.  Meteorol., 22,  92-114. 

Kumar, N. and A.G. Russell,  1996: Development of a computationally efficient, reactive sub(cid:173)
grid scale plume model and the impact in the northeastern United State using increasing 
levels of chemical detail.  J.  ofGeophys. Res.,  101,  16737-16744. 
· 

Mathur, R., L.K. Peters, and R.D.  Saylor,  1992:  Sub-grid presentation ()f emission source 
clusters in regio~a~ air quality modeling. Atmos. Environ., 26A, 3219-3238. 

,,,,,,,, ..  , 

,,, 

I 

• :1111::" 

Morris, R.E. M.A. Yocke, T.C. Myers,  and V. Mirabella,  1992: Overview ofthevariable-grid  ., .... , 
Urban Airshed Mqd~l (UAM-V) 85th Annual Meeting of the .A&WMA,  June 21-26~ '11 
1992, Kansas City, MO., AWMA, Pittsburgh, PA 

1111111111 

"'

· 

'' 

' 

" 

•1:: 

"' 

,1,l,11 

'II 

,',Ill, 

Myer, T.C., P.D.  Guthrie and  S.Y. Wu,  1996: The implementation of a plume-in-grid module 
in the SARMAP air quality model (SAQM).  SYSAPP-96-06, Systems Appljc,~~o~ 
International, Inc.,  Available from Technical Support Div., California Air Resources 
Board, Sacramento CA. 

, 

I'" 

,11111,,,,"' 

Niewstadt, F.T.M.,  1984:  Some aspects of the turbulent stable boundary layer.  Boundary(cid:173)
Layer Meteorol., 30, 31-55 . 

1111: 

,

Odman, M.  T.  and A.G. Russell,  1991: Multiscale modeling of pollutant transp9rt!;!Jld ,,,, 
chemistry.  J.  ofGeophys. Res.,  96, D4, 7363-7370. 

,,,,,,11 

111111111111;  ... , 

Pasquill, F.,  1976: Atmospheric dispersion parameters in Gaussian plum modeling: Part IT. 
Possible requirements for change in the Turner workbook values.  EP A.-600/4:.76-030b, 
EPA, Research Triangle Park, NC, 53  pp. 

us 

'Ill 

Pasquill, F.,  1979: Atmospheric dispersion modeling.  J.  of the Air Pon:  Contrl. Assoc., 29, 
117-119. 

' I   Ill 

Seigneur, C., T.W. Tesche, P.M.  Roth, and M.K. Liu,  1983: On the treatment of point source 
emissions in urban air quality.  Atmos. Environ.,  17(9),  1655-1676. 

11111 

11 

Turner, D.B., T.  Chico and J.A.  Catalano,  1986: TUPOS - a multiple source gaussian 
dispersion algorithm using on-site turbulence data. U.S. Environmental Protection 
Agency, EPA/600/8-86-010, National Technical Information Center, Springfield, VA. 

Venkatram, A., D.  Strimaitis, D.  Cicristofaro,  1984: A semiempirjciµ  mqdel tQ  est!mate 
dispersion of evelated releases in the stable boundary layer.  Atmos.  Environ.,  18,  923-
928. 

Venkatram, A.  1988: Dispersion in the stable boundary layer.  Chapter 5,  In Lectures on Air 
Pollution Modeling, A  Venkatram abd J.  Wyngaard, Eds., Amer. Meteorol.  Soc., Boston, 
MA.,  1988. 

Weil, J.C.,  1988: Dispersion in the convective boundary layer. Chapter 4, In Lectures on Air 
Pollution Modeling, A  Venkatram and J.  Wyngaard, Eds., Amer. Meteorol.  Soc., Boston, 
MA.,  1988. 

This chapter is  taken from Science Algorithms oftlte EPA Models-3 Community 
Multiscale Air Quality (CMAQ) Modeling System, edited by D. W. Byun and J. K. S. 
Ching, 1999. 

Locations  of  MEPSE  Sources 

,111 

1.000 

79  .-~--.--r-------r-------,;,r-::~---, 

y=grid _mepse _36kmjul7 foapi 

0.000 

NUM 
fAYE 
by 

MCNC 

1 

1 

~~ 

<\  ",, 

85 

July 7,1995 0:00:00 

Min=0.000 at (1,11 Max:3.DOO at (48,45) 

Figure 9-1  Location of MEPSEs depicted in individual grid cells. 

stagef 

Ozone 

stage 2 

10(?°' 
ppb 

Su~ate 
201 
ppb t  ./ .. _...  Stage3  •· ... ,'.·! l  10x1 o"'' 

./ .. .'\ ·····.-.. 
'. 

..  Bscat 
::1  rri 1 

.... 

Bscat /""""'"~ 
.//" .,.,. . .,·--. 
---·--

SU/fat~· ...... 

/ 

'-': 

~~~ ~  /·~ 
/'-.Ozone 
,,;-,;'/".~~\~ 
:--·  " ....... 
. 
.... 
'· 
,Cr  ~ 

~,·"' 

1224 

o~ 

11 :31 

'---

11 :38 

o~ 

12:31 

15:57 

16:06 

nrne 

Figure 9-2.  Chemical stages of a plume are depicted by aircraft plume data of S02, ozone, 
sulfate,  and aerosol scattering coefficient (Bscat) from crosswind traverses through a large 

PSE plume. Measurements are from the daytime period of the 23  August  I 978 Tennessee 

lume Study experiment. (Adapted from_ Gillani et al,  1981) 

I (a) 

l 111"1!!-hegf~ V.fNI I 

~~tr-OJJ!f ll!l~1: 

J (b)  Top viewJ 

Plume  handover 

rr1(t wo) 

n,p 

Figure 9-3.  Schematics of the a) time-height view and b) top view of the modeling concept of the 
subgrid scale plume in the Models-3 PinG approach. 


.Zp 

••• 
• 
• 
• 
• 
• 
• 

1600 

1400 J 

1200 

~ 
1000 I 

-
'E' 
.... 
::c 
(!$ 
!! 
II.I 
:t 
:::> 
..... 
Q. 

~ 
i= 
0 
II.I 
LI. 
LL w 
..... 
;l 
i! 

600 

400 

200 

0 

900~  i!I  • •  

•• 

'  . 
.. 

• • 

i!I 

4 

6 

·I 
9 

I 

I 

I 
10 

I 

I 
12 

I 
14 

16 

19 

20 

22 

24 

RELEASE  TIME  (GMT) 

Figure 9-4.  Example of the final  plume he.ight after plume rise for hourly releases from a MEPSE 
300 m stack height. 


:uoo 

2200 

2000 

1900 

1600 

'E' - 1400 

~  1200 
CJ 
iii 
::c: 

1000 

900 

600 

400 

200 

0 

r 
0 

•  hT 
+hb 
+z1 

+-ff---T--'f'\ ----· 

j/ 

,, 

1: 

~ 

\ 
\ 

............... 
I 
u 

I 
19 

I 
1.6 

I 

I 

I 

20 

I 
/ 
·-·-·-·-----~/ 

~-·-·_.,..... /+ 

/+-+--... 

_.__.-r 

/+ 

2 

4 

6 

9 

10 

12 

TIME  (LST) 

Figure 9-5.  Time variation of the plume bottom (hb) and top (hT) heights and the PBL height 

(Zi) for a nocturnal release. 


•Wp 

_,.,..... 

/ I I 

./ 

./ 

./ 

./ 

/ 

/ 
.,,,.,,,·-·-·_.,.,.·-· 

.............. ......-· 

2 

4 

6 

B 

10 

12 

14 

16 

18 

20 

TIME  (l.ST) 

150000 

140000 

130000 

120000 

110000 

90000 

80000 

s 100000 
i!: 
0 
j 
UJ :e 
::::> 
-' Q. 

70000 

60000 

50000 

40000 

30000 

20000 

10000 

0 

I 
0 

Figure 9-6.  Time variation of plume width (Wp) from  a nocturnal plume release.  A plume width 
of about 30 km is achieved during the morning period about  10 hours after release. 

_);:::(cid:173)
\'"'-

I______ 

~ 
•j-••t '"'"'j-•"' 

j  .......... ., 

I 

--~-;----~----~ 
; 

Plume j L 
r- at (t +dt)  b 

cross-section 

I 
~ attimet 

u 
T 

D 

~Entrainment  N 
· 

from.skies 

~·-- -~·--: 

~ I 

' 

~ 

' ' ' ' 
' ~~,.. 

' 

.... ~?> 
Dilfusi:>n 
I[  I ~ 

igure 9-7. An illustration of the PinG module formulation depicting the relevant processes; 
a) time-height view and b) cross-sectional view. 

Emissions 

(:· .. ;li~~i,., 

::·,;  g¢1£i.O:'-
:fi~~~f)/:: ~:~~):~ti~~iif~ 

i: .. i.l ... 11~1i.l1;;: 

MQ~rolor;y 

I 

I 

::  ,.,,,,,,,.·f:;:;t:: 

PDM 

Plume Dynamics 

igure 9-8.  Flow diagram of the PDM processor and PinG module with.associated programs in 
e Models-3  CMAQ system. 


~ 
~~ 
°' 0 
~ 
'° 
~ (,,) 

0 

-

--

PinG  MODEL RESULTS  FOR  OPP  MEPSE 

NASl-MLI.E DOMAIN  (DAY =1995188) 

- - - -

70 

60 

13' 
g 50 
z 
0  40 
F: 
~  30 
I~  20 

0 
0 

10 

\0 
I 
.j::.. 
0 

I 

--------·------------------.... 

--

.._........_ 
_,..a------n...___ 
..... ..&----...., 

Ji' 

-----

~  ~-.-... 

~  ----

--,,. 

.... --.. -

--

__.--· 

.,,.,..~ .. -

,,.,., ....... ~ 
l!. 

.-·&----~ 
.. _ 
<>~....... 

~ 

-

-

..& .... -

~--- __ .,,,, .. -.. ' 
~-1 

\ --~/fl 

\  ~ 

/ 

<!"f 
I 

0  I  I 
-20 

I 

I 

I  I  I 
-15 

I 

I 

I 

I 

I  I  I 
-10 

I  I  I 
-5 

I 

I 

I  I  I 
0 

I 

I 

I  I  I 

I 

I 

5 

I  I  I 
10 

I 

I 

I  I  I 
15 

I 

I 

I  I 
20 

DISTANCE ACROSS  PLUME  (l<M) 

ooo OZONE  IN  Pt.J.M:  14 FROM  CIM_PING  C84 

14 

Fl.E•BNA-

'Figure 9-9 Plume ozone concentrations in an expanding cross-section in the subgrid scale plume 
phase at various times (o - 14:00, * - 14:30, 0 - 15:30,  o - 15:30, • - 17:30 ).  Plume section was 
released at 13:00.  Symbol at each edge is the grid boundary concentration. 

~ 

~ 

AEROSOLS IN MODELS-3 CMAQ 

Chapter 10 
=============

Francis S. Binkowski" 

Atmospheric Modeling Division 

National Exposure Research Laboratory 
U.S. Environmental Protection Agency 

Research Triangle Park, North Carolina 27711 

ABSTRACT 

The aerosol module of the CMAQ is designed to be an efficient and economical depiction of 
aerosol dynamics in the atmosphere.  The approach taken represents the particle size distribution 
as the superposition of three lognormal subdistributions, called modes.  The processes of 
coagulation, particle growth by the addition of new mass, particle formation, etc. are included. 
Time stepping is done with analytical solution to the differential equations for the conservation 
of number and species mass conservation.  The module considers both PM2.5 and PM JO  and 
includes estimates of the primary emissions of elemental and organic carbon, dust and other 
species not further specified.  Secondary species considered are sulfate, nitrate, ammonium, 
water and organic from precursors of anthropogenic and biogenic origin.  Extinction of visible 
light by aerosols represented by two methods, a parametric approximation to Mie extinction and 
an empirical approach based upon field data.  The algorithms describing cloud interactions are 
also included in this chapter. 

"On assignment from the National Oceanic and Atmospheric Administration, U.S.  Department of Commerce. 
Corresponding author address: Francis S.  Binkowski, MD-80, Research Triangle Park, NC 27711.  E-mail: 
fzb@hpcc.epa.gov 

10.0  AEROSOLS IN MODELS-3 CMAQ 
Inclusion of aerosol particles in an air quality model presents several challenges.  Amo~g these 
are the differences between the physical characteristics of gases and particles.  In treating gases 
in an air quality model, the size of the gas molecules is not usually of primary importance.  In 
contrast, particle size is of primary importance.  The interaction between condensing vapors and 
the target particle depends in an important way on the particle size in relation to the mean free 
path in the atmosphere.  For gases, once the concentration is known, the corresponding number 
of molecules is known.  This is not the case for particles.  Thus, including aerosol particles in an 
air quality model means choosing how the total number, total mass, and size distribution of the 
particles is represented.  Oncl:'. this choice is made, then important physical anq chcm:iical 
processes involving particles must be represented.  Particles may be emitted into t~.e air by 
natural processes such as wind blowing dust from a desert.  Human activities may disturb the soil 
to allow wind to blow soil particles off the ground.  Sea salt particles come into the atmosphere 
by wind driven waves on the sea surface.  Volcanic activity is another source of particles for both 
the troposphere and the stratosphere.  Particles can be made in the atmosphere directly from 
chemical reaction.  The most important example of this is the transfonnation of sulfur dioxide, a 
by-product of fossil  fuel  combustion, into sulfate particles.  Hydroxyl radicals
•• ~ttas,~ the ,sulfu~. 
dioxide and make sulfuric acid that then may nucleate in the presence of water vapor and 
.:
ammonia to produce new particles.  If there are particles already present in the atmosphere, the · 
new sulfate may condense on the existing particles or nucleate to form new particles depending 
upon conditions which are only recently beginning to be understood.  Reactions of organic 
precursors such as natural monoterpenes and anthropogenic organic species with ozone and other 
oxidants or radicals make new species that condense on: existing particles or make new particlt!!) 
depending upon conditions.  Combustion sources emit particles composed of mixtures of organic 
carbon and elemental carbon.  The exact mixture of organic and elemental carbon is a strong 
function of the conditions of combustion.  Once these particles are in the air, they may grow by 
condensing of species upon them as has already been mentioned.  For a large group of particles 
made in the air, i.e., secondary particles, growth may be related to relative humidity because of 
water condensing on the particles.  Another gas-particle interaction is the chemical equilibration 
of species within or on the surface of a particle with gases and vapors within the air.  Unlike 
gases, particles coagulate, e.g., collide and form a particle whose mass and volume are the sums 
of the masses and volumes of the colliding particles.  Thus, adding particles to an air quality 
model means adding a new set of physical processes. 

11111 

1 

In designing the aerosol component of CMAQ the following assumptions were made.  Any 
representation of particles had to be consistent with observations of particles. The representation 
had to be mathematically and numerically efficient to  minimize computer time.  And finally the 
representation had to be usable for regional to urban simulations.  These assumptions led to a 
choice of two methods.  The first method would be to model particle behavior in set of bins of 
increasing size.  This approach is quite popular and is described originally by Gelbard et. al. 
(1980) and more recently by Jacobson (1997). The second approach, the one chosen for 
implementation in CMAQ, is to follow Whitby (1978) and model the particles as a superposition 
of lognormal subdistributions called modes. The sectional method using the discrete size bins 
requires a large number of bins to capture the size distribution.  If one wishes to model several 
chemical components then the number of components is multiplied by the number of bins. This 
leads to a very large number of variables that must be added to an air quality model to capture 
particle behavior. In the modal approach, using the three modes suggested by Whitby(l 978), 
only three integral properties of the distribution, the total particle number concentration, the total 
surface area concentration, and the total mass concentration of the individual chemical 
components in each of the three mode. The current approach differs from that taken by 
Binkowski and Shankar (1995) where the sixth moment was chosen as a third in integral 
property in place of the second moment. That moment as chosen because of a mathematical 
simplification (see Whitby and McMurry,  1997). The mathematical simplifications of the modal 
method allow analytical solutions to be used for the aerosol dynamics. The current approach uses 
numerical quadratures to calculate all of the coagulation terms. The numerical quadratures were 
compared with the analytical expressions exhibited in Whitby et al.  (1991) and are accurate to six 
decimal places. The choice of using numerical quadratures was made to reduce the memory 
requirements associated with a variable geometric standard deviation and because the second 
moment unlike the sixth moment does not have an analytical form. 

The aerosol component of the CMAQ is derived from the Regional Particulate Model (RPM) 
{Binkowski and Shankar,  1995) which in, turn, is based upon the paradigm of the Regional Acid 
Deposition Model (RADM), an Eulerian framework model (Chang et al.,  1990).  The particles 
are divided into two groups, which are fine particles and coarse particles.  These groups generally 
have separate source mechanisms and chemical characteristics.  The fine particles result from 
combustion processes and chemical production of material that then condenses upon existing 
particles or forms new particles by nucleation.  The coarse group is composed of material such as 
wind-blown dust and marine particles (sea salt).  The anthropogenic component of the coarse 
particles is most often identified with industrial processes.  The common EPA nomenclature used 
in air quality refers to PM25 (particles with diameters less than 2.5 µm)  and PM 10  (particles with 
diameters less than 1 Oµm).  Note that PM10  includes PM 2.5•  Thus, in the present context, coarse 
particles are those with diameters between 2.5 and  10 µm.  Then, the mass of the coarse particles 
is the difference between the masses in PM 10  and PM25 • 

As already noted, the aerosol particle size distribution is modeled using the concepts developed 
by  Whitby (1978).  That is, PM25 is treated by two interacting subdistributions or modes.  The 
coarse particles form a third mode.  Conceptually within the fine group, the smaller (nuclei or 
Aitken), i-mode represents fresh particles either from nucleation or from direct emission, while 
the larger (accumulation),j-mode represents aged particles.  Primary emissions may also be 
distributed between these two modes.  The two modes interact with each other through 
coagulation.  Each mode may grow through condensation of gaseous precursors; each mode is 
subject to wet and dry deposition.  Finally, the smaller mode may grow into the larger mode and 
partially merge with it.  These processes are described in the following subsections.  The 
chemical species treated in the aerosol component are fine species sulfates, nitrates, ammonium, 
water, anthropogenic and biogenic organic carbon, elemental carbon, and other unspecified 
material of anthropogenic origin.  The coarse-mode species include sea salt, wind-blown dust, 
and other unspecified material of anthropogenic origin.  Because atmospheric transparency or 
visual range is an important air quality related value, the aerosol component also calculates 
estimates of visual range and aerosol extinction coefficient. 


10.1  Aerosol Dynamics 

The particle dynamics of this aerosol distribution are described fully in Whitby et al. (1991) and 
Whitby and McMurry 1997); therefore, only a brief summary of the method is given here. 

(Note: In the following equations repeated subscripts are not summed.) 

10.1.1  Modal Definitions 

Given a lognormal distribution defined as 

n(lnD) =  ~ exp[-O.s(

2n  In cr g 

ln ~) 2 

1
n cr g 

(10-1) 

where N is the particle number concentration, D  the particle diameter, and Dg and crg the 
geometric mean dicµneter an.? standard deviation of the distribution, respectively.  The kth 
moment of the dis~ibution is defined as 

Mk=  [  DknQnD) dQnD) 

with the result 

Mk= N Dg  exp  Tin  crg · 

k 

2 

l 

k 
2 

[ 

(10-2) 

(10-3) 

M 0  is the total number, N, of aerosol particles within the ~ode suspended in a unit volume of air. 
Fork= 2, the moment is proportional to the total particulate surface area within the mode per , 
unit volume of air. Fork= 3, the moment is proportional to the total particulate volume within 
the mode per unit volume of air. The constant of proportionality between M 2 and surface area is 
n; the constant of proportionality between M3  and volume is n/6. Note that the ge9metric 
,,,1111 
standard deviation is the same no matter which moment is selected. M 3  is determined from the .. 
nine distinct fine aerosol species (including water) listed in Table I 0-1  as follows: 

nmax 

M3i=  L  <p7 
()Pn 

n= I  TC 

M=~"1t 

nmax  <pn} 
n~I  ()Pn 

3j 

(10-4a) 

(10-4b) 

where cp?  and  cpnJ  are the species mass concentrations of the nth species in each mode in 
[µg  m·3

], Pn is the average density of the nth species.  The third moment for  the coarse mode is 

10-4 

obtained in a similar manner.  Given a value of third moment concentration and number 
concentration, the geometric mean standard deviation and the ge~metric mean diameter for each 
mode is diagnosed from 

· 

EP A/600/R-99103 0 

ln

2

cr g = ~(21n(M3) -3 In(~ )  -In (MJ 

3_ 

Dg -

M3 
r 9  2 

~· 

Nexp  2ln crg 

(IO-Sa) 

(10-Sb) 

The prediction equations for number, second moment and species mass are given in Section 
10.1.4. 

10.1.2  New Particle Production by Nucleation 

The CMAQ aerosol component has a choice of two particle production mechanisms, those of 
Harrington and Kreidenweis (l 998a,b) and Kulmala et al.  (1998). Both of these methods predict 
the rate of increase of the number of particles, J,  (in number per unit volume per unit time) by 
the nucleation from sulfuric acid vapor. In order to predict the rate of increase on new mass and 
new second moment an assumption about particle size is necessary. Following work by Weber et 
al.  (1997), it is assumed that the new particles are 3.5 nm in diameter. Weber et al. reported 
measurements of the concentration of particles that are in the size range 2.7 to 4.nm. For 
simplicity we have chosen 3.5 nm as a representative diameter. 

Using either of these methods, the production rate of new particle mass'[ µg m-3 s-1

]  is then 

d  Mass  =  ~ pdi.s J 

dt 

and that for number [ m-3  s-1 
d Num  =J 

dt 

]  is 

and that for second moment [ m2 m~3 s-1  ] is 
d  Mz  =di  J 

dt 

3.5 

(10-6a) 

(10-6b) 

(10-6c) 

where d3.5 is the diameter of the 3.5 nm particle and pis the density of the particle (taken as 
sulfuric acid) at ambient relative humidity (Nair and Vohra, 1975). 

10.1.3  Primary Emissions 

The EPA emission inventoryfor PM2.s  ~d PM 10  does not currently contain inforil1ation about  " 
neither size distribution nor chemical speciation.  In the CMAQ work, the assumption is that the 
major part of PM2.5 particulate mass emissions are in the accumulation mode with a small 
fraction in the Aitken mode; i.e. a fraction of 0.999 of PM2_5  is assumed to be in the accumulation 
mode and the remaining fraction, 0.001, is assigned to the Aitken mode.  Sensitivity studies V{!,ll 
be conducted to evaluate this assumption. In order to estimate the emissions rate for number and 
second moment fro1:11  the mass emissions rate an assumed mass size distribution is required. It is 
convenient to express the emission rate for number, Eo, and ..  that for second moment E2 in terms 
of a total emissions rate for third moment. This is shown schematically as follows where En  is' 
the mass emissions rate for species n  and Pn is the density for that species 

" I   ,1•11:1,'ll 

'"""""""""' 

" " ' '  

'"""' 

"'" 

"" 

' 

' 

" 

E,n~ (~)(::) 

,::11 

Eo= 

l 
L E3ri 
9 

11

\ 
Divexp  -2ln cr g) 

2 

( 

E2= 

LE3n 
II( 

\ 
Dgvexp  -~ln2cr g) 

where the sum is taken over all emitted species. 

1111111 

(10-7a) 

,(1" 

(lQ-7b) .. 

.., 

!II' 

(10-7c) 

':11 

In Equation 10-7b,c, Eo and E2 schematically represent the emissions rates for the various 
modes. In Section 10.1.4, the nomenclature used to represent the emissions rate for number for 
each of the three modes will be respectively Eoi, Eoj. and Eocor· 

We have chosen values of 0.3  µm for the geometric mean diameter for mass, D  , and 2.0 for the 
geometric standard deviation, cr g  for the accumulation mode. The corresponding 1:'.,~.ues for th.~ 
Aitken mode are 0.03  µm and 1.7, and those for the coarse mode are 6 µm and 2.2. 

The current emissions inventory estimates that 90% of PM10  is fugitive dust, and that 70% of this 
dust consists of PM2_5  particles. The paradigm adopted for the CMAQ is that fugitive dust is a 
coarse mode phenomenon with a tail that overlaps the PM2.s  range. Therefore, 90% of PMu) 
emissions are assigned entirely to the coarse mode species ASOIL. Sulfate emissions are treated 
differently in CMAQ than in RPM. In RPM sulfate emissions were treated as particles and 
distributed between the Aitken and accumulation modes. In CMAQ, the photochemical module 
has sulfate emissions incorporated into the chemical solver. Thus, the production rate for sulfuric 
acid will include direct emissions of sulfate. This rate is passed from the photochemical module 
to the aerosol module. Assigning fractional amounts of emitted PM2.5 and PM 10  to the specific 
species in Table 10-1  is a matter of ongoing discussions with those responsible for preparing the 
national emissions inventory. 

10.1.4  Numerical Solvers 

The numerical solvers for the two fine particle modes in the Models-3 aerosol component have 
been modified from those in RPM, which followed from Whitby et al. (1991).  The major 
difference is that the RPM solvers linearized the quadratic term for intramodal coagulation in the 
equation for modal number concentration.  The new solvers in CMAQ retain this quadratic term. 

The number concentrations for the Aitken and accumulation modes are denoted as Ni and Nj 
respectively.  Intramodal coagulation coefficients are functions only of the geometric mean 
diameters and geometric standard deviations for each mode and are denoted as Foii and FOJj-

Similarly, the intermodal coagulation coefficient for coagulation between the Aitken and 
accumulation modes is FOij·  For simplicity the following coefficients are defined. 

For the Aitken mode: 

a·  =Fo··  b·=N·Fo··  and 
l 

ll• 

lj• 

') 

l 

dNum 

.  dNum 

c i  = 

dt  + Eoi, with ~ from  (I 0-6b ); 

and for the accumulation mode: 

aJ = F O;J•  and CJ  =  Eoj 
The emissions rates for number concentration are Eoi and Eoj and are set to values determined 
for each mode from Equation 10-7b. 

We may now write for the particle number concentrations 

I  =c  -a. 

BN. 
at 
~  j 

I 

I 

N2  -b N.; and 
. 

I 

I 

BN. 
a(  =c Ta 1N1 . 

2 

(I0-8a) 

(10-8b) 

Equation 10-8a, a Riccati type equation and Equation 10-8b, a logistics type equation, have 
different analytical solutions depending upon whether Ci and CJ  are zero or nonzero. These 
analytic solutions are used in the CMAQ solver with the coefficients being held constant over 
one model time step.  In discussing the analytical solutions to Equations 10-8a and b, subscripts 
will be omitted for simplicity 

The solution to Equation 10-8a for Ci* 0 is of the form 

N{t)  =  r,  + r2P exp(Dlj 
a[ 1 + P exp(Dt)] 

iil1::: 

where 
" 
D=(b

2
+4ac)  ,r,=b'+D,r2- -~, 

2ac 

1 

-

p =  _ 

" 
b+ D 

(  ' )  ,, 
r 1 -a N  to 
r
-aNt
) 
0
2

. 

For Ci  = 0, the solution to Equation !p-8a is of the form 

'I 

i' 

' 

1i::, 

~ 

N(t)  = 

bNQ 0)exp (-bt) 

: 
b + aN(t0)[ 1 -exp (-bt)] 

,i'ili  111 

:11: 

11ll1,, 

,, 

,:111;' 

"11111' 

11:11 

:1, 

111·1' 

1111,,111' 

1111 
111, 

The solution to Equation 10-8b when Cj * 0 is of the same form as that to Equation 10-8a except 
b  = 0.  The solution when Cj = 0, known as Smoluchowski's solution, is: 

The equations for the prediction of second moment, M2,  in the Aitken and accumul.~tion mod~s 
are both of the form 

,, 

' ' ~ 11 

' , 11111,, 1 ' 

11 

"' 

' , 1111 

" 

I 

8M Tt =  p2 - L2M2; 

with solutions of the form 

M,~) ~ ~: + [ M,(tJ- ~]exp (- L,t). 

In these equations, production of second moment is denoted by P2 and loss by Li .For the Aitken 
mode, the production term includes the rate of second moment increase by new particle 
formation from Equation 10-6c, condensational growth (Equation 7a of Binkowski and Shank:ar, 
1995) and by primary emissions from Equation 10-7c.  The loss term accounts for the loss of 
second moment by intramodal coagulation, as well as including the transfer of second moment to 
the accumulation mode by intermodal coagulation. For the accumulation mode, the production 
term includes the transfer of second moment by intermodal coagulation, condensational growth 
(Equation 7b of Binkowski and Shankar, 1995) and the contribution of primary emissions from 
Equation 10-7 c. The loss term accounts for intramodal coagulation. 

It is important to note that the history variable in CMAQ is the modal surface area, which, as 
already noted, is n time the second moment. For convenience, however, within the internal 
aerosol subroutines, the second moment is the treated. Before returning to the main CMAQ 
routines, the second moment is multiplied by n.  That is why species number 23  and 24 in Table 
10-1  are identified as modal surface areas. It is also important to note that the surface area 
predicted by CMAQ is the surface area for spherical particles and may not represent the true 
surface area available in nonspherical particles or in porous particles such as carbon soot. 
Empirical correction factors may be needed for use of CMAQ surface area predictions in certain 
applications. 

The equations for mass concentration of species n may be written as: 

8cp" 
0Tt1  = P/'  - L<p 1!; and 

I 

I 

8<p" 
o1=P'~, J 

(10-9a) 

(10-9b) 

I 

I 

I 

i 

't' I 

r y  f  31) 

where  P"  =  ,n" + E':  + R"Q  and  L.  =  NM 17.  .. /  M  . 
3t 
with  <i>7  =  d ~~s from Equation 10-6a, when n denotes sulfate, and where  E; and  E;' are the 
emission rates and Rn is the gas-phase production rate for species n.  The factors O.i and O.j, 
defined by Equations A 17 and A 18 of Binkowski and Shankar ( 1995) represent the fractional 
apportionment of condensing species.  F3if is the coa~ulation coefficient for the third moment. 

Note that the loss of mass in Equation 10-9a is a gain of mass in Equation 10-9b.  This represents 
the transfer of mass by intermodal coagulation.  There is no such transfer of number in Equations 
10-8a,b because of the convention that when a smaller particle coagulates with a larger particle 
there is a loss of number from the population of smaller particles, but no gain of number in the 
population of larger particles.  There is, however, a transfer of mass.  Equations 10-9a and b have 
an analytic solution holding the coefficients constant for the time step of the form: 

cp(t)  = ~ + [ cpQJ- ~]exp (-Lt). 

The solution to Equation 10-9b are by an Euler forward step once again holding the production 
terms constant over that time step. 

The equation for the prediction of coarse mode mass is 

8<p" cor  =Ell 
-or-
wr 

The solution is by an Euler forward step. The equation for coarse mode number is similar 
because coagulation is ignored for the coarse mode, and is also solved by an Euler forward step. 

10.1.5  Mode Merging by Renaming 

111 

, 

, 

" 

In Binkowski and Shankar (1995), the Aitken mode diameters grew over the simulation periqd to 
become as large as those in the accumulation mode.  While this is probably true in nature, it  , 
violates the modeling paradigm that tw~ modes of distinct siz~ r~nges alway~~~x~~,~r This 
······· 
phenomenon can be modeled by mode merging as follows.  The Aitken mode approaches the 
accumulation mode by small increments over any model time step when particle growth and 
nucleation are occurring.  Thus, an algorithm is needed that ti:ansfers numbe~}tµd ,,mass 
" 
concentration from the Aitken mode to the accumulation mode when the Aitken mode forcing 
exceeds the accumulation mode forcing and the number of particles in the accumulation mod~ is 
no larger than that in the Aitken mode. 

',•''ill 

olll'llllll 

""""' 

I 

, 

,::.,, 

i;,;:!!1·

1 

Th~s algorithm. is formulated as fo~ows (Binkowski et al.,  19?6):  ~en Equ.,~~i?n~"':l0-10 is 
satisfied, the diameter of overlap,  d , for the modal number distnbut10ns can be calculated 
· · 
exactly.  Given this diameter, the fraction of the total number of Aitken mode particles greater 
than this diameter is easily calculated from the complementary error function 

,iii 

I' 

'" 

"'ill• 

.,,: 

F11u111  = 0.5[ 1 + erfc (x,,,1111)] 

,  where 

I' 

=  In (di dgn~ 
filn ( cr gJ 

x 
"'"" 

,,. 

(10-IOa) 

and dgni  is the geometric m.ean diame~er for the Aitken mode number distri9.~tio?. 

The number concentration corresponding to these particles is transferred to the accumulation  ···· 
mode, a processes denoted here as renaming the particles.  A similar process is U§,~d to transfor 
mass (third moment) concentration and surface area (second moment) concentration from the" 
Aitken to the accumulation mode using the complementary error function corresponding to the 
third moment. 
.,, 

' 

··  "' 

'"" 

·· 

·· 

Fk  =  0.5[ 1 + erfc (xk)]  , 

where  xk =  x11 11111  -

kin (crg) 

= 

(i'O-lOb) 

For numerical stability, the transfer of number and mass is limited so that no more than one half 
of the Aitken mode mass may be transferred at any given time step. 

Th.  · 

is is accomp 1s  e 

1 ·  h  d b 

·  · 

y reqmnng  at 

th  3 In ( cr gJ 

fi  ~ x,,,,m  • 

The fraction of the total number and surface area (k= 2) and mass (k=3) remaining in the Aitken 
mode is calculated from the error function of the overlap diameters as: 

10-10 

<1>1111111  = 0.5[ 1 + erf (x;,,,m)] 
<Dk= 0. s[ 1 + erf(x.J] 

EPA/600/R-99/030 

(10-lOc) 

(10-lOd) 

Using these fractions, Aitken and accumulation mode number and mass concentrations are 
updated as 
0 = N; + F111111,Ni 

(10-11 a) 

n_  n+F  n 
3<p i 

<pj  - <pj 

M2rM2;+F2M2i 

N=<D  N. 

I 

11Ulll 

I 

n_ <D  n 
3<p  i 

cp i  -

Mii= <D2M2i 

(10-11 b) 

(10-llc) 

(10-lld) 

(10-lle) 

(10-1 lf) 

This method of particle renaming is analogous to the procedure discussed by Jacobson (1997) 
where particles are reassigned in the moving center concept of a bin model.  When the particles 
grow beyond the boundaries of their size bin, they are reassigned to a larger bin and averaged 
with the new bin. 

10.2  Aerosol Dry Deposition 

The rate of dry deposition of particle zero111  and third moment to the earth's surface provides the 
lower boundary condition for the vertical diffusion of aerosol number and species mass, 
respectively.  The method of doing this follows the RPM approach with the following 
exceptions.  In RPM total fine mass was deposited.  In CMAQ the species mass in each mode is 
deposited separately using the dry deposition velocity for the third moment.  The impaction term 
is omitted for the coarse mode particles in both the zero•h and third moment dry deposition 
velocities.  See Binkowski and Shankar (1995) Equations A25 through A34 for details. 

10.3  Cloud Processing of Aerosols 

Clouds are formed when the relative humidity reaches a value at which existing aerosol particles 
are activated. That is, they pass through a potential barrier and grow rapidly from a few 
micrometers to several micrometers to become cloud droplets (cloud nucleation). Soluble gases 
are then dissolved into the cloud droplets where aqueous-phase chemical equilibria and reactions 
occur. The attack on dissolved sulfur dioxide by hydrogen peroxide produces a dissolved sulfate 
species (oxidation of Sulfur (IV) to Sulfur (VI)).  Because these processes are very complex in 
detail and occur at subgrid scale, most cloud modeling in mesoscale meteorological models and 
in air quality models uses simplified parametric approaches to model the effect of clouds rather 
than modeling the clouds directly. This approach was used in RADM and RPM and is applied in 
the first version of CMAQ. 

,'I,,, 

The assumptions for aerosol,"behavior in clouds are: 

• 

• 

• 

• 

• 

The Aitken ( i ) mode forms interstitial aerosol which is scavenged by the cloud droplets. 
All three integral properties of the Aitken mode respond to in-cloud scavenging. 

, 

,. 

,,, 

,. 

'" 

,,,, 

" 

''I 

'1!1 111·,, 

"' 

The accumulation (j) mode forms cloud condensation nuclei and thus is  distributed as 
aerosol within the cloud water. Mass and number in this mode may be lost through 
precipitation. Mass but not number is increased by in-cloud scavenging of the Aitken 
mode. 

All new sulfate mass produced by aqueous production is added to the accumulation 
mode, but the number of accumulation mode particles is unchanged as is the geometric 
standard deviation, crg, of the accumulation mode processes  (cf Leaitch, 1996 for 
cumulus clouds). 

::~'  ·· 

The assumption about the accumulation mode geometric standard deviation means that 
the surface area of the accumulation mode is reconstucted from  the new mass and new 
number in the accumulation mode at the end of the cloud lifetime. 

,,,  , 

The aerosol is mixed vertically by the same mechanisms mixing other species. The wet 
removal of aerosol is proportional to wet removal of sulfate (See Chapter 11). 

The limitations are: 

• 

• 

The cloud process modules are similar to those of RPM and RADM with cloud droplet 
number concentrations being modeled by an empirical fit to data from Bower and 
Choularton (1992). 

Cloud droplet size distributions are lognormal with cr  set to  1.2. Using the cloud liquid 
water content and the cloud droplet number concentrition, the geometric mean cloud 
droplet diameter, d  can be calculated. 

. 

S' 

The mathematical approach begins with an extension (Binkowski and Shankar,  1994; Shankar 
and Binkowski, 1994) of Slinn's (1974) two-step model as used by Chaumerliac (1984). 

The in-cloud scavenging of interstitial Aitken mode number, surface area and mass 
concentration, Yak•  may be r~presented by: 
' 

.,, 

dyak 
dt= -a.kYak 

po-12) 

10-12 

with solution 

Yak(t +  't  ~ =  y ak(o)  exp  (-a 't 
) 
k  c/d 

cl<!} 

EPA/600/R-99/030 

(10-13) 

where ak (k = 0,2,3) is the attachment rate for interstitial aerosol concentration.  The attachment 
rate is assumed to be held constant over the cloud lifetime 'tc/d·  The initial values Yak(O)  are 
determined after cloud mixing (see Equations 11-4 and 11-5). 

The cloud water aerosol concentration is represented by 

dYck 
dt= 8k3  akYak+ PJ - f38kOY ck>  k-¢ 2 

( 

~ 

(10-14) 

where  13  is the precipitation removal rate, and P is the production of new sulfate mass by aqueous 
chemistry.  The first Kronecker delta indicates that only mass (k=3) is increased for the 
accumulation mode by chemical production and in-cloud scavenging. The second Kronecker 
delta indicates that only number (k=O)  is removed by the precipitation removal term in this form. 
Mass is removed explicitly in the cloud processor. 

The attachment rates, ak, using the form recommended by Pruppacher and Keltt (1978) and 
including an enhancement factor for the settling velocity of the cloud droplets, Vdc  are given by: 
ak = 2nm 1cD /k(l  + 0. 5 Pek1

,  k = 0,2,3;. 

(10-15) 

3
) 

'

Where 
m1 c=N,d<texp[~1n2(crJ]. 
Ne  and  dd  are the cloud droplet number concentration and geometric mean 
diameter respectively. 

Pek =  v3dd  is a Peclet number. 

DP< 

The polydisperse diffusivity is given by 

(10-16) 

(10-17) 

" 
( 
Dk= 

P 

kbT 

) 
37tUPairDg 

x 

{xp( (-2~ + 

1

)  Jn'cr,) + I.246Kn, exp( (-4~ + 4) ln2cr ,)} 

and is the same form as that for dry deposition algorithm 
(see Binkowski and Shankar, 1995, Equation A29). 

(10-18) 

The precipitation removal rate for number is given by 

11111, 

1 

p 
=  ~ SO 

[ 
( 

4] i11i/ 

4  wetdep 

[8SO] 
[  J .\CU• 
+  SO 

+  8SO 

[ 

) 
4]  prod 

111·1 

,,(10-19) 

11!i:1! 

where  i;;cld  is the cloud lifetime, [ 8S04]wetdep  is the change in sulfate concentration due to 
precipitation loss, and [ S04]init  is the sulfate concentration at the beginning of the cloud 
lifetime,  [S04]scav  is the amount of sulfate added from in-cloud scavenging of Aitken mode 
sulfate; [ 8S04]prod  is the amount of new sulfate produced by aqueous chemistrJ. 
·· 

1
111:::1,,, 

'

,, 

1'' 

10.4  Aerosol Chemistry 

11111111". 

'li11:llllliiiil1, 

The aerosol chemical species are listed in Table 10-1.  The secondary species sulfate is produced 
by chemical reaction of hydroxyl radical on sulfur dioxide to produce sulfuric acid that may 
condense on existing particles or nucleate to form new particles.  Emissions of fresh primary 
sulfate are treated in the gas-phase chemistry component, and this contributes to the total change 
in sulfate from the chemistry component.  This is a change from RPM where primary sulfate 
emissions were treated as a source of new mass and new particle number.  Other inorganic 
species such as (anunonia ~d n.itric acid) are equilibrated ~ith .the aerosols.  '1

"',' 

'" 

" 

'I 

An assumption of the model is that organics influence neither the water content nor the ionic  I 
strength of the system; however, this assumption may not be valid for many atmospheric 
aerosols.  Although much progress has been made (e.g. Saxena et al.,  1995; ~,,~:Xe~,~ and 
Hildemann,  1996), sufficient basic data are not yet available to treat the system in a more 
complete and correct way.  Over continental North America for PM2.s, sea salt and soil particles 
are not considered in the equilibria.  Thus, for the initial release of CMAQ, only the equilibriyp1 
of the sulfate, nitrate, anunonium and water system is considered.  The equilibria and the 
associated constants are based upon Kim et al.  (1993a) and shown in Table 10-3. 

The aerosol water content is computed using the ZSR method (see Kim et al.,  1993a)  from: 

(10-20) 

], and mno  is the molality [moles kg'3

where  Wis the aerosol liquid water content [kg m'3
], Mn  is the atmospheric concentration of the 
nth species [moles m'3
], of the nth spec~~s at a va.lue of ....... . 
water activity (fractional relative humidity) of aw.  The values for the molality as a function of 
water activity are calculated from laboratory data from Giauque et aL  (1960), Tang and 
Munkelwitz (1994), and Nair and Vohra (1975).  The ZSR meth()d is used in a s9giewh(lt 
different way than usual.  The water content of sulfate aerosols depends strongly upon the ionic 
ratio of ammonium to sulfate.  This ratio varies from zero for sulfuric acid to 2.0 for ammonium 
sulfate with intermediate values of 1.0 for anunonium bisulfate, and  1.5 for letovicite.  The usual 
method would span this range with a single expression; however, Spann and Richardson (1985) 
have shown that this is not correct.  They proposed a modification whic.h resqltect in a correction 
term.  A very similar result is obtained by using the ZSR method between the ranges of the ionic 
ratio of sulfuric acid to ammonium bisulfate, ammonium bisulfate to letovicite, and letovicite to 
anunonium sulfate.  The binary activity coefficients are computed using Pitzer's method and the 
Bromley method is used for the multicomponent activity coefficients in the aqueous solution (see 
Kim et al.,  1993a) for details. 

Two regimes of anunonium to sulfate ionic ratio are considered.  The anunonia deficient regime 
(in which the ionic ratio of anunonium to total sulfate ion is less than two) leads to an acidic 
aerosol system with very low concentrations of dissolved nitrate ion which depend very strongly 
on ambient relative humidity.  The second regime is one in which the anunonium to sulfate ratio 
exceeds two, the sulfate is completely neutralized, and there is excess anunonia.  If there is nitric 
acid vapor in the system, it will dissolve in the aqueous particles along with the excess anunonia 
and produce abundant nitrate. 

For cases when the relative humidity is so low that the aerosol liquid water content comprises 
less than 20 percent of the total aerosol mass, and the ionic ratio of anunonium to sulfate is 
greater than two, "dry ammonium nitrate" aerosol is calculated with the following equilibrium 
relationship: 

NH 4 N0 3(s) <=>  NH 3(g) + HN0 3(g) 

(I 0-21) 

The value of the equilibrium constant is taken from Mozurkewich (1993) as noted in Table 10-2. 

Precursors of anthropogenic organic aerosol (such as alkanes, alkenes, and aromatics) react with 
hydroxyl radicals, ozone, and nitrate radicals to produce condensable material.  Monoterpenes 
react in a similar manner to produce biogenic organic aerosol species.  The rates of production of 
sulfuric acid and the organic species are passed from the photochemical component to the aerosol 
component.  The formation rates of aerosol mass (in terms of the reaction rates of the precursors) 
are taken frorri  Pandis et al.  (1992).  These factors are given in Table 10-3. 

10.5  Visibility 

Visibility is usually defined to mean the furthest distance one can see and identify an object in 
the atmosphere.  For a detailed presentation on the concepts of visibility, see Malm (1979).  In a 
perfectly clean atmosphere composed only of nonabsorbent gases, the only process restricting 
visibility during daylight is the scattering of solar radiation from the molecules of the gases.  This 
is known as Rayleigh scattering.  Scattering is usually represented by a scattering coefficient.  If 
absorption is also occurring in addition to scattering, an absorption coefficient may also be 
defined.  The sum of the scattering and absorption coefficients is called the extinction coefficient. 
If absorption is not occurring, the extinction coefficient is defined to be equal to the scattering 
coefficient.  The visibility in an atmosphere in which Rayleigh scattering is the only optical 
process active may be taken as a reference.  A  useful index for quantifying the impairment of · 
visibility by the presence of atmospheric aerosol particles is the deciview (Pitchford and Malm, 
1994).  The deciview index, deciV, is given as 


( '3cxl) 
deciV =  10 In  TIN 

(10-22) 

where the value of 0.01  [km-I]  is taken as a standard value for Rayleigh exti:q,9Hqu~  ~e aero~,~l 
extinction coefficient, 13ext [km-I], must be calculated from ambient aerosol characteristics such 
as index of refraction, volume concentration and size distribution. 

The extinction coefficient at a wavelength of A,  for aerosol may be expressed as 

,, 

11

A 
l-'ex1  -

- 3 7t  f  Qexl  d V  di 

2').., J-ro ex dlna  na' 

where the particle distribution is given in a lognormal form as 

dV  _ 
d~n a  - VT  "ff)  exp  - A In  av. 

[ 

(A\ Ia 

2(  a)] 

, 

(10-23) 

(10-24) 

where  a  =  JJl2 
').., 

rtD8 v 

av=~ 

I 

A  = 2 ln2cr g 

Vr is the total particle volume concentration, Qexf, the Mie extinction efficiency factor,  is a 
function of a  and the index of refraction of the particles.  Willeke and Brockmann (1977) 
showed that the behavior of the extinction coefficient is a smooth function of the geometric mean 
diameter for the volume distribution Dgv, and the index of refraction.  This smooth characteristic 
implies that an accurate approximation to the Mie efficiency can be used in its place to reduce a 
very computationally intensive task.  The method of Evans and Fournier (1990), a highly 
accurate approximation, is used to calculate Qext· 

,,,, 

•,II 

111 

"' 

1, 

I 

Because routine measurements of aerosol species mass concentrations are often available, but 
particle size distribution information is not, an additional method of calculating extinction has 
also been included.  This is an empirical approach known as reconstructed extinction.  The 
method is explained by Malm et al. (1994).  The formula used here is a slight modification of 
their Equation 12 (Sisler,  1998). 

, ,, 

,,  ' 

' , '~. '" 

''"'\ 

'  ""'I; 

ll"':i  ' 

, 

I 

':1!1:,  '"'' 

'11 

11 

11111 

;I 

Pext [ 1/lrm] =  0.003* f(rh)*{  [ammonium sulfate]+ [ammonium nitrate]} 

""" 

' 

(10-25) 

+ 0.004 *[organic mass} 
+ 0.01 *[Light Absorbing Carbon]+  0.001 *[fine soil] 
+ 0.0006*[coarse mass] 

In implementing this method, ammonium sulfate and ammonium nitrate were taken as the sum of 
ammonium, plus sulfate, plus nitrate.  Organ~c mass was taken as the sum of all organic species. 
Light absorbing carbon was taken as elemental carbon.  Fine soil was taken as the unspeciated 
portion of PM2.5 emitted species, and the coarse mass term was not implemented in CMAQ at 
this time.  The reason for not implementing coarse mass was that the uncertainty in the emissions 
was deemed to be too large at the present time.  The relative humidity correction, f(rh), is 
obtained from a table of corrections with entries at one- percent intervals.  The methodology for 
the corrections is given in Malm et al. (1994). 

10.6 

Summary 

The CMAQ aerosol component is a major GXtension of the RPM.  Addition of the coarse mode 
and primary emissions now allow both PM2.5  and PM 10  to be treated.  Ongoing work will 
improve the representation of the production of secondary organic aerosol (SOA) material by 
including a version of the method of Pankow (1994a,b) as discussed by Odum et al. (1996).  This 
method, based upon laboratory experiments, calculates the yield of SOA as a function of the 
amount of organic material already in the particle phase. 

Kleeman et al.  ( 1997) have shown that various source types have size and species information 
that may be looked upon as a source signature. This assumes the availability of such source 
characteristics for the entire modeling domain. As noted in Section 10.1.3, there are ongoing 
discussions with those responsible for the national emissions inventory. As more information 
becomes available, identification of source signatures may be possible for a larger domain than 
the Los Angeles area, and an effort similar to Kleeman et al. (1997), albeit using a modal 
approach, might be undertaken.  Other planned improvements for primary particles are the 
inclusion of marine aerosol as well as a better treatment of fugitive dust. 

Future plans also include an intensive effort to evaluate the CMAQ aerosol component using 
atmospheric observations from selected field studies in which aerosol particles were observed. 
Comparison with routine visual range observations during the field study periods will provide an 
additional method of evaluation. 

10. 7  References 

Binkowski F.  S., and U.  Shankar, The regional particulate model  1.  Model description and 
preliminary results. J  Geophys.  Res.,  100, D12, 26191-26209,  1995. 

Binkowski F.  S., and U.  Shankar, Development of an algorithm for the interaction of a 
distribution of aerosol particles with cloud water for use in a three-dimensional eulaeian air 
quality model, Presentation at the Fourth International Aerosol Conference, Los Angeles, CA, 
Aug. 29 - Sept. 2, 1994. 

Binkowski, F.  S., S.  M. Kreidenweis, D.  Y.  Harrington, and U.  Shankar, Comparison of new 
particle formation mechanisms in the regional particulate model, Presentataion at the Fifteenth 
Annual Conference of the American Association for Aerosol Research, Orlando Florida, 
October 14-18, 1996. 

Bower, K. N. and T.  W.  Choularton, A parameterisation of the effective radius of ice free clouds 
for use in global climate models. Atmos.  Res.,  27, 305-339, 1992. 

Bowman, F. M., C.  Pilinis, and J.  H.  Seinfeld, Ozone and aerosol productivity ofreactive 
organics, Atmos.  Environ., 29, 579-589, 1995. 

Chang, J.  S., F. S.  Binkowski, N. L. Seaman, D.  W.  Byun, J. N. McHenry, P.  J.  Samson,\\'. R. 
Stockwell, C. J.  Walcek, S.  Madronich, P.  B. Middleton, J.E. Pleim, and H. L. Landsford, The 
regional acid deposition model and engineering model, NAP AP SOSff Report 4,  in National 
Acid Precipitation Assessment Program, Acidic Deposition: State of Science and Technology, 
Volume I,  Washington, D.C., 1990 .. ,, 

··· 

111111 

Chaumerliac, N., Evaluation des Termes de Captation Dynamique dans un Modele 
Tridimensionel  a Mesoechelle de  Lessivage de L 'Atmosphere,  These Presentee a L'Universite de 
Clermont II, U.E.R. de Recherche Scientifique et Technique, 1984. 

Evans, T. N. and G.  R.  Fournier, Simple approximation to extinction efficiency valid over all 
size ranges. Appl.  Optics, 29, 4666-4670, 1990. 

Gelbard, F., Y.  Tambour, and J.  H.  Seinfeld, Sectional representations for simulating aerosol 
dynamics. lour.of Colloid and Interface. Sci., 76, 541-556,  1980. 

Giauque, W.  F., E.W. Hornung, J.E. Kunzler, and T.  R.  Rubin, The thermodynamics of aqueous 
sulfuric acid solutions and hydrates from  15 to 300 K,  j  Amer.  Chem.  Soc.,  82, 62-67,  1960. 

Harrington, D.  Y.  and S.  M.  Kreidenweis, Simulations of sulfate aerosol dynamics: Part I model 
description, Atmos.  Environ.,  32,  1691-1700, 1998a. 

'' 

·· 

Harrington, D.  Y. 'and S.  M.  Kreidenweis, Simulations of sulfate aerosol dynamiCs: Part II  model 
intercomparison, Atmos.  Environ.,  1701-1709, 1998b. 
Jacobson, M.Z. Development and application of a new air pollution modeling system-II. Aerosol 
module structure and design, Atmos.  Environ., 31, 131-144, 1997. 

'"'' 

I 

Kim,Y. P., J.  H.  Seinfeld, and  P. Saxena, Atmospheric gas-aerosol equilibrium I. 
Thermodynamic model, Aerosol Sci.  and Technol.,  19,  157-181, 1993a. 

..,. 

Kim,Y.  P., J.  H.  Seinfeld, a~d P.  S~ena, Atmospheric gas-ae:osol equilibri~m I~. An~lysis ~l 
common approximations and activity coefficient calculation methods, Aerosol Sci.  and Teclmol., 
19,  182-198, 1993b. 

Kleeman, M.J., G.R. Cass and A.  Eldering, Modeling the airborne particle complex as a source(cid:173)
oriented external mixture. J.  Geophys. Res.,  102, 21355-21372,  1997. 

Kulmala, M.  , A. Laaksonen, and Liisa Pirjola, Parameterization for sulfuric acid/water 
nucleation rates. J  Geophys.  Res.,103, 8301-8307,  1998. 

Leaitch, W.  R., Observations pertaining to the effect of chemical transformation in cloud 
on the anthropogenic aerosol size distribution, Aerosol Sci.  and Technol., Vol. 25, pp 157-173, 
1996. 

Malm, W. C., Considerations in the measurements of visibility, J  Air Pollution Control Assoc., 
29,  1042-1052,  1979. 

Malm, W.  C., J.  F. Sisler, D. Huffman, R.  A. Eldred, and T. A.  Cahill, Spatial and seasonal 
trends in particle concentration and optical extinction in the United States, J  Geophys.  Res.,  99, 
-.p47-1370, 1994. 

McElroy, M.  W., R.  C. Carr, D.S. Ensor, and G. R.  Markowski, Size distribution of fine 
particles from coal combustion, Science, 215,  13-19, 1982. 

Middleton, P.  B. and C.  S. Kiang, A kinetic model for the formation and growth of secondary 
sulfuric acid particles, J  Aerosol Sci., 9, 359-385, 1978. 

Mozurkewich, M. The dissociation constant of ammonium nitrate and its dependence on 
temperature, relative humidity, and particle size. Atmos.  Environ., 27A, 261-270,  1993. 

Nair, P.  V. N. and K.  G.  Vohra, Growth of aqueous sulphuric acid droplets as a function of 
relative humidity, J  Aerosol Sci.,  6, 265-271,  1975. 

Odum, J.  R., T. Hoffman, F.  Bowman, D.  Collins, R.C. Flagan, and J.H Seinfeld, Gas/particle 
partitioning and secondary organic aerosol yields. Environ.  Sci.  Technol.,  30, 2580-2585,  1996. 

Pandis, S.  N., R.  A. Harley, G.  R.  Cass, and J.  H.  Seinfeld, Secondary organic aerosol formation 
and transport, Atmos.  Environ., 26A, 2269-2282,  1992. 

Pankow, J.  F .,  An absorption model of gas/particle partitioning of organic compounds in the. 
atmosphere. Atmos.  Environ.,  28, 185-188,  1994a. 

Pankow, J.F., An absorption model of gas/particle partitioning involved in the formation of 
secondary organic aerosol, Atmos.  Environ.,  28, 189-193,  l 994b. 

Pitchford, M. L.  and W.  C. Malm, Development and applications of a standard visual index, 
Atmos.  Environ.,  28,  1049 - 1054, 1994. 

Pratsinis, S.  E., Simultaneous aerosol nucleation, condensation, and coagulation in aerosol 
reactors, J  Colloid Interface Science, 124,  417-427, 1988. 

Pruppacher, H.  R.  and J.  D. Klett, Microphysics of Clouds and Precipitation, Reidel, Dordrecht, 
Holland,  1978. 

Saxena, P.  and L. Hildemann, Water-soluble organics in atmospheric particles: a critical review 
of the literature and application of thermodynamics to identify candidate compounds, J  Atmos. 
Chem.,  24, 57-109, 1996. 

Saxena, P., L. M.Hildemann, P.H. McMurry, and J.  H.  Seinfeld, Organics alter hygroscopic 
behavior of atmospheric particles, J.  Geophys.  Res.,  100,  18755 - 18770, 1995. 

Seinfeld, J.  H., Atmospheric Chemistry and Physics of Air Pollution, Wiley, New York,  1986. 

Shankar, U. and F. S. Binkowski, Sulfate aerosol wet deposition in a three-dimensional Eulerian 
air quality modeling framework, Presentation at the Fourth International Aerosol Conference, 
Los Angeles, CA, Aug. 29 - Sept. 2,  1994. 

Sisler, J.  Personal Communication 

SHnn, W. G. ~., R~te-limiting aspects of in-cloud scavenging, J.  Atmos.  Sci., 31,  1172-
1173, 1974. 

~ 
Ii' 

. 

Ill, 

,,111111 

,1111 

11111" 

Spann, J.  F. and C.  B. Richardson, Measurement of the water cycle in mixed ammonium acid 
sulfate particles, Atmos.  Environ.,  19, 919-825, 1985. 

Tang, I.N. and H.R. Munkelwitz, Water activities, densities, and refractive indices of aqueous 
sulfates and sodium nitrate droplets of atmospheric importance, J.  Geophys.  Res., 99,  18801-
18808, 1994. 

Van Dingenen, R. and F. Raes, Determination of the condensation accommodation coefficient of 
sulfuric acid on water-sulfuric acid aerosol, Aerosol Sci.  Technol.,  15,  93-106,  1991. 

Weber, R.J., J.J. Marti, P.H. McMurry, F.L. Eisele, D.J. Tanner, and A. Jefferson, Measurements 
of new particle formation and ultrafine partilce growth rates at a clean continental site. J. 
Geophys.  Res.,102, 4375-4385, 1998. 

Wesely, M. L., D.R. Cook, R.  L.  Hart, and R.  E.  Speer, Measurement and parameterization of 
particulate sulfur dry deposition over grass. J.  Geophys.  Res., 90,  2131-2143,  1985. 

\Vexler, A. S., F. W. Lurmann, and J.  H.  Seinfeld, Modeling urban and regional aerosols: I. 
Model development, Atmos.  Envion., 28, 531-546,  1994. 

l11f'I 

'!I: 

, 

Whitby, K. T., The physical characteristics of sulfur aerosols, Atmos.  Environ.,  12,  135-159, 
1978. 

\Vhitby, E. R.and  P.H. McMui-ry, Modal aerosol dynamics modeling, Aero;ol Sci.  and 
Techno/.,  27, 673-688,  1997. 

Whitby, E. R., P.H. McMurry, U.  Shankar, and F.  S.  Binkowski, Modal Aerosol Dynamics 
lilodeling, Rep. 600/3-91/020, Atmospheric Research and Exposure Assessment Laboratory, 
U.S. Environmental Protection Agency, Research Triangle Park, N.C., (NTIS PB91- 16172?/AS), 1991. 

Willeke, K. and J.  E.  Brockmann, Extinction coefficients for multimodal atmospheric particle 
size distributions, Atmos.  Environ.,  11, 995 - 999, 1977. 

Youngblood, D.A. and S.M. Kreidenweis, Further development and testing of a bimodal aerosol 
dynamics model. Colorado State University, Department of Atmospheric Sciences Report No. 
550,  1994. 

Table 10-1  Aerosol Species Concentrations 

Units:  mass [ µg m·3 

], number [ # m·3 

] 

I 

!llh' 

'II' 

{al} 
(82} 
{"~} 
{ a4} 
( aS} 
{ n6} 
{ a7} 
{ a8} 
{ a9} 
{~io} 
{all} 
{al2} 
{a13} 
{al4} 
{alS} 
{al6} 
{al7} 
{a18} 
{al9} 
{ a20} 
{a21} 
{a22} 
{a23} 
{a24} 
{a25} 
{a26} 

AS04J 

Accumulation mode sulfate mass 

AS04I 

ANH4J 

ANH4I 

AN03J 
AN031 

AORGAJ 

Aitken mode sulfate mass 

Accumulation mode ammonium mass 
Aitken' mode ammonium mass 

Accumulation mode nitrate mass 
Aitke~" mode aerosol nitrate mass 
Accumulation mode anthropogenic secondary organic mass 

AORGAI 

Aitken mode anthropogenic secondary organic mass 

1111''' 

AORGPAJ 
'I" AORGPAI 
AORGBJ 
'I 
.,,,  AdRGBI 

".'II' 

AECJ 
AECI 

A25J 

A25I 

ACORS 

ASE AS 

ASOIL 

Accumulation mode primary oq~anic mass 

Aitken mode mode primary organic inass 

Accumulation mode secondary biogenic organic mass 
Aitken mode biogenic second~ biogenic organic mass 
Accumulation mode elemental carbon mass 
Aitken mode elemental carbon mass 

Accumulation mode unspecified anthropogenic mass 

Aitken mode unspecified anthropogenic mass 

Coarse rriode unspecified anthropogenic mass 

Coarse mode marine mass 

Coarse modt.::  soil-derived mass 

NUMA TKN  Aitken mode number 

NUMACC  Accumulation mode number 
NUMCOR 

Coarse mode number 

SRF A TKN  Aitken mode surface area 

SRF ACC 

Accumulation mode surface area 

AH20J 

AH20I 

Accumulation mode water mass 

Aitken mode water mass 

Table 10-2.  Equilibrium Relations and Constants 
(Kim et al.,  l 993a) 

Equilibrium Relation 

Constant 

K(298.15) 

a 

b 

Units 

HSO;( aq) ¢:> H+(aq) + so:-(aq) 

NH3(g) ¢:>  NH 3(~q) 

NH3(aq) + Hp(aq) ~ NH;(aq)  +  OH-(aq) 

HN03(g) ¢:> H+( aq) + N03 (aq) 

....... 
0 
I 
N 
(.,.> 

NH4N0 3(s) ¢:> NHig) + HN03(g) 

(H +][ SO!-]rH+Yso~-

[Hso~]rHSO~-
[NH3(aq)]YNH3 

PNH3 

[NH; ][ oH-Jy NH·Y oH-
[ NH3(aq))yNHaa w 

[H+][No;]yH+YN03 

PHN03 

PNH3PHN03 

l.015E-02 

8.85 

25.14 

mol I kg 

57.639 

13.79 

-5.39 

mol /kg atm 

l.805E-05 

-1.50 

26.92 

mol I kg 

2.511E06 

29.17 

16.83 

moI2 I kg2 atm 

5.746E-l 7# 

-74.38# 

6.12# 

atm2 

H20(aq) ¢:> H+(aq)  +OH  (aq) 

[ H+][oH- ]rH+YoH-

l.OIOE-14 

-22.52 

26.92 

moI2 I kg2 

The constants a and b are used in the following to adjust for ambient temperature 

aw 

K ~ K(r,)e+(~ -I) + b(1 + In(.?f )--¥} r, ~ 298.15 [KJ] 

#These values are only used by Kim et al. (1993a,b).The values used in the CMAQ are from Mozurkewich (1993): 

K ~exp (118.87 - ·  - 6.025 ln (r)) 

where Mozurkevich reports in nanobars squared.  This yields a value for the equilibrium constant of 43.11  [nb2

]  at 298.15 K. 

Table 10-3.  Organic Aerosol Yields in Terms of Amount of Precursor Reacted 
(From Pandis et aL  (1992) and Bowman et al.  (1995)) 

Gas-Phase Organic  Species 

Aerosol Yield 

[µg m"3 

/  ppm(reacted)] 

CS  and higher alkanes 

Anthropogenic internal alkenes 

monoterpenes 

toluene 

xylene 

cresol 

380 

247 

740 

424 

342 

221 

II", 

'II 

I 

i 

11111,,, 

Chapter 11 
===========

CLOUD DYNAMICS AND CHEMISTRY 

Shawn J. Roselle* and Francis S. Binkowski** 

Atmospheric Modeling Division 

National Exposure Research Laboratory 
U.S. Envirorunental Protection Agency 

Research Triangle Park, North Carolina 27711 

ABSTRACT 

Chapter 11  describes the cloud module that is currently incorporated into CMAQ.  This module 
simulates the physical and chemical processes of clouds that are important in air quality 
simulations.  Clouds affect pollutant concentrations by vertical-convective mixing, scavenging, 
aqueous chemistry, and removal by wet deposition.  The CMAQ cloud module includes 
parameterizations for sub-grid convective precipitating and non-precipitating clouds and grid(cid:173)
scale resolved clouds.  Cloud effects on both gas-phase species and aerosols are simulated by the 
cloud module. 

"on assignment from the National Oceanic and Atmospheric Administration, U.S. Department of Commerce. 
Corresponding author address:  Shawn J.  Roselle, MD-80, Research Triangle Park, NC 27711.  E-mail: 
sjr@hpcc.epa.gov 

.. On assignment from the National Oceanic and Atmospheric Administration, U.S. Department of Commerce. 

11.0  CLOUD DYNAMICS AND CHEMISTRY 

11.1  Background 

Clouds play an important role in boundary layer meteorology and air quality.  Convective clouds 
transport pollutants vertically, allowing an exchange of air between the boundary layer and the 
fr~e troposphere.  Cloud droplets formed by heterogeneous nucleation on aerosols grow into rain 
droplets through condensation, collision, and coalescence.  Clouds and precipitation scavenge 
pollutants from the air.  Once inside the cloud or rain water, some compounds dissociate into 
ions and/or react with one another through aqueous chemistry (i.e., cloud chemistry is an 
important process in the oxidation of sulfur dioxide to sulfate).  Another important role for 
clouds is the removal of pollutants trapped in rain water and its deposition onto the ground. 
Clouds can also affect gas-phase chemistry by attenuating solar radiation below the cloud base 
~hich has a si"gnifl~ant impact on the photolysis reactions. 

The Models-3/CMAQ cloud model incorporates many of these cloud processes.  The model 
includes parameterizations for several types of clouds, including sub-grid convective clouds 
(precipitating and non-precipitating) and grid-scale resolved clouds.  It includes an aqueous 
chemistry model for sulfur, and includes a simple mechanism for scavenging. 

,,,,,, 

,,1111 

,,. 

,, 

1111, 

''II, 

11.2  Model Description 

The cloud model can be divided into two main components, including the sub-grid cloud model 
(subcld)  and the resolved cloud model (rescld).  For large horizontal grid resolutions, the grid 
size will be Ia[ger than the size of a typical convective cloud, requiring a parameterization for 
t4~se sub-grici'clouds.  The sub-grid cloud scheme simulates convective precipitating and non(cid:173)
p~ecipitating Clouds.  The second component of the cloud model considers clouds which occupy 
the entire grid cell and have been "resolved" by the meteorological model.  The rate of change in 
pollutant concentrations ( m; ) due to cloud processes is given by: 

am; 
at  cld 

am; 
at 

subcld 

am; 
+-(cid:173)at 

rescld 

(11-1) 

'J]le terms 0.11 ... the right-hand side of Equation 11-1  are solved separately at different times.  The 
influence of sub-grid clouds are instituted once an hour while the resolved clouds impact 
concentrations every synchronization timestep.  Each subcomponent of the cloud model is . 
described in detail below. 

11-2 

11.2.1  Subgrid Convective Cloud Scheme 

om; 
Ot 

subc/d 

- f(mixing,scav,aqchem, wetdep) 

(11-2) 

The current sub-grid cloud scheme in CMAQ was derived from the diagnostic cloud model in 
RADM version 2.6 (Dennis et al.,  1993; Walcek and Taylor,  1986; Chang, et al.,  1987; Chang, et 
al.,  1990).  Seaman (1998) noted that most convective parameterizations are based on the 
assumption that "the area of an updraft is small compared to the area of the grid cell" and most 
parameterizations can be used at grid resolutions a small as  12 km (Wang and Seaman,  1997).  In 
CMAQ, subgrid clouds are considered only for horizontal grid resolutions on the order of 12 km 
or more.  Seaman (1998) also pointed to a study by Weisman et al.  (1997) that showed that 
explicit cloud models can resolve convection for resolution finer than 5 km.  Within CMAQ, for 
resolutions of 4 km or less, vertical convection is assumed to be resolved at the grid level; 
therefore, the resolved cloud model will be the only cloud scheme used at small grid scales. 

The effects of sub-grid clouds on grid-averaged concentrations are parameterized by modeling 
the mixing, scavenging, aqueous chemistry, and wet deposition of a "representative cloud" 
within the grid cell.  For all sub-grid clouds, a  I-hour lifetime (rc1d)  has been assumed.  Sub-grid 
clouds can be either precipitating or non-precipitating, and the non-precipitating subgrid clouds 
are further categorized as pure fair weather (PFW) clouds and non-precipitating clouds 
coexisting (CNP) with precipitating clouds. 

The subgrid cloud model determines if precipitating or nonprecipitating clouds exist over each 
grid cell.  Precipitating clouds are simulated when the meteorological preprocessor (currently the 
Mesoscale Model version 5 or  MM5, Grell et al.,  1994) indicates precipitation from its 
convective cloud model.  The CMAQ implementation differs from the RADM in that only the 
convective precipitation amounts from MM5 are used to drive the subgrid precipitating cloud. 
RADM used the total precipitation (convective and nonconvective precipitation) to drive the 
subgrid cloud model.  In CMAQ, the nonconvective precipitation is used in the resolved cloud 
model.  Nonprecipitating clouds are modeled if the moisture and temperature profiles support the 
development of a cloud (Dennis et al.,  1993).  Nonprecipitating clouds are modeled only when 
the relative humidity of the source level is above 70% and the calculated cloud base is below 
1500 m for PFW clouds or 3000 m for CNP clouds.  For both precipitating and nonprecipitating 
cloud types, the geometry of the cloud (base, top, and spatial extent) are determined next.  The 
cloud base is calculated by lifting a parcel of air from the cloud source level (the level between 
the surface and 650 mb with the highest equivalent potential temperature) to the lifting 
condensation level (LCL).  The cloud top calculation depends upon the cloud type and 
atmospheric stability.  For precipitating clouds in unstable conditions, the cloud top is found by 
following the moist adiabatic lapse rate from the cloud base up to the level where it becomes 
cooler than the surrounding environment.  For precipitating clouds under stable conditions, the 
cloud top is set as the first layer above the cloud base in which the relative humidity falls below 
65%, but limited to less than the 600 mb height.  For nonprecipitating clouds, further restrictions 
are placed on the cloud top.  The cloud top calculation for nonprecipitating clouds uses the same 
relative humidity criterion as the precipitating clouds, but the cloud top is allowed to extend up to 
500 mb for CNP clouds and only to  1500 m for PFW clouds.  If the atmosphere is unstable, the 
nonprecipitating cloud top may be reduced in height if the parcel method calculated a lower 
cloud top.  The fractional cloud coverage calculations depend on cloud type and have been 
described thoroughly by Dermis et al.  (1993).  For precipitating clouds, the model uses a 
parameterization similar to approach of Kuo (1974).  The fractional coverage parameterization 
for the nonprecipitating clouds is based on relative humidity. 

The convective cloud simulated by the sub-grid cloud model is considered to be composed of air 
transported vertically-from below the cloud, entrained from above the cloud (for precipitating 
clouds), and entrained from the sides of the cloud.  Concentrations of pollutants for each layer of 
th~ cloud are calculated by: 

-~ 
11'll 

(z) =  fent  (1 - fside )nu 

-~~ 

+  fside m; (z)  +  (1 - fent )m; 

-~ 

(11-3) 

[ 

-

J 

where f:ntle  is the fraction of entraining air originating from the side of the cloud.  For 
nonprecipitating clouds, no entrainment of air from above the cloud is allowed and therefore 
J;~=l.  The entraiii.ment,.feni• is calculated by iteratively solving conservation and 
thermodynamic equations (Dermis et al.,  1993; Chang et al,  1990,1987; and Walcek and Taylor, 

Ill'",, 

111111 

" 

~.  -·~ 

N 

represent the above and below cloud concentrations, 

1986).  The terms  m;  and  m; 
respectively.  Once the cloud volume has been determined, vertically-averaged cloud 
temperature, pressure, liquid water content, total water content, and pollutant concentrations, are 
computed with liquid water content (We)  as the weighting function (gives the most weight to the 
layers with the highest liquid water content).  Thus, the average pollutant concentrations within 
the cloud are calculated by: 

z<lDp J ;~Id (z)W,,(z)dz 

m:'d  = -'z'=""'~' - - - - (cid:173)
s~(z)dz 

Z~1op 

(11-4) 

With the averages over the cloud volume, the processes of scavenging, aqueous chemistry, and 
wet deposition are considered.  The final step in cloud mixing is the reapportioning of mass back 
into individual layers.  This is accomplished using cloud fractional coverage, initial in-cloud 
concentrations, final in-cloud concentration, and the initial vertical concentration profile.  For 
precipitating clouds, the average pollutant concentration for the grid cell within the cloud layers 
is computed by: 

(11-5) 

where cfrac is the fractional cloud coverage. There are variations on this equation for below 
cloud, above cloud, and for nonprecipitating clouds. 

11.2.1.1 

Scavenging and Wet Deposition 

Pollutant scavenging is calculated by two methods, depending upon whether the pollutant 
participates in the cloud water chemistry and on the liquid water content.  (1) For those pollutants 
that are absorbed into the cloud water and participate in the cloud chemistry (and provided that 
the liquid water content is> 0.01  g/m3), the amount of scavenging depends on Henry's law 
constants, dissociation constants, and cloud water pH.  (2) For pollutants which do not participate 
in aqueous chemistry (or for all water-soluble pollutants when the liquid water content is below 
0.01  g/m3), the model uses the Henry's Law equilibrium equation to calculate ending 
concentration and deposition amounts.  The rate of change for in-cloud concentrations (m/1
each pollutant (i) following the cloud timescale ('tcic0  is given by: 

") for 

-cld 
om; 

-cld( e-a,rcld  - lJ 

=m; 

'c1d 

scav 

(11-6) 

where Cl.;  is the scavenging coefficient for the pollutant.  For subgrid convective clouds, 'tcld is  1 
hour and for grid resolved clouds it is equal to the CMAQ's synchronization timestep.  For gases, 
the scavenging coefficient is given by: 

I 

(11-7) 

where H;  is the Henry's Law coefficient for the pollutant, TWF is the total water fraction given 
by: 

TWF=  PH20 

WTRT. 

11-5 

(11-8) 


11111111 

wtere PH2o  is the density of water,  w T  is the mean total water content (kg/m3
uipversal gas consfan. t, and Tis the in-cloud air temperature (K).  The WaShout tiine, ,;washout 
represents the amount of time required to remove all of the water from the cloud volume at the 
specified precipitation rate (Pr), 
and is given by: 

), R is the 

""" 

'"" 

(11-9) 

H~re, t:J.Zc:ra is the cloud thickness. 

1111111111

1
' 

The accumulation mode and coarse mode aerosols are assumed to be completely absorbed by the 
cloud and rain water.  Therefore, the scavenging coefficients for these two aerosol modes are 
simply a function of the washout time: 

1 
a,=--(cid:173)

"washou1 

(11-10) 

lh" 

The Aitken mode aerosols are treated as interstitial aerosol and are slowly absorbed into the 
cloud/rain water.  This process is discussed in detail in the aerosol chapter (Chapter 10). 

" 

' 

' 

' 

The wet deposition algorithms in CMAQ were taken from the RADM (Chang et al.,  1987).  In 
the current implementation, deposition is accumulated over 1-hour increments before being 
written to the output file.  The wet deposition amount of chemical species i (wdep,.)  depends upon 
th~ precipitation rate (Pr) and the cloud water concentration (mt11: 

11111 

·: 

:I" 

,,, 

wdep; =  f m;  P,.dt 

'rc1J-cld 

0 

(11-11) 

Deposition amounts are accumulated for each of the modeled species, but the user specified 
which species are written to the output file.  This is handled in the Program Control Processor 
(see Chapter fs).  ,,, 

11.2.1.2 

Aqueous Chemistry 

The aqueous chemistry model evolved from the original RADM inodel (Chang et al.,  1987; and 
\Va.leek and Taylor, 1986).  The model considers the absorption of chemical compounds into the 
c~.oud water; the amount that gas-phase species absorb into the cloud water depends on 
· 
thermodyrianlic equilibrium, while accumulation-mode aerosols are considered to have been the 
nucleation particles for cloud droplet forma,tion and are 100% absorbed into the cloud water. 
Then the model calculates the dissociation of compounds into ions, oxidation of S(IV) to S(VI), 
and wet deposition.  The species that participate in the aqueous chemistry are given in Table 11-

1"'1111· 

" 

111 

'II 

1.  This version of the aqueous chemistry model differs from  Walcek's scheme in that it tracks 
contributions from gases and aerosols separately.  It also considers the scavenging of interstitial 
aerosols, and it allows.for variable-length cloud time scales. 

· 

Table 11-1.  List of Species Considered in the Aqueous Chemistry Model 

EPA/600/R-99/030 

Gases 

S02 
HN03 

N10s 
C02 
NH3 
H202 
03 
formic acid 

methyl hydrogen peroxide 

peroxy acetic acid 

H2S04 

11.2.2  Resolved Cloud Scheme 

Aerosols 

S04 =  (Aitken &  accumulation) 
NH4 + (Aitken &  accumulation) 
NQ3- (Aitken, accumulation, &  coarse) 
Organics (Aitken &  accumulation) 

Primary (Aitken, accumulation, &  coarse) 

CaC03 
MgC03 
NaCl 

Fe3+ 

Mn2+ 

KCI 

Number (Aitken, accumulation, &  coarse) 

At any grid resolution, clouds may be resolved by the MM5, which could include stratus, 
cumulus, or cirrus type clouds.  The resolved clouds have been simulated by the MM5 to cover. 
the entire grid cell.  No additional cloud dynamics are considered in CMAQ for this cloud type 
since any convection and/or mixing would have been resolved and considered in the vertical 
wind fields provided by MM5.  A resolved cloud horizontally covers the entire grid cell and 

-cld 

. 

. 

and  m;  are equivalent in resolved 
vertically extends over the whole depth of the layer, thus  m; 
clouds.  These clouds are activated in MM5 when the humidity is high enough for water vapor to 
condense, and then MM5 computes cloud and tain water amounts according to any of several 
microphysical submodels.  Using the total of the condensed cloud water and rain water reported. 
. : 
by Ml\45, the CMAQ resolved cloud model then considers scavenging, aqueous chemistry, 'and 
wet deposition.  The average liquid water content  W c  in a model layer (z) for the resolved cloud 
is given by: 

. .  .  . 

.  ' 

.. 

.  . 

. 

. 

(11-12) 

where Qc(z) is the cloud water mixing ratio (kg/kg), Qn(z)  is the rain water mixing ratio (kg/kg), 
p(z)  is the air density (kg/m3).  Precipitation amounts for resolved cloud layers, P,(z), are derived 
using the MMS non-convective precipitation amounts (Rn),  apportioned into individual model 
layers with the vertical profile of condensed liquid water as follows: 

-

~(z)-Rn 

[  w:;(z)  ] 
() 
I~ z  dz 

(11:-13) 

Once quantities for precipitation rate, liquid water content, etc. have been calculated, then the 
scavenging, aqueous chemistry, and wet deposition are solved using the same procedures as in 
the subgrid clouds. 

Omi  ~  t3mi 
iJt 

rescld  = aLcav +a aqchem 

(11-14) 

Several assumptions have been made in the current implementation of the resolved cloud model. 
(1)  The lifetime of the resolved cloud computations varies based on the synchronization timestep 
0<1
,,(;MAQ.  (2~:,Fo!,!owing the method of operator splitting, the effect ~f the resolved clouds on 

pollutant concentrations occurs at the end of the cloud lifetime, thus no exchange between layers 
is permitted dming the cloud life-cycle.  (3) The pollutants, cloud water, and rain water are 
uniformly distributed within the grid cell.  Because of the separation of MM5 from CMAQ, we 
do not have the information to do precipitation fluxes.  Even if a complete cloud precipitation 
model was developed within CMAQ, there is no guarantee that it would be consistent with what 
was done in MMS. 

11.3  Conclusions 

One of the concepts for Models-3 was that multiple modules may exist for each physical process 
of the air quality model.  The implementation described here is the first module available for 
modeling cloud physics and chemistry.  Other subgrid cloud models (i.e., the Kain-Fritsch (1990, 
1993) and Betts-Miller (1986)) are under consideration and may be included as optional modules 
for CMAQ.  In addition, a more detailed resolved cloud model is under development which will 
include a microphysical submodel for following the evolution of the cloud (i.e., cloud droplet 
formation, growth ofrain droplets, and descent through model layers to the ground).  It will also 
cqpsider resoly~d~~oud lifetimes which extend beyond the C:MAQ synchronization timestep, 
thgs majntaiajpg the partition between gas and aqueous-phase pollutants during the gas-phase 
ch~mistry calculations.  The current implementation of the cloud model in CMAQ will be 
evaluated using available datasets and will be used as a reference for evaluating future cloud 
modules for CMAQ. 

11.4  References 

Betts, A.K. and M.J. Miller,  1986.  A new convective adjustment scheme.  Part II:  Single column 
tests using GA TE wave, BO MEX, A TEX, and arctic air- mass data sets.  Quarterly J.  Roy. 
Meteor.  Soc., 112, 693-709. 

Chang, J.S., R.A. Brost, LS.A. Isaksen, S.  Madronich, P.  Middleton, W.R.  Stockwell, and C.J. 
Walcek,  1987.  A three-dimensional Eulerian acid deposition model: Physical concepts and 
formation. J.  Geophys.  Res., 92,  14681-14700. 

Chang, J.S., P.B. Middleton, W.R. Stockwell, C.J. Walcek, J.E. Pleim, H.H. Lansford, F.S. 
Binkowski, S. Madronich, N.L.  Seaman, D.R.  Stauffer, D.  Byun, J.N. McHenry, P.J.  Samson, H. 
Hass.,  1990.  The regional acid deposition model and engineering model, Acidic Deposition: 
State of Science and Technology,  Report 4, National Acid Precipitation Assessment Program. 

Dennis, R.L., J.N. McHenry, W.R. Barchet, F.S. Binkowski, and D.W. Byun, 1993.  Correcting 
RAD M's sulfate underprediction: Discovery and correction of model errors and testing the 
corrections through comparisons against field data, Atmos.  Environ., 26A(6), 975-997. 

Grell, G.A., J.  Dudhia, and D.R. Stauffer,  1994.  A description of the fifth generation Penn 
State/NCAR mesoscale model (MM5).  NCAR Tech. Note NCAR/TN-398+STR,  138 pp. 

Kain, J.S. and J.M. Fritsch,  1990. A one-dimensional entraining/detraining plume model and its 
application in convective parameterization.  J.  Atmos. Sci, 47, 2784-2802. 

Kain, J.S. and J.M. Fritsch,  1993.  Convective parameterization for mesoscale models: The Kain(cid:173)
Fritsch scheme.  The  Representation of Cumulus Convection in Numerical Models,  Meteor. 
Monogr., 46, Amer. Meteor. Soc.,  165-170. 

Kuo, H.L.,  1974.  Further studies of the parameterization of the influence of cumulus convection 
on large-scale flow, J.  Atmos.  Sci., 31,  1232-1240. 

Seaman, N.L.,  1988. Meteorological Modeling for Air-Quality Assessments: A NARSTO 
Review Paper, Submitted to Atmos.  Environ. 

Walcek, C.J. and G.R. Taylor,  1986.  A theoretical method for computing vertical distributions 
of acidity and sulfate production within cumulus clouds, J.  Atmos.  Sci 43, 339-355. 

Wang, W.  and N.L.  Seaman,  1997.  A comparison study of convective par~eterization schemes 
in a mesoscale model. Mon.  Wea.  Rev., 125, 252-278. 

Weisman, L.M., W.C. Skamarock and J.B. Klemp,  1997.  The resolution dependence of 
explicitly modeled convective systems, Mon.  Wea.  Rev., 125, 527-548. 


Chapter  12 
================

METEOROLOGY-CHEMISTRY  INTERFACE  PROCESSOR  (MCIP)  FOR 

MODELS-3  COMMUNITY  MULTISCALE  AIR  QUALITY  (CMAQ)  MODELING 

SYSTEM 

Daewoo  W.  Byun·  and  Jonathan  E.  Pleim .. 

Atmospheric Modeling Division 

National Exposure Research Laboratory 
U.S. Environmental Protection Agency 

Research Triangle Park, NC 27711 

Ruen  Tai  Tang 
Dyntel Corporation 

Research Triangle Park, NC 27711 

Al  Bourgeois 

Lockheed Martin/U.S. EPA Scientific Visualization Center 

Research Triangle Park, NC 27711 

ABSTRACT 

The Meteorology-Chemistry Interface Processor (MCIP) links meteorological models such as 
l\.1M5 with the Chemical Transport Model (CTM) of the Models-3 Community Multiscale Air 
Quality (CMAQ) modeling system to provide a complete set of meteorological data needed for air 
quality simulations.  Because most meteorological models are not built ·for air quality modeling 
purpose, MCIP deals with issues related to data format translation, conversion of units of 
parameters, diagnostic estimations of parameters not provided, extraction of data for appropriate 
window domains, and reconstruction of meteorological data on different grid and layer structures. 
To support the multiscale generalized coordinate implementation of the CMAQ CTM, MCIP 
provides appropriate dynamic meteorological parameters to allow mass-consistent air quality 
computations. The current implementation of MCIP links l\.1M5 meteorological data to CMAQ 
CTM.  Because its code has a streamlined modular computational structure, adapting the system to 
other inputs only require inclusion of a reader module and coordinate related routines specific for 
the meteorological model. 

On assignment from the National Oceanic and Atmospheric Administration, U.S. Department of Commerce. 

Corresponding author address: Daewon W.  Byun, MD-80, Research Triangle Park, NC 27711.  E-mail: 
bdx@hpcc.epagov 

••On assignment from the National Oceanic and Atmospheric Administration, U.S. Department of Commerce. 


12.0  METEOROLOGY-CHEMISTRY  INTERFACE  PROCESSOR  (MCIP)  FOR 
~~~DE;,LS-~.,,,CQMMUNITY MULTISCALE  AIR  QUALITY  (CMAQ)  MODELING 
SYSTEM 

12 .1  Introduction 

" 

'"" 

, 

1 

:11111111 

" 

, 

"'' 

"' 

:w,111·.11

1111111'"11':1'' 

Models-3 Community Multiscale Air Quality (CMAQ) modeling system is a ~ext generation 
modeling system designed to handle research and application issues for multiscale (urban and 
regional) and multi-pollutant (oxidants, acid deposition, and particulates) air quality problems.  Its 
Chemical Transport Model (CTM) uses a generalized coordinate system.  To accommodate 
meteorological inputs from a variety of meteorological models using different coordinate systems, 
CMAQ CTM (CCTM) requires information about the coordinates and grid as well as the 
meteorological data.  The Meteorology-Chemistry Interface Processor (MCIP) links a 
meteorological model with CCTM to provide a complete set of meteorological data needed for air 
quality simulation.  Because most meteorological models are not built for air quality modeling 
purposes, MCIP cikes care of many issues related to data format translation, conversion of units of 
parameters, diagnostic estimations of parameters not provided, extraction of data for appropriate 
window domains, and reconstruction of meteorological data on different horizontal and vertical 
grid resolutions through interpolations as needed.  Considering these functions, it is not difficult to 
see that MCIP is a key processor in the Models-3 CMAQ system. 

In the Models-3 CMAQ system, the role of MCIP is further expanded to enforce consistency 
among the meteorological variables.  The consistency among meteorological parameters and the 
way they are utilized in a CTM greatly influence the success of air quality simulations.  This issue 
becomes a dominant concern for the CCTM, which uses a generalized coordinate system, because 
it should be able to deal with data from different meteorological models that may or may not use 
fully compressible formulations (or assumptions on the atmospheric dynamics such as hydrostatic 
or nonhydrostatic approximation).  Chapters 5 and 6 of this science document provide detailed 
descriptions on the generalized coordinate system. 

CMAQ's MCIP provides similar functions as the meteorological preprocessor for Regional Acid 
Deposition Model (RADM) (Chang et al., 1987,  1990).  MCIP' s code has a streamlined 
computational stri.icture, incorporating many of the physical and dynamical algorithms necessary to 
prepare meteorological inputs used by CMAQ.  Some of the planetary boundary layer (PBL) 
parameterizations are extensively updated subroutines of the RADM's meteorological preprocessor 
which was described in Byun and Dennis (1995).  MCIP is highly modularized to accommodate 
data from different meteorological models.  This versatility is accomplished by allowing 
incorporation of a different set of input modules for a specific meteorological model.  At present, 
two sets of input modules are available.  One links to the output of Pensylvania State 
'Oniversity/National Center for Atmospheric Research (PSU/NCAR) Mesoscale Modeling System 
Generation 5 (MM5) with CCTM and the other links to meteorological data already in the Models-3 
input/output applications programming interface (1/0 API) format.  MM5 can be run either in 
hydrostatic mode using a time dependent terrain-following hydrostatic pressure coordinate, or in 
nonhydrostatic mode using a time independent terrain-following reference pressure coordinate. 
For the details on how MM5 simulations are conducted and how the reference state is determined, 
refer to Seaman et al. (1995), Seaman and Stauffer (1993), Dudhia (1993), Grell et al. (1994), 
Stauffer and Seaman (1993), Tesche and McNally (1993), and Haagenson et al. ( 1994).  To 
characterize past atmospheric conditions properly, MM5 is usually run with Four Dimensional Data 
Assimilation (FDDA) for air quality simulations.  It incorporates the results of intensive 
meteorological observations into the model simulations so that the uncertainties associated with 
meteorological input for a CTM are minimized (Stauffer and Seaman, 1993; Seaman et al.,  1995). 
Different output data generated by the different options, such as dynamics cloud parameterization 
and surface-PBL algorithms used for the operation of MM5 operation, can be handled by MCIP 
accordingly. 

This chapter provides a detailed description of the functions and data flow of MCIP and 
formulations used for estimating parameters diagnostically.  Although this chapter mainly describes 
the current implementation of MCIP written for MM5, it also provides key information necessary 
to build different MCIP versions for other meteorological models.  It is hoped that developers of 
different MCIP versions can concentrate their efforts to read in data files from different 
meteorological models with minimal modifications for diagnostic routines and output processes. 
Section 12-1  describes basic functions and data dependency of MCIP.  Section 12-2 deals with 
meteorological data types, coordinates, and grids.  Section  12-3 contains descriptions of diagnostic 
algorithms used for estimating parameters necessary for air quality simulation and Section 12-4 
describes additional parameters needed for the generalized coordinate system.  Section 12-5 
provides key operational operational details, such as building and executing MCIP including how 
to set up grids/domains and environmental variables for different runtime options.  Refer to Figure 
12-1  for the structure of the contents of the present chapter. 

L 


111",I' 

" '   ' 

'111,.111' 

I',,," 

111111· 

FUNCI10NS 1 - - - - . i  

MCIP 

O""rvicw  (S<ctlcn  12.1) 

OPERA TIO 
(Sudan 12.5) 

MCIPModJlcs 
(Sution 12.5. /) 

Bulldl~ MCI' 
(Sudon 12.5.2) 

Providi'fl boundary 

layer paran<t<rs 
mb.tinxfrom or 
incunJlstt,. wllh 
mdeorolo&ical 

mal<I t>Jtput ( e.i;. 

PBLlwlsht, 

dtposilion  vtlocilia, 
cloud paramttrrs ) 

Dc6ni~ Grid& 

Dnm.iin 

(Sudan 12.5.4) 

1111,~,:" 

'111111111:, 

Figure 12-1.  Contents and Structure of Chapter 12 

• 

12.1.1 

M CIP  Functions 

One of MCIP' s functions is to translate meteorological parameters from the output of a mesoscale 
model (e.g., MMS) to the Models-3 1/0 API format (CoatS,  1996), which is required for 
operations of Models-3 CMAQ processors.  Some other necessary parameters not available from 
tfie meteorologicaf model are estimated with appropriate diagnostic algorithms in the program.  The 
~ey functions ofMCIP are summarized below. 

Readim:  in  meteorolo2ical  model  output  files: 

:li11'1:: 

.. 

. . . .   ,,,:,1111111111111 

'"11111111. 

. 

.... 

,•,, 

.. 

.. 

... 

... 

. 

. 

. 

The EPA-enhanced MM5 version (P\eim et al.,  1997) generates not only the standard MMS output 
but also several additional files that contain detailed PBL, cloud, and surface parameters.  MCIP 
reads these files and stores the information in the memory for further processing.  Essential header 
information is passed to the Models-31/0 API file header. 

111 

'

J:;f'traction  of meteorolo2ical  data  for  CTM  window  domain: 

In general, the CCTM uses a smaller computational domain than MMS.  Also, MMS predictions in 
th.~ cell.~ neru: .. ,,,,~e. ~,oun~~ may not be adequate for use in air quality simulation.  Therefore, MCIP 
extracts only the portion of the MMS output data which falls within the CCTM's main domain and 
boundary cells. 

Interpolation  of coarse  meteorological  model  output  for  finer  grid: 

When user requests meteorological data on a finer resolution grid than that simulated in the 
meteorological model, MCIP interpolates profile data using simple bilinear interpolation. 

Collapsing  of  meteorolot:ical  profile  data  if  coarse  vertical  resolution  data  is 
requested: 

MCIP performs a mass-weighted averaging of data in the vertical direction.  For example, 30-layer 
meteorological data may be lumped into  15 layers, or 6 layers for the CCTM. 

Computation  or  passing  through  surface  and  PBL  parameters: 

Depending on the user options, MCIP either passes through surface and PBL parameters simulated 
by the meteorology model directly or diagnoses them using the mean wind, temperature, and 
humidity profiles, surface data, and detailed landuse information available. 

Diagnosing  of  cloud  parameters: 

When important parameters needed for processing cloud effects in the CCTM are not provided by 
the meteorological model, MCIP diagnoses cloud information (i.e., cloud top, base, liquid water 
content, and coverage) using a simple convective parameterization.  The information can be used in 
the CCTM to process aqueous-phase chemistry and cloud mixing as well as to modulate photolysis 
rates that reflect the effects of cloud. 

-

Computation  of  species-specific  dry  deposition  velocities: 

MCIP computes dry deposition velocities for important gaseous species using either diagnosed 
PBL parameters or the surf ace/PBL information passed through from the meteorological model. 

Generation  of  coordinate  dependent  meteorolot:ical  data  for  the  generalized 
coordinate  CCTM  simulation: 

Many of the coordinate-related functions traditionally treated in a CTM have been incorporated as a 
part of the MCIP functions.  This change was necessary to maintain modularity of the CCTM 
regardless of the coordinates used and to eliminate many coordinate-dependent processor modules 
in the CCTM.  By incorporating dynamically consistent interpolation methods and associated 
subroutines in the CCTM, the dynamic and thermodynamic consistencies among the 
meteorological data can be maintained even after the temporal interpolations. 

Output  meteorological  data  in  Models-3  1/0  API  format: 

MCIP writes the bulk of its two- and three-dimensional meteorological and geophysical output data 
in a transportable binary format using the Models-3 input/output applications program interface 
(110 API) library. 

12.1.2 

MCIP's  Data  Dependency 

11111111111 

1 

'l11, 

•II"' 

MCIP processes meteorological model output files in order to provide environmental data needed 
for the other computational subsystems in Models-3 CMAQ.  Landuse data is also required to 
generate additional meteorological information needed for air quality simulations.  MCIP utilizes 
this and profiles of temperature, moisture, and wind components to estimate parameters for the 
turbulence and surface exchange characteristics.  When the meteorological model computes all the 
riecessafy information, it can be passed through the MCIP as well.  The inputs for MCIP consist of 
operational inputs and meteorological model output files.  These inputs are described below. 

111111i:::i1111 

''1111111' 

"'"' 

,1,' 

"" 

" 

" 

"' 

'" 

' 

' 

' 

" 

,1 

12.1.2.1 

Environmental  Variable  Inputs 

The user can select a computational path among the internal process options and define parameters 
in MCIP output files by specifying several UNIX environmental variables.  These settings allow 
~CIP to be c~pfigured to fit a particular meteorological model simulation and to follow process 
sfeps requested by the user.  First, it defines the mode of meteorological model run to check if the 
meteorology data linked have been generated using options compatible with the MCIP.  Then it 
assigns filenames of meteorology model output files, defines CTM model window domain offset 
coordinates in terms of the meteorological model grid definition, determines simulation time and 
duration of the MCIP, and assigns appropriate landuse data file typ~.  Refer to Section 12-5 and 
Table  l2~10 for the details of the UNIX environmental variables used in MCIP for these settings. 

111111 

11111111111'" 

I' 

'I 

' 

'• 

'II'" 

11 

12.1.2.2 

M~teorology Model  Outputs 

,, 
'I' 
11·, 
,,11,,111' 

I 

"'' 

'1,,, 

11111111 

"'111111""'" 

'lullllli, 

It is anticipated that MCIP will include a unique set of reader modules for a variety of 
tjjeteorological models.  Most of the idiosyncrasies of meteorological data from a specific 
meteorological model should be resolved in this module.  They include the number of files, 
foformation on the data such as where they are stored and in what format, etc.  In the following, 
we provide a description of the output files from MM5 as an example. 

" '  

"'"'"" 

"""""" 

' '  

"" 

" 

" 

'" 

' 

Standard  MMS  output 

~e s~d,~~,,,~,;? time-st~pped grid-domain output contains most of the key meteorological data 
written by the MM5 subroutine OUTI AP.  Each time-step includes a header record.  This header is 
read by MCIP at each time-step, but only the header from the first time-step is used and the 
subsequent headers are ignored.  Data following each header consist of two- and three-dimensional 
arrays.  The time-step interval for the meteorological data is taken from the header record on the 
f!~st time-step. 

EPA-added  MMS  output 

EPA and MCNC added two more output files for additional information to facilitate air quality 
modeling.  One includes additional two-dimensional boundary layer parameters and flux  values 
and the other contains the detailed Kain-Fritsch (Kain and Fritsch, 1993) cloud data file,  which 
describes locations and cloud lifetimes of convective clouds.  Currently, only the first file is used 
to process CMAQ dry deposition module options and the second file is not actively used because 
the CCTM does not yet support a corresponding aqueous-phase Kain-Fritsch cloud mixing 
module. 

12.1.2.3 

Landuse  Data 

MCIP requires landuse data that define surface characteristics in order to compute dry deposition 
velocities and other PBL parameters.  Depending on the PBL and dry deposition modules desired, 
the needs for landuse data vary.  The RADM dry deposition algorithm (Wesely,  1989) needs 11-
category fractional landuse data.  On the other hand, the new CMAQ deposition algorithm requires 
cell-averaged parameters defining surface exchange characteristics (i.e., landuse dependent 
parameters).  The latter algorithm assumes that the landuse dependent subgrid effects are processed 
in the meteorology modeling system.  To avoid incorrect averaging of the land-surface parameters, 
it distinguishes a dominant water cell from other landuse types. 

Table 12-1.  Relations Among MMS, CMAQ/RADM, and USGS Landuse Categories 

MMS  MMS  Category  MCIP 

CMAQ/RADM 

USGS 

USGS  Category 

I 
2 

3 

4 

5 

6 

7 
8 

Urban Land 
Agriculture Land 

Range-Grassland 

Deciduous Forest 

Coniferous  Forest 

Mixed  Forest/Wet 
Land 

Water 
Marsh or Wet Land 

I 
2 

3 

4 

5 

6 

7 
9 

Cate2ory 

Urban Land 
Agriculture 

Range 

Deciduous Forest 

Coniferous  Forest 

Mixed Forest and 
Wet Land 

Water 
Nonforest Wet 
Land 

9 
10 

Desert 
Tundra 

11 
8 

Rock,  Open Shrub 
Barren Land 

Permanent Ice 
Tropical  Forest 
Savannah 

11 
12 
13 

None 

7 
3* 
3 
10 

Water 
Range* 
Range 
Mixed 
Agriculture/Range 
Land 

1 
2 
3 
4 
7 
8 
9 
10 
12 
16 
13 
14 
17 
6 

15 
18 
19 

20 
21 
22 
23 
24 
25 
26 
27 

l· l 
5 

Urban/built  up 
Drv cropland &  pasture 
Irrigated cropland &  pasture 
Mixed  drvland/irrigated  pasture 
Grassland 
Shrubland 
Mixed  shrubland/grassland 
Chaparral 
Broadleaf deciduous forest 
Deciduous coniferous  forest 
Evergreen  coniferous  forest 
Sub alpine  forest 
Evergreen broadleaf 
Woodland/cropland  mosaic 

Mixed  forest 
Water 
Herbaceous 

Forested  wetlands 
Barren  or sparsely  vegetated 
Shrub &  brush tundra 
Herbaceous tundra 
Bare ground tundra 
Wet tundra 
mixed tundra 
Perennial  snowfields  or glaciers 

Savannah 
Grassland/cropland  mosaic 

* Mappmg ''Tropical Forest" to "Range" 1s not appropnate m most lo_cations. 

Currently, MCIP accepts four different types of landuse data.  Two types of landuse input (one 
from MM5 directly, or the other from TERRAIN, a preprocessor for MMS system) contain 13-
category data.  The third one is a preprocessed landuse data set in an ASCII file.  Recently, we 
added a landuse processor (LUPROC) for the USGS vegetation information (described below) to 
i11:1prove landuse data quality.  For the case of MMS, the percentages of MMS's 13  landuse 
category are transformed into the CMAQ/RADM's 11-category fractions in the landuse reader 
module. The USGS vegetation category is also transformed into the 11-category fractions.  Table 
12-1  provides the conversion rules for landuse types from MMS  13-category, and USGS 27 
(~ttp://edcwww.cr.usgs.gov/landdaac/glcc/ nadocl_l.html) category to CMAQ/RADM's 11-
category.  The USGS North America land cover characteristics data base has 1-km nominal spatial 
resolution and is based on 1-km A VHRR data spanning April  1992 through March 1993.  This 
data base has been adapted to the CMAQ' s base map projection which uses Lambert conformal 
projection with origins at latitude 40° N and longitude 90° W. 

""""'""'"'""" 

' 

' 

" 

'" 

"'""' 

" 

L,~nduse  P£pc~~sor CLUPRQC) 

'',11,, 

,11111' 

111! 

,, 

CMAQ' s Landuse Processor (LUPROC) is a special processor that provides a high-resolution 
landuse data base for the system.  MCIP requires landuse data that define surface characteristics to 
dompute dry deposition and other PBL parameters.  Depending on the PBL and dry deposition 
modules desired, the needs for the landuse data are somewhat different. 

LUPROC windows out the landuse data for the user-defined domain and converts percentages of 
27 vegetation categories in the database into the fractional landuse data in RADM's 11-category. 
The output of the LUPROC should have the same resolution as the CCTM domain and the 
LUPROC domain should include the boundary cells in addition to the CCTM's computational 
domain.  In the near future, MMS will be upgraded to allow use of the USGS land cover 
characteristic data as an option.  When the CMAQ dry deposition algorithm is used and necessary 
J?BL parameters are provided by the MMS directly, LUPROC will not be needed. 

12.1.3 

Computational  Structure 

'the MClp d~Ja flpw diagram, Figure 12-2, shows the key processing sequences.  First, MCIP 
executes the one-time processes such as:  reading the header, processing other operational 
information for the meteorological output, reading appropriate landuse data, and generating time 
il'ldependent MCIP output files.  Then, MCIP loops through the time stepped (hourly or sub(cid:173)
hourly depending on the meteorology data) input data from a meteorology model performing the 
functions described above.  The processing sequence of MCIP is summarized below: 

• 

• 
• 
• 
• 

1: 

I 

•'Ill 
Ill 

, 

"11 
1:,J:J 

.:!iii:. 

,, 

GETMET: reads and extracts meteorology data from standard MMS output for the CCTM 
window domain, converts variables into SI units and process special files (e.g., two(cid:173)
dimensional surface/PBL data and Kain-Fritsch cloud files); 
PBLPKG/PBLSUB: computes PBL parameters using diagnostic method if desired; 
BCLQPR~_AK: computes diagnostic convective cloud parameters if needed; 
SOLAR: computes solar radiation parameters; 
RADMDRY/M3DDEP: computes dry deposition velocities; and 
METCRO_OUT &  METDOT_OUT: computes additional meteorology data required for the 
generalized CTM, interpolates mean profile data into finer grid resolution if needed, and 
output Models-3 1/0 API meteorology files. 

START 

EPA/600/R-991030 

• read met. data 
• reconcile coordinate 

....---------. • unit adjustment 
.__ __ ___  __,  • process special files 

• horizontal inteq>olation 

(e.g., 20 met. &  cloud files) 

•  compute Jacobian, entropy, density 

GETLUSE 

GRID_OUT 

YES 

PBLPKG 

compute all PBL parameters 

PB LS UP 

supplement PBL parameters 

MET3DSUP 

'-----......-----'•complete met data 

NO 

RADMDRY 

M3DRY 

END 

Figure 12-2.  Flow Chart of MCIP Showing Key Data Processing Sequence. 


i ..... i. 2  Data  Types,  Coordinates,  and  Grids 
MCIP's essen'tial role is to provide consistent meteorological data f~r the CMAQ .modeling system. 
Therefore, it is very important to understand the vertical coordinate used in the meteorological 
modeling system.  For example, MM5 can be used either in hydrostatic mode, in which the 
hydrostatic pressure (time dependent) is used to define the terrain-influenced vertical coordinate, or 
in nonhydrostatic mode, where a reference hydrostatic pressure (time independent) in a normalized 
height form is used as the vertical coordinate.  Many parts of current MCIP code deal with these 
differences in the vertical coordinate specifically.  In the following we provide technical 
information related with coordinates and grids used in MCIP. 

I 
12.2.1 

' ' :M:~teorological Data  Types 

Many different combinations of approximations are used for describing the atmosphere in 
meteorological models.  Therefore, classification of MCIP output parameters based on detailed 
classification of vertical coordinate types (such as geometric height, pressure, terrain-following 
coordinates, etc.), and their application approximations (such as hydrostatic and nonhydrostatic), 
can be exceedingly complex for the CTM with generalized coordinate implementation.  Unlike 
previous use of detailed classification of meteorological coordinates for determining meteorological 
data type, we classify the coordinate types mainly based on the temporal dependency of the 
~H~obians (explained later).  The benefit of this distinction is obvious.  For example, a height 
coordinate which is time independent may require only a time constant file for describing the 
vertical coordinate while a dynamic pressure coordinate requires several parameters related with the 
coordinate description that needs to be stored in a time dependent file. 

1'"1, 

,11'111111. 

111111111111111111 

11"111111111" 

111111111,,::1' 

"11111111, 

"' 

'" 

,' 

' 

""' 

"' 

,, 

A similar distinction is made based on the need for describing data in different horizontal positions, 
such as flux-point data for horizontal wind components and cross-point for most other scalar 
parameters.  For MM5, two horizontal wind components are defined at so-called 'dot' points while 
all other scalar values are at 'cross' points, following Arakawa-£ grid definition.  Refer to Figure 
12-3 for the definitions of Arakawa C-grid and E-grid (Mesinger and Arakawa,  1976).  For the 
CCTM, certain flux data are defined on the Arakawa C-grid in which the flux points are not 
collocated in  £ 1 
- and £ 2 -directions.  Therefore, MCIP interpolates MM5' s dot-point wind 
components linearly and multiplies the result with the two-point averaged density to provide the 
flux-point momentum component data.  Both the flux-point and dot point data require array sizes 
larger than the cross-point data by one cell in each horizontal direction. 

111,:1111:,,,,, 

:lh 

llll' 

'II 

'' 

CMAQ utilizes contravariant wind components, instead of the regular wind components, to advect 
tracer species.  Figure 12-4 shows that the east-west component of the contravariant wind field,  u , . 
is placed at the x1 -direction flux points (marked with the square symbol) and the north-south ( .x2-
direction) component of the contra variant wind field,  v, is placed at the  .X2 -direction flux points 
(marked with the triangle symbol).  The vertical wind component is defined at the full-layer height. 

The Models-3 I/O API requires individual data components to have exactly the same temporal and 
spatial dimensions in a file.  Because the flux-point data and dot-point data both need additional 
column or row positions, we can combine them together in a so-called DOT file, which is larger 
than the CRO file by one cell for each horizontal direction.  It is important to note that because the 

12-10 

flux points are different from the dot-points, they must be shifted by a half cell east or north 
(depending on whether they are square-point or triangle-point flux values) for graphical 
visualization of the flux-point parameters. 

EPN600/R-991030 

Figure 12-3.  Two Different Grid Point Definitions, Arakawa C- and B-grids, Used in MCIP. 
u and v are horizontal wind components, s represents a scalar quantity, and pis density of air.  For 
MM5,  p •  is used instead of p. 

( 
/$· ....  , .....  1  ...... 

,..., 
I 

I 

. / 

/ 

¥-- --:::._  -1 _-L·~ 

·-1 

" 

....... .-

........... 

····~·  ........ . 
,,.· 

/ 

:  / 
/ 

l-112 

- - - - - - - - - - - - - - - -

l+l/2 

k+l/2 

k 

A2 x 
~ 

k-112// 

m+l/2 
/ 

/ 

/ 

/ 

/ 

/ 
Al 
•  x 

Figure 12-4.  Computational Grid Points and Corresponding Indices Used in MCIP. 
Markers are for dot points (e), cross points ( X), x-direction flux points (0), y-direction flux 
points (.0.), and vertical cross point at layer interface ( ®). 

12-11 

'':,, 

~p A/600/R-99fP30 

:111,,, 

:I. 

,,  ' I ~ 
,, ~ 
illl'"' 

, 

11 I ' 

Furthermore, when these two flux components are assigned to form vectors ·in a visualization 
program like PA VE (Thorpe,  1996), the starting points of the vectors in the visualization are 
relocated at the dot-points although the two components are actually not collocated there. 

' 

• 

• 

11:1' 

' 

.::::,,1111:: 

.. ,,,111111111''·11• 

Data for the boundary cells are defined with a special 1/0 API boundary data type.  Depending on 
tpe need to d~scril:>e boundary mass flux accurately, one may want to have a boundary domain with 
NTHIK cells (see Figure 12-5).  The boundary grid is  represented as the external perimeter to the 
main grid. This perimeter is NTHIK cells wide (where you may use a negative NTHIK to indicate 
an internal perimeter as used by such air quality modeling systems ROM and RADM).  The 
boundary array is dimensioned in terms of the sizes of the arrays surrounding the main domain. 
Current Models-3CMAQ system uses NTHIK=l  throughout ttie system components. 

""""' 

"'"' 

' 

"' 

"""'' 

,, 

' 

"'" 

•" 

• 

11111' 

' 

).  Vertical wind component and flux values are examples of the full-layer 

Finally, the dimensionality of the parameters (i.e., whether they contain three-dimensional or two(cid:173)
dimensional information) is used to distinguish the data type of meteorological parameters.  In 
vertical direction, we define half and full layer positions based on the values of the generalized 
vertical coordinate, ( .£3 
parameters.  Although full-layer data require one more data point vertically, often the flux  values at 
the bottom boundary (i.e., at the lowest full-layer) are zero.  Therefore, we do not need to use 
additional data types for these, as lorig as we save the non-zero lowest full-layer data in a 
corresponding two-dimensional data type file separately. (Refer to Table 12-2 for dimensions used 
for each grid points.)  Because a file represents a set of data with the same data type (with only a 
few exceptions) in the Models-3 system, locating meteorological parameters from an appropriate 
r7b API file fs relatively easy.  Table 12-3 summarizes the possible data types for the  ····· 
meteorological parameters.  Depending on the choice of coordinates and grids, some of data types 
may not be relevant.  For example, the current version of MCIP does not use GRID _DOT _3D and 
MET_DOT_2D data types.  Appendix 12A provides the list of MCIP output parameters in each 
data file. 

· 

i" 

I 

"I,' 

12-12 

NTHIK 

-

~ 

-
-

61 

62 

63 

64 

49 

50 

51 

52 

95 

96 

65166167168169170  I 11 

~oundary Component-N 
53 
57 

54 

56 

55 

58 

59 

h 

MAIN GRID (NCOLS, NROWS) = (10,10) 

)X 

& 

~ 

-

~·coLs 

~ 
0 
~ 

-
-

EPA/600/R-991030 

k~  I • ~ 

.;; 
f 

0 

y(l4) 

~ 
~ 
0 

f 

r(l2) 

r(l l) 

y(l3) 

r(lO) 

y(l2) 

48 

46 

44 

42 

r(9) 

y(l l) 

72 

60 

47 

45 

43 

41 

39 

40 
t:=-
= 
37  §  38 
c..-
35  ~ 36 
n -= 
33  a  34 
~ =-
= 
31  ~  32 
..... 
~-
30 
-

29 

27 

28 

26 

r(8) 

y(IO) 

r(7) 

y(9) 

r(6) 

y(8) 

r(5) 

y(7) 

r(4) 

y(6) 

r(3) 

y(5) 

r(2) 

y(4) 

r(l) 

y(3) 

... 

~ 

(/) 

~ * <:;! 
~ 
~ 
~ 
>< 
u:i, 
(/) 

~ 

94 

93 

-91  ~ 92 
.... 
-5 
89  !  90 
-E' 
87  8  88 
7s~ 86 
-§  
83  ~ 84 

81 

79 

77 

75 

73 

82 

80 

78 

76 

74 

,, 

x(l) 

1~ 

(XORIG, YORIG) 

,  r 

25 

13 

I 

14 

2 

15 

16 

17 

18 

19 

20 

21 

uOUD lary Component-S 

3  I  4  I  5  I  6  I  1  I  8  I 9 

22 

23 

24 

r(O) 

y(2) 

10 

II 

12 

r(-1) 

y(l) 

c(-1) 

c(O) 

c(l) 

c(2) 

c(3) 

c(4) 

c(5) 

c(6) 

c(7) 

c(8) 

c(9) 

c(lO)  c(l l)  c(l2)  =NCOLS+NTHlK 

x(2) 

x(3) 

x(4) 

x(5) 

x(6) 

x(7) 

x(8) 

x(9) 

x(lO)  x(l l)  x(l2)  x(13)  x(l4) =NCOLS+2*NTHlK 

NCOLS_EXT =NCOLS+2*NTHIK 

~1 

Note: Individual boundary component grids are treated as a 1/0 API 2-D file 
S(l:NCOLS+NTffiK, 1-NTHIK:O) 
E(NCOLS+ 1 :NCOLS+NTHIK, 1 :NROWS+NTHIK) 
N(l-NTHIK:NCOLS, NROWS+ I :NROWS+NTHIK) 
W(l-NTHIK:O, 1-NTHIK:NROWS) 

Figure 12-5.  Grid Data Structure for Models-3/CMAQ Showing Main Grid and Boundary 
Components.  Here NTHIK=2, NCOLS=IO, NROWS=10 are used for the illustration. 

12-13 

WA1600IR-99t()30  . 

Table 12-2.  Dimensions and Indices for Grid Points used in MCIP and CCTM 

Dot-Point 

Cross-Point 

(start: end) 

(start:  end) 

dimension 

dimension 

index 

index 

,... 
x  -
direction 
Flux Point 

x2 -direction  Full-Layer  Half-Layer 
Flux Point 

(start:  end) 

(start:  end) 

dimension 

dimension 

index 

NIA 

index 

NIA 

(l:NCOLS+l) 

(l:NCOLS) 

(l:NCOLS+l) 

(l:NCOLS) 

NCOLS+l 

NCOl..S 

NCOLS+I 

NCO LS 

/±112 

I 

/±112 

l 

(l:NROWS+I) 

(l:NROWS) 

(I: !\'ROWS) 

(I: NROWS + 1) 

NIA 

NIA 

NROWS+l 

NROWS 

NROWS 

NROWS+l 

m±ll2 

NIA 

m 

NIA 

m 
NIA 

m±ll2 

NIA 

(O:NLAYS) 

(l:NLAYS) 

NLAYS+I 

NLAYS 

k± 112 

k 

xi 

.x2 

.x3 

11 

''I' 

1111111 

' 

II' 

Table 12-3.  Classification of Meteorological Data Types in the CMAQ System. 
Q.ata types GRID_DOT_3D and MET_DOT_2D (in gray color) are not used in CMAQ currently . 

1111111111,,,,:11, 

" 1 

•" 

"11 

:111;,,,, 

:111111111 

'1' 

11

,.11

•1 

II 

" 

'" 

"' 

" 

'Ill' 

1111 
111 "!1

' 

1 

11,,:I 

1
""" 

' 

'ii:::::: 

i'I"  I 

:·•  111111!111,J 

.. '' ..• i111lii 

''i' .... 
Time Independent 

,,  ,,,,''·,,,• 

''" 

', 

11 ~ : 

" 

l'h 

,, 

'I 

millll .. 

, 

Time Dependent 

GRID_CR0_2D 
GRID_DOT_2D 
GRID_BDY_2D 

GRID_CR0_3D 
GRID_ DOT_ 3D 
GRID_BDY _3D 

MET_CR0_2D 
MET_DOT_2D 
MET_BDY_2D 

MET_CR0_3D 
MEf_DOT_3D 
MET_BDY_3D 

12.2.2 

12.2.2.1 

Horizontal  Coordinates  and  Grid 

MCIP can be configured with horizontal coordinates based on conformal map projections, such as 
Lambert Conformal, Polar Sterographic, and Mercator.  Table 12-4 summarizes the necessary 
information for the description of the conformal map projections as defined in Models-3 1/0 APL 
To generate 1/0 API files, which require exact definitions of the grid and coordinate system, users 
need to provide all the necessary map projection information in addition to ve1tical coordinate and 
layering definitions.  The Models-3 CMAQ system uses square cells for the horizontal grid 
representation.  A modeling domain is defined with the integer multiples of the square cells in E-W 
CS?lu~-:--Vi~,~) ~.? ~-S ~,row-w~~e) dir~.~tions.  Although a rectangular cell shape can be handled 
by the 1/0 API, the fractional time splitting approach used for the modularization of CTM 
processes requires use of square grid to maintain the accuracy of the finite differencing algorithms 
consistently.  The effect of different horizontal coordinate is reflected in the values of the map scale 

12-14 

factor.  Because of the need to couple the map scale factor (m) with other state variables and wind 
components, MCIP provides map scale factor for both the dot- and cross-points. 

Table 12-4.  Map Scale Factors and Parameters Defining Horizontal Coordinates in Models-3 I/O 
API (Coats,  1996) 

EPA/600/R-991030 

Map Parameters 

Map Scale (m) 

Note 

NIA 
m=l 

m= sin(ir/2-¢,)[ l'ilil(tr/4-¢/2} J (X 1cent,X2cent) = (A0 ,</J,,) 

sin(tr/2-¢)  tan(tr/4-¢1/2) 

Coordinate 

lat.-long. 

ID in 
Models-3 
1/0 API 
LATGRD3=1 

Lambert 

LAMGRD3=2 

Mercator 

MERGRD3=3 

Stereo-
graphic 

STEGRD3=4 

UfM 

UTMGRD3=5 

NIA 

0

Pa  = "'· ~ IP  =  l/J2 
two  latitudes  that 
determine the 
projection  cone. 
P,,  =  A,
,  central 
meridian 
P,.  = tPo•  Pp= ./to: 
latitude  longitude of 
coordinate  origin 
within  the  tangent 
circle. 
P,, : angle  between 
cylinder axis  and  the 
North  polar  axis 
Pa=l/Jo•  Pp=Jlo;_ 
latitude and  longitude 
of the  point  of 
tangency. 
P,.:  angle from  true 
north  to  .X2-axis 
Pa  is the UTM  zone 

PP' pr  not used 

n =In[ sin(tr/2-¢,)] 

sin(tr/2-¢1) 

·[in( tan(ir/4-¢,/2) JT 

tan(tr/4-1/1112) 

cos¢. 
m=--
costfl 

I +sin¢. 
m=--
l+sin¢ 

m=l 

(i1 ,i2 )=(long,lat)  are  in 
degrees 

for the center of 
coordinate  system. 
(i1 ,i2 )are in meters 

) 

(x 1cen1,X2cen1) =  (A0 ,¢0
for the center of 
coordinate  system. 
(.i 1 ,.i2 )are in  meters 

(X 1cen1,X2cen1) = (A0 ,</J0
for the center of 
coordinate  system. 
(.i 1 ,i2 )are in  meters 

) 

cl 

.... 2 

) 

X  cent, X  cent  are offset 
from the UTM coordinate 
origin. 
(.i 1,i2 )are in meters 

12.2.2.2 

Vertical  Coordinates  and  Grid 

The Models-3 CMAQ system allows many popular vertical coordinates used in meteorological 
models.  We expect that the Models-3 I/O API will be extended to include several other vertical 
coordinates.  The I/O API follows the definitions of vertical coordinates as used in meteorological 
models.  However, in CMAQ the vertical coordinates are redefined to increase monotonically with 
height.  This precaution is needed because the CMAQ code is expected to handle generalized 
coordinate system.  We found that this constraint in the vertical coordinate is extremely useful for 
the implementation of CTM in the generalized coordinate system by removing possible sign errors 
wherever vertical differentiations are involved.  For example, the Jacobian information for a 
c:oordinate can be directly used to replace some of the derivatives involved with the generalized 
vertical coordinate.  This internal change does not require redefinition of the vertical coordinates in 
the MCIP output files.  The impact of this constraint is limited to an include file that defines the 
coordinates <llld vertical layers.  In a typical Models-3 operation, this include file is automatically 
generated by the system framework through the use of the coordinate/grid manager.  In the 
{gllowing two typical application examples are presented; one for the time dependent coordinate 
and the other for time independent coordinate. 

Time  dependent  hydrostatic  sii:ma-pressure  coordinate 

For the MMS system, this coordinate is used when the hydrostatic option is chosen.  In general, 
qiis ~09rqin~!~ C:.!!!l  be U$ed not only for the hydrostatic atmosphere simulations but also for 
n()nhydrostat~c cases.  For example, when a regional scale hydrostatic meteorological model 
~:tovides hydrostatic values, the same coordinate can be used in a nonhydrostatic nested model as 
described by Jaung (1992).  In MCIP implementation, we should view this coordinate as an 
example of processing meteorological data with a dynamic vertical coordinate definition rather than 
an example of a hydrostatic coordinate. 

The CCTM utilizes a generalized coordinate system that allows construction of the vertical layering 
consistent with the meteorological coordinate used.  However, to maintain the vertical coordinate 
definition monotonically increasing with height, the coordinate definition for the CCTM has been 
modified as: 

_x::i  = ~ = l _ Ci_  ;  Ci_  =  P - Pr  _  P - Pr 
Ps - Pr  - P0 

P 

P 

(12-1) 

, x3

, .X2

where  p(x1
, t)  is the hydrostatic pressure,  Pr  is the pressure at the model top which is  held 
~onstant, Ps(x1 ,x2 ,t) is the surface pressure, and  'j/ = Ps - PT.  Be~~use th~ pressure used in the 
definition of the vertical coordinate is in hydrostatic balance, we have: 

i,,,1 

- ' 
ap 
-=-pg 
(k 

The Jacobian is then defined as: 

,11 

1'::11

1 

(12-2) 

(12-3) 

and it is time dependent because the surface pressure and air density are time dependent. 

Time  independent  reference  hydrostatic  siema-pressure  coordinate 

In MMS this coordinate is specifically used for the simulation of the nonhydrostatic atmosphere. 
J'he layer structure is entirely different from the case when hydrostatic option is used.  The 
coordinates defined with this option are time independent and have very similar characteristic to 
those of the normalized geometric height coordinates.  The only difference is that the vertical layer 
thickness is defined with a nonlinear function of the geometric height.  Here, we should view this 
coordinate as an example of processing meteorological data with time independent vertical 
coordinate. 

The terrain-following reference hydrostatic pressure ( <J' Po  )  coordinate, again in a monotonically 
increasing form,  is given as: 

(12-4) 

where  p 0 (x 1 ,x2 ,x3
the model top,  p 0,,(x1 ,x2
height  z .. , and  p; =Pus - PT' 

)  is the hydrostatic pressure of the reference atmosphere,  PT  is the pressure at 
)  is the reference surface pressure which is detennined by the topographic 

Because the reference atmosphere is in hydrostatic balance, we have: 

The Jacobian is then defined as: 

(12-5) 

(12-6) 

and it is time independent because it is a function of the time-independent surface pressure and the 
density of the reference atmosphere.  Here, the vertical coordinate z represents a height above the 
lowest point in a modeling domain, or the mean sea level (MSL) height if there is no place lower 
than the MSL.  Usually, this type of vertical coordinate accompanies with a simple description of 
reference temperature profile of the base state.  For example, in MM5 the base temperature profile 
is defined with a simple expression: 

T,,(z) = T,,,,  + Aln(p0 (z)J 

Poo 

(12-7) 

where the reference values are chosen such that T,,,,  is a sea level reference temperature in K,  p 00 = 
1000 mb =  105 Pascal, and A, which is set to be 50 K, is a measure of atmospheric lapse rate 
represented in temperature difference for the e-folding depth.  With Equations  12-5 and  12-7 and 
the Equation of State, we could relate the reference pressure in terms of height z in a differential 
equation: 

dlnp,(z) = _..[ 

1 

dz 

R  [7;,s-Aln(p00 )]+Aln(p0 (z)) 

(12-8) 

which can be readily solved for  p0 (z)  by the separation-of-variables technique.  The solution is a 
q~adratic equation in terms of In p 0 •  For typical tropospheric conditions, the base pressure can be 
related with the geometric height by taking the positive square root term: 

p 0  z  =exp 
[

() 
. 

-b+"1b2 -2Ac] 

A 

(12-9) 

Equation  12-9 shows thatp0 (z)  is a monotonic, but nonlinear, function of z. 

12.2.3 

Modification  of  Grid  Structure 

In CMAQ, the horizontal and vertical coordinate information (such as the map projection 
parameters) for CTM simulation domains are required to be exactly the same as (or a derivative of) 
the master coordinates used in the meteorological model simulation.  However, the horizontal grid 
structures of the CTM domains can be redefined depending on the need for air quality simulations. 
Here, the concept of grid family is introduced.  It is as a set of grid domain specifications with the 
following properties: 

1. 
2. 
3. 

the same coordinate origin and map projection; 
a window domain for the parent domain; or 
a nest (multi-stage) domain from a window or the parent domain. 

The Models-3 I/O API file header helps to describe the horizontal grid and coordinates 
unambiguously to position the background map correctly and to provide relations among the 
members (multi-stage nesting domains) of the grid family.  Only with a limited manner, the user is 
allowed to modify the grids in the vertical directions because of the concern that ad hoc 
interpolation may destroy the integrity of the meteorological data. 

12.2.3.1  Windowing 

The windowing functions in MCIP extract MM5 output for a CCTM window domain.  As a rule of 
thumb, a CCTM uses a smaller computational domain than the domain used by meteorological 
models, because predictions in the cells near the boundaries may not be suitable for use in air 
quality simulation.  Therefore, MCIP extracts only the portion of the MM5 output data which falls 
within the CTM' s main domain and boundary cells.  The CTM domain should be located at least 
four or five cells inside the MM5 domain to minimize the boundary effects.  MCIP can, however, 
generate output for the CMAQ domain as large as 2 cells smaller than the meteorology domain, 
because it generates files for the boundary cells with NTHIK=l.  (Note in MM5 terminology, it 
may seem like the CMAQ domain is smaller by three because a DOT point concept is used in MM5 
system for the grid definition.) 

Limitation on the number of horizontal cells (to 120 cells) of the meteorology grid is coming from 
the MCIP's parameters defined in MCIPPARM.EXT: 

PARAMETER  (  MAXI 
& 

=  120, 
MAXJ  = 120  ) 

MET  domain  size  in  N-S  dir. 
MET  domain  size  in  E-W  dir. 

When the meteorology data has larger dimensions, MAXI and MAXJ should be modified 
accordingly.  Also, there coulcJ be some limitations with reader routines specific for meteorology 
models.  Because these reader modules are essentially foreign codes, there is no easy way to 
generalize the input process of the meteorological data.  Refer to Figure 12-6, which shows the 
relation among the meteorology domain, the window domain for meteorological data extraction, 
and the CTM main and boundary domains. 

12-19 

Relations am0ng MM grid, extented-CTM~ grid, ~d CTM grid for NDX::J 

-~""'==~-~=---~ 

,!g 
§ 
~ I 
\0 
\0 
,Cs 
,1.>J 
0 

l=MAXLMM 

x 

! 
l 
!X 
I 
Ii_  L. 
--!1- -1---~- -,- .. 
x I 

x 

I 

--

x 

1----

-

--~-x_.__ 

I 

! 

I 

! 
i 
! X 

i 

• 
; 
X 

I 
.  I 

I 
I 

I 
I 
I xi 

I 

I 
x: 
! 

1 
x: 
! 
I 

I 

! 

I 

x 

x:  I  Xi 
I 
i 
i --1-·11  : 

-··.-

--·-

I 
t 

' 

-

)( 

DXL.._ 

X  IX 

X: 
I 

-~-1'- x 

~trri~ 
x i x 
)(  ! x 

l 
I" 
-1---- ~ 
x I 

'x. I I 
i.-~x~ 
I 
-~  i'~ ;. "_ _ ~ ~X ~-x- --~-\-?<t_x _ ~~~- - --1 ~-~+~+-. 
-~--r.  . 
I 
~I  I 
_j_x_, ___ ~e-.~-!--~1.  ·_1xJ·_  :J:< __  ._  -·~x~_x ___ x __ \_x_\ _ _:__~_x _____ 
i_x-'--. _ ~-\--
1
I 
, 
I 
' 
: 
: 
I x 
J-~-- -- ----'----· 
_J  x; 

xx   x  xlx\x  x;x!x  ><;x 
x1x1x  xix  x  X!><  xfx  x  X 1 x  ><  x:xlx  xx 

•Jxlx  x!x;x  xjx;x  >e;x1x  x;x 
)(  x  x  x  x  x 
-- -
·  x 
x 

_J_ __  ----!:._.  - ~~-'----
x : •  • : x  •  • ; x:  •  •  x 

• 
x  x~x  xx   x 

•(XCENTYCEN'l)=(OO)'  • 

xx   xjx 

'  . 

><jx:x 

---
___ 

j 
t '  
I 

-...;-.-----

---

I 

I 

><I 

i 
I 
-

i 

I 
I 

x 

I 
• 

I 

I 

: 

' 

• 

>< 

I 

• 

! 

I 

j 

T 

x 

x 

' 
I 

1 

l 

! 

X 

>e 

I 

1 

I 
• 

>C 

I 

' 

. 
I 
j 

' 

1 

: 

I 

I 

1 

I 
~  I 
' 
I 
! x 1 __ 
I  1 

-·- - -+- ----~- --·----- ---~-
! x ,_ 
; 
I 

- x 

I 

• 

I 

. 

-·--x-- --- -· >c-:---

I 

x 

,._ ____ .__....__1 

--- --

:E 
:E, 
0 
§ 
;.-. 

I=l 

S::-'--1-----'--~-'-~--i------i--EXTENDED CTM DOMA 

(XORIG_.X. YORIG_X) 

I 

--

\-
' 

x  : 

x 

·X 

J=I 

J 

-- - - ·- x 

XORIG_MM 

\ 

~L --.J~-

' 
I 
I 

x  ~,pox  x 

x 

'.  x 

-;;- !-x ·--.- -~-;-x- -• ·I  .-:-x-~--;;  ·-;'.·-x- --- ---~-;,+-·--

>< 

x 

x 

• 

( 

I 
I 

: 

WINDOW DOMAIN 

I 

··  -

- ----

---- • -
I 
-1- -·-~----
;_x_  t -· ____ '. _~.;.  -

x. 

' 

·-

! 
1_x t 

I 
I 

I 

I 

\ 

--·r·-x-'.·----
' 
-- · ··  ;-
I 
-
' 
----1-
---r' .?< __ ,_ 

MM DOMAJN----1 
J=MAXJ_.MM 

' 

(XORIG_MM. YORIG_MM) 

Figure 6.  Relations among the meteorology domain, window domain for data extraction, 

and CTM's main and boundary domains. 

,_ 
N 
I 
~ 

~ 

12.2.3.2  Horizontal  Interpolation 

A horizontal interpolation function is provided to help users generate higher resolution data than the 
input meteorological data.  This function is used when higher resolution emissions data is available 
but the detailed variations in meteorological fields can be neglected.  This option is useful only 
when the surface and PBL parameters are diagnosed in MCIP.  If interpolation is desired, NDX 
(defined in MCIPPARM.EXT) must be modified before the MCIP is compiled so that data arrays 
are dimensioned properly.  When interpolation is desired, MCIP copies contiguous grid cell values 
from the coarse grid to the fine grid and then performs a two-dimensional bilinear interpolation on 
the three-dimensional data.  The interpolated temperature profile is updated using fine resolution 
landuse data to reflect land-sea boundaries in the profile appropriately.  The interpolated 
temperature, moisture, and wind components profiles, together with the detailed landuse data, are 
used to estimate surface and PBL parameters for the finer resolution.  The user should be reminded 
that this procedure generates higher resolution meteorological data without enhanced physics, thus 
the newly generated data may have consistency problems.  Therefore, such interpolation should be 
used sparingly for cases such as testing higher resolution emissions data with a finer resolution 
CTM.  The procedure is never meant to replace or minimize the need for higher resolution 
meteorological model runs.  It should be noted that the interpolated temperature and moisture 
profiles result in different estimations of cloud parameters (such as cloud bottom and top heights, 
fractions, liquid water contents) as determined by the diagnostic Anthes-Kuo cloud routine. 

12.2.3.3 

Vertical  Layer  Collapsing 

A vertical collapsing function is supplied to generate a smaller data set for testing CTM in a smaller 
computer system.  If desired, MCIP collapses MMS profile data for the coarse vertical resolution 
data as defined by the user.  MCIP performs a mass-weighted averaging of data in the vertical 
direction.  For example, 30-layer MMS data may be averaged into 15 or 6 CTM layers.  During the 
collapsing procedure, the layer description is modified accordingly.  The resulting profile may have 
consistency problems.  This option is usually used to generate meteorology data for a system test(cid:173)
run for code debugging and development purposes.  It is also appropriate to study the effects of the 
vertical resolution in air quality simulation such as presented in Byun and Dennis ( 1995).  Refer to 
Table 12-5 as an example for the layer collapsing. 

Defining the vertical layering structure for the CMAQ system requires consideration of several 
factors.  Depending on the layer definitions used, the model results will be affected considerably. 
The implications of the layer definition are pervading across the entire system.  For example, to 
determine mass exchange between the boundary layer and free troposphere, a good resolution near 
the boundary layer top is preferable.  Also, different cloud parameterizations may perform 
differently, depending on the layering structure.  Aerodynamic resistance, which influences dry 
deposition velocities, is a function of layer thickness and the boundary layer stability.  For 
emissions processing, the layer thickness affects the plume rises from major stacks.  Also, the 
vertical extent of the area emission effects is limited by the thickness of the lowest model layer for 
the CCTM.  Although 6-layer vertical grid definition is provided with the tutorial simulation 
ex~ples, we do not recommend it to be used for regulatory applications because of the difficulties 
in simulating certain processes, such as dry deposition under stable atmospheric conditions. 

Current limitation on the number of vertical layers to 30 comes from one of the MCIP' s parameters 
defined in MCIPP ARM.EXT: 

PARAMETER  (  MAXK 

=  30 

!  MET  number  of  layers 

When a meteorological data has more number of layers, the parameter MAXK should be increased 
ac'cordlngly.  Collapsfr1g is done automatically when the COORD.EXT file (see Models-3 CMAQ 
User's Guide for the details) for the output grid has smaller number of layers than the input grid. 

'11111"''" 

'I' 

I 

'' 

'" 

'I, 

'I 

, 

"I" 

•I 

''l'I 

'I 

Table 12-5.  An example of layer collapsing from  15 to 6 er-layers.  Full and half er-levels and standard 
heights are provided to show relations between the two vertical grid systems. (adapted from Byun and 
D~nnis, 1995) 

Level 

Index(15) 

Level 

Index(6) 

er-Level 

Full (15)  Half (15) 

15 

14 

13 

12 

11 

10 

9 

8 

7 

6 

5 

4 

3 

2 

1 

0 

6 

5 

4 

3 

2 

1 

0 

......... 

0.0 

0.1 

0.2 

0.3 

0.4 

0.5 

0.6 

0.7 

0.78 

0.84 

0.89 

0.93 

0.96 

0.98 

0.99 

1. 0 

0.05 

0.15 

0.25 

0.35 

0.45 

0.55 

0.65 

0.74 

0.81 

0.865 

0.91 

0.945 

0.97 

0.985 

0.995 

·" 12-22 

Standard  Height  (ml 
Full (15)  Half(15) 
16069 

11998 

9512 

7621 

6073 

4754 

3600 

2570 

1818 

1289 

868 

544 

307 

152 

76 

0 

13712 

10649 

8513 

6813 

5390 

4159 

3071 

2187 

1550 

1077 

705 

425 

230 

114 

38 


12. 3  Estimation  of  Physical  Parameters 

MCIP's essential role is to provide consistent meteorological data for the CMAQ modeling system. 
However, the meteorological models used for air quality study may not provide important 
boundary layer parameters at all, or may predict those at very coarse temporal resolution, or may 
only compute a subset of the needed parameters.  In such a case, it becomes necessary to estimate 
remaining meteorological parameters using certain diagnostic methods.  MCIP allows either the 
direct pass through of the PBL parameters provided by MM5, or they can be computed from the 
mean profiles of temperature, humidity and momentum together with the surface landuse data.  In 
the following, we explain the diagnostic methods used in MCIP.  Note that the approaches 
introduced here may not be consistent with MM5 directly and therefore may produce somewhat 
different spatial distribution patterns for certain parameters.  Basically, the diagnostic routines treat 
meteorological model outputs as the pseudo radiosonde observations. 

When desired, MCIP estimates key parameters for cloud distributions based on Anthes-Kuo 
parameterization.  They include precipitation rate, cloud fraction, and cloud base and top heights. 
MCIP also provides estimated dry deposition velocities for various chemical species in the RADM 
and carbon bond 4 (CB-4) mechanisms. 

12.3.1 

PBL  Parameters 

Depending on the user option, MCIP either passes through MM5 predicted surface and PBL 
parameters or estimates them us the MM5 profile data and detailed landuse information.  The 
algorithms used for the diagnostic computation of PBL parameters are provided below. 

12.3.1.1 

Surface  Flux  Related  Parameters 

We utilize a diagnostic method based on similarity theory to estimate the turbulence flux related 
parameters.  When the meteorological model uses very high vertical resolution and the thickness of 
lowest model layer is less than 20 m, we can utilize the surface similarity theory to determine 
turbulence parameters for both stable and unstable atmosphere. 

For the computation of the surface layer parameters, MCIP utilizes analytical solutions suggested 
by Byun (1990) to minimize the needs for numerical iterations in solving the flux-profile relations. 
The method has been reviewed and successfully applied in several surface layer studies (e.g., 
Hess,  1992; Lo,  1993 and  1995).  Also, a weather research model, the Advanced Regional 
Prediction System (ARPS) (Xue et al.,  1995) utilizes it in the description of the surface layer.  The 
algorithm is summarized below. 

The nondimensional surface layer profile functions for momentum (<Pm)  and potential temperature 
( </J1.) are defined as: 

(12-lOa) 

kz ae =,,.  (~) 
e.  ik .H 
'l'h  L 

• 

(12-lOb) 

1"' 

, 

"" 

,,1 

"' 

1111111'"1"' 

where  U  and e are the horizontal wind speed and potential temperature in the boundary layer, 
respectively,14  is the friction velocity, and  fJ.  is the temperature scale representing the surface heat 
···flux (covariance of potential temperature and wind fluctuations) divided by the friction velocity.  L 
is the Monin-Obukhov length defined as: 

"!'Ill 

"11'"1111 

, 

,,11111111,,, 

•"" 

I 

1,,

11 

1 

1,, 

, 

1 

, 

L= eoU: 
kg(). 

(12-11) 

The similarity functional forms proposed by Bu singer et al. ( 1971) are used in MCIP as follows: 
For moderately stable conditions ( 1;;:: z/L;;;:: 0) we have: 

where  Pr0  is the Prandtl.number for neutral stability and  /3m  and  f3h  are the coefficients determined 
th{ough field experiments.  Refer to Table 12-6 for the values of these coefficients used in MCIP. 
Fqr unstable c9nclitions  {z/L < 0 ), we have: 

(12-12a) 

(12-12b) 

where rm  and r h  are coefficients of the profile functions.  In addition, we added a function for the 
very stable condition ( zlL ;;::1  ) to extend the applicability of the surface layer similarity following 
Holtslag et al. ( 1990): 

(12-13a) 

(12-13b) 

To estimate surface turbulence fluxes with the layered data from a meteorological model, we utilize 
the integrated flux-profile relationships:  For ( z/L <1  ) we have profile functions represented as a 
mqdified logarithmic functions, when integrated from the height of the roughness length (z), 

( 12-14a) 

(12-14b) 

12-24 

z  z,,  ] 
U(z)=- ln--lJI  (--) 

u. [ 
k 

z 
z,, 

m  L' L 

EPA/600/R-991030 

(12-15a) 

(12-15b) 

and for strongly stable conditions, ( dL ~I ), we use direct integration of the profile functions: 

U(z) = u. [/3m ln3....+ z-z,,J 

k 

Z0 

L 

(12-16a) 

(12-16b) 

The  1JI  functions are given by (e.g., Paulson  1970), for moderately stable conditions (1~ dL ~ 0): 

and for unstable conditions: 

where  x=(l-ym ~)1'·,  x 0  =(I-rm 2)"•, and 

(12-17a) 

.  (12-17b) 

(12-18a) 

(12-18b) 

One important fact to note here is that although the similarity functions for stable conditions, 
Equations  l 2-12a-b and 12-14a-b, are continuous at dL = 1, their integrated profiles are not 
continuous. 

The flux profile relations described above are used to relate the Monin-Obukhov stability 
parameters with the readily computable bulk Richardson number  Rib: 

R

.  g(z-z0
e 
l  -""'----~ 
b -

)  AB 
u2 

0 

For moderately stable conditions (I> z/L;;::: 0 ), we have: 

1111111111
' 

(12-19) 

(12-20) 

and for strongly stable conditions, (z/L ;;:::J  ), we can derive a similar solution following the same 
procedure as described in Byun (1990) to give: 

(12-21) 

Given a positive bulk Richardson number, one should use both Equations 12-20 and 12-21  to 
compute t; and choose the value in the correct range between the moderately stable and strongly 
stable conditions. 

For unstable conditions, we use an efficient analytical approximation by Byun (1990), for 
(~ - P,,2) ~ 0, 

s ~(-z )1n(3-l-2.JQ; cos(eh)+-
1 
3ym 

z-z0 

z0 

3 

] 

(12-22) 

(12-23) 

~ =.!.[_1 +3I!!...s2]; 
rm  b 

9  r! 

=- --+-(--+3)s  ; 

P. 
b 

1  [ 
54 

2 
r3 
m 

9 
r 
m 

rh 
r 

m 

2] 

h 

e = arccos(__!J_J · and 

w' 
-yQi, 

b 

T,,  = ~ P,,2  - Q~ + P,, 

[ 

]

1/3 
. 

The above equations are used to estimate friction velocity, u., by estimating the bulk Richardson 
number using the layered meteorological data: 

Heat flux can be found by using the temperature scale estimated with: 

where 

(12-24) 

(12-25) 

(12-26) 

There have been several suggestions for the coefficients of the surface layer profile functions.  For 
example, Businger et al. ( 1971) suggested: 

/3m=4.7,  /3h=6.35,  Ym=l5.0,  yh=9.0,  Pr0 =0.74 

with the von Karman constant value of 0.35.  On the other hand, Hagstrom (1988) reanalyzed the 
experimental data used for the determination of the similarity functions and suggested use of: 

with the von Karman constant value of 0.40.  In the current version of MCIP, the latter set of 
coefficient values are used (refer to Table 12-6). 

Moisture flux is found by using similar method as the potential temperature: 

E=-pu.q., 

(12-27) 

where mixing ratio scale,  q., is determined with an equation similar to Equation 12-26 for given 
Liq= q1 - qs  (q1 and qs are the mixing ratios at the lowest model layer and at the surface, 
respectively). 

12-27 

",II' 

:1111111·.·111, 

11111111 

,,111111 

12.3.1.2 

Estimation  of  Surface  Fluxes  Using  PBL  Profile  Functions 

Occasionally meteorological models use the lowest model layer thicker than 40 m or so.  Under 
this condition, it becomes difficult to believe that the lowest layer always belongs to the smface 
layer all the fune, espedaliy for very stable conditions.  To avoid thisfiffiitation, MCIP estimates 
s~.tf ~ce h.eat~ ,~o~~n~.~ ,,~d m<:>i,sture flux tr~nsfer param~ters from~5 smface wind and 
temperature by using the boundary layer similarity profiles proposed by Byun (1991).  In this 
section, we descnbe the methods used in MCIP for estimating surface fluxes when the thickness of 
the lowest model layer is too thick to rely on the surface layer similarity.  The intention is to 
provide a diagnostic method that can estimate the surface fluxes even when the lowest model layer 
extends above the surface layer.  It is difficult to expect that a layer with 40 m thick, for example, 
continuously belongs to the surface layer though out a day. 

Table  12-6.  Parametric Constants Used to Describe the PBL in MCIP 
Parameter 
von Karman constant 
Coefficient in stable profile function for momentum 

Coefficient in stable profile function for heat (scalar) 

Coefficient in unstable profile function for momentum 

Coefficient in unstable profile function for heat (scalar) 

Prandtl number for neutral stability 

Critical Richardson Number 

Maximum bulk Richardson number 

Minimum bulk Richardson number 

Minimum magnitude of Monin-Obukhov length 
Scale height ratio for neutral stability 

Symbol 
K 
{3m 
{3h 
Ym 
rh 
Pr0 
Ricr 
max( Ri8 ) 
min( Ri8 ) 
abs(L) 
Ao 

Zilitinkevich ch 
Neutral value of similarity function for wind component parallel to surface stress 
Neutral value of similarity function for wind component normal to surface stress 
Reference height 
,,, 

,, 

ch 

A(O) 

B(O) 

Z, 

" 

Value 
0.4 
6.0 

8.21 

19.30 

11.60 

0.95 

0.25 

0.70 

-4.75 

4.0 
0.07 

0.80 
1.70 
4.50 
10 m 

The wind and temperature predicted by a meteorological grid model represent layer averaged 
values.  In order to simplify computation of the surface fluxes, we apply the assumption that the 
predicted wind for the lowest model layer has the same direction as the surface stress (i.e., 
u! + v! = U!,  where  um  and v m  are latitudinal and longitudinal components of the first layer mean 
wind on the map and Um  is the layer mean wind speed in the direction of surface stress).  Applying 
the PBL momentum profile functions of Byun (1991) and integrating them vertically  from Zo 
(roughness length) to the top of the lowest CTM layer ( zFI  ~ h ), one can obtain wind and potential 
temperature profiles in the form: 

(12-28) 

(12-29) 

where  T10  = h , TIF  =  ~ 1 
z 

z 

,  and  µ = L.  For a detailed description of the notation used, refer to 

h 

Byun ( 1991) and Byun and Dennis (1995).  Initially, the atmospheric stability (µ) is approximated 

by the analytical solutions of flux-profile relationships described earlier.  Then, we computeµ, u*, 
and(}*  using Equations  12-28 and 12-29, with the Newton-Raphson iteration.  Equation  12-29 is 
then used to estimate temperatures at heights  1.5 m and 10 min MCIP. 

12.3.1.3 

Utilization  of  Sub-grid  Scale  Landuse  Information 

Accurate description of atmospheric turbulence is one of the important elements in modeling the 
deposition of pollutants.  For Eulerian air quality models, grid-average surface roughness based on 
sub-grid scale landuse information has played an important role in the characterization of the 
surface condition, which in tum determines intensity of turbulence in the atmosphere.  To represent 
the atmospheric deposition process utilizing the available sub-grid landuse information, Walcek et 
al. (1986) introduced a method to estimate friction velocity for each landuse patch, which is used in 
the calculation of the subgrid-scale aerodynamic resistance.  Also, several estimation methods have 
been proposed for the effective roughness length for use in meteorological grid models.  Compared 
with the latter methods that estimate the representative grid values for the given sub-grid 
information, Walcek et al. ( 1986) emphasized the description of the sub-grid flux estimation by 
introducing a somewhat ad hoc, but useful assumption.  They assumed that the quantity  Uu.  is 
constant both for the cell averaged parameters and for the individual landuse patches, i.e.: 

(12-30) 

where the non-subscripted variables refer to grid-averaged values while the j-subscripted values 
refer to the corresponding quantities over individual landuse types.  Equation 12-30 is an intuitive 
expression of the often observed condition that where wind speed is high, the turbulence is low, 
and vice versa, under similar pressure gradient forcing.  Strict validity of Equation 12-30 could be 
controversial, however, this approach is more realistic than those that assume constant wind or 
constant friction velocity.  In the dimensional analysis point of view, the condition is a statement 
about the conservation of kinematic energy in the presence of surface friction.  A derivation leading 
to Equation 12-30 is provided below using a combination of the surface layer similarity and the 
mixing length theories. 

The momentum flux is related with mean wind gradient as: 

-(u"w")  =U:=K  -

s 

au 
m  (k 

(12-31) 


111

'" 

:1!!

:' 

,1.11111::: 

''Ill 

,',,l"I 

i' 

,,,lli::!!li.ii 

. 

:1111 

atjd the edpy diffusivity for momentum is given by: 

,1;,,, 

.. ,,,, 

,,:illl!'!I 

K  = 

ku.z 

m  </Jm(z/ L) 

(12-32) 

I ' 
:1;;:,,, 
I 

11111':'1 

' '  I , 
;;i111!!!!i1ill!. 

11 

~~en we app~~ ass~mptions such as steady state flow and horizontal ...  homogeneity of the each 
landuse patch, the momentum conservation equation can be simplified to give: 

::· 

11,1:',, 

" " 
·illj:'. 

' I ' 
·I!:::. 

1 

, 

" 

1111 I ~ ~ ! I 
•11,1,,, 

U-+ 

au  du"w" 
ik 
ik 

=--V p 

z 

1 
p 

(12-33) 

Coriolis forcing is neglected in deriving Equation 12-33 because we are dealing with only the sub(cid:173)
grid scale variation of momentum field. 

The right hand side of Equation 12-33 represents the pressure gradient forcing imposed over the 
grid and is therefore not dependent on sub-grid representation.  Within the surface layer, which is 
treated as a constant flux layer, Equation 12-33 is further simplified to give: 

au 
ik 

1 
p 

z 

U-=--V p=const. 

Combining Equations 12-31,  12-32 and 12-34, one obtains 

Uu.  </Jm(zl L) =canst. 

,kz 

(12-34) 

(12-35) 

For the atmosphere at neutral stability,  <Pm  = 1, and the same expression should be applicable for 
ea.ch landuse patch.  Then, Equation 12-35 becomes identical to Equation 12-30 at a given 
reference height z = Zr. 

In,,,,addition to J;quation  12-30, Walcek et al. (1986) assumed that the surface roughness length can 
be averaged as 

(12-36) 

where  ~ 's are fractions of different landuse types in a grid cell.  W alcek et al. ( 1986) stated that 
Equation  12-36 conforms to a logarithmic wind profile.  In reality, however, Equation  12-36 can 
be derived from a simple geometric averaging and it does not produce a logarithmic wind profile. 
On the other hand, Mason (1987) suggest an averaging method based on the logarithmic wind 
profile by introducing a blending height (lb  ) concept: 

In~  =  L 
( 

2  [ 
)

Z0 

~ 
ln(lb I Z0i )

]-1 

2 

(12-37) 

Although this approach is a practical averaging method of the roughness length, this by itself 
cannot be used to estimate landuse-dependent friction velocities.  Therefore, here we compare 
several other roughness length averaging schemes that satisfy both Equation  12-30 and the 
logarithmic wind profile function for the neutral condition: 

EP A/600/R-99/030 

and 

(12-38a) 

(12-38b) 

where  Zr  is the reference height.  The objective is to compute landuse specific friction velocities 
from the cell average wind and friction velocity values while providing a consistent averaging 
scheme for the roughness length.  The simplest method for estimating the grid average values from 
the sub-grid scale information is using the linear summation with the fractional weight: 

(12-39) 

where  xi is a physical quantity and LJJ = 1.  Because Up.
12-30 with Equation 12-39 as follows: 

=constant, one can rewrite Equation 
1 

Uu. = U .u.  = ""f,.U .u.  =< Uu. > 

, ,   £ . . i11 ,  

j 

(12-40) 

If the surface wind is a quantity that follows Equation 12-39, a relation between the grid average 
and sub-grid landuse dependent roughness lengths can be found as: 

(12-41) 

In order for the expression to be useful,  u.i  in Equation 12-41  should be eliminated.  From 
Equations 12-38a-b and  12-40, a simple relation for  u. i  is found in terms of known quantities: 

112 

U..  = u.[-ln--'(__..zr_l-"z0'-'--) ]
ln(zr I Znj) 

1 

(12-42) 

Substituting Equation 12-42 into Equation 12-41, we obtain a simple relation for the effective 
roughness length that satisfies both the logarithmic wind profile and the linearly-additive wind 
speed assumptions under the approximation, Equation  12-30: 


(12-43) 

,  but still within the surface layer.  In the 

'IJ:le referenc~,,,,height Zr  needs to be within the regime where the log-linear wind profile can be 
s~tisfied.  Thi,~"me~ns that it sQ.ould be far away from  z0
cilrrent MCIP~ we are using Zr=10m.  The new method conserves wind speed and  Uju.,  under the 
Ii.near su;mrn~!,ioq(Equation 12-39).  With this assumption the turbulence momentum flux (  u3  ) 
can be summed linearly when it is scaled with the factor  [ln(zr I z0 )/ln(zr I z0j) ].  Depending on the 
degree of inhomogeneity, this factor can be substantially different from unity, making less 
consistent with the expectation that fluxes from different patches can be summed up.  One may 
expect that Equation 12-43 is sensitive to the choice of reference height  Zr;  however, the average 
roughness length is not strongly sensitive to the reasonable value of zr  between  1 to  10 m. 

II" 

An alternative approach to the linearly-additive wind speed assumption is to assume that the sub(cid:173)
grid scale momentum flux can be summed linearly: 

u.  = £.JJi~i =< ~ > 
2 

.,..  2 

2 

" 

J 

Q'sing Equation  12-39 and the logarithmic wind profiles, one can find: 

1111::: 

11:: . . .  

[1nczr I Z0 ) ]2  - i 

. - L.r. ~) ---;;-
) r 
(U./U) 2 
i  [ ln(zr I z01

.... 
1 

11

" 

'1111

(12-44) 

(12-45) 

In order that Equation 12-45 to be useful,  ( Ui I U) should be expressed in terms of z0 ,  z0j  ,  and  Zr. 
This is accomplished by dividing Equation 12-38a with Equation  12-38b and substituting  (u. I u.j) 
with Equation 12-30 to get: 

~· 

'I 

, 

I:,, 

111, 

• 

'I· 

""" 

,, 

This leads to an averaging method for the sub-grid scale roughness length: 

(12-46) 

(12-47) 

I 

Another popular assumption is that at the reference height (or blending height) the drag coefficients 
representing the individual landuse patches in a cell can be summed linearly, i.e.: 

(12-48) 

12-32 

Unlike the two other assumptions introduced, this assumption does not depend on Equation  12-30. 
The resulting equation for average roughness length is then identical to Equation 12-37. 

EP AJ600/R-99/030 

z0  = Z, exp  -

[ ( 

~  f.. 
1 
,£.J 
2 
j  [ln(z,lz0j)] 

-112] 
J

(12-37') 

Although the assumption in Equation 12-48 has been used often in the literature, it is  not intuitive 
that the sub-grid drag coefficients can be added linearly.  The drag coefficient simply quantifies the 
turbulence exchange characteristic of a landuse patch.  By using this assumption together with the 
Equation 12-30, one can readily show that: 

(12-49) 

It is difficult to expect that U:  is a physical quantity that can be added linearly.  In MCIP, we have 
implemented both Equations 12-43 and  12-47 as a user option.  Results of the comparison of the 
two recommended methods should be available as the model evaluation project progresses. 

12.3.1.4 

Boundary  Layer  Heights 

Boundary layer height is a key parameter that determines the domain of atmospheric turbulence in 
which pollutants disperse.  It is used as a fundamental scaling parameter for the similarity theory in 
the description of atmospheric diffusion characteristics.  Estimating PBL height has been one of the 
key functions of meteorological pre-processors for air quality models.  Below, we summarize PBL 
height estimation algorithms used in MCIP. 

Unstable  conditions 

MCIP estimates the PBL height using the vertical profiles of potential temperature and the bulk 
Richardson number with an algorithm similar to the one reported in Holtslag et al. (1995).  The 
bulk Richardson number of each model layer with respect to the surface is given as: 

(12-50) 

where subscript H represents values at the layer middle (i.e., half sigma level). 

First, the index of the PBL top (kp8J is determined at the layer when  Ri8  first becomes larger than 
max( Ri8 ).  Then the proration factor of the bulk Richardson number relative to max( Ri8 )  is 
computed with: 

(12-51) 

where  max(Ri~)=0.7 (refer to Table 12-6).  Depending on the value of fR;s,  the index kPBL  and 
!Ri,  are modified as follows: 

'1111 

for  fR;, < 0.5, f~11  = fR;,  + 0.5; k~BL = kPBL  -1. 

Once the fraction and index for the PBL top are determined, we estimate the initial PBL height 
with: 

(12-52) 

The above proration procedure ensures gradual increase of PBL height.  Without the procedure, 
th.~ resolution of PBL height is limited by the layer thickness of the model.  In the RADM 
preprocessor, the PBL height is determined simply at the layer where the potential temperature first 
becomes warmer than the surface temperature for convective conditions.  Compared with the 
RADM method, the present method takes into account effects of the wind shear as well. 

,, 

Ill 

Stable  conditions 

For stable conditions, the PBL height is determined by the maximum of the PBL height computed 
with above method and the stable boundary layer height given by the Zilitinkevich's (1989) 
formula: 

(12-53) 

Limitine  PBL  heiehts 

Unlike the PBL height estimation algorithms based on temporal integration of surface heat flux 
(e.g., Carson, T973; Betts, 1973; Driedonks, 1981), the above diagnostic algorithm could predict 
temporally disconnected PBL heights when the hourly meteorological data change abruptly.  To 
~nimize this ~ff~t, following limits on the PBL height are imposed. 

1. 

Compare with PBL height for neutral conditions, and take maximum except for the tropical 
areas: 

(12-54) 

2. 

Compare with the urban boundary layer height, which is approximated with: 

(12-55) 

where  furban  is the fraction of urban landuse in a cell.  In MCIP, the minimum PBL height 
for urban area and other land use types are set to be  huBI.min =300 m and  hp8 u,,;n =50 m. 
Then, take a maximum of the two to reflect the effect of urban landuse: 

h' PBL = max{hPBL'  huBd 

(12-56) 

This step is introduced to apply the urban landuse classification, which is consistent with 
the one used for the emission processing, for the determination of the PBL height. 

3. 

Limit the PBL height with a maximum value (hPBulUU=3000 m) in case the temperature 
profile does not have a capping inversion: 

(12-57) 

12.3.1.5 

Aerodynamic  Resistances 

Aerodynamic resistance describes the ability of the atmospheric turbulence to transport pollutant to 
the surface for the deposition.  In this regard, it may well be described with the probability 
concept.  If 100 particles, say, are at height 20m, how many of them can reach the surface to be 
available for deposition during a given time interval?  Or, what is the transport rate of particles in 
the air to the surface?  The ratio represents the maximum potential deposition rate of particles 
subjected to atmospheric turbulence.  However, even those particles which arrive at the surface 
may not all be deposited because of other resistances, which usually are parameterized using· 
characteristics of surface and gaseous elements. 

There have been many efforts to compare different formulations for dry deposition velocities. 
While there are a lot of uncertainties in describing atmospheric processes, the different 
aerodynamic resistance formulas in the literature are mainly originated from the differences in the 
applications and approximations of the same PBL theories and formulas.  Among the components 
involved in atmospheric resistance computation, formulations for aerodynamic resistance have the 
least controversy.  To compute the aerodynamic resistance, the parameterization of the eddy 
diffusivity for the PBL should be known.  The eddy-diffusivity formulations used in the derivation 
of aerodynamic resistance are discussed below. 

Eddy  diffusivity  formulations 

The similarity theory suggests that eddy diffusivity in the surface layer for heat flux is given by: 

(12-58) 

The profile function  </>his  defined in Equations 12-12b and 12-13b.  Eddy diffusivity in the PBL 
(above the surface layer) (Brost and Wyngaard 1978) is given as: 

_  ku.z(l-z/hpp1.)312 

K 

h-

</Jh(zl L) 

for stable atmosphere ( z IL> 0 ), and as: 

Kh  = kw.z(l - - )  

z 
hPBL 

..... 

,, 

I 

,,11111111111, 

•'""' 

(12-59a) 

(12-59b) 

for unstable atmosphere ( z IL ::;; 0 ), where the convective velocity scale  w.  is defined as 

resistance  formulations 

(12-60) 

We often characterize the ability of turbulent atmosphere to carry pollutants to the vegetation or 
other surface elements using the aerodynamic resistance concept.  Certain meteorological models 
may use the resistance representation of surface exchange processes in lieu of the conventional 
bulk aerodynamic methods and the aerodynamic resistance is available as a part of meteorological 
datawith other PBL parameters.  Conversely, there are models that do not predict resistances and 
refated parameters needed.  In such cases, we need to estimate it using PBL parameters and 
profiles of state variables. 
The aer()dynamic resistance ( R0
)  and sub-layer resistance (Rb) are parameterized in terms of 
friction velocity and surface roughness (W alcek,  1987; Chang et al.,  1987 and  1990; Wesely, 
1989; Wesely and Hicks, 1977).  Although some consider the estimation of aerodynamic 
resistance as an integra.J. part of the dry deposition velocity computation, we treat the aerodynamic 
~~istance !15 !l:11  iJ!Qependent element that characterizes the effects of atmospheric turbulence.  Here, 
W,,~ provide a set of integrated equations, which allow robust estimation of aerodynamic resistance 
compared with the method based on the nonintegrated form, which sometimes provides negative 
fluxes for unstable conditions.  Refer to Byun and Dennis ( 1995) for details. 

"""""'"""""""" 

' '   """"""'" 

1111,,,1

1 

1
" 

"' 

1111

'' 

' 

' 

"' 

" 

" 

' 

' 

' 

,, 

""' 

" 

General formulation for the aerodynamic resistance at the deposition height  Zt1ep  (where 
concentration is represented) is divided into two components; the resistance in the surface layer 
(whose top is at  Zsi, height of the surface layer) and the resistance in the PBL above the surface 
layer: 

'"'"" 

"' 

'""' 

" 

' 

" 

" 

'"' 

,, 

11111111 
Ill' 

' 

'""''" 
"'"" 
z  dz 

zsL  dz 

z 
dtp  dz 

Ra = J K  (z) = J K  (z) + J K  (z) = RaSL + RaPBL 

z.z 

Zo 

z 

ZsLZ 

(12-61) 

111

1· 

,, 

1111"'11111111111111 

I: 

1111111' 

II 

111111! 

::: 

,11111" 

12-36 

(a) For stable conditions: 

R 

aPBL  -

_  Pr0 

[  2(/3+1)  _  2(/3+1) 
.JI - Tlsi 

ku.  ~1- Tldep 

+  n 

l  (-1 + ~l -T]dep )(1 + ~l -TJsi)] 
, 
(1 + ~1- Tldep  )(-1 +.JI - Tlsi) 

where  =  h -L '  Tldep  = - - an  Tlsi  = --. 

/3  hPBL 

/3 

d 

Zdep 
hPBL 

ZsL 
hPBL 

(b) For unstable conditions: 

R  __ 1_1 [Tldep (1-TJsi)] 
• 
aPBL  -
TJsi (1- TJdep) 

kw. 

n 

EP A/600/R-99/030 

(12-62a) 

(12-62b) 

(12-63a) 

(12-63b) 

12.3.2 

Dry  Deposition  Velocities 

The term dry deposition represents a complex sequence of atmospheric phenomena resulting in the 
removal of pollutants from the atmosphere to the surface of the earth.  The rate of transfer of 
pollutants between the air and exposed surfaces is controlled by a wide range of chemical, 
physical, and biological factors, which vary in their relative importance according to the nature and 
state of the surface, characteristics of the pollutant, and the strength of turbulence in the 
atmosphere.  The complexity of the individual processes involved and the variety of possible 
interactions among them prohibits simple generalization of the process.  Nevertheless, a 
"deposition velocity," analogous to a gravitational falling speed is of considerable use.  In practice, 
the knowledge of dry deposition velocities enables fluxes to be estimated from airborne 
concentrations.  Two dry deposition estimation methods, that from Wesely (1989) currently as 
implemented in CMAQ, and the new Models-3/CMAQ approach are presented. 

12.3.2.1 

RADM  Method 

The RADM dry deposition module in MCIP calculates deposition velocities of sixteen chemical 
species (Table 12-7).  It requires various ancillary 2-D meteorology fields such as the PBL height, 
mixing scale velocities, Monin-Obukov length, etc.  They are usually estimated from horizontal 
wind components, temperature and humidity profiles.  The dry deposition flux of each chemical 
species from the atmosphere to surface is calculated in the CCTM by multiplying the concentration 
in the lowest model layer with the dry deposition velocity.  The dry deposition velocity ( Vd) is 
computed from the resistance-in-series method; 

where Rtf  is the aerodynamic resistance, Rb is the quasi-laminar boundary layer resistance, and Re 
is the  canopy (surface) resistance.  Refer to Figure 12-7.  Vd  is usually estimated from a series of 
resistances to vertical transfer and surface uptake.  Aerodynamic resistance (Ra  ) is a function of 
turbulent transfer in the atmospheric surface layer and can be estimated in several ways depending 
on the instrumentation used or parameterizations provided. 

lll111::r' 

'' 

,,1111111111,.'1', 

:'"·,,,;::1111' 

11' 

1;::111111 

(12-64) 

The canopy resistances (R) for S02 and 03 are estimated from available measurements as a 
function of season, insolation, surface wetness, and land type (W alcek et al.,  1986; Shieh et al., 
1979; Fowler,  1978).  The surface resistances for all other gaseous species, due to the lack of 
extensive measurements, are qualitatively scaled to the S02 and 03 surface resistances according to 
their reactivity and solubility.  The surface resistance for particulate sulfate is parameterized in 
terms of stability and friction velocity in the surface layer (Wesely,  1989), based on limited studies 
t11at do not inc'iUde water surfaces.  In CMAQ this method only applies to the treatment of surrogate 
gas-phase representation of sulfate species.  Size dependent deposition velocities for particle 
depositions are estimated inside the CCTM's aerosol module.  See Chapter 10 of this document 
and Binkwoski and Shankar (1995) for details. 

11r"~llll'  :!' 

"1111" 

• "'" 

II'  1111!! 

•I.,  " 

I" 

'  ' 

" 

, ,,,!, 

!111111111111111111 

11, 

" 

1111 

,!1

"

'  ,! 

' 

,,11111:. 

'II, 

I, 

"'' 

, 

I' 

'II' 

" 'I, 

'Ill'" 

,  ,• 

, 

"" 

I,, 

, 

,,II 

11111 

The laminar sub-layer resistance (Rb)  depends on the landuse specific friction velocity and 
molecular characteristics of gases.  Using the landuse dependent friction velocity or the cell average 
friction  velocity, R,,'s for heat (Rbh)  and trace gases (R,,) are estimated with the Schmidt number 
(Sc): 

(for heat) 

(for trace gas species) 

(12-65a) 

(12-65b) 

R  =-Sc 213 
bx 

x 

2 
k 
l4 

where Schmidt number is defined as the kinematic viscosity of air (v = 0.146  cm2s-1
molecular diffusivity (i.e.,  Sc= v I De  for heat and  Sc"= v I Dex  for trace gases).  Here,  v 
kinematic viscosity of air;  De  is molecular diffusivity of air (heat); and Dex  is molecular diffusivity 
of trace species.  For heat, the molecular thermal diffusivity ( D8
vapor, molecular diffusivity (Dew)  is 0.244  cm 2s-1
0.159  cm 2 s-1  (molecular diffusivities of other chemical species are included in the model). 

;  and, for ozone molecular diffusivity ( Dg03 )  is 

)  is 0.206  cm 2s- 1

)  divided by 

;  for water 

is 

,: 

111 

12-38 

Ambient Concentration 

EP A/600/R-99/030 

.. ................... , 
• 
• 
• 
• 
• 
• 
RC: 
• 
• 
• 

,...... 
• 
• 
• 
• 
• 
• 
i 
• 
• 
• 
1-4=-

~ 

• 
• 
• 
• 
~-·--·-----·--~ 

Figure 12-7. Schematic Diagram of Pathway Resistances Used in RADM Dry Deposition Model 
Resistances with subscript x are for different chemical species. 

Re represents the canopy resistance defined as: 

R  = 
( 
c 

I 

+-1-+ 

1 

r sx  + r m.t 

'iux 

rdc  + r;,lx 

+ 

1 

r <lC  + rgsx 

-1 

J

(12-66) 

where  rsx  = stomatal resistance; 

r=  = mesophyl resistance; 
'iu:c=  resistance of the outer surface of leaves in the upper canopy; 
rdc  = resistance for the gas transfer affected by buoyant convection in canopy; 
r;,tx  = lower canopy resistance (uptake pathways at the leaves, twig, etc.); 
rac  = resistance that depends on the canopy height; and 
rcsx=  resistance of soil, leaf litter, and other ground materials. 

Stomatal resistance for water is obtained using following equation: 

rsw  =~min  +  O.l+G.nv 

1 

(  [ 

200 

]2J( 

400 

'.f,,(40-T,) 

J 

(12-67) 

where  r sw  = stomatal resistance for water; 

1:.min= minimum stomatal resistance for water, specified in Table 12-7; · 

7;  = surface air temperature in the canopy in Celsius temperature; and 
GS'IY  =-solar radiation reaching at the canopy in W/m2 unit. 

Then stomatal resistance for trace gas species is obtained with: 

r,g:  - r .sw 

-"'"  ~ 

D 

Dex: 

(12-68) 

w is the molecular diffusivity of water.  Ratio of molecular diffusivity of water to that of 

where D1
each trace species is provided in Table 12-7. 

The mesophyl resistance is parameterized as: 

1
' 

111'

1111 

r mx:  =  __..!.&_ + 100 fox 

H 

)-

( 
····•••··  3000 

1 

(12-69) 

where  H.x  is Henry's gas constant (in mole atm-1)for the species, and.fox:is the reaction intensity 
factor. 

,1:::11:::11" 

I 

,11111· 

'11, 

,, 

'

1 ',111111, 

Both the Henry's gas constants and reaction intensity factors are provided in Table 12-7 as well. 
r1vx  is related with the upper canopy resistance for water ( 'iu)  which is provided in Table 2 of 
\Vesely ( 1989) as: 

r.1c  is parameterized in terms of the available solar radiation and the slope of local terrain: 

rtlc  = 100[1+lOOO(GSIV+10r1J(l + 10008)-1 

(12-71) 

(12-70) 

where e is the slope of local terrain in radians.  t;;1x and  ~.u are estimated based on the respective 
resistance V~!Jesfor S02 and 03 as follows: 

' 

,1111111:.. 

'' 

11111111111'' 

"'I 

"( 
H. 
r.  = 
1 as '"c-rs 
clx 

f, 
x  + _.!!L 
T;;ro 

)-1 

(12-72a) 

(12-72b) 

where subsci,:ipt Sand 0  are for S02 and 0 3, respectively.  All of these values, and  rue  (the 
resistance that depends on the canopy height) are landuse dependent and listed in Table 2 of 
Wesely (1989). 

12-40 

Table 12-7.  Gaseous Species Treated in RADM Dry Deposition Module and Their Properties 
Relevant to Estimating Resistance Components as Implemented in MCIP 
(Modified from Wesely,  1989.) 

EP A/600/R-99/030 

Gaseous  species 

Symbol 

Dew/ Dgx 

H.x (mole atm- 1
) 

Sulfur dioxide 
Sulfate 
Nitrogen dioxide 
Nitric oxide 
Ozone 
Nitric acid vapor 
Hydrogen peroxide 
Acetaldehyde 
Formaldehyde 
Methyl hydroperoxide 
Peroxyacetic acid 
Formic acid 
Ammonia 
Peroxyacetyl nitrate 
Nitrous acid 
Carbon monoxide 

S02 
S04 
N02 
NO 

03 

HN03 
H202 
ALD 
HCHO 

OP 

PAA 
ORA 
NH3 
PAN 
HONO 
co 

1.9 

1.6 
1.3 
1.6 
1.9 
1.4 
1.6 
1.3 
1.6 
2.0 
1.6 
1.0 
2.6 
1.6 
1.2 

l.OX105 

0.01 
0.002 
0.01 

1.ox1014 
I.OX105 

15.0 

6.0XI03 
240.0 
540.0 
4.0X106 
2.0X104 

3.6 

I.OX105 
0.001 

fnx 

0.0 

0.1 
0.0 
1.0 
0.0 
1.0 
0.0 
0.0 
0.1 
0.1 
0.0 
0.0 
0.1 
0.1 
0.0 

12.3.2.2  Models-3/CMAQ  Dry  Deposition  Model 

The Models-3/CMAQ dry deposition (M3DDEP) module estimates dry deposition velocities 
according to the same electrical resistance analog represented by Equation  12-64.  M3DDEP uses 
common components with the new land-surface model that has recently been added to MM5. 
Specifically, the aerodynamic resistance and the canopy or bulk stomata} resistance are the same as 
those used in the modified MM5 (MM5PX) for computing evapotranspiration.  Since the land 
surface scheme includes soil moisture and has an indirect nudging scheme for improving soil 
moisture estimates, the resulting stomata! resistance estimates should be better than those achieved 
with a stand alone dry deposition model.  Pleim and Xiu ( 1995) give a description of an early 
prototype of the land surface model which is now coupled to MM5.  Pleim et al ( 1996) and Pleim 
et al. (1997) briefly describe the dry deposition model and some studies comparing model results 
to field measurements of surface fluxes and PBL heights.  The description which follows here is 
partially drawn from these sources. 

. 

When using the M3DDEP option in the CMAQ system the aerodynamic resistance, as well as the 
bulk stomata! resistance (~ibw; discussed below) is provided to MCIP from the MM5PX.  Note that 
these parameters are computed as part of the land surf ace model in the MM5PX and are not 
available from the standard MM5.  In MM5PX the aerodynamic resistance  Ra  is computed 
assuming similarity with heat flux such that: 

'I)  = pC (e  - e ) I H - R 

.. 'II 

p 

g 

I 

bh 

(12-73) 

where Rbh is the quasi-laminar resistance for heat (defined in Equation 12-65a), ec  and e1  are 
potentiafiemperafure of the ground surface and the air, respectively, in the lowest model layer, and 
His the sensible heat flux defined in Equation 12-25.  If the sensible heat flux is very small (as 
during transition periods) the surface layer theory for neutral conditions is used as follows: 

(12-74) 

~here. z1 is the height of model layer 1 and z0  is the roughness length.  The heat and momentum 
fluxes are denvedfrom flux-profile relationships as in the MM5 (see Grell et al.,  1995). The quasi-
1 .. &ID: .. nar bouqgary layer resistance accounts for diffusive transfer across a thin laminar layer 
adjacent to surfaces.  Because of the no-slip condition, turbulent eddies cannot penetrate to a 
surface.  Therefore, there exists a thin layer of non-turbulent air where molecular diffusion is the 
primary mechanism for transfer.  While this concept is not relevant for momentum, it is relevant 
for any quantity that directly interacts with the surface such as heat, moisture, and chemical 
deposition.  Therefore, for these quantities, the addition of a resistance based on molecular 
diffusion is necessary.  Deposition layer resistance varies by the transported quantity because of 
differences in molecular diffusivity, which is defined earlier in Equations 12-65a and b. 
The total surface ~esistance to dry deposition (Rs)  has several components including bulk stomatal 
resistance (rsrb),  dry cuticle resistance (rcu1), wet cuticle resistance (rcw),  ground resistance (rg),  and 
in-canopy aerodynamic resistance (r1c): 

,Ill" 

1111,,, 

'11111 

1 

:111' 

, 

• 

(12-75) 

Bulk stomatai res!Stance (rsrb),  vegetation fractional coverage ifv), leaf area index (LAI) and 
(i:actiomtl leafar~ wetness ifw) are all provided by MM5PX since the same parameters are used in 
the lancfsurface scheme.  Figure 12-8 shows a schematic representation of Equation 12-75.  Note 
that r Sib•  as output from MM5PX, is already a combination of stomatal resistance on a leaf area 
basis r..,,  mesophyl resistance rm,  and LAI as described below. A  key component of the land 
surf ace model in the MM5PX is the parameterization of the bulk stomata! resistance that is used to 
c9mpute evapotranspiration.  The bulk stomatal resistance for water vapor is read in to MCIP from 
MM5PX and adjusted for chemical dry deposition in the M3DDEP model by weighting with the 
J1ltiO of molecular diffusivities for water vapor and the chemical species: 

1111''' 

(12-76) 

12-42 

Ambient Concentration 

Leaf 

~c 

ground, water, ground, water, 

snow 

snow 

Figure 12-8.  Schematic Diagram of Pathway Resistances Used in Models-3/CMAQ Dry 
Deposition Model. 

In general, the bulk stomata} resistance is related to leaf based stomatal resistance as: 

where Psis a shelter factor to account for shading in denser canopies.  For water vapor and many 
chemical species, such as 0 3  and S027  rm  is assumed to be zero, however, for many less soluble 

12-43 

(12-77) 

'" 

1111111,, 

EP A/600/R-99/030 

1111111 

!1111!! 

species a non-zero value should be used.  The shelter factor is given by: Ps = 0.3 LAI+ 0.7 with a 
iwnimum of Ps = 1.0.  Leaf scale stomata! resistance, computed as: 

'11111111111111, 

'11111111~ 

•,,1111' 

• 

I 

, 

, 

, 

1 

1111

111 

•••• 

•• 

., 

r.  _ 
st  -

11111'"1111"11' 

r. 
.</mm 

. 

F,_(PAR)F;_(w2 )f;(RHs)~(T,,) 

(12-78) 

depends on four functions of environmental factors which influence stomata! function, and the 
raj11iip~,~ stqmcit2:!,,, resi~~!illce (,-~,min) Vlh!.ch ~epends on ve~etative s12ecies.  The minimum stomatal 
resistance is a bulk parameter which reflects the maximum conductance of a leaf per unit area under 
unstressed conditions (well watered, full  sunlight, and optimal temperature and humidity).  This 
parameter is specified in the model according to vegetation type. The key to the model's ability to 
simulate stoJl1atal conductance in real world conditions is the four environmel}tal stress functions, 
f;-4 in Equati~~ iZ-78 ...  This kind of stomata! model, with independent empirical stress functions, 
is often called a Jarvis-type model after Jarvis (1976).  Specifically, the land surface model in 
MM5PX is based on Noilhan and Plan ton ( 1989) (hereafter referred to as NP89) with many 
svpsequent modifications. The radiation stress function is: 

Iii,,,,; 

with 

Fi= 

l+f 

f  + rs1m1n I ~1max 

(12-79) 

f  = 0.55 

2Ra  where rs, max is maximum stomata! resistance which is an arbitrarily large 
,,~L 

""'' 

" 

' 

"" 

'" 

I 

,,, 

" 

,,111111'1'" 

number (5000 s/m), Ro is solar radiation at the surface and the 0.55 factor is an approximation for 
the photosynthetically active portion,  and RoL is a limit value of 30 W/m2 for forest and 100 W/m2 
for crops according to NP89.  The only difference from the F1 in NP89 is that the dependence on 
LAI has been removed since the effects of leaf shading within the canopy are now accounted for by 
the shelter factor in Equation 12-77.  Therefore, the F1 as defined here represents the effects of 
sunlight on an individual leaf rather than the integrated effect on a canopy. The functions of root 
zone soil moisture and air temperature (F2 and F4)  were modified to follow the form of logistic 
curves as suggested by A vissar eial. (1985).  Logistic curves are "S" -shaped and therefore good 
fo'r representing a smooth transition from one state to another.  Also, logistic curves can be defined 
With varying degrees of abruptness, from an almost linear transition to an almost threshold 
behavior, and can be altered while maintaining differentiability.  The function of root zone soil 
moisture (w2)  is: 

"""""'"""""""' 

11111111111111111111,, 

""'"" 

'''"' 

" 

,,. 

1

' 

' 

.1

F;  = 11(1+exP(-5.o(waJ +b._)]) 

where the available soil moisture fraction is: 

(12-80) 

wef = 

W2  -Ww11 

wfc  -wwlt 

and the half point of the function (where F2 = 0.5) is: 

where Wwtt is the wilting point and w1cis the field capacity.  All soil moisture values (w) are in 
volumetric fraction. In many previous models, including NP89, Jacquemin and Noilhan (1990), 
Wetzel and Chang (1988), Mihailocic et al. (1993), Sellers et al. (1986), and Avissar et al (1985), 
the function of air humidity (F3)  is expressed in terms of vapor pressure deficit between the inside 
of the leaf, assumed to be saturated at leaf temperature, and ambient air humidity (vpd = elTsJ-ea). 
However, recent advances in plant physiology research have led to a new generation of stomatal 
models based on leaf photosynthesis (Sellers et al.,  1997) in  which stomatal conductance (g., = 
1/rs,) is a linear function of relative humidity at the leaf surface (Collatz et al.,  1991): 

(12-81) 

where g:,  is the stomatal conductance at RHs = 1 and b is the minimum stomatal conductance at 
RHs = 0.  Clearly, it makes more sense that stomata react to the humidity at the surface of the leaf 
rather than the ambient air humidity at some height above the canopy. Although, a physical 
mechanism for this linear relationship to leaf surf ace RH has not been determined, experimental 
data shows it to be a very good fit (Ball et al.,  1987). Since leaf surface relative humidity is neither 
an easily measured nor a modeled quantity, it must be computed from other parameters.  According 
to the electrical analog, the humidity at the leaf surface (qt) is an intermediate potential between the 
ambient air humidity (qa)  and the leaf interior humidity, qs{T5 ) ,  where Ts is surface temperature and 
qs  is saturation humidity (see Figure 12-9 for the schematics of the derivation).  Assuming 
constant flux from the ambient air to the leaf interior, the relative humidity at the leaf surface (RHs 
= q/qlTs)) can be represented as: 

RH  =  qaga + q,.g,, 
(g_,,  + ga)q, 

s 

(12-82) 

where Ka  is the air conductance (Jl(Ra+Rbw))  and qs is short hand for qlTs).  If we assume that bin 
Equation 12-81  is small compared to gsr.  which will be true in all but the driest conditions, and g 'st 
is the result of Equation  12-78 without the effects of humidity ( g 'st  = F /rs1), then RHs is the 
solution of a quadratic equation which can be computed, once all the other components of Equation 
12-78 have been determined.  F3  is equal to RHs but with a minimum imposed at 0.25. 

12-45 

111111!!!:,,,, 

· 

1111111111 

1111111111 

'

1 11111;,1 

,· 

11111111 

111111 

I' 

8rnoi:~nt 8umidity 

1 

1
!!:i11::
l:",111 

= 1/ga 

Leaf Surface 
rn  Humidity 

Leaf Surface 

~t  1 /Qst 

.. 

' 

Figure 12-9.  Derivation of Leaf Surface Relative Humidity 

11111111111"' 

" 

•I, 

• 

"""' 

'•11'111 

•I, 

'•'II'  ""'"'II•• 

•''Ill 

'll•'lh,,I• 

'1111'"11 

11"""11111111111111111111" 

The fourth environmental stress function (F4  )  is related to ambient temperature.  Again, we deviate 
from the NP89 formulation which used a quadratic function peaking at the optimal temperature of 
298 K.  Instead, we followed the method of A vissar et al. ·c 1985) which results in a function  with a 
pfateau over a range of ''optimal temperatures; the idea being that temperature ( I;,) inhibits stomatal 
(yncfioq Qnly at extremes of heat or cold.  F 4  is defined as: 

1 

''"'' 

11• 

,!I 

'''11"11111 

11" 

1 

1 

'" 

,11111 

··•II!' 

1111111111

, 
1

1
11111·:.. 

1
11111 

1::.

11:,1 

·I·'' 

···· 

•.  F. .. ~.  ="'l''t(l +. exp[ti.r(T;, - br )]) 

· 

·  · 

(12-83) 

' ! 111111111 i i II 

, , 

: 

11 ' ' 

' ' 

I I i i ' ' 11 : 

' 1,, 

' ~ 

' ' 

' " " ' : " " ' : : : I 

I ., 

" 

I , 

: 

' , , 

' 

' ' " ' 

" 

"  ' 

' 

' ' 

where ar= -0.41  and br= 282.05 K for Ta:::;;  302.15 Kand ar=l.18 and br= 314 K for Ta> 
3'oi;~ lg·:K.  No'te'"ihat the hlgh side or"the function extends.into higher temperatures than suggested 
by A vi~'~ar ~1'"~.· ("'1985) ~ho used a b~ = 307. 95. The current function is very similar to the 
function used by Rochette et al. ( 1991) and is close to the high side of the NP89 F4  function. 
Resistan~es fo; alI ~f the no~-stomataJdry d~position patfi:~ays in the M3DdiiP module of MCIP 
are siffiilar to""'the"dri deposition modei'developed for the A.cid Deposition and Oxidant Model 

',, 

"' 

"' 

'" 

" 

' 

'I 

11 ! ~ : I ' 11 Ii " 

' 

, .... 

(ADOM) by Pleim et al. (1984) and later evaluated and modified by Padro et al. (1991).  As in 
ADOM, surface resistances to ground and leaf cuticles are scaled relative to the most well measured 
chemical species such as S02  and 0 3•  The term used for the scaling factor:  relative reactivity  has 
caused considerable confusion since many users try to find a chemical definition for this parameter. 
This factor has no chemical definition but is simply meant to be a relative scaling factor for the 
removal rate of different species at the ground or cuticle surfaces.  It is assumed that the relative 
propensity to deposit to different surfaces is similar, so that the same scaling factor can be used for 
ground and cuticles: 

~ 

rcut = rcuto A/A 

(12-84a) 

(1Z-84b) 

where rg0  and rcuro  are the ground and cuticle resistances, respectively, for the reference chemic&} 
species (usually S02  or 0 3 )  and A0  and A are the relative reactivities for the reference species and 
the modeled species, respectively. 

One improvement from the original ADOM model is the inclusion of an in-canopy aerodynamic 
resistance which is added in series to the ground resistance for the vegetated portion of the modeled 
area (fv)  according to Erissman et al. (1994): 

(12-85) 

where he is the height of the canopy.  For wet or partially wet canopies ifw), the surface resistance 
to wet cuticle is estimated as: 

(12-86) 

where KH  is the nondimensional Henry's law constant and a* is an aqueous dissociation factpf. 
The empirical factor (rcwo)  is set to 2.4x 108 s m· 1
,  which is similar to Wesely (1989).  For 0 3,  rcw 
is set to 1250 s m·1 based on field measurements.  The pH of the canopy water can be specified to 
compute a* for species such as S02  and NH3  which readily dissociate.  The canopy wetness 
fraction ifw) is provided by the surface model in MMSPX.  For deposition to open water, the 
ground resistance is replaced by a water surface resistance according to Slinn et al. (1978): 

(12-87) 

The parameters needed for the non-stomata! part of this model are quite uncertain for many 
chemical species.  Our latest estimation of these parameters for the species in the RADM2 chemic&] 
mechanism for which dry deposition is considered to be an important process are presented in 
Table 12-8.  The Henry's law coefficients in Table 12-8 are in non-dimensional form as the ratio of 
gas- to aqueous-phase. 

Molecular diffusivity and Henry's law have the least amount of uncertainty since these have 
definite chemical definitions and can be experimentally determined.  Relative reactivity, however, 

1 : " I ~ " : ' " 
i 1
l,,ll,1 
11"11 

' I  

" ' ' : 1111 " 

' " ' 

' 

' 

' 

is less well defined and is estimated according to experimental and modeling studies in the 
published literature .  The only organic species for which dry deposition is considered significant 
are the aldehydes, peroxides, and acids, all of which are soluble in water.  For these organic 
l~mped species the numbers for reactivity are merely educated guesses. 

Table 12-8.  Cheml.cal Dependent Parameters for M3DDEP 

,11111111'' 

,,'1111111111111111, 

·'"1"1111111 

" 

lh11lll111 

,, 

'l,,h 

1
'

1111111111 

,' 

111:::111,,, 

11111111 

'11111!11!11' 

Species 

111111":11111111 

biff 
(cm2/s) 

0.1509 
0.1656 
0.1594 
0.2402 
0.1628 
0.2626 
0.0938# 
0.1877# 
0.1877# 

• a 
(dimensionless) 
1000.0 
l.O 
10.0 
1.0 
1.0e9 
l.Oe5 
1.0 
l.O 
1.0 
1.0 
l.O 
1.0 
l.O 
1.0 
l.O 

sg2 
N02 
OJ 
Hz(}z 
HNOJ 
NHJ 
PAN 
NO 
HCHO 
ALD 
OP 
~aA 
ORA 
11111:· HONO 
co 
•  Updates based on literature review 
'Diff and H based on Wesely (1989) same as RADM 
+Estimated 
• gaseous phase  value/aqueous  phase value 

0.1525' 
0.1525# 
0.1220# 
0.1525# 
0.1525# 
0.2033# 

:11111:.1, 

11!1•'!1· 

I 

11111111111, 

1111111111, 

,I, 

Reactivity 
(dimensionless) 

8.00 
2.00® 
16@ 

301# 
800@ 

10.0 
4.0 
2.0+ 

10.0+ 
10.0+ 
10.0+ 
20.0+ 
20.0+ 
20.0+ 

5.0 

Henry's laws.  ( KH) 
(dimensionless) 
0.04 
3.5 
2.0 
4.e-7 
2.7e-7 
6.6e-4 

0.01 
23. 
4.E-6 
2.7e-3• 
l.7e-4# 

7.6e-5' 
1.0e-8• 
4. le-7• 

40. 

'fhe dissociation factor (a*) is simply defined as the ratio of the effective Henry's law coefficient 
to the actual Henry's law coefficient.  In this case, the effective coefficient is meant to i~clude both 
aqueous dissociation and aqueous reactions.  The a*s for S02  and NH3  are particularly important 
since their solubilities are greatiy effected by dissociation, which is a strong function of pH for 
both species.  Therefore, the model enables the user to specify the pH of the rainwater wetting the 
c~opy and let the model compute a* rather than use the default values in Table  12-7.  The a* for 
0 3 is also important since 0 3 is only slightly soluble so any enhancement can have a large effect. 
The value of 10 for 0 3  is meant to account for,  very approximately, aqueous reactions such as the 
oxidation of S(IV) to S(Vl).  Clearly, all of these parameters are quite uncertain and subject to 
r~y1s1on: 

"'llll,,,llll• 

''"· 

I  ' 

111111111:: 

" 

e 

' 

111

'

' 

' 

,,, 

:11111:;1;1:.,,,,, 

The main advantage of the M3DDEP model over the many similar models previously used in air 
quhlity modeling is the coupling to the land surface model for description of the stomata! pathway. 
This is a veryimportant t'eatiire for certain chemical species, particularly 0 3  and SO~, which have 

,,.,,1111!'!11111111111111 

'"""'"""""' 

" 

"' 

, 

, 

, 

· 

II• 

.. 

, ,, 

been shown experimentally to have a strong stomata! pathway components.  Several studies with 
this model have demonstrated its ability to realistically simulate both latent heat flux, with a large 
fraction from evapotranspiration, and ozone dry deposition, over com and soybeans (Pleim et al., 
1996; Pleim et al.,  1997).  These studies are continuing and are being extended to other chemical 
species (S02), and land-use types (deciduous and coniferous forests). 

12.3.3 

Cloud  Parameters  and  Solar  Radiation 

Cloud information is developed and used in  many different ways throughout the Models-3 CMAQ 
system.  For example, MM5 includes parameterizations related with subgrid convective clouds, 
grid resolved cloud water and microphysics, and cloud effects on radiation.  The CCTM needs 
cloud information for photolysis, convective transport, and aqueous chemistry.  Therefore, MCIP 
has an impo1tant role in providing cloud information to CTMs by either propagating information 
from upstream processors (MM5) or by parameterization. 

MCIP has multiple cloud parameterizations and functions depending on the options selected. 
There are currently two main options related to MM5 runs, either the standard MM5 version 2.6 
which does not include cloud cover and radiation parameters in its output, and MM5PX which 
does.  Later versions of MM5 (2.7, 2.8, and 2.9) also output these additional parameters. 
However, when MM5v2.6 or earlier versions are used, it is necessary to compute these parameters 
in MCIP.  Incident solar radiation at the surface is an important output from MCIP since it is used 
to estimate biogenic emissions in the emissions processor. 

Another cloud function  in MCIP is to diagnose cloud infonnation (such as cloud top, cloud base, 
liquid water content, and cloud coverage) which is passed to the CCTM to adjust actinic fluxes for 
computation of photolysis rates.  This function is executed regardless of the choice of the MM5 
version used.  In addition, grid resolved cloud water and rain water are propagated through MCIP 
from the MM5 output to CMAQ for use in aqueous chemistry and for photolysis calculations at the 
4 km grid resolution. 

12.3.3.1 

Cloud  Coverage 

The fractional cloud coverage scheme currently used in MCIP is the same as used in MM5PX and 
similar to the scheme used in the standard MM5.  Cloud cover fraction ( fck)  above the boundary 
layer is computed at each vertical model level k , according to Geleyn et al.  ( 1982), as: 

where RHc is the critical relative humidity defined as a function of a  as: 

( 12-88) 

We have modified the Geleyn scheme to avoid the overprediction of clouds in well-mixed 
boundary layers. Within the convective boundary layer (CBL) when RH> RHc  the cloud cover is 
es!lmate by: 

~Ir. = 0.34 RHk - RHC 
1-RH 
c 

Jc 

(12-89) 

where the critical relative humidity (RHc)  within the CBL is set to be 0.98.  The factor 0.34 is from 
the suggestion that convective mixing induced clouds within the CBL should not exceed the 
fq1~tional are3:,,,9f tJ!.e updrafts at top of CBL, which large eddy simulations estimate to be about 
34% (Schumann,  1989; Wyngaard and Brost, 1984) when inactive clouds are disregarded.  The 
re5ulting layered cloud fractions, from Equations 12-88 and 12-89, are used for both functions; 
mimely, to be used lo the surface radiation calculation when these parameters are not read from 
~5, and to derive the cloud parameters needed for the photolysis calculations. 

11 

''II 

., 

For the surface radiation calculation, the layered cloud cover fractions are aggregated into the same 
three broad vertical cloud layers (low, middle, and high) as in MM5, assuming maximum overlap. 
&ch layer is defined by pressure such that the low layer is between 97 and 80 kPa, the middle 
layer is between 80 and 45 kPa and the high layer is above 45 kPa.  These three cloud layer 
fractions are then used in the radiation calculation described in this section (12.3.3.2). 

~e photolysis model requires cloud information in a different form.  For the sake of consistency, 
these parameters are estimated from the same layer resolved fractional coverage described above 
(Equations  12-88 and 12-89).  The photolysis model assumes a single uniform, vertically mixed 
cloud layer.  Therefore, the required parameters are; cloud top, cloud base, cloud fractional 
coverag~. an cf average liquid water content.  Cloud top and base layers ( k 10p  and  kbu•e)  are 
d~~ermined by looking up and down from level of maximum coverage to where the fractional 
cqverage first becomes 50% of the maximum.  The layer average cloud cover is then computed 
from the volume averaging of layer cloud fractions between  k10P  and  k,,use : 

•'lll•1111i"llll1••I 

""11111'1111'"'',1 

''lh 

11

1111::,1!

.1., 

111111 

I 

111111• 

I 

"1 

' 

• 

'I.,, 

l:,.. 

k,.. 

!/"' = Lfc"L1z~ILL1z~ 

(12-90) 

" -

k,_ 

Once the base, top, and fraction of the cloud layer are determined, the average liquid water content 
of the cloud is computed assuming convective characteristics as described by Walcek and Taylor 
(1986), Chang et al. (1987), and Chang et al. (1990).  The lifted condensation level is assumed to 
be at the cloud base, defined as the bottom boundary of cloud layer kbuse , where the air is saturated 
at the model's ambient temperature.  The in-cloud liquid water profile (q) is then computed as a 
fraction of the adiabatic liquid water profile (qad): 

(12-91) 

where a = 0. 7 exp[ (p - Pic1) I 8] + 0.2  and  Pic1  is the pressure (in KPa) at the lifting condensation 
level according to Warner (1970).  The layer liquid cloud water values are then vertically averaged 
in the same way as fractional coverage (Equation  12-90). 

12.3.3.2 

Computation  of  Solar  Radiation  Components 

To meet air quality modeling needs, MCIP outputs several parameters related with radiation at the 
surface including: incident surface shortwave radiation (Rcmd),  absorbed surface shortwave 
radiation (G.,.,),  net long wave radiation at the ground (G1w),  total net radiation at the ground (Rnez), 
and surface albedo (A).  These radiation components are used in several CMAQ processors.  For 
example, photosynthetically active radiation  (PAR), which is needed for the biogenic emissions 
processing, is estimated with  PAR= 0.55Rcmd.  Depending on which version of MM5 is used, 
surface radiation parameters are either passed through from MM5 or computed in MCIP.  The 
computation of surface radiation parameters in MCIP is identical to the surface radiation option in 
MM5, as described in Grell et al.  (1995), except that the dependence on zenith angle is added to the 
land use specified albedo (A1u)  such that: 

A= A1u + O.l[exp(0.00386Z312

) - t.O] 

(12-92) 

where Z is zenith angle in degrees. 

Note that MCIP computations of surface radiation parameters, which essentially replicate MM5, 
are a stop gap measure for use with MM5v2.6 which does not output these values.  All later 
versions of MM5 do output these parameters which will be read and passed through by MCIP as is 
now done for the MM5PX option.  It will be preferable in future applications of Models-3 to 
directly propagate the radiation parameters from MM5 to CMAQ so that the more sophisticated 
radiation models now available in MM5 can be used.  The currently used surface radiation option 
includes effects of clouds, aerosols, and water vapor on radiation but neglects radiation effects on 
the atmosphere.  Therefore, many future applications may utilize either the Dudhia radiation 
scheme (Dudhia,  1989) or the CCM2 scheme (Hack et al.,  1993) which include atmospheric 
radiation effects.  See Chapter 3, section 3.3.4.1, for description of MM5 radiation options. 

1 ~.4  l\fete~ro~ogical Data  for  CCTM  with  Generalized  Coordinate  System 

"' 

'" 

"'" 

'" 

' 

'

I 

1 

'Ii 

,, 

1111,,,1

"""' 

11111111,," 

""''""' 

""""'':. 

, ,   " "  

1
1111:::11111111111111111 

','""  ,,,,1

ci'ne feature of"''ihe C:rvfAQ system"t:hat is distinct from other Eulerian air quality modeling systems 
is its ability to incorporate meteorological models with various different coordinates and dynamics. 
This functionahty is achieved by recasting meteorological parameters in terms of the variables used 
in the governing set of equations for the fully compressible atmosphere in generalized coordinate 
system (Byun,  1999a).  Key dynamic and thermodynamic parameters are estimated for the given 
coordinates in such a way to ensure consistencies among the meteorological data.  The consistency 
ccm be maintajnec:!: µiroughout CCTM simulations when appropriate temporal interpolation methods 
'  d 
~'~use ·· 
12.4.1 

Thermodynamic  Variables:  Pressure,  Density  and  Entropy 

,,1,,111:! 

111111:1"' 

0 

.. :111111111 

To facilitate mass-consistent interpolation among the them1odynamic variables, the governing set 
of equations for the fully compressible atmosphere is used in the CMAQ system.  The system 
iq9Iu9es prognostic equations for entropy and air density as suggested by Ooyama (1990). The 
algorithms used for estimating the thermodynamic parameters are presented below.  For a detailed 
cliscussfon on the governing set of equations and mass-consistent interpolation algorithm, refer to 
Byun (1999a and b). 
1"'2. 4 .1.1 

Pressure,  Density  of  Air  and  Density  of  Water  Vapor 

lli'I' 
' Ii I : ' ' : : : , ' ' ' : II ~ ~ ! i '  h 

11111111 
' 111 ! I ' 

!,' .. 1:1'.l.:.'•'.,'':I 

I 

' , , " 

'''I 

,,,, 

I,'' 

' ' 

• 

• 

' 

' 

Like most of the other meteorological models, MM5 does not use a predictive equation for air 
d~nsity.  Instead, air density is  estimated with the equation of state using predicted pressure and 
temperature.  For a terrain-influenced pressure coordinate, when it is applied for hydrostatic 
atmosphere, the hydrostatic pressure ( p) can be computed with  µ•  available from MM5. 

(12-93) 

1J:ie total pressure (p) in the terrain-influenced reference pressure coordinate (applied for a 
nonhydrostatic atmosphere in MM5) is the sum of the reference pressure and perturbation pressure: 

Once p  is known, virtual temperature ( T., ) and density of the (moist) air are computed with: 

(12-94) 

(12-95) 

~here mw  and  md  are the molecular weights of water vapor and dry air, respectively , and 

,1111,.':; 
I 
~ 

;! 

p = _!!_. 
RdJ: 

'''I 
,,11 

1
' ,   " 

~ " 11 
''.111!"
, 11
~ 

1 

" 

(12-96) 

The water vapor partial pressure ( Pv) can be found from the vapor mixing ratio (r) supplied by 
MMS using the following equation: 

EPA/600/R-991030 

Then, the density of water vapor is simply given as: 

r 

Pv  =  l+rp. 

12.4.1.2 

Entropy 

(12-97) 

(12-98) 

In the CMAQ system, entropy is treated as one of the key thermodynamic parameters.  Because its 
conservation equation follows similar continuity equation for air density, entropy can be 
interpolated using the same interpolation scheme as air density.  Then, we can reconstruct 
temperature and pressure for the intermediate time steps from the interpolated densities (for air and 
water) and entropy.  This type of interpolation will maintain mass consistency among the 
thermodynamic variables for air quality applications.  Using the density of moist air and density of 
water vapor obtained above, the entropy for ~oist air can be computed with: 

(12-99) 

where  pd= p - Pv•  p00 =105  Pascal, A 00  is the specific entropy of saturated vapor,  pd 
density of reference dry air, and Pv•o  is the density of reference state water vapor saturated over 
water at reference temperature T,, 0
Ooyama (1990): 

,  273.15 K.  The integral constants are computed following 

is the 

00 

Poo 
Pdoo  =RT 
d  00 

A  = A(T  ) = 1) T  dlnE(i::) 

dT 
c 

Too 

oo 

oo 

.. "'  oo 

-

- E(i::) 
Pv•o  - Pv•(T,,J - - -
~T r. 

00 

(12-100) 

(12-101) 

(12-102). 

where  i:: = T-273.15. 

For the basic formulation of the saturation vapor pressure approximation, we use the AERK 
formula recommended by Alduchov and Eskridge ( 1996): 

12-53 

1, . .  :!' 

111
1

111111 

111111 

,,·:11111!111" 

EPA1600IR-99to3o 

,,,,111111.11 

,, 

111 

,,;"'[' 

11· 

:,','1'" 
'I, 

E(T,) = aebT,l<c+T,) 

111,.i' 

II 

dlnE(1~) _ 
-

dr:: 

be 

(c + r::) 2

' 

'II' 

I 

•111111111 

.11' 

:1; 

, 

'.':,jlllljll'. 

111

, ,

1iii11I! 

"', 

'11111111 

1:,"' 

(12-103a) 

(12-103b) 

where a=6 l0.94, h=l 7.625, c=243.04 and E(r::)  is in Pascal.  With this information we can 
evaluate the integration constants, and thus the entropy using Equation 12-99. 

12.4.2 

Vertical  Jacobian  and  Layer  Height 

In  the CCTM, Jacobian is used for the definition of vertical and horizontal coordinates/grid system 
at ,svery model synchronization time step.  The Jacobian characterizes the coordinate transformation 
and is tre:ited as one of the fundamental parameters definin~ grid structure of the CTM.  Depending 
on'll'll'ifie  honzop~~ m~p projections and vertical coordinates, the physical characteristics of the 
JaGobian change. 

, 

'1111, 

12.4.2.1 

Jacobian  for  Coordinate  Transformation 

The vertical Jacobian defines the coordinate transformation rules.  For a vertical coordinate  £ 3  = ~ , 
where <;,  is a monotonically increasing function of height, the Jacobian is related with the 
geopotential height,  <P = gz, as: 

J  _ .!..  a<P  = _!. _a<P_ 
g  a;;, 
~ - g  a;;, 

(12-104) 

1111111, 

1111111• 

111111 

Si~ma- p.  time  dependent  coordinate 

11111 

11!~1"  " 

'I 

' 

"11'"1111' 

:1· 

' 

·::111· 

' 

' 

'  '!!I!:" 

FOr hydrostatic application of MMS, the vertical coordinate is the same as the terrain-influenced 
sigma- p coordinate, whose vertical Jacobian is defined as  .,, 

J  = f/(x,y,t) 
a,. 

-pg 

(12-105) 

N?te thatEquations  12-3 and 12-105 are identical although CMAQ uses monotonically increasing 
coordinate <;,  and MM5 uses monotonically decreasing sigma- p coordinate. 

U~,ing the Equation of State and the definition of the sigma- p coordinate, the vertical Jacobian can 
be obtamed usmg the temperature and surface pressure from MM5. 

II  ~II,, 

•' 

'" 

111111 

"' 

''" 

I' 

'I, 

I, 

' 

,, 

,1, .. 1 

'"'""' 

lh,lh 

Jacobian at half sigma-level is estimated for  1 ~ k ~K with: 

(12-106) 

12-54 

where K is the number of model layer (i.e., NLAYS in Models-3 I/O API), and Jacobian at full 
sigma-level is computed for  1::;; k $K-l with: 

EPN600/R-99/030 

k+112  R. p-·. (Tk+I + Tk  ) 

=  arr 

vH 
2g(a;+112p"+pr) 

vH 

J 
u,,  F 

)

( 

and, at the surface (k= 1/2) with: 

k=112 

J 
)
( 
u"  F 

= 

R. p-"  • T 
vs 

air 

g( a~=112 p*  +Pr)' 

(12-107) 

(12-108) 

where we have used  I;, ..  to represent the virtual air temperature at the surface. 

For the thirty layer MM5 sigma- p coordinate, whose sigma value for the top of first layer is set 
0.995 (i.e., about 38 min the standard atmosphere), the reference temperature is estimated from 
the average between the skin temperature ( ~ ) and air temperature at the lowest model layer.  The 
virtual air temperature at the surface is computed with the assumption that the relative humidity at 
the surface is the same as the relative humidity at the middle of first layer. 

Time  independent  coordinate 

For the nonhydrostatic application of MM5, we use the ten-ain-following sigma- p 0  coordinate 
whose vertical Jacobian is defined as: 

(12-109) 

Again, Equations 12-6 and 12-109 are identical although CMAQ uses monotonically increasing 
coordinate; and MM5 uses monotonically decreasing coordinate.  Using the Equation of State for 
the reference hydrostatic atmosphere and the definition of the sigma- p 0  coordinate, the vertical 
Jacobian can be obtained using the temperature and surface pressure from MM5.  Jacobian at half 
a-height is estimated for  1::;; k $K with: 

k 
)  = 

(J 

CTPo  H 

] 
R. p* •  T  +Aln(  HPo  Pr) 
air  o 

ak  • + 

os 

[ 

g(a~p= +Pr) 

Poo 

and Jacobian at full  a-height is computed for  0::;; k::;; K  with: 

R. p 0  •[T  +Aln(a~+ 112p; +Pr)] 

air  o 

os 

Poo 
g(a;+112p; + Por) 

)k+112  = 

J 
ur.  F 

(

12-55 

(12-110) 

(12-111) 

"'' 

EP A/600/R-99/030 

' 

'"""" 

The Jacobian does not depend on :MMS data except for the topographic height and sigma-layer 
d~flnitio'n. ·  " 

· 

' 

Total  .Jacobian 

1 

)  is used in the governing equations for the CCTM.  The trace 

The total Jacobian (.Jr== J~ I m 2
species concentrations are coupled with the total Jacobian.  Because of the need to couple with both 
•  ~~1  traC~ ~pecies concentrations (defined at the layer middle) and vertical flux variables (defined at 
~;·1~ye~'1foterfiice); total Jacobians at the half and full level values are stored in the MET_CR0_3D 
file.  The total .. fac~?i~ at the surface, (lap ):=112 
divided by the map scale factor squared, is stored 
in the :MET_CR0_2D file.  For hydrostatic applications of MM5 the Jacobian varies with time and 
fQX: nonhydrostatic applications it is constant with time.  Although we could have saved some file 
space by distinguishing this feature, the Jacobians are stored in MET_CR0_3D and 
.MET_CR0_2D files to maintain the compatibility of data structure for both time-dependent and 
time-independent coordinate systems. 

"'1,11"" 

"'1111'1''11' 

I 

1'' 1[11' 

For use in the mass-conserving temporal interpolation, Jacobian weighted densities at the half(cid:173)
levels defined ''.for' fs; k s;K  as: 

" 

1
11111111" 

(12-112a) 

(12-112b) 

are stored in tlie MET_CR0_3D file.  Like density, the Jacobian weighted entropy at the layer 
middle is obtained for 1 s; k -5.K with: 

111111111' 

'llllli 

''"'I 

(12-113) 

They are stored in the MET_CR0_3D file as the Jacobian-weighted total air density and water 
vapor density, and entropy, respectively. 

12.4.2.2 

Layer  Heights 

~ .. CMAQ, la~:r ~~ights are computed using the basic definition of the geopotential height in terms 
0~11,~aco~i3:11 ~~11~1~~~2 of re~xing .on the coordinate-specific analytic equations, such as a hypsometric 
equation for a hydrostatic coordinate.  The height above mean sea level (MSL) is defined in terms 
of the vertical 1 acobian as: 

' 

! 

111· 

Ii 

"I 

,1111:. 
"';II 

1111. 

111 

....  ':111

I' 

'l .. illi 

Z = cf>/ g = Zs + 

., 
'I 

' 

' "  

•1,·1111:' 
Ill 
111 
::.illl,,:: 

... 

'' 

,, 

' 

J  d~ 

I~ 
~.  ~ 
''  :: 

' 

. 

' 

The layer heights at the interface and middle of the layers above the ground level (AGL) are 
cgmputed with: 

12-56 

(12-114) 

for  1 s; k S:K+l  where 

' 
= 0 

zk+112I 

F 

k=O 

and for 2s; k S:K with: 

ZH-z  Z-

,..k  -

k  -
. 

,.. 
s 

~. 

- f ~~ J d~' 

" 
.. 

where 

EP A/600/R-991030 

(12-115a) 

(12-115b) 

. (12-116a) 

(12-116b) 

Note that bothz~+ 1 ' 2  and  z~ are stored either in the GRID_CR0_3D file for the time independent 
vertical coordinate, or in the file MET_CR0_3D for time dependent one.  Because  z~+ 1 ' 2 lk=O is 
always zero for the terrain-influenced coordinates, it is not stored in any of MCIP files. 

12.4.3 

Contravariant  Velocity  Components 

The generalized CCTM requires a set of contravariant velocity components to simulate numerical 
advection.  Contravariant velocity components are scaled components of the wind vectors for the 
transformed coordinates.  When the true velocity components (i.e., wind components for earth(cid:173)
tangential coordinates) are predicted in a meteorological model, they need to be transformed 
accordingly. 

12.4.3.1 

Horizontal  Wind  Components 

MM5 predicts horizontal wind velocity components defined on the spherical earth in the coupled 
form with the surface pressure scale  p • .  First, we need to de-couple the surface pressure scale as 
follows: 

vt+112,m+li2  = (p ·v)/+112,m+l/2 l(p. )/+112,m+112 

(12-117a) 

(12-117b) 

for OS l SL and OS m <5:.M,  where Lis the number of columns and Mis the number of rows for the 
rectangular modeling domain.  In the expression,  p •  represents either  p • or  p;  depending on the 
hydrostatic/nonhydrostatic option in MM5.  The value  p 0  at the dot-point is approximated with: 

(12-118) 

The next step i~ to compute the contravariant components  u~ = ~U and  v~ = mV at 1the dot-point: 

I 

,,111111,1i 

11111!: 

(u~)1+112,m+112 = ni1+112,m+112u1+112,m+112 

:II' 

(v~)1+112,m+112 = m/+112,m+112yl+112,m+112 

(12-119a) 

(12-119b) 

Because the Jacobian-mass weighted contravariant wind components are needed for the mass 
consistent interpolation, we estimate these quantities at the square-point (flux point) for x1 
direction and at the triangle-point (flux point) for  .X2 -direction, respectively: 

-

(12-120a) 

(12-120b) 

Both of these parameters, together with the contravariant wind components  u~, and  v~ at the DOT 
points, are stored in the MET_DOT_3D file. 

,:':I''" 

' I l l  

"I 

'" 

.I" 

I. 

I" 

I 

" 

12.4.3.2 

Vertical  Wind  Component 

In most meteorological models with terrain-influenced coordinates, the contravariant vertical 
v~Iocity components are not computed directly because of the complex representation of the 
di:yergence term in the generalized coordinate system.  In the generalized coordinate system, the 
prognostic equation for the vertical component contains Christoffel-symbols-of-the-second-type 
terms that make the equation not only complicated but also make conservation of momentum or 
kinetic energy difficult (Byun,  1999a).  To circumvent this difficulty, some meteorological models 
use the prognostic equations of motion for the true vertical wind component. 

I 

''1

11111111 

Ill 

, 

1' 

1 

!lllllll 

llp'' 

'Ill:,,,,,,,,,. 

For the MM5 hydrostatic application, the terrain-influenced hydrostatic pressure coordinate allows 
diagnostic computation of the contra variant vertical velocity.  The continuity equation for air 
dcwsity becomes a diagnostic equation for this application.  ·Here, the expressions are written with 
the normalized, vertical coordinate, which increases with geometric height,  ~ = 1- <J';.  By 
se~ecting the i~tegration limits as  ~ = 0 to  1, (i.e.,  <J' f>s  = 1 to  <J' f>T  = 0) and using the boundary 
cqnditions at tq~ tO.IJ  and bottom  ~ = v3  = 0 , the tendency term can be computed with: 

.. ,.... 
,, 

'"··""' 
:11111lli,1I 

',1: 1li1l1:::!!! 

I 
I, 

I 

,,,'"11111, 

1111111 

, 

1
:"' 

" 

,,, 

,, 

'II 

'" 

'" 

I 

I" 

'" 

1, 

I 

1
'

1,'I• 

• 

(12-121) 

This equation predicts time rate change of the hydrostatic pressure component whose vertical 
gradient is in balance with gravitational acceleration.  In the geometric height coordinate, this 
equation does not exist.  However, the height coordinate does not require surf ace pressure 
tendency to close the system because the coordinate is time independent.  Because the hydrostatic 
pressure coordinate  i; = 1 - c;;;  is a material coordinate, the mass continuity equation can also be 
used to estimate contravariant vertical velocity component by integrating the wind divergence term 
either from the bottom to a level i; or from the top to i;. 

(12-122a) 

(12-122b) 

where  i;r  =  1. 

For other coordinates that do not have diagnostic relations, the contravariant vertical velocity 
component should be estimated using standard coordinate transformation 

~ = v3  = ~ +(-mV~ • V~hr +w{~) 

(12-123) 

where hr is the height of the coordinate surface and w is the regular vertical component of wind. 
For nonhydrostatic MM5 applications,  i; = 1 - a Po  is the corresponding vertical coordinate in 
CMAQ.  Equation 12-122a can be rewritten as: 
a.  • 
j; = -d"  = [-1!!!..._vp_,, ](mU) + [-1!!!... 
'Po  ](mV) + Pog W 
. ax2 
• 
'::> 
Po 
Po 

(12-124) 

Po 

•  a~i 

tx 

po 

Ci 

;),..,* 

Ci 

Like the horizontal momentum components, we need the Jacobian-mass weighted contravariant 
vertical wind for the mass consistent interpolation. The quantity is computed with the thickness(cid:173)
weighted density as: 

(12-125) 

where .f/+112  = cz;+l/2 - z~) /(z~•I - z~).  Note that  (pl; ~) is defined at the layer interfaces.  It is 
zero at the earth's surface (no-penetration boundary condition) and therefore not included in the 

m 

12-59 

''1 
,1111 

EP A/600/R-99/030 

i,11!,,, 
1:11 

output.  It also vanishes at the top of the modeled atmosphere.  The quantity  ( pJf ~) is stored in 
theMET_CR0_3D file from k=l to K (i.e., NIAYS) with the variable name (WHAT_JD). 
. 

I  m 

,,,,1''l·11illl111ll:' 

lllllllllrh 

''''""11111111 

1111111111: 

11" 

"' 

'"·' 

'"',,, 

,.," 

"'' 

I 

·II 

', 

,, 

,, 

"" 

' 

I 

""" 

I, 

llll'"lll' 

""II 

11

' ' 1lli11illlll"lllh• 

I 

II 

" 

,' 

I 

1' 

12.4.4 
Parameters 

Mass  Consistent  Temporal  Interpolation  of  Meteorological 

In the CCTM, the temporal interpolations of meteorological data are needed beeause the output 
frequency of the meteorological data is usually much coarser than the synchronization time step of 
the chemistry-transport model.  Consistency in meteorological parameters such as, Jacobian, 
density of air (total), density of water vapor, entropy (or temperature), and pressure are important 
for the science modules in the CCTM. 

Here, we recommend interpolation schemes for density and velocity fields that maintain mass 
consistency.  First, the Jacobian and density at a time  ta= (1- a)tn + atn+t  between the two 
c~,!:!-secutive o~tput time steps,  tn  and  tn+t , are expected to be interpolated with: 

..  (plt;)a = (1-a)(plt;)n + a(plt)n+t 

::· 

1
1111 

'

(12-126) 

(12-127) 

where  0 ~ a ~ i . The Models-3 I/O API provides a convenient function call (INTERP3) for the 
linear interpolation of grid variables. The premise used here is that the Jacobian is a fundamental 
qu'antit}t that 'detemliries""tlle coordinate system.  Den'sity ofwater vapor (pv) and entropy should 
follow the same interpolation rule (Equation 12-127).  Then densities and entropy at  tn  are 
cqµiputed with 

It is obvious that the functional form of the Jacobian (which depends on a vertical coordinate) 
changes the characteristic of density interpolation.  For nonhydrostatic MM5 runs, where the 
Jacobian is constant with time, the density is simply interpolated linearly with time. 

(12-128) 

1
'' 

11 

When the den~ .. !ty tendency term is available from the meteorological model, or can be computed 
from diagnostic relations for certain choice of vertical coordinate system, one can use a piecewise 
cu.bic spline interpolation method for  (pls) : 

111'"1'"""' 

..  •, 

11111,11111 

I• 

,' 

11111111111, 

I 

,II' 

11: 

"' 

' 

(pJ:s)a  "= aa3 + ba2 +ca+ d 

(12-129) 

12-60 

:::1111: 

"lliillk 

I" 

' 

b = 3[(pJJn+I -(pJs)n]-2L1{ d(~s) )n  - L1{ d(~s) l+l 
c=L1{ d(~..)l 

EP AJ600/R-99J030 

The density of water vapor ( Pv) and entropy should be interpolated with the same method.  The 
density of dry air from the total air density can be obtained by subtracting Pv  from p.  The 
interpolated temperature is computed with: 

(12-130) 

and entropy can be computed with Equation 12-99.  The interpolated pressure is computed with the 
ideal gas law, 

(12-131) 

Next, wind components multiplied with the Jacobian-weighted density are interpolated linearly and 
the interpolated wind components are obtained by dividing the results with  (pJ .. )a: 

(12-132a) 

(12-132b) 

(12-133a) 

(12-133b) 

When density and wind data are not collocated, the above procedure may incur spatial interpolation 
errors. 

12.4.S 
Meteorological  Data  for  MMS 

Optional  Conversion  of  Nonhydrostatic  Data  to  Hydrostatic 

There may be a special situation when a hydrostatic CTM run is desired while the MM5 run is 
made with the nonhydrostatic option.  In such a case one may want to redefine the nonhydrostatic 
coordinate into hydrostatic one while keeping the profile data as provided.  In spite of many 
theoretical problems with this kind of data conversion, MCIP provides an option to convert the 
nonhydrostatic coordinate into the hydrostatic pressure coordinate.  Use of this option is not 
r~omm~nrj~ fo~ ~ci~ntifi!?ally rigorous computations.  However, this is a useful option for certain 
purposes such as code development and test.mg of a hydrostatic CTM. 

' , , , ,  

11111,111111111111111, 

'"""""""" 

,111111111111,11, 

"'"'' 

' 

• 

' 

' 

' 

,., 

• 

' 

' 

,,,,,,,,1111 

"" 

Nonhydrostatic and hydrostatic coordinates can be compared in terms of the atmospheric pressure. 
Pressure in a hydrostatic MMS run is defined in Equation 12-93 while the same in a hydrostatic 
MMS is defined in Equation 12-94.  Then, the difference in the nonhydrostatic and hydrostatic 
pressures is: 

p· = p;-a-1(p- p)+a-•pP 

111" 

(12-134) 

If we force the hydrostatic pressure to be that of nonhydrostatic coordinate, i.e.,  p  z  p at the 
surf ace, the time dependent surf ace pressure,  p; , can be estimated with: 

(12-134') 

where  a~ 2  =as= 1 is used.  Here, the perturbation pressure at the surface is assumed to be that of 
layer 1 hecau'se the real slliface perturbation pressure is not provided by the nonhydrostatic MM5. 
Q!}e can r~Ci~[f,pe,,,~be verti~!tl COO~Hin~te to be hydrostatiC with the time dependent surface pressure. 
'!]:le difficlllty of converting nonhydrostatic meteorology data into hydrostatic data is not in the 
e~~imation of pressure surfaces, but rather in the representativeness of profile data because of the 
change in the layer definitions. 

11111111111111 

' 

"""'" 

""''"" 

'" 

,111:''lli1 

,111111 
111:1" 

llh 

1111 

1111111 

11111111111 

12-62 

! I i 1111 ~ : : 

11111, 

111111, 

12.5  Operation  of MCIP 

Because MCIP is a Models-3 conformant processor, it needs to be compiled and executed using a 
Models-3 build command (m3bld) with a configuration file.  It requires the grid-domain object 
include files to define output domain and resolution.  In most cases, the user does not need to 
define input data domains and resolutions because reader modules can extract the information from 
file headers.  MCIP code structure, compilation and execution procedures are discussed below. 
Additional operational information for preparing MCIP through Models-3 system framework can 
be found in Chapter 7 of the EPA Third-Generation Air Quality Modeling System User Manual. 
Also, the User Manual Tutorial for the initial public release of Models-3 provides step-:by-step 
instructions for running MCIP with a set of sample examples. 

12.5.1 

MCIP  Modules 

MCIP code is archived with CVS (Concurrent Version System) (Cederqvist,  1993) in the Models-
3/CMAQ system.  Currently, eleven module classes are defined for MCIP.  The classification 
makes it convenient to customize MCIP code for special situations.  For example, when different 
meteorological inputs and process options are needed to link with the CCTM, appropriate modules 
from different classes can be used.  Refer to Table 12-9 for the details of module descriptions and 
associated source code. 

12.5.2 

Building  MCIP 

The MCIP code conforms to the Models-3 coding standard.  It is designed to be compiled using 
m3bld with a configuration file.  Refer to Appendix  12C for a sample MCIP configuration file. 
The user needs to retrieve the source code (main program, associated subroutines for selected 
modules, and include files) appropriate to the user's choice of optional modules through the CVS 
system.  There are four kinds of include files for this processor.  Three include file types, Models-
3 1/0 AP! include files, MCIP' s global include files, and MCIP module specific include files, are 
fixed.  The fourth include file type describes dimensional information of the input meteorology data 
~nd, as an exception, must be edited to match the number of vertical layers in the input. 

The parameter MAXK in MCIPP ARM.EXT may need to be changed large enough to accomodate 
the dimensions of the number of layers for the meteorological data.  Horizontal domain information 
is obtained from the header of MMS files automatically.  MCIP expects that include files for the 
CTM grid/domain domain (HORD.EXT, VGRD.EXT, COORD.EXT), for which the data will be 
extracted, are provide by the user.  Vertical collapsing is done automatically when the number of 
layers in VGRD.EXT is less than the number of layers in input data and the coordinate interface 
values match as shown in Table 12-5.  When a few lowest input model layers are collapsed into 
one for the output, only diagnostic option can be used because the surface flux  values and 
aerodynamic resistance passed through are no longer valid due to the change in the thickness of the 
lowest layer.  The M3DDEP option must not be used when collapsing the lowest model layers and 
doing so will be violating the parameteric values passed through from the meteorological model. 

Table 12-9.  MCIP Module Definitions and Associated Source Code 
Class 
driver 
input 

Description 
controls main computational flow 
reads in MM5 output files 

Module 
mcip 
mrn5 

,111::11 

11111,,, 

,, 

'", 

.:1•.,1, 

1111"''111·111, 

fakemet 

rams 
m3radm 
pblpkg 

rOOmcld 

1
:111111111111111 

·11111:

,, 

'I',  ':1!11'" 

cmaqdd 
radinkiio 

land use 
phi 

drydep 

111111111111 

cloud 

s~Jar 

solnr_px 

···.n'et3d 

m3sup 

11111111111· 

output 

util 

,":.11111,' 

stnd 

util 

reads in MCIP output files 
generates meteorology fields for idealized flow  field 
stud 
reads in RAMS J/O API output files 
reads in landuse data in RADM dry deposition category 
computes PBL parameters 

computes dry deposition velocities using Wescly's 
RADMmethod 
computes dry deposition velocities using Pieim's 
CMAQmethod 
computes cloud parameters using convective column 
assumption 
computes solar radiation using the algorithm 
implemented in MM5-PX version 
computes supplemental three-dimensional variables 
needed for CMAQ 

generates MCIP output for standard variable lists 

collection of utility subroutines 

icl 

1111111:::1, 

ic{ 

MCIP specific include files 

11 

11'"1

',,i,1'' 

12-64 

Source  Code 
riicip.F,  initx.F 
getmet_mm5.F, 
rea:dmml.F, 
readmm2.F,  getgist.F, 
MM5INPUT.EXT, 
MM5HEADER.EXT 
getmet  m3.F 
getmet_m3fake.F 

not available 
getluse.F 
pblpkg.F,  pblpwr.F, 
sfcflux.F,  slflux.F 
radmdry.F, 
DDEPSPC.EXT 
not available 

bcldprc_ak.F 

solar.F,  transm.F 

layht.F,  verthat.F, 
vertnhy.F,  verthyd.F, 
jacobi.F,  met3dsup.F 
comheader.F, gridout.F, 
metcro.F, metdot.F 
bilin2d.F,  bilin3d.F, 
cvbdx.F, collapx.F, 
cvmgp.F,  cvmgz.F, 
ratint.F,  errmsg.F, 
sanit  .F 
CONST_mete.EXT, 
C9NST_pbl.EXT, 
FILES3_MCIP.EXT, 
GROUTCOM.EXT, 
INFILES_MCIP.EXT, 
LlµDMDAT.EXT, 
MCIPCOM.EXT, 
MCIPPARM'.EXT, 
MCOUTCOM.EXT, 
MDciUTCOM.EXT 

Executing  MCIP 

12.5.3.1 

Run  Script  Command  File 

As with other interfaces, an execution run script is used to define key environmental variables 
prescribing run-time characteristics and linkage between logical file names specified in the codes 
and actual files for input and output.  A sample script for MCIP execution can be retrieved from the 
CVS archive and edited for the user's particular application.  The user may modify environmental 
variables for choosing different processing options and for defining input and output files.  Refer 
to the APPENDIX D for a sample MCIP run script.  For processing MM5 output, MCIP may not 
need to be co-resident with MM5 if its output files are in IEEE binary format.  MCIP can be run on 
any UNIX computer for processing meteorological data in Models-3 I/O API format. 

Input parameters METROW, METCOL, and METLA Y are defined through the UNIX 

. environmental variable list.  These are used to check if the input meteorology data have correct 

dimensions as expected.  Within MCIP, the actual values will be picked up from header 
information of MM5 data file.  When offset values (IO, JO) are inconsistent with the information in 
MM5 header and in COORD.EXT, MCIP suggests a new set of (IO, JO) or (XORIG, YORIO) 
values.  Make sure to set NDEP to correspond to the number of lowest input layers being collapsed 
into the lowest output model layer, so aerodynamic resistances are computed accordingly. 

12.5.3.2 

Input  Files  for  MM5  Data  Processing 

Logical names of input files are described below: 

• 

• 

• 

MMOUT_DOMAIN#:  This standard MM5 file contains gridded hourly (or sub-hourly) 
two- and three-dimensional meteorological data covering the entire MM5 domain. 

MDL3_DOMAIN#:  This is optional EPA added MM5 output that contains file contains 
PBL parameters needed when the pass-through option is chosen. 

LAND_CR0_2D_##KM:  This is LUPROC output that contains  I I-category fractional 
land-use data covering the entire MM5 domain.  If USGS North American land/vegetation 
characteristic data base used as input to LUPROC is not enough to cover the desired 
domain, dominant landuse file LANDUSE_DOMAIN# from TERRAIN, a preprocessor 
for MM5 system, can be used. 

12.5.3.3 

Input  Files  for  1/0  API  Meteorological  Data  Processing 

MCIP can be used to extract meteorology data for a smaller window domain, to collapse number of 
layers, or to process meteorological data already in I/O API format further.  It treats gridded input 
meteorological data as pseudo profiles for temperature, moisture and wind components.  Required 
I/O API meteorological inputs for this option are; GRID_CR0_2D, GRID_DOT_2D, 
MET_CR0_2D, MET_CR0_3D, and MET_DOT_3D files.  Because it does not use boundary 
files as its input, the output domain can be as large as (NCOLS-2)x(NROWS-2) for windowing or 
layer collapsing process.  This option can be used to generate interpolated meteorology data for 
higher resolution grid than the original input as well. 

12-65 

Description 

Note 

number of layers in input meteorology 
data 
column (east-west) direction cell 
dimension In input meteorology data 
row (south-north) direction cell dimension 
.. 
in input meteorology data 
location of CTM domain origin offset in 
row direction= ROW  OFFSET 
location of CTM domain origin offset in 
column direction= COL=OFFSET 
file type for landuse data 

should be larger than or equal to 
CTMNLAYS 
should be larger than CTM 
NCOLS  ... 

.. 

. 

. .. 

should be larger than CTM 
NROWS 
offset should be counted based on 
the input grid definition 
offset should be counted based on 
the input grid definition 
1: TERRAIN binary  13 category 
2: preprocessed ASCII 11 
category 
3: MM5 dominant landuse 
category 
4: use landuse in GRIDCR02D 
5:  use USGS 1/0 API landuse 
file 
offset should be counted based on 
the input grid definition. For 
LUTYPE 4 & 5, IOLUSE is  not 
used 
offset should be counted based on 
the input grid definition. For 
LUTYPE 4 &  5, JOLUSE  is  not 
used 
TRUE: re-compute PBL 
parameters 
FALSE: pass through from 
MM5 
TRUE: use surface layer 
similarity 
FALSE:  use  PBL similarity 
TRUE: use CMAQ dry 
deposition 
FALSE: use RADM dry 
de  osition 

EP A/600iR-99l030 

lllllllllh' 

1)1ble 12-10~ "" MQJP Environmental Variables 

Environmental 
Variables 
METI.AY 

METCOL 

METROW 

IO 

JO 

LUI'YPE 

IOLUSE 

JOLUSE 

location of CTM domain origin offset in 
row direction w.r.t. landuse data origin 

location of CTM domain origin offset in 
column direction w.r.t. landuse data origin 

LCALCPBL 

flag for estimating PBL parameters of not 

r;§LFLUX 

flag for similanty algorithms 

LM3DDEP 

flag for dry deposition algorithm 

12-66 

Table 12-10.  MCIP Environmental Variables (continued) 

EP A/600/R-99/030 

Description 

Note 

flag for wind field correction 

0 (default): no correction 
+/- 1,2,3 wind field correction 
options (TBD) 
TRUE: compute cloud 
parameters 
FALSE: pass through from 
MM5 
TRUE: forces hydrostatic data 
output with approximations 
FALSE: pass through from 
MM5 
I  (default): time dependent 
0 (special): time independent 
TRUE: check 
FALSE: do not check 
2 (default):  100% increase when 
urban and water areas are 
coexistin 
(yyyyddd) 
(hh) 
(hh) 
(hhh) 
1 (default) 

FALSE (default) 

Environmental 
Variables 
LWIND 

LCALCCLD 

flag for cloud algorithm 

LHYDOUT 

flag  for hydrostatic output 

CRO_FfYPE 
DOT_FIYPE 

LSANTIY 

BMAX 

flag for 110 API file type 

flag for checking ranges of output 
parameters 
Maximum boost rate for urban area 

JUDA TE 
HSTRT 
HTOSKIP 
HTORUN 
NDEP 
GRDNAM 
EXECUTION  ID 
SCENFILE 
IOAPI_CHECK_HEAD 
ERS 

Julian date for the start time 
start hour 
number of hours to skip MCIP process 
number of hours to run 
number of deposition layers 
grid/domain name for MCIP output files 
user defined execution ID 
user defined file path 
flag for checking 1/0 API file headers 

12-67 

" ' ! ~ '  i I I I I ::' 

,,. 

"II' 
i!Jii: 

11111 

111, 

'II 

11111111111' 

,, 

EPN600/R-99/030 

!llll!llllli 

I 

i I ' 

1111 : : ~ II : I ! i ; : : ' 

' 

' I 

: ' I : 1111 : ; ; : ! ! ~ I 

,,  1:!!ble  1,7-1 L,,,,!YIG!P file ~inkage 

' " '  : : : : 1111 : ,, 

I ' 

I 

I 

' " 

'"',, 
' 
' 

11

1' 

:1!!

Environmental 
Variables 
MMSl 
MM52 
LU13 

11

11111111

::,, 

::1111111111':"" 

LUSE 

GRID.,DOT_2D 
M'E'r_cR.oP1t20·········· 

MET0 DOT.3D 
GRID,,,,BDY _2D=G l 
GRID.BOY  3D_G l 

,.  MET_CR0_2D_Gl 

,,  MET_DOT.3D_Gl 

Description 

Note 

for mm5  input module 
for mm5 input module 
.,  applicable for LtJrYPE =  1 
applicable for LUTYPE = 4 or 5 
for II13  input rrioCiufo 
for m3  input module 
for m3 input mocfofo 
for m3  input module 
for m3  input module 

Input filename for MM5 l  data file 
Input filename for MM52 data file 
~nput filename for TERRAIN binary 
land use 

, .. 

,. 

,. 

input filename for I/O API landuse file 
input fiieilaffie  for GRID  cR.o  2D 
input filename for GRID__,DOT_2D 
lllput filename for M:Et  cR.o  2D  · 
input filename  for MET  CR0_3D 
input filename for MET  DOT _3D 
output filename for GRID  BDY _2D 
output filename for GRID_BDY =3D 
output filename for GRID  CR0_2D 
output filename for GRID  CRO. 36 . 
output filename for GRID  DOT  2D 
output filename for MET  CRO  2D 
output filename for MET  CRO  3D 
output filename for MET  DOT  3D 

12.5.4 

Defining  Grid  and  Domain  for  MCIP 

, .,.  Ml\.15  Grid  and  Domain  Definitions 

f2.5.4. l 
MMS may ou'tput as many as nII1e grid domains (one'coarse grid and up to eight nestedgrid 
domains) per MMS execution.  The MM5 developers took the approach of compiling.MM5 with 
the appropriate dimensions for each study being performed.  On the other hand, MCIP processes 
::,  o!;!tput meteorological data one grid domain at a time.  It needs to be compiled explicitly for each 
grid domain.  For multiple scale MM5 model runs, usually MM5 users have to define all the multi(cid:173)
l~vel Qest. dorpaim;Jogether with the coarse "mother" grid.  The complication in defining MM5 
domains as the Models-3 domain objects is caused by somewhat inauthentic use of the left-hand 
c§:ord~,n~te system and dot-point grid/domain definitions in MM?.  For the details on how to define 
MMS q9main§. users are recommended to read MM5 User's Guide.,  In the following, we uses a 
set of multi-level MM5 domains listed in Table 12-12 as the exampfos of the discussion. 

111111111111 

"' 

' 

I 

''' 

"' 

"II 

I 

'"'Ill'• 

''II;', 

'" 

,111 

Table 12-12.  An Example Set of Multi-level Nesting MM5 Domains 
{Note that  C(]) inMM5 corresponds to (ROW, COL) in CMAQ system.) 

lllhmll 

"'11'"111111''11111 

" 

'1111' 

'" 

' 

Ill"' 

II 

MMS 
Domain 
No.(N) 

1 
2 
:llllllllli,,, 3 

1111111:::::,4 

,,, 

Resolution 

(L1t=L1y) 

Dimensions 
(IX,JX) = 

(ROWS+J,COLS+l) 

Origin Relative to Base 

Origin Relative to 

Grid 

ImmCdiate Parent grid 

(l_ll,]_11) 

( ROlV,,ffut + 1, COL,iff,., + 1) 

l08krn 
36km 
!i,,;?~11111111, 
.:'Q~kn:i 

11111111111111'' 

'l;,,:,:111::::1, 

'"'

(41,61) 
(67,82) 
(~2.190) 
(100;82) 

(1,1) 
(9,24) 

' ( 19.333333,35.3~3333) 
'(21.444444,41.555555) 

(1,1) 
(9,24) 
<~'~,35) 
(2b,57) 

a) 

Definitions for MMS  108 km mother grid (N=l) 

In MMS, the grid is defined with the number of dot points.  Therefore, to use MMS's grid 
definitions, for Models-3/CMAQ's cross-point grid definitions, we need to use following 

NCOLS =JX-1 =61-1 =60 

NROWS =IX - 1=41-1=40. 

(12-138a) 

(12-138b) 

For this grid, no "parent grid" is defined. Origins should be defined with the formula that is 
specific to MMS' s method of grid/domain definition.  Note that we require the MMS mother 
domain's number of cells in horizontal directions (i.e., NCOLS and NROWS) to be even 
numbers, so that the dimensions of the four quadrants relative to the center of the coordinates are 
identical (Refer to Figure 12-9).  The origin of the coarse MM5 grid is defined with 

<x  .  y  . ) = (-__sElL * L1x  _ ____!!!!!::!:.. * L1y) 

orig '  orig 

' 

N 
2 

N 
2 

Because it is the mother grid of the grid family, offsets should be set to zero: 

(12-139) 

(12-140) 

Currently this domain is defined with resolution of 108km (see Table 12-12). 

b) 

Definitions for MMS 36 km first-level nest grid/domain (N=2) 

For this grid, the MMS  108km domain defined above is used as the "parent grid."  For the nested 
domains, NCOLS and NROWS can be either even or odd numbers: 

NCOLS=JX-1 =67-1=66 

NROWS =IX - 1=82-1=81. 

(12-14la) 

(12-14lb) 

Because the left-most and bottom comer of the nest 36km domain is defined with  (/1,1, 11,1)  in 
MMS, we need to convert this information into  (COL0.ff.rei•R0""1ffsei)  using following equation: 

(12-142) 

Note that MMS uses left-hand coordinate system, so that the index positions for  (/1,1, 11,1)  are 
reversed with those for the Models-3/CMAQ' s  ( COL0ffsel' R0""1ffsei).  In the following case, the 
general equation for computing the offset numbers from  (/1,1, 11,1)  of the MM5 domains will be 
presented.  The coordinates of the origin is computed with: 

( 
xoric•Yoric 

) _  (  parent  COL 
-

xorig  + 

offset 

L1xparent 

parent  ROW 

•Yoric  + 

offse1L.J.Y 

A  parent) 

(12-143) 


c) 

Definitions for MMS  12 km and 4 km nest grid/domains (N=3, 4) 

For the third~"""12kin domain cN=3), we have: 

: I ! ! ii i i 11 I ! ' 

I, 

,II 

:ll:"llllllli,,,,, 

I" 

"lll!!i 

,,I, 

NCOLS = JX - I= 100-1=99 

'"II 

,, 

(12-144a) 

''! 

"'' 

,illllll' 

NRO\VS =IX- 1=82-1  = 81 

(12-144b) 

a11d  MMS 3cikm domain is used as the parent grid.  Also, for the fourth 4 km domain (N=4 ), we 
have: 

II"' 11 .. ,: 

NCOJ'....S:;:; JX - 1=82-1  = 81 

NROWS =IX - I= 100-1=99 

(12-145a) 

(12-145b) 

~d Mf\/1,,~  I~km,,~orpain is,,,~,~~~ a~,tqe parent grid.  Usually, the offset values will be known to the 
~od~Is73/C~1~911111users. 

,,,.,  . 

;,,

11 

, 

MM5 Mother Grid/Domain and Coordinate Center 

, .. 
.. .. 

...  rr 
....  LI. 

llllli, 

(Xon11•  ~,) 

..  ~7 
..  " 

(Xr,YJ 

NCO LS 

A • 

;1 r 

Figure 12-10.  A Schematic of the MMS Mother Grid Definitions. 

Because ~\15's mother grid is defined from the coordinate center and grows outward, the 
numbers of columns and rows for each quadrants relative to the coordinate center should be the 
same, i.e., NCOLS and NROWS for the MMS mother grid should be even numbers.  In case the 
Qffset iqf ()nn,~t-ie>n)s not ,,known ~priori, one needs to compute the offset values using the header 

12-70 

1
:
11111 

information in the MM5 output files.  To use the information correctly, we need to know how the 
MM5 nest domain's left-most and bottom comer (/1,1,11,1)  is defined.  In MM5, all  the nest 
domains are defined relative to the mother grid, and  U1.1,J1.1)  provides the offset information of 
the nest domains in terms of the mother grid's resolution.  The formula linking a nest MM5's 
domain  (/1,1,11,1)  and Models-3/CMAQ's offset values  (COL0/fm'ROW,,ffut)  are given for  N  ~ 2 as: 

EP A/600/R-99/030 

where  (L1xpurenr I L1x) = 3  for the current MM5 application example.  Because our objective is to 
help users to find out  (COL01!,..,,ROW,,ff.w)  for the nest grid, we need to rewrite Equation  12-146 
for  (COL0ff.,et'ROW,,ff.,er).  Assuming we know all the coarser grid/domains offset values, 
(COL0ff.w•ROW,,ffser)  for the current nesting level  N  ~ 2 can be found as: 

(12-146) 

(COL 

)  = (L1xparenr / L1x)N-2  (J  ) 
1,1  N 

[ 

offw  N 

- l - ~ 

N-I 

(COL 

] 
6 (L1xparenr / L1x)k-2 

) 
off.w  k 

(ROW 

offset  N 

~ 

)  = (,1  parent/ ,1  )N-2  (/  )  _  1- ~ 

~ 

I.I  N 

[ 

(ROW 

] 
N-I 
£..i (,1  parent/ ,1  )k-2 
k=2  ~ 

) 
offset  k 
~ 

(12-147a) 

(12-147b) 

Although Equations  12-147 a and b look somewhat complicated, one can readily compute offset 
numbers for Models-3 CMAQ's grid/domain definitions for the example set of domains defined in 
Table 12-11  as follows: 

[CCOLoffset),(ROW,,ffw) ]N=3 = [3[(35i- -1)-3° * 23],3[(19i- -1)-3° * 8]] 

= [34,31] 

= [56,19] 

(12-148a) 

(12-148b) 

(l2-148c) 

Most of the time, the above MM5 domain definitions are provided by the MM5 modelers and 
Models-3/CMAQ users do not have to re-compute them. 

12.5.4.2 

CMAQ  Grid  Definitions 

The horizontal grid structure used for the MM5 serves as the parent grid for the CCTM domains. 
To define a CCTM grid, number of cells to be excluded from the parent domain must be 
detennined.  It is recommended that the CCTM grid be smaller than its parent MM5 grid by at least 
4 grid cells (preferably by 6 grids) to avoid the possible numerical reflection problems at 
11,,fvll'15  ~om~n. One~ the offset values are known,  (xqrig•Yorig)  of the nest domain can 
~,~mndari~,~ ot
be computed using Equation  12-143.  Refer to Appendix 12B for other examples of other CCTM 
nest domain definitions. 

12.S .5 

Extension  of MCIP  for  Other  Meteorological  Models 

CMAQ 

·1· 

al'  d 

ty mo  e mg, 

d  1··· 

uti 1zes gener  1ze  coor  mates. 

The current release version of MCIP can only process MM5 output in binary format or previous 
¥CIP outI?utin 1/0 API format.  To realize the one-atmosphere concept for meteorological and air 
111111111 .• ali 
qu 
coordinate system is that a single CTM can adapt to any of the coordinate systems and dynamics 
commonly used in meteorological modeling.  Because most meteorological models are not 
originally designed for air quality studies, they lack characteristics that are required for air quality 
modeling.  Consistencies in dynamic descriptions of atmosphere, physical parameterizations, and 
numerical algorithms, where applicable, in meteorological and chemistry-transport models are 
cHtical in detennining the quality of air pollutant simulations.  This issue becomes more critical 
with high resolution air quality study where nonhydrostatic meteorological models must be used. 

al'  d 
e gener  1ze 

ne a  vantage o 

f th 

d' 

0 

d 

MCIP is the key processor allowing the consistent linkage between meteorological models and 
CMAQ.  Currently, different meteorological models are used by different atmospheric modeling 
groups forming their own respective user communities.  It is because these meteorological models 
ru-e  applicable for a limited range of spatial and temporal scales.  To expand the user base of the 
~9~els-3 C~11~Q system and to promote the one-atmosphere community modeling paradigm, it is 
e5sential to continuously develop MCIP modules for several popular mesoscale meteorological 
models such as RAMS, ARPS, HOTMAC, and others. 

1111111111111 

,, 

'"'" 

'"'"""'' 

To build a version of MCIP for processing a set of meteorological model output, several issues 
'"'' 
involved with different dynamics and coordinates must be considered.  They are; ( 1) compatibility 
of governing set of equations and state variables used, (2) scale limitations in subgrid scale 
parameterizations such as cloud, turbulence, and surface exchange processes, and (3) consistency 
in numerical algorithms and discretization methods.  Before designing MCIP modules for other 
meteorological model, developers should identify the structure, format, and frequency of data as 
well as their impact on the processing structure of MCIP.  MCIP expects time dependent 
meteorological data in a structured grid system as the input.  As this moment, there is no provision 
for handling irregularly spaced data structure either from observations or from a meteorological 
modeling system with unstructured adaptive (fixed or dynamic) grid structure, such as the one 
used in OMEGA system (Bacon et al.,  1996).  If there is need for including these data, object 
analysis tools must be used to prepare data in a structured grid system. 

The essential information related to the coordinates and dynamic assumptions used in 
meteorological models is captured in MCIP.  Dynamic and thermodynamic state variables are recast 
into the fully compressible system as described in Chapter 5 of this volume. 

It is important to know the processing sequence and associated data structures used in the current 
MCIP code.  Major processing steps in MCIP can be summarized as follows:  ( 1) Grid, coordinate, 
and information on atmospheric dynamics are used to compute Jacobian and layer heights; (2) State 
variables in meteorological models are recast into density and entropy; (3) Contravariant wind 
components are computed; (4) necessary two-dimensional parameters are diagnosed; and (5) Some 
of two- and three-dimensional parameters are passed through.  Figure  12-11  shows corresponding 
data structures used at different phases.  Input phase uses arrays with dimensions covering the full 
meteorology domain ('F-arrays'), processing phase uses arrays for extended domain covering both 
the CMAQ and boundary domains ('X-arrays').  During the output phase, the information in X(cid:173)
arrays are separated into the CMAQ and boundary domains for respective data types described in 
Table 12-3. 

Input phase  Processing 

Output phase 

Met. Domain 

'F'-arrays 
Figure 12-11. 
Processing 

Extended CMAQ Domain 

CMAQ Domain 

'X'-arrays 

Dot &  Cross 

Boundary 
Domain 

Data Structures Corresponding to Input, Processing, and Output Phases of MCIP 

12. 6  Concluding  Remarks 

MCIP is a key processor linking meteorological models to the CMAQ modeling system.  Its major 
roles are: 

1. 

2. 

To read meteorological data from a meteorological model and converts them in Models-3 
IIO API format. 

To provide all the necessary meteorological parameters for air quality simulations. When 
necessary, PBL parameters and other derived quantities are computed using gridded 
meteorology data and high-resolution fractional land use information. 

3. 

To support multiscale generalized coordinate implementation of the CCTM. 

Current implementation of MCIP is mainly for linking MM5 output to CCTM.  Reader modules to 
Regional Atmospheric Modeling System (RAMS) (Pielke et al.,  1992), will be added.  Users who 
wish to link other meteorological models may need to modify and introduce appropriate input 
modules. 


12. 7  References 

Alduchov, 0. A. and R. E. Eskridge,  1996: Improved Magnus form approximation of saturation 

pressure. J.  Appl. Meteorol., 35, 601-609. 

Anthes, R. A., E. Y. Hsie and Y.H Kuo,  1987: Description of the Penn State/NCAR Mesoscale 
:.  Model version 4 (MM4).  NCAR Technical Note, NCAR!fN-282+STR, National Center for 

Atmosph~rlc 'R:esearch, Boulder, CO. 66pp. 

Avissar, R., P. Avissar, Y. Hahrer, and B. A.  Bravdo,  1985:  A model to simulate response of 

plant stomata to environmental conditions.  Ag. and Forest Meteorol., 34, 21-29. 

Bacon, D. P., Z.  Boybeyi, P.R. Boris, T.  J.  Dunn, M. Hall,  R.  A.  Sarma, S.  Young, and J. 

Zack,  1996: Ail overview of the operational Multi-sclae Environmental model with Grid 
Adaptivity. Proc.  of the 15th Conj.  on Wea.  Anal. and Forecasting, Norfolk, VA, August  19-
23,  1996, American Meteorological Soc., Boston, MA. 

Ball, J. T., I.E., Woodrow, and J.  A. Berry,  1987: A model predicting stomatal conductance and 

its contribution to the control of photosythesis under different environmental conditions.  In 
Progress in photosynthesis Research,  Vol.  IV (ed. J.  Biggins), pp. 221-234.  Martinus Nijhof 
Publishers, Dordrecht. 

Betts, A. K.,  1973: Non-precipitating cumulus convection and its parameterization. Quart. J.  Roy. 

Meteorol.  Soc. 99,  178-196. 

Binkowski, F.S. and U. Shankar,  1995: The Regional Particulate Model.  1.  Model description 

and preliminary results. J.  Geophys.  Res.,  100 Dl2, 26191-26209. 

Blackadar, A. K.,  1978: Modeling pollutant transfer during daytime convection, Preprints,  Fourth 

'.,  Symposium on Atmospheric Turbulence,  Diffusion, and Air Quality, Reno, Am. Meteor. 

Soc., 443-447. 

i3'~ost R.  A.  ~di ;t. Wyngaard,  1978: A model study of the stably stratified: planetary boundary 

"'I 

layer. J.  Atmos.  Sci., 35,  1427-1440. 

· 

Businger J. A., J.C. Wyngaard, Y. Izumi, and E. F. Bradley,  1971: Flux profile relationships in 

the atmospheric surface layer, J.  Atmos.  Sci., 28,  181-189. 

Byun, D. W.,  1990: On the analytical solutions of flux-profile relationships for the atmospheric 

surface layer, J.  Appl.  meteorol., 29, 652-657. 

Byun, D. W.,  1991: Determination of similarity functions of the resistance laws for the planetary 

boundary layer using surface-layer similarity functions, Boundary Layer Meteorol., 57,  17-
48. 

Byun, D.W., 'i999a: Dynamically consistent formulations in  meteorological and air quality models 
""""'  for multiscate atmospheric applications:  I. Governing equations in generalized coordinate 

System. J.  Atmos.  Sci.,  (in print) 

Byun, D.W.,  1999b: Dynamically consistent formulations in meteorological and air quality models 

for multiscale atmospheric applications:  II. Mass conservation issues. J.  Atmos. Sci., (in 
print) 

Byun, D. W., and R.L. Dennis,  1995: Design artifacts in Eulerian air quality models: Evaluation 

of the effects of layer thickness and vertical profile correction on surface ozone concentrations. 
Atmospheric Environment,  29, No.  1,  105-126. 

Carson, D. 1.,  1973: The development of a dry inversion-capped convectively unstable boundary 

layer.  Quart.  J.  Roy.  Meteorol.  Soc. 99, 450-467. 

Cederqvist, P.,  1993:  Version Management with CVS,  Signum Support AB, Linkoping, Sweden. 

168pp. 

Chang, J.S.,  R.A.  Brost,  LS.A.  Isaksen, S.  Madronich,  P.  Middleton, W.R.  Stockwell, and C.J. 

WaJcek,  1987: A three-dimensional Eulerian acid deposition model: Physical concepts and 
formulation,  J.  of Geo phys.  Res., 92,  14,681-700. 

Chang, J.S.,  P.B.  Middleton, W.R.  Stockwell, C.J.  Walcek, J.E.  Pleim,  H.H.  Lansford, S. 

Madronich,  N.L.  Seaman, D.R.  Stauffer, F.S.  Binkwski, D.  Byun, J.N.  McHenry,  H.  Hass, 
and  P.J. Samson,  1990: The Regional Acid Deposition Model and Engineering Model, 
NAPAP report 4. 

Coats, C. J., cited  1996: The EDSS/Models-3 I/O Applications Programming Interface. MCNC 

Environmental Programs, Research Triangle Park, NC.  [Available on-line from 
http://www.iceis.mcnc.org/EDSS/ioapi/H.AA.html.] 

Collatz, G. J., C. Grivet, J. T. Ball, and J. A. Berry,  1991:  Physiological and environmental 

regulation of stomata] conductance, photosynthesis and transpiration: a model that includes a 
laminar boundary layer.  Ag.  and Forest Meteorol., 54,  107-136. 

Driedonks, A. G. M.,  1981: Dynamics of the well-mixed atmospheric boundary layer. De Bilt 

K.NMI Sci. Rep. WR 81-2,  189pp. 

Dudhia, J.,  1989: Numerical study of convection observed during the Winter Monsoon 

Experiment using a mesoscale two-dimensional  model. J.  Atmos.  Sci., 46, 3077-3107. 

Dudhia, J.,  1993: A nonhydrostatic version of the Penn State-NCAR mesoscaJe model: Validation 
tests and simulation of an Atlantic cyclone and cold front, Mon.  Wea.  Rev.,  121,  1493-1513. 

Erisman, J. W., A. van Pul, and P. Wyers,  1994: Parameterization of surface resistance for the 

quantification of atmospheric deposition of acidifying pollutants and ozone.  Atmos. Environ. 
28,  2595-2607. 

Fowler, D.,  1978: Dry deposition of S02 on agricultural crops, Atmos.  Environ.,  12, 369-373. 

Fritsch, J.M., and C.F. Chappell, 1980: Numerical prediction of convectively driven mesoscale 

pressure systems,  1,  Convective parameterization, J.  Atmos. Sci., 37,  1722-1733. 

Geleyn, J.-F., A. Hense, and H.-J. Preuss,  1982: A comparison of model-generated radiation 

fields with satellite measurements.  Beitr.  Phys. Atmos., 55, 253-286. 

Grell, G.A., J. Dudhia, and D.R. Stauffer,  1994:  A Description of the Fifth-Generation PENN 

STATE/NCAR Mesoscale Model (MM5), NCAR Technical Note, NCAR!fN-398+STR, 
National Center for Atmospheric Research, Boulder, Colorado, 138pp 

111111

1

111111;;1 

Haagenson, P.  L., J. Dudhia, D. R.  Stauffer, and G.  A.  Grell,  1994: The Penn State-NCAR 
;;;;;;;;;,,  mesgscaj~ m.2 .. ?el (MM5) source code document, NCAR/TN-392+STR, National Center for 
""'  Atmospheric Research, Boulder, Colorado. 
1. 
Hack, J. J., B. A. Boville, B. P. Briegleb, J. T. Kiehl, P.  J.  Rasch, and D. L. Williamson,  1993: 
Description of the NCAR community climate model (CCM2).  NCAR Tech. Note, NCAR!fN-
382+STR, 120 pp. [Available from the National Center for Atmospheric Research, P.O. Box 
3000, Boulder, CO 80307.] 

f',  :i•·:· 
,,lit, 

llii:'!!! 
,,,,,,,Jlll11111 

i':
1llll!!' 
II 
, 

, 

' 
' 

,, 
'" 

,,,, 

;,,, 

I';, 

' 
' 

111

•

·:,;, 

, 

, 

"' 

1

,, 

Hess, G.D., 1992: Observations and scaling of the atmospheric boundary layer. Aus. Meteorol. 
,,,,,,.,,  M 

ag. 

41  79 99 
. 

, 

-

1111111111. 

I 

''"'II 

'1''"11 

~ogstrom, U.,  1988: Non-dimensional wind and temperature profiles in the ~tmosphe~ic surface 

layers: a re-evaluation. Boundary-Layer Meteor., 42, 55-78. 

Holtslag, A. A.,  E. I.  F. de Bruin, and H.-L. Pan,  1990:  A high resolution air mass 

transformation model for short-range weather forecasting. Mon.  Weather Rev., 118,  1561-
1575. 

Holtslag, A.AM., E.V. Meijgaard, and W.C. DeRooy, 1995:  A comparison of boundary layer 

diffµsionschemes in unstable conditions over land, Boundary-Layer Meteor., 76, 69-95. 

""' 

' 

"" 

ili111::':' 

1 

,,'·1;;;1 11

"

,, 

1ll!: 

,11111111: 111:111: 

,p 

,, 

Jarvis, P. G.,  1976: The interpretation of the variation of leaf water potential and stomata! 

I 

" 

" 

" 

I• 

I 

conductance found in canopies in the field.  Phil.  Trans.  Royal Meteorol.  Soc.  of London, 
Series IJ,  273,  593-61 o. 

Jacquemin B. and J. Noilhan, 1990: Sensitivity study and validation of a land surface 

parameterization using the HAPEX-MOBILHY data set.  Bound.-Layer Meteorol.,  52, 93-
134. 

Jaung, H.-M. H.,  1992: A spectral fully compressible nonhydrostatic mesoscale model in 

hydrostatic sigma coordinates: Formulations and preliminary results. Meteor.  Atmos.  Phys., 
SO,  75-88. 

Kain, J. S., and J.M. Fritsch,  1993: Convective paramterization for mesoscale models: The Kain(cid:173)
Fritsch scheme. Jthe representation of cumulus in mesoscale models., K.A. Emanuel and D.J. 
Raymond, Eds., Amer. Meteor. Soc., 246pp. 

Lo, A. K.,  1993: The direct calculation of fluxes and profiles in the marine surface layer using 

measurements from a single atmospheric level. J.  Appl. Meteorol.,  32,  1890-1990. 

Lo, A. K.,  1995: Determination of zero-plane displacement and roughness length of a forest 

canopy using profiles of limited height. Boundary-Layer Meteorol., 75, 381-402. 

Madronich, S.,  1987: Intercomparison of N02 photodissociation and UV radiometer 

measurements, Atmos.Environ., 21,  569-578. 

Mason, P.J.,  1987: The formation of areally-averaged roughness lengths.  Q.J.R.  Meteorol.  Soc., 

106,  351-366. 

Mesinger, F. and A. Arakawa,  1976: Numerical methods used in atmospheric models. In:  Global 

Atmospheric Research Programme (GARP), Joint Organization Committee, GARP Publication 
Series, No.  17, Aug.,  1976:  [Available from WMO Secretariat, Geneva]. 

Mihailovic, D. T., R.  A. Pielke, B. Rajkovic, L. J. Tsengdar, and M. Jeftic,  1993:  A resistance 
representation of schemes for evaporation from bare and partly plant-covered surfaces for use 
in atmospheric models.  J.  Appl. Meteorol., 32,  1038-1054. 

Noilhan, J.  and S. Planton,  1989: A simple parameterization of land surface processes for 

meteorological  models.  Mon.  Wea.  Rev.,  117, 536-549. 

Ooyama, K. V.,  1990: A thermodynamic foundation for modeling the moist atmosphere. J. 

Atmos.  Sci.,  47,  2580-2593. 

Padro, J., G.  den Hartog, and H.  H. Neumann,  1991: An  investigation of the ADOM dry 

deposition module using summertime 0 3  measurements above a deciduous forest, Atmos. 
Environ.,  25A,  1689-1704. 

Paulson, C. A.,  1970: The mathematical representation of wind speed and temperature profile in 

the unstable atmospheric surface layer. J.  Appl. Meteor., 9, 857-861. 

Pielke, R.  A., W.R. Cotton, R.  L.  Walko, C.  J. Tremback, M.  E.  Nicholls, M.  D.  Moran, D.  A. 

Wesley., T. J. Lee, and J.  H.  Copeland,  1992: A comprehensive meteorological modeling 
system-RAMS.  Meteor.  Atmos.  Phys., 49, 69-91. 

Pleim, J., A.  Venkatram, and R.  Yamartino,  1984:  ADOM!f ADAP Model Development 

Program, V?lume 4, The Dry Deposition Module.  ERT P-B980-520, Prepared for OME, AES 
of Canada and the Umweltbundesamt, Germany. 

Pleim, J.E. and A. Xiu,  1995:  Development and testing of a surface flux and planetary boundary 

layer model for application in  mesoscale models, J.  Appl. Meteor.,  34,  16-32. 

Pleim, J.  E.  , A.  Xiu, P.  L.  Finkelstein, and J.  F. Clarke,  1997:  Evaluation of a coupled land(cid:173)

surface and dry deposition model through comparison to field measurements  of surface heat, 
moisture, and ozone fluxes, Proceedings of the  12th Symposium on Boundary Layers and 
Turbulence, July  28-August 1,  1997, Vancouver, BC. 

Pleim, J.E., J. F. Clarke, P.  L.  Finkelstein, E. J. Cooter, T.  G.  Ellestad, A.  Xiu, and W.  M. 

Angevine,  1996:  Comparison of measured and modeled surface fluxes of heat, moisture and 
chemical dry deposition.  In: Air Pollution Modeling and its Application XI, Ed: Gryning and 
Schiermeier, Plenum Press, New York. 

1111!""" 

,, 

'""lll:,,,1111111111111111 

'''" 

"'' 

" 

11111"' 

'''11111, 

, R~hette, P.1, 1111DesJ~dins, R.  L., Dwyer, L. M., Stewart, D. W., Pattey, E.,  and Dube, P.A., 
1991: Estimation of maize canopy conductance by scaling up leaf stomatal conductance. Ag. 
and Forest Meteorol., 54, 241-262. 

,,  Schumann, U.,  1989: Large-eddy simulation of turbulent diffusion with chemical reactions in  the 

convecti":,~"" po~ndary layer. Atmos.  Environ., 23,  1713-1727. 

' 

,,,,,,1111,,,,,, 

,1111111 
::1111111' 

" 

,,1, 

,,,, 
'" 

,, 

' 

Seaman, N. L:; D.R. Stauffer, and A. M. Lario-Gibbs,  1995: A multiscale four-dimensional data 

',,,1111111111111 

I'°'" 

,.,1 

''"" 

'" 

" 

' 

assimilation system applied in the San Joaquin Valley during SARMAP. Part I:  Modeling 
design and basic performance characteristics, J.  Appl. Meteor., 34,  1739-1761. 

!, 
I,, 

, 

" "  
, 

,!!111111' 
:1111111 

'Ill' 

I 

Seaman, N. L., and D.R. Stauffer,  1995: Simulation of the thermal structure of the San Joaquin 

Valley during SJV AQS/AUSPEX/SARMAP using MM5 with four-dimensional data 

, " assimilation, paper presented at the A WMA conference, Regional Photochemical Measurement 

'•,,. 

""'',,111111 

111 

,:11""""'111·11111 

""""'""' 

, and Mode;,,!ing Studies, November 8-12, San Diego, Calif.,  1993. 

Sellers, P. J., Y. Mintz, Y.  C. Sud, and A.  Dalcher,  1986: A simple biosphere model (SiB) for 

" 

llllllli, 

, 

11' 

',111 

11iiilllli 

1
' 
!!"!!!Ill,,  '

1::r 

use within general circulation models.  J.  Atmos. Sci., 43, 505-531. 

Sellers, P.  J., R.  E.  Dickinson, D.  A.  Randall,  A.  K.  Betts, F.  G.  Hall, J.  A.  Berry, G.  J. 

Collatz, A. S. Denning, H.  A.  Mooney, C.  A. Nobre, N.  Sato, C.  B.  Field, and A, 
Henderson-Sellers,  1997: Modeling the exchanges of energy, water, and carbon between 
continents and the atmosphere.  Science, 275, 502-509. 

Sheih, C.M., M.L. Wesely, and B. B. Hicks,  1979: Estimated dry deposition velocities of sulfur 

over the eastern United States and surrounding regions, Atmos.  Environ., 13,  1361-1368. 

slrois, A., an~'L.A. Barrie,  1988: An estimate of the importance ~f dry deposition as a pathway of 
acidic substances from the atmosphere to the biosphere in eastern Canada, Tellus, 40B, 59-80. 

Slinn, W. G.  N., L.  Hasse, B.  B.  Hicks,  A.  W.  Hogan,  D.  Lal,  P.  S. Liss, K.  0. Munnice, G. 
""""'"  A. ~ehm~,!,~, and o.,,, Vi~iori, ,,! ~78: Some aspects of the transfer of atmospheric trace constituents 
past the ,~ir-sea i,~terface. Atmos.  Environ. 12, 2055-2087. 

'1'"111 

:111111111 

,1 

" 

111 

111 

I 

Ill 

.. 

1111' 

I' 

Stauffer, D.R., and N. L. Seaman, 1993: Evaluation of multiscale four-dimensional data 

assimilation techniques developed and tested in MM5 during SJV AQS/ AUSPEX/ SARMAP, 
paper presented at the A WMA conference, Regional Photochemical Measurement and 
Modeling Studies, November 8-12, San Diego, Calif.,  1993. 

Tesche, T. W., and D. McNally, 1993: Operational evaluation of the SARMAP meteorological 
, model (SMMI) for episode 1:  3-6 August,  1990, Alpine Geophysics, Crested Butte, CO. 

Thorpe, S., cited 1996: PA VE User Guide. MCNC Environmental Programs, Research Triangle 

Park, NC, [Available on-line from http://www.iceis.mcnc.org/ 
EDSS/pav~_doc/SCCS/s.Pave.html.] 

Voldner, E.C., L.A. Barrie, and A.  Sirois,  1986: A literature survey of dry deposition of oxides of 

sulfur and nitrogen with emphasis on long-range transport modelling in North America, 
Atmos.Environ., 20,  2101-2123. 

Walcek, C.J.,  1987: A theoretical estimate of 03 and H202 dry deposition over the northeast 

United States, Atmos.Environ., 21,  2649-2659. 

Walcek, C.J., R.  A.  Brost, J.  S.  Chang, and M. L.  Wesely,  1986: S02, sulfate and HN03 

deposition velocities computed using regional landuse and meteorological data, 
Atmos.Environ., 20,  949-964. 

Walcek, C.J., and G.R. Taylor,  1986: A theoretical method for computing vertical distributions of 

acidity and sulfate production within cumulus clouds, I.Atmos.Sci., 43, 339-355. 

Warner, J.,  1970: On steady-state one-dimensional models of cumulus convection, I. Al!Jlos.  Sci., 

27,  1035-1040. 

Wesely, M. L.,  1989: Parameterization of surface resistances to gaseous dry deposition in 

regional-scale numerical models, Atmos.Environ., 23,  1293-1304. 

Wesely, M. L., and B. B. Hicks,  1977: Some factors that affect the deposition rates of sulfur 

dioxide and similar gases on vegetation, I. Air Pollut.  Control. Assoc., 27,  1110-1116. 

Wesely, M.  L., D.R. Cook, R.  L.  Hart, and R.  E.  Speer,  1985: Measurements and 

parameterization of particulate sulfur dry deposition over grass, J.  Geophys. Res., 90, 2131-
2143. 

Wetzel, P. J.,  and J.-T. Chang,  1988: Evapotranspiration from nonuniform surfaces: a first 
approach for short-term numerical weather prediction.  Mon.  Wea.  Rev.,  116, 600-621. 

Wojcik, G.S., and J.S. Chang,  1996: An Eulerian modeling study of anthropogenic sulfur 

budgets and lifetimes for Eastern North America, submitted to I.Atmos.Chem. 

Wyngaard, J.  and Brost, J.C. and R.  A. Brost,  1984: Top-down and bottom-up diffusion of a 

scalar in the convective boundary layer. I.  Atmos.  Sci., 41,  102-112. 

Xue, M., K.  Droegemeier, V.  Vong, A.  Shapiro, and K.  Brewster,  1995:  ARPS Version 4.0 

User's Guide. Center for the Analysis and Prediction of Storms, Univ. of Oklahoma, 380 pp. 
[Available from Center for the Analysis and Prediction of Storms, Univ. of Oklahoma, 
Norman, OK 73019]. 

Zilitinkevich S. S., 1989: Velocity profiles, the resistance law and the dissipation rate of mean 

flow kinetic energy in a neutrally and stably stratified planetary boundary layer. Bound. Layer 
Met., 46,  367-387. 

This chapter is taken from Science Algorithms of the EPA Models-3 Community 
Multiscale Air Quality (CMAQ) Modeling System, edited by D. W. Byun and J. K. S. 
Ching, 1999. 


Appendix  12A 

MCIP Output Data 

MCIP ytfites gie f?ulk of its two- and three-dimensional meteorology and geophysical output data 
in a transportable binary format using a tailored Models-3 input/output applications program 
interface (I/O API) library.  Depending on whether the meteorological vertical coordinate is time 
dependent or not, the temporal characteristics of certain variables that belong to GRID data types 
and MET data types may differ.  For example, when the meteorological coordinate is crP,  which is 
time dependent, Jacobian is also time dependent.  On the other hand for  a po  coordinate, Jacobian 
i"s time independent.  However we are using a consistent list of meteorological variables for both 
hydrostatic and nonhydrostatic coordinates for as the standard output. Tables 12A-1  through  12A-
6 provide lists of variables in each data type. 

1

' 

' '

11111' 

" 

"""I'  . .  "'1111111 
11 :1, 

.... ::1,1"''1111' 

' 

Table  l 2A 1. Variables in GRIDCR02D 

"111

' 

' 

Variable Name 

LAT 
Lal 
~FX2 
Hl' 
iZERo 
PRSFCO 

!11111111 

111111:"" 

,, 

JACOBSO 
WSE;_URBA 
LUSEJGRI 
LU~ 
LUSJLDECI 
~COOI 
LUSlUfiXF 
LUSE;_WATE 
~SE_BARR 
LUSEJ'QIB 
LUSE_.MIXA 
LUSJLDECI 
WSE_ROC!< 

Unit 
DEGREES 
DEGREES 
(M/M)**2 
M 
M 
Pascal 

M 
fraction 
fraction 
fraction 
fraction 
fraction 
fraction 
fraction 
fraction 
fraction 
fraction 
fraction 
fraction 

(0-1) 
(0-1) 
(0-1) 
(0-1) 
(0-1) 
(0-1) 
(0-1) 
(0-1) 
(0-1) 
(0-1) 
(0-1) 
(0-1) 

Description 
latitude  (south  negative) 
longitude  (west  negative) 
squared  map-scale  factor  (CROSS) 
terrain  elevation 
roughness  length 
surface  pressure  difference  of  reference 
atmosphere 
total  Jacobian  at  surface 
landuse  for  URBAN_LAND 
landuse  for  AGRICILTURE 
landuse  for  RANGE 
landuse  for  DECIDUOUS_FOREST 
landuse  for  CONIFEROUS_FOREST 
landuse  for  MIXFOREST_WETLND 
landuse  for  WATER 
landuse  for  BARREN_LAND 
landuse  for  NONFOREST_WETLND 
landuse  for  MIXAGRI_RANGE 
landuse  for  URBAN__LAND 
landuse  for  ROCKY  OPENSHRUB 

Table l 2A2.  Variables in GRIDDOT2D 

1111111;;: 

,, 

,,::.;,, 

""Variable Name 

111" 

11 

111111111 

LAT 
Lal 
MSFD2 

Unit 
DEGREES 
DEGREES 
(M/M) **2 

Description 
latitude  (south  negative) 
longitude  (west  negative) 
squared  map-scale  factor  (DOI') 

Table  12A3.  Variables in GRIDCR03D 

Variable Name 

DENSO 
ENT RPO 
JACOBOF 
JACOB OM 
TEMPO 
PRESO 
X3HTOF 

X3HTOM 

Unit 
KG/M**3 
J/K/M**3 
M 
M 
K 
Pascal 
M 

M 

Table  12A4. Variables in METCR03D 

Variable Name 

JACO BF 
JACO BM 
DENSA.....J 
DENSW_J 
ENTRP_J 
WHAT_JD 
r:;i:; 
QR 
<;N 
TA 
PRES 
DENS 
WWIND 
ZH 
ZF 
JDRATE 

Unit 
M 
M 
KG/M**2 
KG/M**2 
J/K/M**2 
KG/ (M"S) 
KG/KG 
KG/KG 
KG/KG 
K 
Pascal 
KG/M*"3 
MIS 
M 
M 
KG/M**2/S 

Table 12A5. Variables in METDOT3D 

Variable Name 

UWIND 
VWIND 
UHAT_JD 

VHAT_JD 

Unit 
MIS 
MIS 
KG/ (M*S) 

KG/(M*S) 

EPr\/600/R-991030 

Description 
density  of  reference  atmosphere 
entropy  density  of  reference  atmosphere 
total  Jacobian  at  layer  face 
total  Jacobian  at  layer  middle 
te:rrperature  of  reference  atmosphere 
pressure  of  reference  atmosphere 
height  of  layer  face  (top)  of  reference 
atmosphere 
height  of  layer  middle  of  reference 
atmosphere 

Description 
total  Jacobian  at  layer  face 
total  Jacobian  at  layer  middle 
Jacobian  weighted  total  air  density 
Jacobian  weighted  density  of  vapor 
Jacobian  weighted  entropy  of  moist  air 
J  & Density weighted  vertical  contra-W 
cloud  water  mixing  ratio 
rain  water  mixing  ratio 
water  vapor  mixing  ratio 
air  te:rrperature 
pressure 
total  density  of  air 
true  W corcponent  of  wind 
mid-layer  height  above  ground 
full-layer  height  above  ground 
time  rate  change  of  Jacob*Density 

Description 
u-comp.  of  true  wind  at  dot  point 
V-comp.  of  true  wind  at  dot  point 
(contra_U*Jacobian*Density)  at  square 
point 
(contra_V*Jacobian*Density)  at  triangle 
oint 

Table 12A6. Variables in METCR02D 

Variable Name 

11111111111 

'11111,, 

PRSFC 
JJl.COBS 
IENSAS 
WSTAR 
RIB 
PBL 
ZRlJF 
?«LI 
HFX 
~ 
l«lLI 
RADYNI 
RBNm'I 
RS'l'QII 
TEMPG 
TEMPlO 
TEMPlPS 
SURF2 
ALBEDO 
FSOIL 
Gal 
GSW 
~ 
RNET 
RN 
~· 
CFMCH 
CFRAQl 
CFRJ\CL 
CFRAC 
CI.Dr 
cum 
wBAR 
VD,,XXXX 

1111111111: 

Unit 
Pascal 
M 
KG/M**3 
M/S 
NOD IM 
M 
M 
1/M 
WA'I'I'S/M**2 
WA'I'I'S/M**2 
l/M 
M/S 
M/S 
M/S 
K 
K 
K 
EMPTY 
NO DIM 
WA'I'I'S/M**2 
WA'I'I'S/M**2 
WA'I'I'S/M**2 
WA'I'I'S/M**2 
WA'I'I'S/M**2 
CM 
CM 
Fraction 
Fraction 
Fraction 
Fraction 
M 
M 
G/M**3 
M/S 

Description 
surf ace  pressure 
total  Jacobian  at  surface 
air  density  at  surface 
convective  velocity  scale 
bulk  Richardson  number 
PBL  height 
surface  roughness  length 
inverse  of  Monin-Obukhov  length 
sensibie  heat  flux 
latent  heat  flux 
inverse  of  Monin-Obukhov  length 
inverse  of  aerodynamic  resistance 
inverse  of  laminar  bnd  layer  resistance 
bulk  stomata!  resistance  for  water 
skin  t~erature at  ground 
air  t~erature at  10  m 
air  t~erature at  1.5  m 
surface  parameter  1 
surface  albedo 
heat  flux  in  soil  layers 
longwave  radiation  at  ground 
solar  radiation  absorbed  at  ground 
solar  radiation  reaching  surface 
net  radiation  . 
accumulated  nonconvective  hourly  precip. 
accumulated  convective  hourly  precip. 
fraction  of high  cloud 
fraction  of  middle  cloud 
fraction  of  low  cloud 
total  cloud  fraction 
cloud  top  layer  height 
cloud  bottom  layer  height 
liquid  water  content  of  cloud 
arY  deposition  velocity  for  species  xxxx 

Note: List of deposition velocities 
VD....S02 
VD...,SULF 
VJ)JK>2 
VDJK) 
VD_03 
VDJ-!003 
VDJl202 
VD__,ALD 
VDJCHO 
VD_OP 
VD_ORA 
VD_NH3 
VD_l?AN 
VDJI(H> 
VD_CO 

deposition  velocity 
deposition  velocity 
deposition  velocity 
deposition  velocity 
deposition  velocity 
deposition  velocity 
deposition velocity 
deposition  velocity 
deposition velocity 
deposition  velocity 
deposition  velocity 
deposition  velocity 
deposition velocity 
deposition  velocity 
deposition  velocity 

: "M/S" 
:"MIS" 
: "M/S" 
: "M/S" 
: •M1s• 
: "MIS" 
: ·M1s• 
: •Mis• 
: "M/S" 
: "MIS" 
: "MIS" 
:"M/S" 
: •M1s· 
: "M/S" 
: "M/S" 

for 
for 
for 
for 
for 
for 
for 
for 
for 
for 
for 
for 
for 
for 
for 

species  S02 
species  SULF 
species  N02 
species  NO 
species  03 
species  HN03 
species  H202 
species  ALD 
species  HCHO 
species  OP 
species  ORA 
species  NH3 
species  PAN 
species  HONO 
species  co 

Appendix  12B 

Examples  of  Nest  Domain  Definitions  for  CMAQ  system 

12B.1 

Grid  Domain  Definitions  for  the  Models-3  CMAQ  Tutorial  Study 

Table 12B- l.  Origins for the TUTORIAL MMS domain, MCIP landuse domain, and CTM 
domains.  Note that (x,y) corresponds to (COL.ROW) in CMAQ.  MCIP landuse domain is 
smaller by one cell around than the original MMS domain.  Also, the CTM domain removes three 
cells around from the original MM5 domain. Origin is measured from the center of  Base 108 km 
domain located at 90W and 40N. 

Resolution 
(L1.t=L1y) 

108km 
36km 
12km 
04km 

Origin for original MM5 

Origin for MCIP Landuse 

Origin for CTM Domain 

Domain 

(xorig•Yorig) 

(-3996xl03
(432x103
(972x 103
(1200xl03

,  -2808xl03
,  -432xl03
,  -36xl03
) 
,  120xl03
) 

) 

) 

Domain 

(Xorig•Yorig) 

NIA 
,  -396xl03
) 
,  -24x 103
) 
,  124xl03
) 

(468xl03
(984x 103
(1204xl03

(xorig•Yorig) 

NIA 
,  -324x 103
,  Oxl03
) 
,  132x103
) 

(540x 103
(1008xl03
(1212x103

) 

Table 12B-2.  Offset Definitions for the Tutorial MM5 Nest Domains 

MM5 
Domain 

Resolution  NCOlS 
(km) 

NRCM/S  Col.  Offset  Row  Offset  Col.  Offset  Row  Offset 

01 
D2 
03 
04 

108 
36 
12 
4 

74 
36 
39 
36 

for  nest 

from  Parent from  Parent for  nest 
Domain,  D1  Domain,  D1 
0 
0 
52 
22 
36 
41 
36 
47  26.666666 
36  48.666666  28.111111 

0 
41 
15 
19 

0 
22 
11 
13 

Table 12B-3.  Dimensions of Set of MMS, MCIP, and CTM Domains for Each Grid Resolution 
for the Tutorial Study 

Resolution  MM5NCOLS  MM5 NROWS  MCIP NCOLS  MCIP NROWS  CTM NCOLS  CTMNROWS 

108 
36 
12 
4 

74 
36 
39 
36 

52  NI A-
36 
36 
36 

NIA 

N/A 

N/A 

34 
37 
34 

34 
34 
34 

30 
33 
30 

30 
30 
30 

12B.2Grid  Domain  Definitions  for  the  Models-3  CMAQ  Demonstration  Study 

Table 12B-4. Origins for the CMAQ demonstration MM5 domain, MCIP landuse domain, and 
CTM domains.  Note that (x,y) corresponds to (COL,ROW) in CMAQ.  MCIP landuse domain is 
smaller by one cell around than the original MM5 domain.  Also, the CTM domain removes three 
cells around from the original MM5 domain. Origin is measured from the center of Base  I 08 km 
domain located at 90W and 40N. 

Resolution 

(.1x=L\y) 

108km 
36km 
12km 
1111111111,,.  04km 

",111,,,,' 

llli111111111· 

:11 

Origin for original MMS 

Origin for MCIP Landuse 

Origin for CTM Domain 

Domain 

· (xorig•Yorig) 

(-3996xl03
3
....... ~~ .. 1080x 1,0

,  -2808x103
) 
3
,  -1728.:X: .. 10
) 
(486x103, -216x103
) 
(1 i4ox103
,  24xi03

) 

:::,1111,'1!1111, 

1111111:

1
111111 

11,,11111111 

Domain 

(xorig• Yorig) 

NIA 
,  -1692xl03
,  -Z04x103
) 
,  28x103
) 

(-1044xl03
(480xl03
(1144xl03

) 

(xnric• Ynrig) 

NIA 
(-864x103
,  -1512xl03
) 
,  -144xI03
c.54oxto3
) 
(l 164x103, 48x103
) 

Table  liB-5.  Offset Definitions for the CMAQ Demonstration MM5 Nest Domains 

I 

I 

II' 

" 

11 

.f; 

MMS 
Domain 

Resolution  NCOLS 
(km) 

NRONS  Col.  Offset  Row  Offset  Col.  Offset  Row  Offset 

from  Parent from  Parent for  nest 
Domain,  D1  Domain,  D1 

for  nest 

01 
D2 
03 
04 

108 
36 
12 
4 

74 
87 
102 
87 

0 
52 
81 
27 
84  42.333333 

0 
22 
25 
105  48.555556  27.222222 

0 
27 
43 
56 

0 
10 
42 
20 

1111111111, 

1 , 

11111111111',, 

·Ill 

, 

""" 

, 

, 

" 

, 

,,,, 

-

Tabl~ B6.  Dimensions of Set of MM5, MCIP, and CTM'. Domains for Each Grid Resolution for 
tfie tMAQ Demonstration Study 

· 

Resolution 

MM5NCOLS 

MM5NROWS  MCIPNCOLS 

108 
36 
12 
4 

111111111 

74 
87 
102 
87 

52  NIA 
81 
84 
105 

MCIP NROWS  CTM NCOLS 
NIA 

NIA 

CTMNROWS 
NIA 

85 
100 
85 

79 
82 
103 

75 
90 
75 

69 
72 
93 

1111,1' 

'II' 

Appendix  12C 

Sample  MCIP  Configuration  File 

II  RCS  file,  release,  date  & time  of  last  delta,  author,  state,  [and  locker] 
II  $Header:  lprojectlworklreplMCIPlsrclsunOS51sun_;n3_12.cfg,v  1.1.1.1  1997110113  17:38:23  yoj 
Exp$ 

II  what(l)  key,  module  and  SID;  SCCS  file;  date  and  time  of  last  delta: 
II  @(#)sun_rn3_12.cfg  1.1  lprojectlrnod31MCIPldoclbldrunlsunOSSISCCSls.sun._rn3_12.cfg  14  Jun 
1997  15:41:54 

II  This  is  a  configuration  file  for 

model  mcip_rn3_12; 

11  f77_flags  "-e  -Nl200  -fast  -04"; 

f77_flags 

•-e  -g  -C"; 

11  link_flags  "-fast  -04"; 
link_flags  "-e  -g  -C"; 

libraries 

"-L${M3TOOLS}IIOAPilsrc_liblSunOS5  -lrn3io  \ 
-L${M3TOOLS}lnetCDFISunOSS  -lnetcdf"; 

II  global  {verbose  I  parse_only  I  cornpile_all  I  one_step  I  clean._up}  ... 

global  verbose; 

II  shared  include  files  llllllllllllllllllllllllllllllllllllllllllllllll 

II  Models-3  IIO  API  permanent  includes 

include  SUBST_IOPARMS 
include  SUBST_IOFDESC 
include  SUBsr_IODECL 

$M3TOOLSIIOAPilincludeslPARMS3.EXT; 
$M3TOOLSIIOAPilincludeslFDESC3.EXT; 
$M3TOOLSIIOAPilincludeslIODECL3.EXT; 

II  Models-3  global  constants  for  this  processor 

include  SUBST_CONST 

$M3MODELIICLlsrclfixedlconstlCONsr.EXT; 

II  Models-3  grid  definitions 

include  SUBST_HGRD_ID 
include  SUBST_VGRD_ID 
include  SUBST_COORD_ID 

$M3MODELIICLlsrclgridlD_l2_1SIHGRD_21X21.EXT; 
$M3MODELIICLlsrclgridlD_l2_151VGRD.EXT; 
$M3MODELIICLlsrclgridlD_l2_1SICOORD_21X21.EXT; 

II  Models-3  IIO  API  files  for  this  processor 

include  SUBsr_INFILES 
include  SUBST_FILES 

$M3MODELIMCIPlsrclicllicllINFILES_MCIP.EXT; 
$M3MODELIMCIPlsrclicllicllFILES3_MCIP.EXT; 

include  SUBST_MET_CONST  $M3MODELIMCIPlsrclicllicllCONSTJ11ete.EXT; 
include  SUBsr_PBL_CONST  ~M3MODELIMCIPlsrclicllicllCONST_pbl.EXT; 
include  SUBST.....MPARM 
include  SUBST..J1(l-lMN 
include  SUBST...}l3001' 
include  SUBST...,M:X)UT 
include  SUBSTJIDOUT 
include  SUBST__..LRAI:ff 

$M3MODEL/MCIP/src/icl/icl/MCIPPARM.EXT; 
$M3MODEL/MCIP/src/icl/icl/MCIPCOM.EXT; 
$M3MODEL/MCIP/src/icl/icl/GROUTCOM.EXT; 
$M3MODEL/MCIP/src/icl/icl/MCOUTCOM.EXT; 
$M3MODEL/MCIP/src/icl/icl/MDOUTCOM.EXT; 
$M3MODEL/MCIP/src/icl/icl/LRALMDAT.EXT; 

llllllllllllll///l/l///////l/ll////////l///l/ll//ll/////ll/ll//l/////I// 

:1111111111111,, 

:i1':,, 
1111::111 

I I  the  rncip  driver  class 

module  mcip  developnent; 

II  the  landuse  class 

module  m3radm  develoi;:rnent; 

II  the  input  class 

module  m3  development; 

II  the  met3d  class 

module  m3sup  development; 

,;111111: 

II 

1111111:; 

.11111! 

' '  

illllll: 
~ 111111 : 

' 

II  the  pbl  class 
;1111;,  module  pb~1,J;>,kg  ~evelopnent; 
I l,  the  drydep  ,cl~,,s 

1!1111111, 

:::, 

11

11

',,, 

1  module  radmdd  development; 

1111111

111

II  the  cloud  class 

module  radmkuo  development; 

11  the  util  class 

module  util  development; 

II  the  output  class 

module  stnd  developnent; 

Appendix  12D 

Sample  MCIP  Run  Script 

#!  /bin/csh  -f 

#  RCS  file,  release,  date  & time  of  last  delta,  author,  state,  [and  locker] 
#  $Header:  /project/work/rep/MCI~/src/sunOSS/sun..;n3_12.q,v 1.1.1.1  1997/10/13  17:38:23  yoj 
E>Cp  $ 

#  what(l)  key,  module  and  SID1  secs  file;  date  and  time  of  last  delta: 
#  @(#)sun..;n3_12.q 
08:26:34 

1.2  /project/mod3/MCIP/doc/bldrun/sunOSS/SCCS/s.sun..;n3_12.q  19  Jun  1997 

#  for  Sun  $pare  20,  Ultra$parc  2 
#method:  sun..;n3_12.q  >&I  sun..;n3_12.log  & 

#  QSUB  -r sun..;n3_12 
#  QSUB  -eo  -o  /work/you/your_directory/sun..;n3.log 
#  QSUB  -lM  8MAF 
#  QSUB  -lT  1800 

date;  set  timestanp;  cat  stU\.)113_12.cfg;  echo  • 

•;  set echo 

setenv M3HOME  /home/models3 
setenv M3DATA  $M3HOME/datasets 

#------------------------------------------------------------
#  set  executable 
1------------------------------------------------------------
set  EXF.C  =  mcip_Jl\3_12 

#------------------------------------------------------------
#  set base  directory 
#------------------------------------------------------------
#set  BASE  = /work/you/your_directory 
set BASE  =  $cwd 

#------------------------------------------------------------
#  set working  directories 
#------------------------------------------------------------
set MCIPOIR  =  $BASE 
set  OUTDIR  =  $cwd 

#------------------------------------------------------------
#  set  input  data  directories 
#------------------------------------------------------------
set  DATADIR  =  $M3HOME/datasets/nostudies 

#-------------------------------------------------------------


I  , ..  (METRCM,METCoL,METLAY)  is  (ROWS,  COLS,  LAYS)  for  MM5  data 
1-------------------------------------------------------------
setenv METROW  25 
setenv METCOL  25 
setenv METLAY  15 

·-------------------------------------------------------------
(IO,  JO):  The  left bottom  loc.  of  CI'M  domain  in MET  terms 
• 
In C'IM  terms,  IO  = ROW_OFFSET,  JO  =  COL_ OFFSET 
I 
1-------------------------------------------------------------
&'etenv  IO  1 
setenv JO  l 

'liiii::' 

1-------------------------------------------------------------
1  LUTYPE:  Filetype  for  Landuse  data: 
I 
I 
I 
I 
1-: ... ------------:------------------------------------------------
setenv LUTYPB  4 

1:  BINARY  13  category  directly  from  TERRAIN 
2:  Preprocessed ASCII  11  category 
3 :  Use  MM5  internal  dominant  landuse  category 
4:  Use  M3  landuse  fractions  available  in  GRIDCR02D 

(IOLUSE,  JOLuSE):  The  left bottom  loc.  of  CI'M  domain  in 

1-------------------------------------------------------------
1 
I  ··· 
1-------------------------------------------------------------
setenv  IOLUsEl 
aei:env  JOLUSE  1 

····.LAND ..  USE  DATA  GRID  terms 

If LCALCPBL  is:  TRUE,  Recorrpute  PBL  values 

1---------------------------------------------------------~---
I 
I 
1-------------------------------------------------------------
setenv  LCALCPBL  T 

FALSE,  Read  PBL  values  from  MM52 

If LSLFLUX  is: 

·-------------------------------------------------------------
TRUE,  Use  only  surface  layer  similarity 
I 
t 
FALSE,  Use  PBL  similarity 
1-------------------------------------------------------------
setenv  LSLFLUX  F 

If  LM3DDEP  is: 

·-------------------------------------------------------------
• 
I 
1-------------------------------------------------------------
setenv  I.M3DDEP  F 

TRUE,  Use  Models-3  D.  Dep  routtine 
FALSE,  Use  RADM  D.  Dep.  routine 

·-------------------------------------------------------------
• 

If I.CALCCLD  is:  TRUE:  Recorrpute  CLOUD  values 

12-88 

'1111111 

FALSE:  Read  CLOUD  values  from  MM52 

#-------------------------------------------------------------
setenv  LCALCCLD  T 

EP A/600/R-991030 

If  LSANITY  is: 

#-------------------------------------------------------------
• 
# 
#-------------------------------------------------------------
setenv  LSANITY  T 

TRUE: 
check  range  of  output  parameters 
FALSE:  do  not  check  range  of  paramters 

INITIAL  JULIAN  STUDY  DATE  (YYDDD) 
STARTING  HOUR  OF  .JUDATE  FOR  STUDY 
NUMBER  OF  HOURS  TO  USE  FROM  MM5 

#-------------------------------------------------------------
JUDATE 
# 
#  HSTRT 
#  HTORUN 
#  HTOSKIP:  NUMBER  OF  HOURS  TO  SKIP  FIRST 
#-------------------------------------------------------------
#  88218  00  0  2 
John's  data 
#  88216  12  0  49  I  Dave's  data 
#  88214  12  10  108  !  Daewon's  data 
setenv  .JUDATE  88209 
setenv  HSTRT  00 
setenv  HTOSKIP  00 
setenv  HTORUN  25 
#setenv  HTORUN  108 

input  file  linkage 

#-------------------------------------------------------------
# 
#  MMSl:  Filename  for  MMSl  datafile 
#  MM52:  Filename  for  MM52  datafile  (NA  if none) 
#  LU13:  Filename  for  LU13  datafile  (binary  from  TERRAIN) 
#-------------------------------------------------------------
#setenv MMSl  $INDIR/MM5l_es80 
#setenv MM52  $INDIR/MM52_es80 
#setenv  LU13  $INDIR/LU80 
#setenv  LUSE  $DATADIR/LU11_80 
#setenv  LUSE  /work/bdx/metpp/newmcip/input/LU11_80 

number  of  iterations  for  vertical  wind  correction 

#-------------------------------------------------------------
# 
# 
#-------------------------------------------------------------
setenv  IWIND  0 

(Use  0,  +/- 1,2,3, .. ) 

number  of  deposition  layers  (default  = 1) 

#-------------------------------------------------------------
# 
# 
#---~---------------------------------------------------------
setenv  NDEP  1 

(for  layer  collapsing,  it could  be  2,  or  3) 

·-------------------------------------------------------------
•  GRIW\M:  Grid  Name  (User  Defined) 
1-------------------------------------------------------------
setenv GROOAM  TUTOR12 

111111'""" 

1-------------------------------------------------------------
,:.,, ___________ :..'.,. ___ ,,:.. __________________________________________ _ 
I  EKECU'I'ICN_ID 

(User  Defined) 

setenv EKECU'I'ION_ID  MCIPJlETA 

SCENFILE:  file  path(User  Defined) 

·-------------------------------------------------------------
' 
·-------------------------------------------------------------
lsetenv  SCENFILE 

$BASE/ 

1-------------------------------------------------------------
1  If  IOAPI_CHECKJiEADERS  is:  TRUE,  Check  the  headers 
f 
1-------------------------------------------------------------
setenv  IOAPI.....CHECKJiEADERS  F 
lsetenv LOGFILE  m::ip.log 
, ____________ _: ___ _:,:_ __________________________________________ _ 

FALSE,  Do  NOT  check  headers 

I  Remove  any  previously  generated  output  files 
·-------------------------------------------------------------
1/bin/rm GRID_*  MET_* 
I/bin/rm  •• /output/GRID_*  •• /output/MET_* 

. _________________ :_ _______________________________ _: __________ _ 

f  Set  up  input  files 
·-----------------~-------------------------------------------

11111111,, 

11111 

I 

11111 

illlii1:,,, 

1111 

'1!!

illl' 

~,,tenv . GRID_CR0_2D  $DATADIR' /GRIDCR02D_TUT12 ' 
~:.~tenv GRID.....DOT_2o  $DATADIR • /GRIDOOT2D_TUT12 • 
setenv MET_CR0_2D 
setenv :MET_coo_3ri 
setenv MET_DOT_3D 

$DATADIR' /METCR02D_TUT12 ' 
$DATADIR I  /METCR03D_TUT12  I 
$DATADIR' /METDOT3D_TUT12 ' 

, ____________ _: ____ :_ __________________________________________ _ 

"II', 

f  Set  up  output  files 
·-------------------------------------------------------------

111111111,,' 

111,, 

aetenv  GRIDJIDY_2D_Gl  $Ol1l'DIR' /GRIDBDY2D_tut12 ' 
setenv  GRID_IIDY_3D_Gl  $Ol1l'DIR' /GRIDBDY3D_tutl2 ' 
setenv GRID_CR0_2D_Gl  $0UI'DIR' /GRIOCR02D_tutl2 ' 
setenv GRID_CR0_3D_Gl  $0l1l'DIR'/GRIOCR03D_tutl2' 
aetenv  GRID_DOT_2D_Gl  $0l1l'DIR'/GRIDD0'1'2D_tutl2' 
aetenv MET_IIDY_2D_Gl 
setenv METJlDY_3D_Gl 

$0UTDIR'/METBDY2D_tut12' 
$OUTDIR'/METBDY3D_tut12' 

setenv MET_CR0_2D_Gl 
setenv MET_CR0_3D_Gl 
setenv MET_DOT_3D_Gl 

$0UTDIR'/METCR02D_tutl2' 
$OUTDIR'/METCR03D_tutl2' 
$OUTDIR'/METDCYl'3D_tut12' 

#-------------------------------------------------------------
#  Execute  MCIP 
#-------------------------------------------------------------
#cdbx  "$EXEC  -g  -x";  exit 
#  ja 
#/opt/Su:t-Mspro/bin/debugger  "$MCIPDIR/$EXEC";  exit 
$MCIPDIR/$EXEC 
#  ja  -cshlt 

exit() 
#-------------------------------------------------------------
#  Move  output  to  proper  directory 
#-------------------------------------------------------------
# /bin/rnv  GRID*  .. /outputl/ 
#/bin/rnv  MET* 
.. /outputl/ 

12-91 


Chapter 13 
===========

THE INITIAL CONCENTRATION AND BOUNDARY CONDITION PROCESSORS 

Human Exposure and Atmospheric Sciences Division 

Gerald L. Gipson· 

National Exposure Research Laboratory 
U.S. Environmental Protection Agency 
Research Triangle Park, NC 27711, USA 

ABSTRACT 

This chapter describes the two processors in the Community Multiscale Air Quality (CMAQ) 
modeling system that generate the initial concentrations and boundary conditions that are required 
by the CMAQ Chemical Transport Model (CCTM).  The major emphasis is on the functionality 
incorporated in  those processors - the  initial condition (ICON) and boundary condition (BCON) 
processors.  The chapter describes how each processor can be used to generate initial 
concentrations and boundary conditions from one of two sources - from predefined default 
vertical profiles or from other CMAQ simulation results when model nesting is being performed. 
A description of generating initial and boundary concentrations for special tracer species is also 
included.  The procedures that are used in both processors for interpolating in both the horizontal 
and vertical directions are described.  A description of methods for converting initial and  · 
boundary concentrations from one chemical mechanism fom1  to another is also presented.  Finally, 
the manner in which each processor is applied within the Models-3/CMAQ framework is 
addressed. 

•Corresponding author address: Gerald L. Gipson, MD-80, Research Triangle Park, NC 27711.  E-mail: 
ggb@hpcc.epa.gov 

13.0  TlIE INITIAL CONCENTRATION AND BOUNDARY CONDITION 
PROCESSORS 

13.l 

Introduction 

1 

"

"""" 

'"'' 

lll,,,"!1111 

'"""""""""' 

'''""""'' 

The solution of partial and ordinary differential equations that arise in air quality models requires 
both initial concentrations (ICs) and boundary conditio~s (BCs). This chapter describes the 
Community Multiscale Air Quality (CMAQ) modeling system processors that generate these 
quantities.  In the discussions that follow, they will be referred to as the ICON and BCON 
prHcessors, re'specHvely.  The ICs and BCs generated by these two processors are used by the 
CMAQ Chemical Transport Model (hereafter referred to as the CCTM). For ICs, the CCTM 
requires that the concentrations of all model species within each grid cell in the modeling domain 
be specified for the start of the simulation.  Concentrations of all model species at the boundaries 
of the modeling domain throughout the simulation are required as BCs to the CCTM.  The 
e~~hasis in tiiis chapter is on how the ICs and BCs are generated rather than on how they are 
u5ed in the CCTM.  The reader is referred to Chapter 5 for a discussion of the latter. 

'''''''""'"' 

111111,,,,'"' 

11'"'"'1
' 

''''''''"" 

"""' 

""'" 

' 

1111'' 
,,',,' 
:1::"ul' 
I

1

, 

' '  

'111111111;,llll 

•:: 

:1111 

'l,"'1111111' 
·:i111::11 
:, 

ll··.11.1''. 
•lll'"'ll,'' 

, 

" 

' 

'" 

' 

,,; 

• 

' 

I 

'""' 

'11"' 

1 
' 

' 

' 
·:,, 
;,,· 

11,:.11 

' 

1 

,, 

' 

:1.1111 

'1111:' 

1111111111111111 

"'I,,,, 

·:: ... 1111111111111111· 

,The ICON and BCON processors have been designed to process data as automatically as 
possible.  Users should be aware of certain operational assumptions that are employed by the two 
processors alldthe CCTM to insure that their applications are performed in the intended manner, 
however.  The discussion below begins with a brief overview of the processors and their 
re!ationship to the CCTM.  Several topics that address the various aspects of the IC/BC 
processing are then presented, including the input sources, spatial· interpolation, species 
processing, and mechanism conversions.  The last section provides a brief overview of how the 
ICON and BCON processors are applied. 

13.2  O'\'crview of the ICON and BCON Processors 

II 

I!' 

The ICON and BCON processors generate ICs and BCs for individual model species, which 
include gas-phase mechanism species, aerosols, nonreactive species and tracer species.  The 
techniques for selecting and processing species data will be discussed in more detail below.  It is 
important to emphasize at the outset, however, that it is not necessary for the ICON and BCON 
processors to generate !Cs and BCs for every species that is being modeled.  The CCTM will 
attempt to extract I Cs and BCs for each species being modeled from the input files.  If a species is 
not found on the file, the CCTM will automatically set its ICs and BCs to a minimum threshold 
limit (i.e., a nominal zero).  Any data on an IC or BC file for a species that is not being modeled 
will simply be ignored by the CCTM.  Therefore, the user is encouraged to check the ICON, 
BCON, and CCTM output logs to insure that the ICs and BCs are being set in the intended 
manner. 

" " " '  

111111''1

1
' 

" 

• 

I 

The ICON processor generates species concentrations for every cell in the modeling domain, 
whereas the BCON processor generates species concentrations for the cells immediately 
surrounding the modeling domain.  At present, the thickness of the boundary cells is limited to 
one, which is the thickness required for all the transport algorithms currently included as part of 
the CCTM (e.g., see Chapter 7).  The reader is referred to Chapters 6 and 7 for a description of 
the CMAQ conventions used in establishing modeling domains and their boundary cells. 

Both the ICON and BCON processors write the output ICs and BCs to standard Models-3 
Input/Output Application Programmer Interface (I/O API) files:  3-dimensional gridded files for 
the ICs and 3-dimensional boundary files for the BCs.  The opening, formatting, and writing of 
these files are handled automatically by the ICON and BCON processors. It should be noted, 
however, that the IO/API has a limit of 120 output variables (i.e., number of species) for any one 
IO/ API file.  If the number of output variables exceeds the IO/ API maximum, the ICON and 
BCON processors will generate up to two additional files to hold the outputs.  If more than 360 
output variables are needed, however, code modifications will need to be made to the ICON and 
BCON processors and the CCTM to accommodate the additional variables. 

13.3 

Input Sources 

The ICON and BCON processors generate IC and BC files from one of three input sources.  The 
first is a time invariant set of vertical concentration profiles.  The second source of input data 
consists of existing Models-3 IO/ API 3-dimensional concentration files, normally generated by the 
CCTM.  The final  source of IC and BC data involves the generation of special tracer species 
concentrations used to test numerical transport algorithms.  Each of these will be discussed 
below.  It should be added, however, that the ICON/BCON processors can be bypassed ifthe 
user desires to use a different method.  The only requirement is that the IC and BC files that are 
eventually fed to the CCTM must be standard Models-3 IO/API gridded concentration and 
boundary concentration files.  The reader is referred to 10/API documentation for a description of 
the structure and format of those files (EPA, 1998). 

13.3.1  Time Invariant Concentration Profiles 

This section describes the manner in which the ICON and BCON processors generate ICs and 
BCs from predefined, vertical concentration profiles.  The CMAQ system contains a set of 
predefined profiles that can be used to generate the requisite ICs and BCs.  These profiles give 
species concentrations as a function of height, and are spatially independent for the ICON 
processor and only minimally spatially dependent for the BCON processor.  Both the ICON and 
BCON profile data are time independent.  Since these data are not highly resolved, they are 
typically used when no other information about ICs and BCs is available.  It should also be noted 
that the predefined profile files can be replaced by user developed profile data provided that the 
replacement files are in the same format as the predefined files. The discussion below begins with 
a description of the predefined profile data, and is followed by a description of how the user can 
prepare replacement data. 

The default IC and BC profiles have been developed for the RADM2 chemical mechanism and the 
terrain following sigma-p coordinate system (see Chapter 6 for a discussion of CMAQ coordinate 
types).  Both the IC and BC profiles are intended to represent relatively clean air conditions in the 
ea's'~ern-half of the United States, and have been formulated from available measurements and 
r~,,Hlts ~~t2:~,5,~ frn,pi ~o~eH11~studies.  Thus, they do no~ represent any specific time period. 
~11*qpg~ J.Jro~!es for other chemical mechanisms and vertical coordinate systems are not currently 
avrulable in the CMAQ system, it may still be possible to use the predefined profiles for these 
cases.  Special procedures are included with the ICON and BCON processors to allow conversion 
from one vertical resolution and/or chemical mechanism to another.  These procedures will be 
described in sections 13.4.2 and 13.6, respectively. 

The predefined profile data are stored in ASCII files in the CMAQ system. Table 13-1  contains a 
listing of the CMAQ predefined IC profile file.  Note that line numbers have been added to the 
listing for reference.  The first three lines contain informational text that is not used by the ICON 
processor.  Line 4 contains the number of vertical layers and the number of species for which 
profiles have been developed, followed by the vertical coordinate values of the sigma-p levels. 
'11!,~ fifth line !,,§,,bl,~ and is ignored by the  ICON processor.  Lines 6 through 46 contain vertical 
profiles for 43 different RADM2 gas-phase species.  The species name is given in the first column, 
followed by mixing ratios (in ppm) for each layer.  The first entry for a species corresponds to the 
lowest layer, whereas the last entry corresponds to the uppermost layer.  Lines 4 7 through 52 
···cd'~iain an .. alogousI:nformation for key aerosol species.  The units for AS041, AS04J, and ASOIL 
are''j.tg/m3,  and the units forNUMAT.KN, NUMACC, and NUMCOR are number/m3

II•,,''''• 

• 

'"''"""" 

•""""""""" 

... 

,, 

1111111111111•'1 

'1111111111111' 

1111111111' 

11111111111111111111, 

1::;,11~ 

, 

I 

I 

Table 13-2 contains a listing of the corresponding predefined BC profile file.  The format for this 
fi~,~ i~ similar 12 ti?:,,!!~ ~or th~ I~, fil~, except that one set of profiles is input for each of the four 
different boundaries of the modeling domain (i.e., north, east, south and west).  The BCON 
pro'cessor uses"'"ihe appropriate set of profiles to generate the BCs at each edge of the modeling 
domain.  Again, line five is blank and is ignored by the BCON processor. 

,11 

111' 

I 

, 

I' 

As indicated above, the user can replace a CMAQ predefined profile file with one of their own 
provided the same file format is used.  As noted in the discussion above, none of the first three 
text lines nor the fifth line in either file is used.  Thus, those lines can contain any information or 
be blank, but they must be present in the file.  The remaining data lines are re.ad in FORTRAN 
list-directed format, so it is not necessary to align the data by columns.  The only formatting 
requirement is that all inputs be separated by commas or by one or more blanks.  The species 
names must not exceed 16 characters and must not contain any blanks. Also, it is not necessary 
that a six-layer vertical resolution be used, but at least one layer must be present and no more than 
30 are allowed.  Note that the number of layer heights on line 4 must be one greater than the 
actual number of layers used. These layer heights must correspond to the heights of the layer 
interfaces (i.e., not the mid-layer heights), and the first entry for any profile must be for the lowest 
level (i.e., ground-level).  The input mixing ratios, however, are interpreted as layer average 
values as opposed to values at the layer interfaces.  Finally, note that the BC vertical profile data 
for each edge begins with a line that contains the edge name.  Although the processors do not 
require that these names be specified explicitly, a line corresponding to the edge name line must 
be included and the processors expect the data for each edge to be input in the order shown in 
Table 13-2 (i.e., north, east, south, and west). 

13.3.2  CCTM Concentration files 

Both the ICON and BCON processors can be configured to generate ICs and BCs from existing 
Models-3 IO/API 3-dimensional, gridded, concentration files.  This situation typically arises when 
performing a nested model simulation and modeling results are available for a coarser grid. 
Unlike the predefined profile files described above, the CCTM concentration files are both 
temporally and spatially resolved, necessitating some additional processing procedures. (The 
subject of spatial interpolation is described in section 13.4.)  It should be added, however, that it 
is not necessary to use the ICON processor for a model continuation run (i.e., a run in which a 
model simulation is started at the exact same time that a previous one ended and the same 
modeling domain is being used).  In such cases the CMAQ IO/ API concentration file from the 
previous run may be used directly as the input IC file to the CCTM.  However, it will still be 
necessary to generate a BC input file. 

Since ICs are required only for the start of a model simulation, the ICON processor will generate 
ICs for only one time step.  BCs are required throughout a simulation, however, so the user must 
prescribe the period of record for which to produce outputs.  One set of BCs will be generated at 
each time step for that period ofrecord.  To illustrate, consider the case in which a model 
simulation has been performed for a coarse grid for a 24-hour period of record using  I-hour time 
steps (i.e., the model concentrations were predicted at hourly intervals).  The IO/API gridded 
concentration file for the coarse grid will then contain species concentrations for 25 time steps, 
one for the start of the simulation (i.e., the I Cs for that simulation) and 24 time steps 
corresponding to the model predictions at each hour.  Now assume that it is desired to generate 
I Cs and BCs for a nested model simulation for the same time period.  The user would select the 
first time step for the ICON output, and the ICON processor would generate ICs for that time 
step only.  For the BCON processor, the period of record for the output BCs would be obtained 
by selecting the same starting time and setting the duration for outputs at 24 hours.  This selection 
would produce 25 time steps on the output file, one for the start and 24 for each of the 
subsequent simulation hours.  The manner in which the time controls are set is described in the 
Models-3 User Manual (EPA,  1998). 

13.3.3  Tracer Species 

The ICON and BCON processors also contain the capability to generate ICs and BCs for special 
tracer species that can be used to investigate the accuracy of the various transport and diffusion 
algorithms available in the CCTM system.  This capability has been included primarily to facilitate 
the evaluation of alternative algorithms, and thus would not likely be used in most air quality 
modeling applications. 

ICs and BCs can be generated for eight different tracers.  Each one can be used to examine 
different properties of transport algorithms, and thus can be selected individually for output.  They 
are chosen by including specially defined tracer names in the list of model species.  The defined 
names and a brief description of each tracer species follow.  (Note that the I Cs for these tracers 
can be viewed with one of the visualization tools to examine the patterns more closely.) 

1111 

• 

• 

• 

• 

• 

• 

• 

• 

ICl_BCO:  All ICs in the modeling domain are set to  1.0 and all BCs are set to 0.0. 

ICl_BCl:  All !Cs in the modeling domain are set to  1.0 and all BCs are set to  1.0. 

"" 

1111111 

" 

,, 

ICO_BCI:  All I Cs in the modeling domain are set to 0.0 and all BCs are set to  1.0. 

STREET:  Within any horizontal cross-section of cells, IC cell concentrations are set to 
either 1.0 or 0.0 such that the overall domain pattern resembles a street grid.  All BCs are 
set to zero. 

CHKBRD:  Within any horizontal cross-section of cells, IC cell concentrations are set to 
either 1.0 or 0.0 such that the overall domain pattern resembles a checkerboard.  All BCs 
are set to zero. 

SPOS_A:  !Cs and BCs are set such that a concentration mound is centered at cell (10,10) 
in the modeling domain, and the concentration profile is defined below. 

SPOS_B:  I Cs and BCs are set such that a concentration mound is centered at cell (10, 10) 
in the modeling domain, and the concentration profile is defined below. 

SPOS  C:  I Cs and BCs are set such that a concentration mound is centered at cell (10, 10) 
in the modeling domain, and the concentration profile is defined below. 

hs  = - - - - - - - - -
a2  +  (x-x/  +  (y-y/ 

a2 

( 13-1) 

The last three tracer species are designed for superposition tests of transport algorithms.  The 
b~e shape of the concentration mounds is described by the Witch of Agnesi surface:where a is 
the radius of the mound, xr and yr define the position of the peak of the mound, and h"' is the 
h~lght of the mound.  In the ICON and BCON processors, a is set to 3 and (xr, Yr)  to ( 10, 10). 

iii!!:"" 

·:111111!: 

I 

' 

•II 

13-6 

':11::::, 

1111 

The three tracer signals hA, h8 ,  and he for  SPOS_A, SPOS_B, and SPOS_C  are then defined as 
follows: 

EPA/600/R-99/030 

h  =q  (l+h)+q. 
A 
mm  ' 

max 

s 

(13-2a) 

(13-2b) 

(13-2c) 

where qmax and qmin determine the amplitude and background values of the signals, and both are 
set to 50 in the  ICON and BCON processor.  With these signals, the addition of mounds B and C 
will yield mound A. Thus, the degree to which hA  - (h8+ he) differs from zero in an advection test 
provides a measure of the nonlinearity of the advection algorithm. 

13.4  Spatial Interpolation 

Both the ICON and BCON processors are designed to account for differences in spatial resolution 
between the input files and the IC/BC output files on an automatic basis.  As described in 
Chapter 6, the CMAQ system is designed to handle different types of horizontal and vertical 
coordinate systems.  All of the data required to completely specify the horizontal and vertical grid 
structure are contained in three INCLUDE files that are generated by the Models-3 framework: 
COORD.EXT, HORD.EXT, and VGRD.EXT.  When the CCTM is compiled (or built), these 
three files are included with the source code, thereby providing the CCTM with all of the 
necessary information on the grid structure that is being used.  Both the ICON and BCON 
processors operate in a similar fashion, and thus both processors must be built with the same three 
INCLUDE files that are used to build the CCTM that will eventually use the ICs and BCs.  Grid 
information on the IC/BC inputs is extracted from the input files themselves, so no additional 
information is required for them. Note that either the horizontal and vertical coordinates for the 
input file may be of a different type than that for the output file, or they may be of the same type 
but have different extents or resolutions. 

· 

13.4.1  Horizontal Interpolation 

Horizontal interpolation is required when a CCTM concentration file  is being used as input to 
either ICON or BCON and the horizontal coordinate system of the input file  differs from that 
needed for the output file.  Such cases typically arise when I Cs and BCs are being generated for a 
nested modeling domain that has a finer resolution than a coarser, outer domain.  Note that no 
horizontal interpolation is necessary if both the input and output domains have the same structure 
or if the time invariant profiles are being used to generate the ICs and BCs. 

Disparities in horizontal grid structure are handled by mapping each vertical column of output 
cells to a corresponding column of input cells. The vertical concentration profiles corresponding 

13-7 

111111'" 

'11111111'"' 

' ' 

' 

' I 11 

: I 

, I 111 

11111111111 : : , 

11 
" ~ I 

' : • II , " 11,,  " 

" I ,, " ,  , " " " " , " " " " " " 

to the input column of cells are then used as the vertical profiles for the output column of cells. 
Note that some vertical interpolation may also be required as described in the next section.  The 
: horizontal mapping is done on the basis of cell proximity.  The ground-level latitudes and 
, longitudes at the center of each vertical column of cells are fust calculated for both the input and 
output domains.  These computed values are then used to find which input column is closest to 
each output column.  Since the ICON and BCON can compute latitude and longitude for any of 
the availE}ble CfviAQ map projections, the horizontal grid coordinate of the input and output files 
d~1•  n0i1 ha~·e 1i1~11'""1)~"1111fue same type. 

' ' " " " " " " '  

,,, 

'""""""' 

1
'',, 

' "  

" "  

11111111111

. ,  

"""' 

""" 

"  " , 

""' 

"' 

"' 

"' 

"' 

'' 

' 

' 

' 

13.4.2  Vertical Interpolation 

, 

::1111

, ,  

11111111111111111, 

IQ,,some applications, the ICON and BCON may be required to generate ICs and BCs for a 
vertical grid system that is different from the one used for the input file.  The CCTM is capable of 
h2!14lin~, sev<:~al different vert~cal grid structures (e.g., sigma-p, sigma-z, pressure, etc.), and each 
'':·of those grid types can have different vertical resolutions (i.e., different numbers of vertical layers 
~t11111~iffer~11,! spacings with the same number of layers).  If the vertical structure of the input and 
output grids is identical (i.e., both are of the same type and have the same vertical resolution), 
then the processing of input data to output data is routine because of the one-to-one 
c~11!'.f~Sponden~~ o~the vertical !ayers.  If the "'.ertical grid types or resolutions,, are different, 
however, the ICON and BCON will convert from the input to the output vertical structure in 
most cases. Conversions from one resolution to another can be performed usmg either profile data 
orCCTM concentration files,  but conversions from one grid type to another can only be 
performed when using CCTM concentration files.  Both the ICON and BCON processors assume 
that the vertical grid-type of the profile data is the same as the required output structure, and thus 
no conversions can be performed in that case.  The two different vertical interpolation cases that 
can be performed by the ICON and BCON processors are described next. 

lllll111i1::::i11111;, 

~ 

' '   I, 

e" 

"""""' 

•II" 

""' 

," 

'1' 

e 

'" 

1 

lh 

" 

" 

" 

" 

• 

I' 

, 

11 

1'1'1·'," 

,:11111111:;:' 

1111::, 

Identical Vertical Grid Types, Different Resolutions.  When the input and output vertical grid 
types are the same but vertical resolutions are different, both ICON and BCON will derive ICs or 
BCs by linear interpolation using the layer heights contained in the input files and those contained 
in"ihe COORJ5.EXT INCLUDE file.  These heights are in the units of the vertical coordinate 
system (e.g., sigma-p, sigma-z, pressure, etc.) rather than height above ground level as measured 
i.qgistance unjJs sych as feet or meters.  The vertical resolutiqn of th~ input IC/BC data can be 
either greater than or less than the output resolution.  Linear interpolation is performed using 
layer heights that correspond to the middle of the layers.  Output concentrations are not always 
interpolated for the bottommost and topmost layers, however.  Output concentrations for all 
layers with mid-layer heights less than the bottommost mid-layer height in the input file will be set 
equal to the concentration of that bottommost layer. Similarly, output concentrations for all layers 
above the input topmost mid-layer height will be set equal to  the concentration of the topmost 
layer. 

Different VertlcalGrid Types.  A complete switch of vertical coordinate types can be carried out 
when the foll2,Yving  two conditions are met:  1) the input IC/BC data are in standard Models-3 

IOI API files and 2) the gridded 3-dimensional meteorological files that contain the mid-layer 
heights for both vertical coordinate systems are also available (see Chapter 12 for a description of 
these meteorological files).  When these conditions are met, the ICON and BCON processors will 
use linear interpolation to convert from one coordinate system to another.  The interpolation is 
performed in exactly the same manner as described in the previous paragraph, except that the mid(cid:173)
layer heights are taken from the 3-dimensional meteorological files which give the mid-layer 
heights in meters above ground level for both the input IC/BC data and the output IO/API files. 
Thus, the meteorological data files containing the layer heights in meters above ground level must 
be available for both the input and output grids before the ICON and BCON processors can be 
used. 

13.5 

ICON/BCON Species Processing 

The selection of species that are to be modeled and thus require I Cs and BCs is controlled by the 
Program Control Processor (PCP).  A detailed description of that processor is contained in 
Chapter 15, and will not be repeated here.  A brief overview of some of the relationships between 
the PCP and the ICON/BCON processors is presented here to facilitate the description of species 
processing, however. 

The species that are to be modeled in a CCTM simulation are determined when the user invokes 
the PCP in the Models-3  framework to select a gas phase chemical mechanism, whether or not 
aerosols are to be included, and whether to include other nonreactive and/or tracer species.  The 
Models-3  framework generates four INCLUDE files that contain the names of all species that are 
to be modeled -- GC_SPC.EXT, AE_SPC.EXT, NR_SPC.EXT, and TR_SPC.EXT (collectively 
referred to below as the SPC INCLUDE files).  The Models-3 framework also allows the user to 
invoke special treatment of the I Cs and BCs for individual species by defining special surrogate 
names and providing corresponding scale factors for the calculation of I Cs (EPA,  1998).  The 
Models-3  framework generates four INCLUDE files that contain this information -(cid:173)
GC_ICBC.EXT, AE_ICBC.EXT, NR_ICBC.EXT, and TR_ICBC.EXT (collectively referred to 
below as the ICBC INCLUDE files).  Note that some of these files may not contain any entries 
depending on the user's selection, but all files will be generated by the framework.  Just as both 
the SPC and ICBC INCLUDE files must be included when the CCTM is built, they must also be 
included when the ICON and BCON processors are built. 

The SPC INCLUDE files contain the names of all species to be modeled and will therefore require 
ICs and BCs in the CCTM.  The ICON/BCON processors use the information in both the SPC 
and the ICBC INCLUDE files to determine which species data should be extracted from the input 
file and be subsequently written to the output file.  The ICON and BCON processors also include 
an option to convert from one chemical mechanism to another.  Since it represents a special 
option with its own unique rules,  it is described separately in section 13.6.  The subsequent 
discussion focuses on the treatment of individual species for two cases - one with and one without 
associated surrogate names. 

13-9 

Consider first the case in which a surrogate name is not specified.  This situation occurs when a 
model species (i.e., one whose name is included in one of the  SPC INCLUDE files) does not 
have a surrogate name assigned to it.  In this case, the ICON and BCON processors simply check 
to see if the input file contains data for a species with the exact same name as the model species 
name.  If none is found,  I Cs and BCs are not generated for that species.  If a match is found, the 
data for that species are extracted from the input file,  processed, and written to the IC and BC 
output files. 

The assignment of a surrogate name to a particular species complicates the processing slightly. 
Surrogate names in the CMAQ system arise at least in part from the generalized treatment of the 
chemical mechanisms and the fact that species names are not "hardwired" in the CMAQ system. 
1J1eir primary function is to link a model species with data that are associated with a species of a 
d~ffcwn~ 11:~.~·  T;,vo e?Cru:nples are p7esented to illustratepot~ntial uses. 

'"'I'' 

.·11: 

1 

,'",11

1111111111111 

' 

" 

' 

' 

11 

1 
' 111111 I I 1

' 11 

. " i 1 I I I 11 

. ' • ' ' • 

. ' ' ' 

. . • 

1 

• 

• • . . 

'  . 

1

. 

111 '  . . . ' . I I 

II " ' 

' 

' . 

~ ' " 

...  The first example illustrates how surrogates can be used to provide simple links from one species 
to another.  First, suppose a series of CMAQ model simulations had been performed using the 
CMAQ system standard RADM2 mechanism in which formaldehyde is named HCHO.  Thus, all 
of the data for that species will be associated with the name HCHO in the CMAQ system data 
files.  Now consider that a researcher wants to make use of that data but will be using their own 
version of the RADM2 mechanism in which formaldehyde is named FORM.  To use the older 
modeling data, the researcher could either change the formaldehyde name in the chemical 
mechanism to conform to the original RADM2 name or assign the surrogate HCHO for FORM. 
In the latter case, both the ICON/BCON processors and the CCTM are designed to extract IC/BC 
data using the surrogate name in place the model species name.  This will be explained in more 
detail further below. 

The second example of using a surrogate name illustrates how scale factors can be used with 
surrogates.  Suppose a researcher is experimenting with a new chemical mechanism which divides 
a particular species p AR Into two new species, p ARi and PAR2.  Further, suppose the researcher 
wants to  use existing CMAQ model simulations with the PAR species to generate ICs and BCs 
for both PARl and PAR2.  The researcher will assume that 25% of the PAR IC/BC 
c~mcentrations will be assigned to PARl and 75% to PAR2.  To effect this in the CMAQ 
modeling system, the researcher can assign the species surrogate name PAR to both PARI  and 
PAR2, and assign 0.25 to the ICBC scale factor for PARI  species and 0.75 to the ICBC scale 
factor for PAR2.  The ICON/BCON processors and CCTM will use this infmmation to compute 
the proper ICs and BCs for the two species PARI  and PAR2 from the input PAR values.  The 
procedures followed by both the ICON/BCON and the CCTM are described next. 

The introduction of surrogate names for IC and BC species affects the manner in which both the 
ICON/BCON processors and the CCTM operate. Consider first the processing that takes place in 
the ICON/BCON processors.  Each species in the SPC INCLUDE files is selected for processing 
individually.  If a surrogate name is assigned to that species, the IC/BC input files are examined to 
sec if the surrogate name is included with the inputs.  If the surrogate name is on the input file,  the 

13-10 

:,, 

"' 

1

11

11,'

1
' 

11111

'" 

data corresponding to that name are extracted from the input file,  processed and output under the 
surrogate name.  Further, the ICBC scale factors are not applied in the ICON and BCON.  If the 
surrogate name is not found on the input data file,  the ICON/BCON processors will then check 
the input file using the model species name as if no surrogate name had existed.  Again, if a match 
is found using the model species name, the corresponding data are extracted and output under the 
model species name.  If the input file does not contain any data under the surrogate name or the 
model species name, then no IC/BC data are generated for that particular model species. 

Now consider processing in the CCTM when surrogate names are used for ICs/BCs.  The CCTM 
processes each species in the SPC INCLUDE files individually.  If a surrogate name is specified 
for the model species and it is found on the IC/BC input files, the CCTM extracts the data for that 
name, applies the scale factor to those data, and then assigns the scaled concentrations to the I Cs 
and BC concentrations for the model species.  If the surrogate species name is not found on the 
input IC/BC files, the input file is checked using the model species name contained in the SPC 
INCLUDE files.  If data for that model species are found,  then the data are extracted and used 
directly as I Cs and BCs (i.e., no scale factors are applied).  If data for the species are not found on 
the input file, the ICs and BCs are set to the lower threshold limits. 

For most routine applications, users need not concern themselves with surrogate mapping issues. 
The ICON and BCON processors are designed to generate the appropriate ICs and BCs with 
minimal user interaction, provided the correct input files and include files are used with the 
processors.  Both the ICON and the BCON processors generate a species map on the output log 
that reports the relationship between the input and output IC and BC species. The user can check 
these logs to insure that the desired species mapping has been performed.  Further, the CCTM's 
output log lists those species for which the lower threshold limits are used, and these should be 
checked to insure that the ICs/BCs for an important species have not been omitted. 

13.6  Mechanism Conversions 

The vertical profile data and the CCTM concentration file data that were described above 
normally correspond to one gas-phase, chemical mechanism.  For example, the predefined, 
vertical profile data presently in the CMAQ system were developed for the RADM2 chemical 
mechanism.  The capability to convert from one gas phase chemical mechanism to another has 
been included in the ICON and BCON processors, however. It should be emphasized that there is 
not always a definite correspondence between chemical mechanism species, and it is usually 
necessary to make several assumptions to make such conversions.  This is particularly true for 
organic species that may be defined differently in two mechanisms.  Nevertheless, some simple 
mechanism conversion capabilities have been included for those cases in which approximations are 
acceptable for converting from one mechanism to another. 

A special routine to generate ICs and BCs for the CB4 chemical mechanism from RADM2 gas(cid:173)
phase mechanism inputs is included as part of the ICON and BCON processor options.  At 
present, no other "hardwired" conversion routines are available in the system, but it is conceivable 
that some C()l!ld b~ added in the future as more chemical mechanisms are added to the CMAQ 
s}'stem.  No conversion from CB4 to RADM2 format has been included because the carbon bond 
lumping technique makes it difficult to disaggregate mechanism species into their original 
chemical compounds.  For a description of these two mechanisms, the reader is referred to 
Chapter 8.  The hardwired RADM2 to CB4 conversion procedures that are used are the same as 
for the generalized conversion processor that is described next. 

11111111111' 

'' 

"" 

·,  '' 

'''''''''''''''''''' 

As a convenience for the user, a generalized mechanism conversion processor has also been 
included in both the ICON and BCON processors.  This conversion procedure requires the user 
to generate an ASCII input file,that contains mechanism conversion rules.  Thus, the user is 
responsible for defining how the mechanism conversion is to be performed.  An example file 
showing the conversion from RADM2 to CB4 is included in Table 13-3.  The file contains the 
lllllllllli' 
expressions that are used to convert the ICs and BCs from one mechanism form to another.  The 
I Cs and BCs for the CB4 species (i.e., those on the left hand side of the equal sign) are computed 
from the RADM2 species concentrations (i.e., those on the right hand side of the equal sign) 
according to the equations shown.  As is evident, there is a simple one-to-one correspondence for 
most species and lumping only occurs for relatively few species.  It should also be noted that no 
cgnvcrsions will!Je performed for those species that are not included in the input file, and thus no 
!Cs or BCs will be generated for them.  As mentioned previously, the user is advised to review the 
species map on the ICON/BCON output log to  insure that the conversions are being done as 
intended.  Finally, it should be added that the mechanism conversion option applies only to the gas 
phase chemistry species.  Aerosol, nonreactive and tracer species will be processed in the standard 
Wa.y, regardless of whether a mechanism conversion is being performed. 

lllllllli' 

·, 

• 

·1111 .. 111"''111"'" 

,, 

11111111111111'.,ll 

' 

"' 

,,,  : ' 

The format for the mechanism conversion rules is relatively simple.  Species names must be  16 
characters or less and not contain any blanks.  Only one species is permitted on the left-hand side 
of the equation, and the species name should correspond to a name in the output mechanism. 
The equal sign must be present, and at least one species name must appear to the right of it. 
Coefficients :for species are allowed on the right-hand side only, and they can be in either integer, 
real, or exponential format.  They must always be followed by an asterisk to indicate 
multiplication.  For expressions involving lumping of species, only addition is allowed and it is 
indicated by a plus sign.  Line-wrap is allowed so that a single lumping rule can span more than 
ope line~  E?~h ce>,vversio~ rl!,l~ myst conclude with a semicolon, and the last command must be 
"END;".  Finally, the input files are read in a free form input that generally ignores white spaces 
betv.·een species names, coefficients, operators and line terminators. 

13.7 

ICON/BCON Applications 

This section provides an overview of how the ICON and BCON processors are applied in 
practice.  Applications are normally carried out in two steps: compilation (or building) and 
execution.  As mentioned earlier, when the ICON and BCON executables are built, the grid 
INCLUDE files for the modeling domain must be included.  In addition, the user must select four 
modules that determine the ICON/BCON processing routines to incorporate when the executable 
is built.  Two modules must always be present:  icon (or bcon in the case of the BCON processor) 
and ic/.  These two modules contain processing routines that are common to all applications.  One 
of the following three modules must be chosen to  include the routines to process the specific input 
source:  1) profile for using a time invariant vertical concentration profile contained in an ASCII 
file,  2) m3conc for processing a CMAQ 10/API concentration file,  or 3) tracer for generating 
special tracer species I Cs and BCs.  Finally, one of three modules must also be selected to control 
the mechanism conversion procedure:  1) noop for no mechanism conversion, 2) radm2  to  cb4 
for a CMAQ predefined RADM2 to CB4 conversion, or 3) us.er_ defined to process a user 
generated ASCII file (e.g., Table 13-3) containing mechanism conversion rules that are used to 
generate ICs and BCs for one mechanism using input concentrations for a different mechanism. 

The second step involves running the processors with all necessary input files assigned and the 
time control parameters set.  Both are provided to the processors by means of environment 
variables.  The input and output files are assigned by means of predefined logical file names.  The 
ICON processor requires a starting date and time in the Models-3 conventional time stamp 
format.  The BCON processor requires both a starting date and time and a run duration parameter. 

For detailed information on compiling and running these processors,  the reader is referred to the 
Models-3  User Manual (EPA,  1998). 

13.8  References 

EPA,  1998.  Models-3  Volume 9b:  User Manual, Draft EPA report, U.S. Environmental 
Protection Agency, Research Triangle Park, N.C. 

This chapter is taken from Science Algorithms of the EPA Models-3 Community 
Multiscale Air Quality (CMAQ) Modeling System, edited by D. W. Byun and J. K. S. 
Ching, 1999. 

Table 13-1.  CMAQ Predefined Vertical Profiles for Initial Concentrations 

47 

1.00  0.98  0.93  0.84  0.60  0.30  0.00 

layers  and  defined  sigma  levels  are  listed  below. 

l  Optional  boundary  condition:  The  vertical  coordinate  of  the  model  to 
2  "generate  i:Eese  b.c.  is  the  terrain-following  sigma  coordinate.  The  number  of 
3  sigma 
4  i 
5 
6  S02 
7  SULF 
8  N02 
9  NO 
10  03 
11  "'HNo3 
12  H202 
13  ALD 
14  HCHO 
15  OPl 
16  OP2 
17  PAA 
18  ORAl 
19  ORA2 
20  NH3 
21  N205 
22  N03 
l?AN 
23 
24  HC3 
25  HC5 
2G  HCS 
27  ETH 
28  co 
29  OL2 
30  OLT 
31  OLI 
32  TOL 
33  XYL 
34  AC03 
35  TPAN 
36  HONO 
37  HN04 
38  KET 
39  GLY 
40  MGLY 
41  DCB 
42  ONIT 
43  CSL 
44  ISO 
45  HO 
46  H02 
47  AS04I 
48  AS04J 
49  NUMATKN 

0.300E-03  0.200E-03  O.lOOE-03  O.lOOE-03  0.200E-04  O.lOOE-04 
0.150E-03  O.l50E-03  O.lOOE-03  O.lOOE-03  0.200E-04  O.lOOE-04 
O.OOOE+OO 
0.200E-04  0.200E-04  O.lOOE-04 
O.OOOE+OO 
0.200E-04  0.200E-04  O.lOOE-04 
0.700E-01 
6.i50~-01  0.350E-01  0.400E-01 
'6.560E-o4'  0.500E-04  0.500E-04 
O.lOOE-03 
0.200E-03 
0.100E-02  O.lOOE-02  0.150E-02 
· '"''o. 3"'ooE-o4  o. 35'0J::-04  o. 300E-04 
O.lOOE-04 
0.250E-03 
0.500E-04 
0.250E-03 
0.500E-07 
0.250E-06 
0.250E-06 
0.300E-07 
O.lOOE-07 
0.300E-07 
0.150E-04 
0.300E-04 
0.300E-04 
O.OOOE+OO 
0.500E-06 
O.lOOE-05 
O.OOOE+OO 
0.500E-06 
O.lOOE-05 
0.300E-04 
O.lOOE-04 
O.lOOE-03 
O.OOOE+OO 
O.OOOE+OO 
o.OboE+OO 
O.OOOE+OO 
O.OOOE+OO 
O.OOOE+OO 
O.OOOE+OO 
O.lOOE-04 
0.200E-04 
O.OOOE+OO 
0.320E-04 
0.400E-04 
O.OOOE+OO 
0.320E-04 
0.400E-04 
O.OOOE+OO 
0.160E-04 
0.200E-04 
O.OOOE+OO 
0.000E+OO 
O.OOOE+OO 
0.500E-01 
0.800E-01 
0.800E-01 
O.OOOE+OO 
0.200E-05 
0.500E-05 
O.OOOE+OO 
O.lOOE-06 
0.200E-06 
O.OOOE+OO 
O.OOOE+OO 
O.lOOE-06 
O.OOOE+OO 
O.lOOE-05 
O.lOOE-05 
O.OOOE+OO 
O.lOOE-06 
0.200E-06 
O.lOOE-08 
O.lOOE-08 
O.lOOE-08 
O.lOOE-07 
O.lOOE-07 
O.lOOE-07 
O.lOOE-08 
O.lOOE-08 
O.lOOE-08 
0.200E-08 
0.200E-08 
0.200E-08 
· 'o. 3"'ooE-o4 
0.300E-04 
O.lOOE-04 
0.500E-07 
0.2SOE-06 
0.250E-06 
0.250E-06 
0.500E-07 
0.250E-06 
0.250E-06 
0.500E-07 
0.250E-06 
0.160E-04 
O.OOOE+OO 
0.200E-04 
O.lOOE-08 
O.lOOE-08 
O.lOOE-08 
0.250E-05 
0.250E-05 
0.250E-05 
O.OOOE+OO 
O.OOOE+OO 
O.OOOE+OO 
O.OOOE+OO 
O.OOOE+OO 
O.OOOE+OO 
1. 603E-02 
l.603E-03 
4.SlOE-02 
3.848E-02 
3.848E-01 
l.154E+OO 
4.791E+09 
4.791E+08 
1.437E+10 

O.OOOE+OO  O.OOOE+OO 
O.OOOE+OO  O.OOOE+OO 
0.500E-01  0.600E-01 
0.500E-04  0.700E-04 
O.lOOE-02  0.800E-03 
o.26dE-04"  o.2ooi~o4 
0.200E-03 
O.lOOE-03 
O.lOOE-06 
0.200E-06 
0.200E-07 
0.200E-07 
0.200E-04 
0.250E-04 
0.500E-06 
0.500E-06 
0.500E-06 
0.500E-06 
0.200E-04 
0.200E-04 
O.OOOE+OO 
O.OOOE+OO 
O.OOOE+OO 
O.OOOE+OO 
O.lOOE-04 
O.lOOE-04 
0.120E-04 
0.400E-05 
0.120E-04 
0.400E-05 
0.600E-05 
0.200E-05 
O.OOOE+OO 
O.OOOE+OO 
0.650E-01 
0.700E-01 
O.lOOE-05 
O.lOOE-05 
O.OOOE+OO 
O.OOOE+OO 
O.OOOE+OO 
O.OOOE+OO 
O.OOOE+OO 
O.lOOE-05 
O.OOOE+OO 
O.OOOE+OO 
O.lOOE-08 
O.lOOE-08 
O.lOOE-07 
O.lOOE-07 
O.lOOE-08 
O.lOOE-08 
0.200E-08 
0.200E-08 
0.200E-04 
0.200E-04 
0.200E-06 
O.lOOE-06 
0.200E-06 
O.lOOE-06 
0.200E-06 
O.lOOE-06 
0.200E-05 
0.600E-05 
O.lOOE-08 
O.lOOE-08 
0.250E-05 
0.250E-05 
O.OOOE+OO 
O.OOOE+OO 
O.OOOE+OO 
O.OOOE+OO 
3.207E-03 
l.603E-02 
7.696E-02 
3.848E-Ol 
4.791E+09 
9.583E+OB 

0.250E-03 
0.250E-06 
0.350E-07 
0.300E-04 
O.lOOE-05 
O.lOOE-05 
O.lOOE-03 
O.OOOE+OO 
O.OOOE+OO 
0.200E-04 
0.400E-04 
0.400E-04 
0.200E-04 
O.OOOE+OO 
0.800E-01 
0.300E-05 
0.200E-06 
O.lOOE-06 
O.lOOE-05 
0.200E-06 
O.lOOE-08 
O.lOOE-07 
O.lOOE-08 
0.200E-08 
0.350E-04 
o.250E-o6 
0.250E-06 
0.250E-06 
0.200E-04 
O.lOOE-08 
0.250E-05 
O.OOOE+OO 
O.OOOE+OO 
3.207E-02 
7.696E-01 
9.583E+09 

111111111 

1 

.II"" 

11111'"' 

11' 

h' 

13-14 

Table 13-1.  CMAQ Predefined Vertical Profiles for Initial Concentrations 

50  NUMACC 
51  ASOIL 
52  NUMCOR 

l.370E+08  2.740E+07  1.370E+07 
4.110E+08  2.740E+08  1.370E+08 
1.000E+OO  8.000E-01  4.000E-01  4.000E-01  8.000E-02  4.000E-02 
1.740E+04 
l.392E+03  6.960E+02 

l.392E+04  6.960E+03  6.960E+03 

EPA/600/R-99/030 

13-15 

Table  13-2.  CMAQ Predefined Vertical Profiles for Boundary Conditions 

: 11111 i : I i : I :  i . .  ' 

' ' ' 

' , , 

:  111111:: 

11: 

" ,  

, 

I : ; ' I ~ 11 i : : : : ~ : : 

..  •1111111111: 

' ! 11 I : I :I ii 11 :I : : 
:""!I  I: 

' 

' 

. 

' 

·· 

' ' " I i 
, 

: ' " '  . ' 
r. 

...... :•, 

··· 

' 

' 

" '  .  ' ' 
, 

" :  ' I ! 1, 
,  1111, 

:11 ·1 i : : " ' ' ' ' i  : ' 
·:!::::l,. 1

111111· 

,1 

. ' ' : 

. 

.. •••· 

. 

· 

,, 

47 

1  Optional  boundary  condition:  The  vertical  coordinate  of  the  model  to 
2  generate  these  b.c.  is  the  terrain-following  sigma  coordinate.  The  number  of 
3  sigma  layers  and  defined  sigma  levels  are  listed  below. 
4  6 
s 
6  North 
7 
a  S02 
51  SULF 

1.00  0.98  0.93  0.84  0.60  0.30  0.00 

''11111111 

'1 111111·1, 

111111111:·1:, 

111111,. 

" 

1111 

I 

"'' 

111111111111111 

111::,,111!"' 

!11111!""111'' 

10  N02 
11  NO 
12  03 
13  HN03 
14  H202 
15  ALD 
16  HCHO 
17  OP1 
ie  OP2 
151  PAA 
20  ORA1 
21  ORA2 
22  NH3 
:n  N205 
24  N03 
25  PAN 
26  HC3 
27  HCS 
28 'iics 
29  ETH 
30  co 
31  OL2 
32  OLT 
33  OLI 
34  TOL 
35  XYL 
36  AC03 
37  TPAN 
38  HONO 
39  HN04 
40  KET 
41  GLY 
42  MGLY 
43  DCB 
1 0NIT 
44
45  CSL 
46  ISO 
47  .~o 
48  H02 

11111111111· 

'" 

"" 

" 

" 

1
""

Ill'' 

1
111111

1111111111111 

1
11111111 

''"''"""'""' 

l1u1lllllll" 

•111111111" 

0.300E-03 
0.1SOE-03 
0.200E-04 
0.200E-04 
0.350E-01 
0.500E-04 
0.100E-02 
0.300E-04 
0.250E-03 
0.250E-06 
0.300E-07 
"'o.300E-04 
0.100E-05 
0.100E-OS 
0.100E-03 
O.OOOE+OO 
O.OOOE+OO 
0.200E-04 
0.400E-04 
0.400E-04 
· .,,  o. 2ooE-o4 
O.OOOE+OO 
11111""0. efOoE-01 
0.500E-05 
0.200E-06 
0.100E-06 
0.100E-05 
0.200E-06 
0.100E-08 
0.100E-07 
O.lOOE-08 
0.200E-08 
0.300E-04 
0.250E-06 
, .. 
,,,  o. '.iso:E-06 
o.2soE-06 
o.2ooE:-o4 
····  o. iooE-00 
0.2SOE-05 
O.OOOE+OO 
.OOOE+OO 

""

I· 

0.2aoE-03  O.lOOE-03 
O.lSOE-03  0.100E-03 
0.lOOE-04 
0.200E-04 
0.200E-04 
O.lOOE-04 
0.400E-01 
0.350E-01 
O.SOOE-04 
O.SOOE-64 
O.lSOE-02 
O.lOOE-02 
0.300E-04 
0.350E-04 
0.2SOE-03 
0.2SOE-03 
0.250E-06 
o.2sCJE-06 
o. '3soE-07 
o.3ooE-o7 
0.300E-04 
0.30ciE-04 
O.SOOE-06 
O.lOOE-05 
O.lOOE-05 
O.SOOE-06 
0.100E-03 
0.300E-04 
O.OOOE+OO 
O.OOOE+OO 
O.OOOE+OO 
O.OOOE+OO 
O.iOOE-04 
o::.fodE-04 
0.400E-04 
0.320E-04 
0.320E-04 
0.400E-04 
0.160E-04 
0.200E-04 
O.OOOE+OO 
O.OOOE+OO 
0.800E-01 
O.SOOE-01 
0.200E-05 
0.300E-05 
O.lOOE-06 
0.200E-06 
O.OOOE+OO 
O.lOOE-06 
0.100E-OS 
O.lOOE-05 
0.100E-06 
0.200E-06 
O.lOOE-08 
O.lOOE-08 
O.lOOE-07 
O.lOOE-07 
O.lOOE-08 
O.lOOE-08 
0.200E-08 
0.200E-08 
0.300E-04 
0.350E-04 
0.2SOE-06 
0.250E-06 
0.2SOE-06 
0.250E-06 
0.250E-06 
0.2SOE-06 
0.160E-04 
0.200E-04 
O.lOOE-08 
O.lOOE-08 
0.2SOE-OS 
0.2SOE-OS 
O.OOOE+OO 
O.OOOE+OO 
O.OOOE+OO 
O.OOOE+OO 

d.~6oE-o3"  o.200E-04 
O.lOOE-03  0.200E-04 
O.OOOE+OO 
O.OOOE+OO 
O.OOOE+OO 
O.OOOE+OO 
0.600E-Ol 
0.500E-01 
O.SOOE-04 
0.700E-04 
O.lOOE-02 
0.800E-03 
0.200E-04 
0.200E-04 
0.200E-03  O.lOOE-03 
o.26bE~o~  6.1ob~-06 
0.200E-07- 0.20bi-07 
0.250E-04  0.200E-04 
O.SOOE-06  O.SOOE-06 
O.SOOE-06  O.SOOE-06 
0.200E-04 
0.200E-04 
O.OOOE+OO 
O.OOOE+OO 
O.OOOE+OO 
O.OOOE+OO 
O.lOOE-04 
O.lOOE-04 
0.120E-04 
0.400E-OS 
0.400E-05 
0.120E-04 
0.600E-05 
0.200E-05 
O.OOOE+OO  O.OOOE+OO 
0. 700E-Oi  ........  0. 6 SOE- 01 
O.lOOE-05  O.lOOE-05 
O.OOOE+OO 
O.OOOE+OO 
O.OOOE+OO 
O.OOOE+OO 
O.lOOE-05 
O.OOOE+OO 
O.OOOE+OO 
O.OOOE+OO 
O.lOOE-08 
O.lOOE-08 
O.lOOE-07 
O.lOOE-07 
O.lOOE-08 
O.lOOE-08 
0.200E-08 
0.200E-08 
0.200E-04 
0.200E-04 
O.lOOE-06 
0.200E-06 
O.lOOE-06 
0.200E-06 
0.100E-06 
0.200E-06 
0.600E-05 
0.200E-05 
O.lOOE-08 
O.lOOE-08 
0.250E-OS 
0.2SOE-05 
O.OOOE+OO 
O.OOOE+OO 
O.OOOE+OO 
O.OOOE+OO 

O.lOOE-04 
0.100E-04 
O.OOOE+OO 
O.OOOE+OO 
0.700E-01 
O.lOOE-03 
0.200E-03 
O.lOOE-04 
O.SOOE-04 
O.SOOE-07 
O.lOOE-07 
O.lSOE-04 
O.OOOE+OO 
O.OOOE+OO 
O.lOOE-04 
O.OOOE+OO 
O.OOOE+OO 
O.OOOE+OO 
O.OOOE+OO 
O.OOOE+OO 
O.OOOE+OO 
O.OOOE+OO 
O.SOOE-01 
O.OOOE+OO 
O.OOOE+OO 
O.OOOE+OO 
O.OOOE+OO 
O.OOOE+OO 
O.lOOE-08 
O.lOOE-07 
O.lOOE-08 
0.200E-08 
O.lOOE-04 
O.SOOE-07 
O.SOOE-07 
O.SOOE-07 
O.OOOE+OO 
O.lOOE-08 
0.250E-05 
O.OOOE+OO 
O.OOOE+OO 

• 

II 

13-16 

'1111' 

111111, 

i!lllllli 

1111111" 

"Ill!!:::::, 

111 


Table 13-2.  CMAQ Predefined Vertical Profiles for Boundary Conditions 

49  AS04I 
50  AS04J 
51  NUMATKN 
52  NUMACC 
53  ASOIL 
54  NUMCOR 
55  East 

2.405E-02 
S.772E-01 
7.187E+09 
2.0SSE+08 
S.OOOE-01 
8.7SOE+03 

2.405E-02 
5.772E-01 
7.187E+09 
2.055E+08 
5.000E-01 
8.7SOE+03 

1.603E-02 
3.848E-01 
4.791E+09 
1.370E+08 
4.000E-01 
7.000E+03 

1. 603E-02 
3.848E-Ol 
4.791E+09 
l.370E+08 
4.000E-01 
7.000E+03 

3.207E-03 
7.696E-02 
9.583E+08 
2.740E+07 
8.000E-01 
1. 400E+03 

1.603E-03 
3.848E-02 
4.791E+08 
l.370E+07 
3.000E-01 
5.2SOE+02 

56 
57  S02 
58  SULF 
59  N02 
60  NO 
61  03 
62  HN03 
63  H202 
64  ALD 
65  HCHO 
66  OP1 
67  OP2 
68  PAA 
69  ORA1 
70  ORA2 
71  NH3 
72  N205 
73  N03 
74  PAN 
75  HC3 
76  HCS 
77  HC8 
78  ETH 
79  co 
00  OL2 
81  OLT 
82  OLI 
83  TOL 
84  XYL 
85  AC03 
86  TPAN 
87  HONO 
88  HN04 
89  KET 
90  GLY 
91  MGLY 
92  DCB 
93  ONIT 
94  CSL 
95  ISO 
96  HO 
97  H02 

O.OOOE+OO 
0.200E-03 
0.100E-04 
O.OOOE+OO 
0.300E-01 
O.SOOE-04 
0.200E-02 
0.400E-04 
0.250E-03 
0.250E-06 
0.400E-07 
O.SOOE-04 
0.150E-05 
0.150E-05 
O.SOOE-04 
O.OOOE+OO 
O.OOOE+OO 
0.100E-04 
0.120E-04 
0.120E-04 
0.600E-05 
O.OOOE+OO 
0.800E-Ol 
O.OOOE+OO 
O.OOOE+OO 
O.OOOE+OO 
O.OOOE+OO 
O.OOOE+OO 
O.lOOE-08 
O.lOOE-07 
O.lOOE-08 
0.200E-08 
0.400E-04 
0.2SOE-06 
0.250E-06 
0.250E-06 
0.600E-05 
O.lOOE-08 
0.250E-05 
O.OOOE+OO 
O.OOOE+OO 

O.OOOE+OO 
0.200E-03 
O.lOOE-04 
O.OOOE+OO 
0.350E-01 
O.SOOE-04 
0.200E-02 
0.400E-04 
0.250E-03 
0.250E-06 
0.400E-07 
O.SOOE-04 
O.SOOE-06 
O.SOOE-06 
O.SOOE-04 
O.OOOE+OO 
O.OOOE+OO 
O.lOOE-04 
0.120E-04 
0.120E-04 
0.600E-05 
O.OOOE+OO 
O.BOOE-01 
O.OOOE+OO 
O.OOOE+OO 
O.OOOE+OO 
O.OOOE+OO 
O.OOOE+OO 
O.lOOE-08 
O.lOOE-07 
O.lOOE-08 
0.200E-08 
0.400E-04 
0.250E-06 
0.250E-06 
0.250E-06 
0.600E-05 
O.lOOE-08 
0.250E-05 
O.OOOE+OO 
O.OOOE+OO 

O.OOOE+OO 
0.200E-03 
O.OOOE+OO 
O.OOOE+OO 
0.400E-01 
O.SOOE-04 
0.200E-02 
0.400E-04 
0.250E-03 
0.250E-06 
0.400E-07 
O.SOOE-04 
O.SOOE-06 
O.SOOE-06 
O.SOOE-04 
O.OOOE+OO 
O.OOOE+OO 
O.lOOE-04 
0.120E-04 
0.120E-04 
0.600E-05 
O.OOOE+OO 
O.BOOE-01 
O.OOOE+OO 
O.OOOE+OO 
O.OOOE+OO 
O.OOOE+OO 
O.OOOE+OO 
O.lOOE-08 
O.lOOE-07 
O.lOOE-08 
0.200E-08 
0.400E-04 
0.250E-06 
0.250E-06 
0.250E-06 
0.600E-05 
O.lOOE-08 
0.250E-05 
O.OOOE+OO 
O.OOOE+OO 

13-17 

O.OOOE+OO 
0.200E-03 
O.OOOE+OO 
O.OOOE+OO 
O.SOOE-01 
O.SOOE-04 
0.200E-02 
0.400E-04 
0.200E-03 
0.200E-06 
0.400E-07 
O.SOOE-04 
O.SOOE-06 
O.SOOE-06 
0.200E-04 
O.OOOE+OO 
O.OOOE+OO 
O.lOOE-04 
0.800E-05 
0.800E-05 
0.400E-05 
O.OOOE+OO 
0.750E-01 
O.OOOE+OO 
O.OOOE+OO 
O.OOOE+OO 
O.OOOE+OO 
O.OOOE+OO 
O.lOOE-08 
O.lOOE-07 
O.lOOE-08 
0.200E-08 
0.400E-04 
0.200E-06 
0.200E-06 
0.200E-06 
0.400E-05 
O.lOOE-08 
0.250E-05 
O.OOOE+OO 
O.OOOE+OO 

O.OOOE+OO 
0.200E-04 
O.OOOE+OO 
O.OOOE+OO 
0.600E-01 
O.SOOE-04 
O.lSOE-02 
0.400E-04 
O.lSOE-03 
0.150E-06 
0.400E-07 
O.SOOE-04 
O.SOOE-06 
O.SOOE-06 
0.200E-04 
O.OOOE+OO 
O.OOOE+OO 
0.lOOE-04 
0.400E-05 
0.400E-05 
0.200E-05 
O.OOOE+OO 
0.700E-01 
O.OOOE+OO 
O.OOOE+OO 
O.OOOE+OO 
O.OOOE+OO 
O.OOOE+OO 
O.lOOE-08 
O.lOOE-07 
O.lOOE-08 
0.200E-08 
0.400E-04 
0.150E-06 
0.150E-06 
O.lSOE-06 
0.200E-05 
O.lOOE-08 
0.250E-05 
O.OOOE+OO 
O.OOOE+OO 

O.OOOE+OO 
O.lOOE-04 
O.OOOE+OO 
O.OOOE+OO 
0.700E-01 
O.lSOE-03 
0.150E-02 
0.400E-04 
O.lOOE-03 
0.100E-06 
0.400E-07 
O.SOOE-04 
O.SOOE-06 
O.SOOE-06 
0.200E-04 
O.OOOE+OO 
O.OOOE+OO 
O.lOOE-04 
0.400E-05 
0.400E-05 
0.200E-05 
O.OOOE+OO 
0.650E-01 
O.OOOE+OO 
O.OOOE+OO 
O.OOOE+OO 
O.OOOE+OO 
O.OOOE+OO 
O.lOOE-08 
O.lOOE-07 
O.lOOE-08 
0.200E-08 
0.400E-04 
O.lOOE-06 
O.lOOE-06 
O.lOOE-06 
0.200E-05 
0.100E-08 
0.250E-05 
O.OOOE+OO 
O.OOOE+OO 

Table 13-2. '"'cM.AQ Predefined Vertical Profiles for Boundary Conditions 
. 

. 

-

.~1"g'1Ei-cl2  3.2o7E-02  3.207E-02  3.2o7E-02  3.207E-03 

l..603E-03 
7.696E-01  7.696E-01  7.696E-01  7.696E:..01  7.696E-02  3.848E-02 
4.791E+08 
9.583E+09 
1.370E+07 
2.740E+08 
8.000E-01 
4.000E-02 
1.392E+04  1.392E+04  1.392E+04  1.392E+04  1.392E+03  6.960E+02 

9.583E+09  9.583E+09  9.583E+09  9.583E+08 
2.740E+08  2.740E+08  2.740E+08  2.740E+07 
8.000E-01  8.000E-01  8~000E-01  ~.oo6E~02 

El> A/600/R-99/030 

f'" 

'" 

,

11

98  ~04I' 
99  AS04J 
100  NUMATKN 
101  ~c:c 
102  ASOIL 
103  NU?-~COR 
104  South 

,,,,.  105 
J.06 

1111111111111 

' 

.. ~02 
···  107  SULF 

'1::  116 
117 
118 
Iii  119 

11111111: 

:111111111:,, 

'1::::11111111,, 

,,,  11;,, 

108  N02 
109  NO 
110  03 
111  HN03 
112  :H202 
113  ALD 
114  HCHO 
115  OPl 
OP2 
PAA 
ORAl 
'111111111111 ORJ\2 
NH3 
N205 

120 
121 
122  N03 
123  PAN 
124  HC3 
12s  HCS 
126  HCS 
127  ETH 
128  co 
129  OL2 
130  OLT 
131  OLI 
132  ToL 
lJl  XYL 
11Ac63' 
134 
135  TPAN 
13'  HONO 
137  HN04 
l.3e  KET 
139  GLY 
140  MGLY 
141  DCB 
142  ONIT 
143  CSL 
144  ISO 
145  HO 
146  H02 

:11::11111:''1111'' 

11111'''1' 

11

'11

" 

1111111111°11• 

,,,,,,,111111111· 

' 

,'' 

I 

'" 

., 

;:1111" 11111" 

111·111 

1 111111 

,,,,:1111111111111, 

'''II 

1'"'":111111111 

1il:.,11lll1•,ll11: 

o". OOOE+OO  '  0. OOOE+OO 
O.lOOE-03  O.SOOE~04 
O.OOOE+OO 
O.OOOE+OO 
O.OOOE+OO 
O.OOOE+OO 
0.600E-01 
O.SOOE-01 
O.SOOE-04 
O.SOOE-04 
0.150E-02 
0.200E-02 
0.400E-04 
0.400E-04 
0.200E-03  O.lSOE-03 
0.200E-06  0.150E-06 
0.400E-07  0.400E~07 
o.1.odE-03 
ci.sooE-04 
O.SOOE-06  O.SOOE-06 
O.SOOE-06.  O.SOOE-06 
0.300E-04  0.200E-04 
0. OOOE+oo  ''  0. OOOE+OO 
O.OOOE+OO 
O.OOOE+OO 
O.lOOE-04 
O.lOOE-04 
0.400E-05 
0.400E-05 
0.400E-05 
0.400E-05 
0.200E-05 
0.200E-05 
O.OOOE+OO 
O.OOOE+OO 
0.700E-01 
0.650E-01 
0. o6c5E+oo  ,,,  0. OOOE+OO 
o.ooo:E+oo 
O.OOOE+OO 
O.OOOE+OO 
O.OOOE+OO 
O.OOOE+OO 
O.OOOE+OO 
O.OOOE+OO 
O.OOOE+OO 
O.lOOE-08 
0.100E-08 
0.100E-07 
O.lOOE-07 
0.100E-08 
0.100E-08 
0.200E-08 
0.200E-08 
0.400E-04 
0.400E-04 
o.1sb:E-06 
0.200E-06 

O.OOOE+OO 
O.OOOE+OO 
O.OOOE+OO 
0.200E-03 
0.200E-03 
0.200E-03 
O.lOOE-04  O.OOOE+OO 
O.lOOE-04 
O.lOOE-04  O.OOOE+OO 
0.100E-04 
0.350E-01  0.400E-01 
0.300E-01 
O.SOOE-04  O.SOOE-04 
O.SClOE-04 
,,,,,,,,,,,,,  0 . 2 6 0 E:- 0 2 
0.200E-02  0.200E-02 
0.400E-04 
0.400E-04  0.400E-04 
0.250E-03 
0.2SOE-03 
0.250E-03 
0.2SOE-06 
0.250E-06 
0.2SOE-06 
0.400E-07 
0.400E-07 
0.400E-07 
o .·''fd"'O'E-03 
O.lOOE-03 
O.lOOE-03 
O.SOOE-06 
O.SOOE-06 
0.1SOE-OS 
o.SOOE-06 
O.SOOE-06 
0.150E-05 
0. SCJOE-04 
O.SOOE-04 
O.SOOE-04 
'lllllll11·o11  ·1.  0. 0. OE+o 
O.OOOE+OO 
o.ocioE:+oo 
0 
O.OOOE+OO 
O.OOOE+OO 
O.OOOE+OO 
O.lOOE-04 
O.lOOE-04 
0.100E-04 
0.120E-04 
0.120E-04 
0.120E-04 
0.120E-04 
0.120E-04 
0.120E-04 
0.600E-05 
0.600E-05 
0.600E-05 
O.OOOE+OO 
O.OOOE+OO 
O.OOOE+OO 
0.700E-01 
0.700E-01 
0.700E-01 
O.OOOE+OO 
O.OOOE+OO 
O.OOOE+OO 
O.OOOE+OO 
O.OOOE+OO 
O.OOOE+OO 
O.OOOE+OO 
O.OOOE+OO 
O.OOOE+OO 
O.OOOE+OO 
O.OOOE+OO  O.OOOE+OO 
O.OOOE+OO  O.OOOE+OO 
O.OOOE+OO 
0.100E-08 
'(). lOOE-08  0. lOOE-08 
0.lOOE-07 
0.100E-07  0.100E-07 
0.100E-08 
0.100E-08  O.lOOE-08 
0.200E-08 
0.200E-08  0.200E-08 
0.400E-04 
0.400E-04 
o:2soE-o6 
0.250E-OG 

O.OOOE+OO 
0.200E-04 
O.OOOE+OO 
O.OOOE+OO 
0.700E-01 
0.150E-03 
0.100E-02 
O.SOOE-05 
O.lOOE-03 
O.lOOE-06 
O.SOOE-08 
O.SOOE-04 
O.SOOE-06 
O.SOOE-06 
0.200E-04 
O.OOOE+OO 
O.OOOE+OO 
O.lOOE-04 
0.400E-05 
0.400E-05 
0.200E-05 
O.OOOE+OO 
O.SSOE-01 
O.OOOE+OO 
O.OOOE+OO 
O.OOOE+OO 
O.OOOE+OO 
O.OOOE+OO 
0.100E-08 
O.lOOE-07 
O.lOOE-08 
0.200E-08 
·o.400E-04 
O.SOOE-05 
0.2SOE-06 
0.100E-06 
0.250E-06  0.250E-06  0.250E-06  0.200E-06  O.lSOE-06  0.100E-06 
0.250E-06  0.250E-06  0.2SOE-06  0.200E-06  0.150E-06  O.lOOE-06 
0.600E-05  0.600E-05  0.600E-05  0.200E-05  0.200E-05  0.200E-05 
0.100E-08  0.100E-08  O.lOOE-08  O.lOOE-08  0.100E-08  O.lOOE-08 
0.2SOE-05  0.250E-05  0.250E-05  0.250E-05  0.250E-05  0.250E-05 
O.OOOE+OO  O.OOOE+OO  O.OOOE+OO  O.OOOE+OO  O.OOOE+OO  O.OOOE+OO 
O.OOOE+OO  O.OOOE+OO  O.OOOE+OO  O.OOOE+OO  O.OOOE+OO  O.OOOE+OO 

'11111'"""111111' 

:1:·.11111· 

'11111111111111111' 

1' 

1111 

,11111111 

Table 13-2.  CMAQ Predefined Vertical Profiles for Boundary Conditions 

147  AS04I 
148  AS04J 
149  NUMATKN 
150  NUMACC 
151  ASOIL 
152  NUMCOR 
153  West 

3.207E-02 
7.696E-01 
9.583E+09 
2.740E+08 
8.000E-01 
1.400E+04 

3.207E-02 
7.696E-01 
9.583E+09 
2.740E+08 
8.000E-01 
1.400E+04 

3.207E-02 
7.696E-01 
9.583E+09 
2.740E+08 
8.000E-01 
1.400E+04 

1.603E-02 
3.848E-01 
4.791E+09 
1.370E+08 
4.000E-01 
7.000E+03 

3.207E-03 
7.696E-02 
9.583E+08 
2.740E+07 
8.000E-02 
1.400E+03 

1. 603E-03 
3.848E-02 
4.791E+08 
1.370E+07 
4.000E-02 
7.000E+02 

154 
155  S02 
156  SULF 
157  N02 
158  NO 
159  03 
160  HN03 
161  H202 
162  ALD 
163  HCHO 
164  OP1 
165  OP2 
166  PAA 
167  ORA1 
168  ORA2 
169  NH3 
170  N205 
171  N03 
172  PAN 
173  HC3 
174  HC5 
175  HC8 
176  ETH 
177  co 
178  OL2 
179  OLT 
180  OLI 
181  TOL 
182  XYL 
183  AC03 
184  TPAN 
185  HONO 
186  HN04 
187  KET 
188  GLY 
189  MGLY 
190  DCB 
191  ONIT 
192  CSL 
193  ISO 
194  HO 
195  H02 

0.200E-03 
0.200E-03 
0.100E-03 
0.500E-04 
0.400E-Ol 
O.SOOE-03 
0.200E-02 
0.400E-04 
0.400E-03 
0.400E-06 
0.400E-07 
0.250E-04 
0.250E-05 
0.250E-05 
0.300E-03 
O.OOOE+OO 
O.OOOE+OO 
O.lOOE-03 
0.800E-04 
0.800E-04 
0.400E-04 
O.OOOE+OO 
0.800E-01 
0.100E-04 
O.lOOE-05 
0.200E-06 
O.SOOE-05 
0.200E-05 
0.100E-08 

O.OOOE+OO 
O.OOOE+OO 
O.OOOE+OO 
O.OOOE+OO 
0.600E-01 
0.200E-03 
0.800E-03 
0.400E-04 
0.100E-03 
0.100E-06 
0.400E-07 
0.200E-04 
0.500E-06 
0.500E-06 
O.lOOE-03 
O.OOOE+OO 
O.OOOE+OO 
0.100E-04 
0.800E-05 
0.800E-05 
0.400E-05 
O.OOOE+OO 
0.650E-01 
0.100E-05 
O.OOOE+OO 
O.OOOE+OO 
O.OOOE+OO 
O.OOOE+OO 
0.100E-08 

O.OOOE+OO 
0.300E-03 
O.OOOE+OO 
0.300E-03 
O.OOOE+OO 
0.100E-03 
O.OOOE+OO 
0.500E-04 
0.700E-01 
0.350E-01 
0.100E-03 
0.500E-03 
0.200E-03 
0.200E-02 
O.SOOE-05 
0.400E-04 
0.500E-04 
0.400E-03 
0.500E-07 
0.400E-06 
0.500E-08 
0.400E-07 
0.100E-04 
0.250E-04 
0.500E-06 
0.250E-05 
0.500E-06 
0.250E-05 
0.500E-04 
0.300E-03 
O.OOOE+OO 
O.OOOE+OO 
O.OOOE+OO 
O.OOOE+OO 
0.100E-04 
0.100E-03 
0.400E-05 
0.800E-04 
0.400E-05 
0.800E-04 
0.200E-05 
0.400E-04 
O.OOOE+OO 
O.OOOE+OO 
O.SOOE-01 
0.800E-01 
O.OOOE+OO 
0.100E-04 
O.OOOE+OO 
0.200E-05 
O.OOOE+OO 
O.lOOE-05 
O.OOOE+OO 
0.100E-04 
O.OOOE+OO 
0.300E-05 
0 .100E-08. 
O.lOOE-08 
0.100E-07  0.100E-07  0.100E-07  O.lOOE-07  0.100E-07  0.100E-07 
0.100E-08 
0.100E-08 
0.200E-08 
0.200E-08 
0.500E-05 
0.400E-04 
0.500E-07 
0.400E-06 
0.500E-07 
0.400E-06 
0.500E-07 
0.400E-06 
0.200E-05 
0.400E-04 
0.100E-08 
0.100E-08 
0.250E-05 
0.250E-05 
O.OOOE+OO 
O.OOOE+OO 
O.OOOE+OO 
O.OOOE+OO 

0.200E-03 
0.200E-03 
0.100E-03 
0.500E-04 
0.450E-01 
0.500E-03 
0.200E-02 
0.400E-04 
0.400E-03 
0.400E-06 
0.400E-07 
0.250E-04 
0.250E-05 
0.250E-05 
0.300E-03 
O.OOOE+OO 
O.OOOE+OO 
0.100E-03 
0.800E-04 
0.800E-04 
0.400E-04 
O.OOOE+OO 
0.800E-01 
0.500E-05 
0.500E-06 
0.100E-06 
0.500E-05 
0.400E-06 
O.lOOE-08 

0.100E-08 
0.200E-08 
0.400E-04 
0.400E-06 
0.400E-06 
0.400E-06 
0.400E-04 
O.lOOE-08 
0.250E-05 
O.OOOE+OO 
O.OOOE+OO 

0.100E-03 
0.100E-03 
0.500E-04 
0.200E-04 
O.SOOE-01 
O.SOOE-03 
0.200E-02 
0.400E-04 
0.400E-03 
0.400E-06 
0.400E-07 
0.250E-04 
0.250E-05 
0.250E-05 
0.200E-03 
O.OOOE+OO 
O.OOOE+OO 
O.SOOE-04 
0.600E-04 
0.600E-04 
0.300E-04 
O.OOOE+OO 
0.800E-01 
O.SOOE-05 
0.300E-06 
O.OOOE+OO 
0.300E-05 
0.400E-06 
0.100E-08 

0.100E-08 
0.200E-08 
0.400E-04 
0.400E-06 
0.400E-06 
0.400E-06 
0.300E-04 
0.100E-08 
0.250E-05 
O.OOOE+OO 
O.OOOE+OO 

0.100E-08 
0.200E-08 
0.400E-04 
0.400E-06 
0.400E-06 
0.400E-06 
0.400E-04 
0.100E-08 
0.250E-05 
O.OOOE+OO 
O.OOOE+OO 

13-19 

0.100E-08 
0.200E-08 
0.400E-04 
0.100E-06 
0.100E-06 
0.100E-06 
0.400E-05 
0.100E-08 
0.250E-05 
O.OOOE+OO 
O.OOOE+OO 

I : 1 I ! ! ! ~ : : 

'11111111 

"'111 

1
111;;,,, 

1 

1111111111

Table 13-2.  CMAQ Predefined Vertical Profiles for Boundary Conditions 

I' 

"I 

11111111111" 

1!16  AS04I 
197  AS04J 
198  NUMATKN 
199  NUMA CC 
200  ASOIL 
201  NUMCOR 

,, 

,,,,I',, 

1,,,,1 

I 

' , " i ' " " i 1 I " ~ I 

11
,, I 

11

~ 111111111 

1.603E-03 
4.SlOE-02  3.207E-02  3.207E-02 
1.154E+OO  7.696E-01  7.696E-01  3.848E-01  7.696E-02  3.848E-02 
1.437E+10  9.583E+09  9.583E+09  4.791E+09  9.583E+08  4.791E+08 
4.110E+08  2.740E+08  2.740E+08 
l.370E+08  2.740E+07  1. 370E+07 
1.000E+OO  8.000E-01  8.000E-01  4.000E-01  8.000E-02  4.000E-02 
1. 7SOE+04  1.400E+04 
l.400E+04  7.000E+03  1.400E+03  7.000E+02 

J.207E-03 

1.'E5oJE.:'.b:2 

11 

111

!11111

111, 

,1:.11111!1 

1
1111' 

1111111111: 

11111.1,1,1,h, 

'11111111 

11111 
, ... 11 

!ii',, 

,111.1 

Table 13-3.  Example RADM2 to CB4 Conversion Rules 

EPA/600/R-991030 

= 

= 

= 

N02 
NO 
0 
03 
N03 
OlD 
OH 
H02 
N205 
HN03 
HONO  = 
PNA 
H202  = 
co 
S02 
SULF 
PAN 
FACD 
AACD 
PACD 
UMHP 
MGLY  = 
OPEN  = 
CRES  = 
FORM  = 
ALD2 
PAR 

= 

OLE 
TOL 
ISOP 
ETH 
XYL 
TERP 

END; 

i 

N02 
NO 
i 
03P; 
03 
i 
N03; 
OlD; 
HO 
; 
H02 
; 
N205; 
HN03; 
HONO; 
HN04; 
H202; 
CO; 
S02; 
SULF; 
PAN; 
ORAl; 
ORA2; 
PAA; 
OPl; 
MGLY; 
DCB; 
CSL; 
HCHO  +  1. 0  *  GLY; 
+  2.0  *  OLI; 
+  2.9  *  HC3 
+ 
+  0.8  *  OLT  +  0.8  *  OLI  + 

+  4.8  *  HCS 

1.0  *  ALD 
0.4  *  ETH 
7.9  *  HC8 
3.9  *  KET; 
OLT; 
TOL; 
ISO; 
OL2; 
XYL; 
TERP; 

Chapter 14
================

PHOTOLYSIS RA TES FOR CMAQ 

Shawn J. Roselle," Kenneth L. Schere,"* and Jonathan E. Pleim ·· 

Atmospheric Modeling Division 

National Exposure Research Laboratory 
U.S. Environmental Protection Agency 

Research Triangle Park, North Carolina 27711 

Adel F. Hanna 

MCNC-North Carolina Supercomputing Center 
Research Triangle Park, North Carolina 27709 

ABSTRACT 

The method for calculating photodissociation reaction rates (photolysis rates) for CMAQ is 
described in this chapter.  The description includes the photolysis rate preprocessor (JPROC) and 
CMAQ subroutine PHOT.  JPROC produces a clear-sky photolysis rate look-up table.  The 
look-up table consists of photolysis rates at various altitudes, latitudes, and hour angles.  The 
look-up table is recalculated for each simulation day and is dependent upon the chemical 
mechanism.  Within CMAQ, photolysis rates for individual grid cells are interpolated from the 
look-up table in subroutine PHOT.  PHOT also uses a parameterization to correct the clear-sky 
photolysis rates for cloud cover. 

·on assignment from  the National Oceanic and Atmospheric Administration, U.S. Department of Commerce. 
Corresponding author address:  Shawn Roselle,  MD-80, Research Triangle Park, NC 27711. E-mail: 
sjr@hpcc.epa.gov  . 

.. On assignment from  the National Oceanic and Atmospheric Administration, U.S. Department of Commerce. 


14.0  PHOTOLYSIS RATES FOR CMAQ 

,, 

'lllllllllllllh 

14!1  Background 

Many chemical reactions in the atmosphere are initiated by the photodissociation of numerous 
tn,J,.~e gases.  These photodissociative reactions are responsible for most of the smog buildup 
detrimental to humans, animals, plant life and materials.  In order to accurately model and predict 
the effects of air pollution, good photodissociation reaction rate (or photolysis rate) estimates 
must be made. 

Photodissociation is the conversion of solar radiation into chemical energy to activate and 
dissociate chemical species.  Examples of species that photodissociate include many important 
trace constituentsof the troposphere such as N02,  0 3,  HCHO, CH3CHO, HONO, the N03 
radical, and I-1;02 (8.lso see Table 14.1).  The simulation accuracy of the entire chemical system is 
highly dependent upon the accuracy of photolysis rates, which are the primary sources of radicals 
i11111111~~ !f9posp~ere.  Photolysis rates (min-1), sometimes called J-values, are computed for 
photodissociation reaction (i) by 

Ai 

J;  = f F(A.)ap.)<f>,(A.)dA. 

A.1 

(14-1) 

11111111111111• 

,,11111'"'1111 

,., 

,, 

' 

,, 

"' 

"' 

), al.Ii.) the absorption cross section for the 
), <Ml..)  the quantum yield of the 

where, F(A.) is the actinic flux (photons cm·2  min· 1 nm· 1
molecule undergoing photodissociation (cm2  molecu1e- 1
), and I..  the wavelength (nm).  Absorption cross sections 
photolysis reaction (molecules photon- 1
and quantum yields are functions of wavelength, and may also be functions of temperature and 
pressure~ they are unique to species and reactions.  Laboratory experiments measuring the 
absorption cross sections and quantum yields. have been conducted for many species that 
photodissociate in the troposphere.  Actinic flux is a radiometric quantity that measures the 
spectral radiance integrated over all solid angles per unit area.  The spherical receiving surface 
distinguishes the actinic flux from the more commonly measured irradiance, which is the radiance 
falling on a horizontal surface.  Thus, the actinic flux can be called spherical spectral irradiance. 
The actinic flux changes with time of day, longitude, latitude, altitude, and season, and is 
governed by the astronomical and geometrical relationships between the sun and the earth.  It is 
greatly affected by the earth's surface albedo as well as by various atmospheric scatterers and 
absorbers.  Hence, correct model calculation of the temporal and spatial variation of the actinic 
flux is critical to obtaining accurate photolysis rates for regional and mesoscale episodic 
photochemical modeling. 

The current approach taken for setting photolysis rates in the Models-3/CMAQ framework 
follows that of the Regional Acid Deposition Model (RADM) (Chang et al., 1987).  It includes 
two stages of processing: (1) a table of clear-sky photolysis rates is calculated for specified 
heights, latitudes, and hours from  local noon; and (2) photolysis rates are interpolated from the 
table within the CMAQ Chemistry Transport Model (CCTM) based on grid cell location and the 
model time, and are corrected for cloud cover.· This approach is computationally efficient and has 
been shown by Madronich (1987) to give clear-sky photolysis rates within the uncertainty of the 
surface-based measurements. 

14.2  Preprocessor JPROC: Calculate Clear-sky Photolysis Rate Table 

Preprocessor JPROC calculates a table of clear-sky photolysis rates (or J-values) for a specific 
date.  The table is dimensioned by latitude, altitude, and time.  Currently, J-values are calculated 
for 6 latitudinal bands (l0°N, 20°N, 30°N, 40°N, 50°N, and 60°N), 7 altitudes (0 km,  1 km, 2 
km, 3 km, 4 km, 5 km, and  10 km), and ±9 hours from local noon (0 h,  1 h, 2 h, 3 h, 4 h, 5 h, 6 h, 
7 h,  and 8 h).  There is a separate table for each photolysis reaction.  In order to compute the 
photolysis rates using Equation 14.1, the actinic flux, absorption cross section, and quantum yield 
must be determined as a function of wavelength. 

The delta-Eddington two-stream radiative transfer model (Joseph et al.,  1976; Toon et al.,  1989) 
is used for computing the actinic flux.  The two-stream approximations are limited in application 
to cases where the scatter is  not highly anisotropic.  In computing the actinic flux, a description of 
the extraterrestrial radiation, aerosol, ozone absorption, oxygen absorption in the 
Schumann-Runge Bands, Rayleigh scattering (WMO,  1985) and surface albedo are provided to 
the radiation model. 

Extraterrestrial radiation is specified by a user input file.  JPROC is flexible enough to use any 
extraterrestrial radiation data distribution specified by the user.  However, the wavelength 
distribution of the extraterrestrial radiation data is important because this is also the distribution 
that will be used in the integration of Equation 14.1.  Therefore, the user should choose a 
wavelength distribution that resolves the features that are important to the photolysis reactions of 
interest.  A modified WMO extraterrestrial radiation data distribution (Chang, et al.,  1990) is used 
as input to JPROC, which has a variable wavelength resolution ranging from  1 nm to  10 nm. 

The 0 2 and 0 3  absorption cross section data are specified by user input files, but it is 
recommended that the most recent NASA data (DeMore et al.,  1994) be used in the calculations. 
Vertical ozone profiles are set by interpolating seasonal profiles from a user input file, and if total 
ozone column data are available (such as data measured by the Total Ozone Mapping 
Spectrometer (TOMS) instrument aboard the sun-synchronous polar orbiting Nimbus satellite), 
then the interpolated vertical profiles are uniformly rescaled so that the profiles integrated total 
ozone column value matches the measured total ozone column data.  TOMS data are archived 
and available at the National Satellite Service Data Center (NSSDC) in the form of digital daily 
maps with a resolution of 1 degree latitude by  1.25 degrees longitude.  The TOMS data are 
averaged over each latitudinal band in JPROC.  Nimbus-7 TOMS data are available for years 
1978 through 1993; Meteor-3 TOMS dataare available for  1991-1994; ADEOS TOMS dataare 
available for  1996-1997; and Earth Probe TOMS data are available for  1996-1998.  These data 
can be downloaded from site http://jwocky.gsfc.nasa.gov. 

The albedo data given by Demerjian et al.  ( 1980), which have been used extensively in radiative 
transfer models, are given as a function of wavelength and are used in the current version of 
JPROC.  Currently, a single vertical profile of aerosol attenuation coefficients (Elterman,  1968) is 
used in JPROC.  An effort is underway to  incorporate predicted aerosol parameters from CMAQ 
i~'i'o the photoiysi's'rate calculations. 

· 

···· 

···· 

111'"' 

l!::::,,11111. 

llllli111l1111 

·! 

"" 

" 

,, 

.,,  r  ·' 

";;;::111111;:!: 

·11111::1111111111:" 

,,, 

. 

.,. 

. 

... ,, 

,,111111, .. :111:" 

~::· 

1
·
;,,,:::::

1111111111

'' 

'" 

•1"::111 

::,,,t:11111: 

" 

' 

' 

'" 

.: 

" 

" 

' 

"' 

Several factors in JPROC depend on the vertical profiles of temperature and pressure, including 
ozone absorption and the absorption cross sections and quantum yields for individual photolysis 
reactions.  JPROC interpolates seasonal profiles of temperature and pressure.  We use the same 
vertical profile data that are used in the RADM (Chang et al.,  1987). 

,,. 

''"  · 

"· 

',,,1'' 

,,,,,. 

·, 

, 

11111 

1: 

. 

, 

1
"' 

1111 

' 

111111' 

"·111!!!1:::' 

11,,,11111 

''I 

,,I 

' 

Absorption cross section and quantum yield data are specified by the user through input files. 
Input files depend on the chemical mechanism selected by the user in the Program Control 

...  Prnc~ssor (see Chapter 15).  The original sets of cross section/quantum yield data published with 

the CarbQn Bond Mechanism IV (Gery et al.,  1989), the Regional Acid Deposition Model 
mechanism version 2 (RADM2) (Stockwell et al.,  1990), and the SAPRC mechanism (Carter, 
1990) are available for use in JPROC.  However, users can deviate from these standard sets to 
test other data, including the revisions suggested by NASA (DeMore et al.,  1994).  Table  14.1 
lists the photolysis reactions for the RADM2 mechanism. 

14.3  Subroutine PHOT: Table Interpolation and Cloud Attenuation 

shbroutine PHOT within the CCTM has two basic functions,  including intel1Jolation of the clear(cid:173)
sky photolysis rate table and application of a cloud correction factor to the clear-sky values.  The 
interpofation step is fairly simple.  For each grid cell, the latitude, height, and time from local noon 
are determined and used to interpolate clear-sky values from the photolysis rate table.  The cloud 
co'rrcction step is a little more complicated.  The method used to correct for cloud cover in PHOT 
was taken from RADM (Chang et al.,  1987; Madronich,  1987).  The correction of clear-sky 
values depends on whether the location is below, above, or within the cloud.  The below cloud 
photolysis rate ( J bdow)  is calculated as: 

where cfrac is the cloud coverage fraction (cloud fraction is interpolated from hourly data for 
each grid cell), 8  is the zenith angle, and tr is the cloud transmissivity.  Below cloud photolysis 
rates will be lower than the clear-sky values due to the reduced transmission of radiation through 
the cloud.  The cloud transmissivity is calculated by: 

(14-2) 

(14-3) 

where/is the scattering phase function asymmetry factor (assumed to be 0.86) and 'tc1d  is the 
cloud optical depth.  We have replaced the cloud optical depth equation in RADM with one taken 
from Stephens (1978).  The original RADM equation for  't'cid  required an estimate of the cloud 
droplet radius, which is not readily available.  In RADM, the cloud droplet radius was assumed to 
be I Oµm.  The empirical formula for 't'cid  from Stephens ( 1978): 

log('rc1)  = 0.2633 + l.7095 In[ log( W)] 

(14-4) 

is only a function of liquid water path (W), where W=L.6.z (g/m2
(g/m3

), and .6.z is the cloud thickness.  The above cloud top factor (F J is calculated as: 

), L is the liquid water content 

· 

(14-5) 

This equation allows for enhancement of photolysis rates above the cloud due to the reflected 
radiation from the cloud.  It also includes a reaction dependent coefficient ( aJ which allows for 
further above cloud enhancements (Chang et al., 1987).  Within the cloud, the cloud correction 
factor is a simple linear interpolation of the below cloud factor at cloud base to the above cloud 
factor at cloud top.  Once computed, the below, above, and within cloud factor are used to scale 
the clear sky photolysis rates to account for the presence of clouds.  In the current 
implementation, all cloud types (including clouds composed of ice crystals) are treated the same 
using the above outlined procedure. 

14.4  Summary 

The current method for calculating photolysis rates in CMAQ, which was derived from RADM, 
uses a preprocessor to compute a look-up table and a subroutine within the chemistry transport 
model to interpolate J-values and apply a cloud-cover correction.  Other approaches and 
enhancements are being developed and tested.  One enhancement to be added in the future is the 
dynamic link between aerosol predictions and photolysis rate calculations.  Another is to replace 
the two-stream model with a more comprehensive multi-stream radiative transfer model (Stamnes 
et al.,  1988).  Other absorption cross section and quantum yield data will be added or updated 
using the DeMore et al.  (1997) revisions. 

14.5  References 

Carter, W.P .L., 1990: A detailed mechanism for the gas-phase atmospheric reactions of organic 
compounds, Atmos.  Environ., 24(A), 481-518. 

Chang, J.S., R.A. Brost, LS.A. Isaksen, S.  Madronich, P.  Middleton, W.R. Stockwell, and C.J. 
Walcek, 1987: A three-dimensional eulerian acid deposition model:  physical concepts and 
formulation, J.. Geophys.  Res.  92 (Dl2):  14681-14 700. 

11

' 

1111!

,. 

"•11,:iiiif 

::111 

., 

' ' •  

111

!111!!

" 

1
1' 

'

w·:·;11,,,1llli:"1!ll 

"11111111111' 

"!11'1 

Chang, J.S., P.B. Middleton, W.R. Stockwell, C.J.  Walcek, J.E. Pleim, H.H. Lansford, F.S. 
Biiikowski, S. Madronich, N.L. Seaman, D.R. Stauffer, D.  Byun, J.N.  McHenry, P.J.  Samson, H. 
Hass,  1990: The regional acid deposition model and engineering model, Acidic Deposition: State 
o(Scicnce and ...  Tectmology,  Report 4, National Acid Precipitation Assessment Program. 

, 

• 

111111111 

, 

!iii1:1111lll 

.;;;1""1: 

'"il'''l;!!!i11, 

I 

Demerjian, K.L., K.L. Schere, J.T. Peterson,  1980: Theoretical estimates of actinic (spherically 
int'egrated) flux and photolytic rate constants of atmospheric species in the lower troposphere. 
Advances in Environmental Science and Technology, Vol.  10, by John Wiley &  Sons, Inc., 
369-459. 

. 

,' 
1

'' 

1111 

,.,: 

I 

DeMore, W.B., S.P. Sander, D.M. Golden, R.F.  Hampson, M.J.  Kurylo, C.J.  Howard, A.R. 
Ravishankara, C.E. Kolb, and M.J. Molina, 1994: Chemical Kinetics and Photochemical Data for 
Use in Stratospheric Modeling: Evaluation Number 11, JPL Pub. 94-26. Pasadena, CA:  National 
Aeronautics and Space Administration, Jet Propulsion Laboratory. 

:li1111111: 

1111, 
:: 
11

,, 

.,:·1':;,.,:;1. 
ll"'i, 
,,·:1;, 

·'' 
'.111, 
':1111 

. 

D~More, W.B:,,~, 87~. Sander, D.M. Golden, R.F. Hampson, M.J. Kurylo, C.J. Howard, A.R. 
Ravishankara, C.E. Kolb, and M.J. Molina,  1997: Chemical Kinetics and Photochemical Data for 
Use in Stratospheric Modeling: Evaluation Number 12, JPL Pub. 97-4. Pasadena, CA:  National 
Aeronautics and Space Administration, Jet Propulsion Laboratory. 

Elterman, L,  1968: UV, Visible, and IR Attenuation for Altitudes to 50 km; AFCRL-68-0153. 
Bedford, MA: Air Force Cambridge Res. Lab. 

Gery, M.W., G.Z. Whitten, J.P. Killus, M.C. Dodge, 1989:  A photochemical mechanism for 
urban and regional scale computer modeling, J.  Geophys.  Res., 94,  12925-12956. 

Joseph, J.H., W.J. Wiscombe, and J.A. Weinman,  1976: The delta-Eddington approximation for 
radiative flux transfer, J.  Atmos. Sci., 33, 2452-2459. 

Mndronich, S,  1987: Photodissociation in the Atmosphere:  1.  Actinic flux and the effects of 
ground reflections and clouds, J.  Geophys.  Res.  92 (08): 9740-9752. 

Stamnes, K., S. Tsay, W.  Wiscombe, and K.  Jayaweera,  1988: Nwnerically stable algorithm for 
discrete-ordinate-method radiative transfer in multiple scattering and emitting layered media, 
Appl.  Opt., 27, 2502-2509. 

Stephens, G.L.,  1978: Radiation profiles in extended water clouds. II.:  Parameterization schemes, 
J.  Atmos. Sci.  35:'2123-2132. 

Stockwell, W.R., P.  Middleton, and J.S. Chang,  1990: The second generation regional acid 
deposition model chemical mechanism for regional air quality modeling, J.  Geophys.  Res.  95 
(DlO):  16343-16367. 

Toon, O.B., C.P. Mckay, and T.P. Ackerman, 1989: Rapid calculation ofradiative heating rates 
and photodissociation rates in inhomogeneous multiple scattering atmospheres, J.  Geophys.  Res., 
94,  16287-16301. 

World Meteorological Organization,  1986:  "Atmospheric Ozone 1985:  Assessment of Our 
Understanding of the Processes Controlling its Present Distribution and Change"; WMO Rep. No. 
16; Global Ozone Research and Monitoring Project, Geneva, Switzerland. 

Table 14-1.  RADM2 Photolysis Reactions (Adapted from Stockwell et al.,  1990.) 

' 

" 

""'1'"11''11111'' 

Description 
Ozone Photolysis to 0 1D 
Ozone Photolysis to 0 3P 
Nitrogen Dioxide Photolysis 
Nitrate Photolysis to NO 
Nitrate Photolysis to N02 
Nitrous Acid Photolysis 
Nitric Acid Photolysis 
Pernitric Acid Photolysis 
Hydrogen Peroxide Photolysis 
Formaldehyde Photolysis to Radicals 
Formaldehyde Photolysis to Molecular 
Hydrogen 
Acetaidehyde Photolysis 
Acetone Photolysis 
Methyl Ethyl Ketone Photolysis 
Glyoxal Photolysis to Formaldehyde 
Glyox~ Ph~'tolysis to Molecular 
Hydrogen 
Methyl Glyoxal Photolysis 
Unsaturated Dicarbonyl Photolysis 

Methyl Hydrogen Peroxide Photolysis 
Organic Nitrate Photolysis 
Acrolein Photolysis 

Reaction 

-

t 

• 

........... 

0 3 +hv  - 0 2 +0 1D 
0 3 +hv  - 0 2 +03P 
3 
.... 
N02 +hv  -NO+O P 
N03 + hv  ....  NO + 0 2 
'Nbl + hv  - N02 + 0 3P 
HONO+hv  :.;.  OH+NO 
H;N03 + hv  - OH+ N02 
HN04  + hv  ....  H02 + N02 
H20 2 +hv  - OH+OH 
HCHO+hv  -H+HCO 

~~ 

r 

HCHO+hv  -H2 +CO 
CH3CHO + hv (+202)  - CH300 + H02 +CO 
CH3COCH3 +"hv  '...  CH3 + CH3CO 
CH3COC2Hs + hv  ....  AC03 + ETH 
I-icocHo + fiv  .:.  HcHo +co 
HCOCHO + hv  - 2CO + H2 

:·· 

..•. 

111.. 

"" 

. •. 

1': 

CH3COCHO + hv  - AC03 + H02 +CO 
HCOCH=CHCHO + hv  - 0.98H02 + TC03 + 
0.02AC03 
CH300H + hv  - CH20  + OH+ H02 
CH30N02 + hv  - 0.2ALD + 0.8KET + H02 + N02 
C,H,O + hv - products 


Chapter 15 
===================

PROGRAM CONTROL PROCESSING IN MODELS-3 

EPA/600/R-991030 

Jeffrey Young' 

Atmospheric Modeling Division 

National Exposure Research Laboratory 
U.S.  Environmental Protection Agency 

Research Triangle Park, NC 2771  l 

ABSTRACT 

Based on user choices and input, the Models-3  framework creates objects and include files that 
control the complete problem domain under which a CMAQ model is built and executed.  The 
general concepts underlying the definition of these objects and the creation of the include files 
are discussed. 

'On assignment from  the National Oceanic and Atmospheric Administration, U.S.  Department of Commerce. 
Corresponding author address: Jeffrey Young, MD-80, Research Triangle Park, NC 27711.  E-mail: 
yoj@hpcc.epa.gov 

1
'111 
1

'1111111 

EPA/600/R-99/030 

'llllllluill, 

...  is':o 

i>11oGR.AM coN'TRoL PRocEssING IN Mon'ELs-3 , 

,;:1111111111 

"I 

"111 

Program control processing (PCP) refers to setting up internal arrays and mappings, global 
parameters, and data linkages to establish the complete problem domain in which the programs, 
of "models," in the Community Multiscale Air Quality (CMAQ) system are built and executed. 
Controlled by user choices, the Models-3 framework carries out this processing automatically 
ai;!,~ ~rovides the ~~y to modu!~ity and ensures uniform, consistent internal dimensioning, 
looping parameters and solver data in the compiled codes for all the CMAQ system models. 
Thus, modularity and consistency in establishing the computational domain and chemical 
mechanism for any particular application of the CMAQ system are assured by PCP. Modelers 
can easily and relatively safely carry out many different applications at different scales, or with 
different chemistry, or different solvers.  Model developers can readily study the effects of 
different schemes and determine optimal implementations of the science and codes.  PCP helps 
to establish a true "one-atmosphere" approach to modeling. 

"""""""""'" 

1111111111,,," 

'"' 

PCP involves both the Models-3 framework's graphical user interface and specialized processors 
that are launched from the framework.  In the Models-3  framework, a user selects the 
computational grid and domain characteristics, the vertical layer structure, and the chemical 
mechanism to be used in building (compiling and linking) a model (an executable).  How these 
choices get transformed automatically into compiled code is discussed in the following sections. 
This chapter focuses on the CMAQ Chemical Transport Model (CCTM) since the CCTM 
requires the most extensive use of PCP.  However, some or all of the user choices made to set up 
a particular CCTM determine the particular application characteristics for all of the supporting 
processors (or "models").  In addition to the CCTM, CMAQ is comprised of eight additional 
processors as follows: 

• 

• 

• 

• 

• 

• 

• 

• 

The Models-3 emissions processing and projection system (MEPPS), described in 
Chapter (  ···· 

· 

The emissigns-ch~mistry interface processor (ECIP), described in Chapter 4. 

The pfiJme:in-gricfdynarriics processor (PDM), described in Chapter 9. 

the meteorology-chemistry input processor (MCIP), described in Chapter 12. 

The land-use processor (LUPROC), described in Chapter 12. 

The initial and boundary conditions processors (ICON and BCON), described in Chapter 
13. 

The photolytic J-value processor (JPROC), described in Chapter 14. 

The process analysis processor (PROCAN), described in Chapter 16.  PROCAN is 
launched by the Models-3 framework and its execution is transparent to the user.  The 
outputs from PROCAN are used to control CCTM diagnostic outputs (see Section 15.3.1 
below). 

Building a particular model in the Models-3/CMAQ system requires the creation·of Fortran 
include files that populate the model's codes to set the specific computational grid and domain 
characteristics, the vertical layer structure, the chemical mechanism, and (for the CCTM) the 
process analysis to be used for the particular model.  Once these model configuration objects are 
set by the user in the Models-3  Science Manager, the Models-3  framework automatically 
generates the required global Fortran include files.  The use of global Fortran include files,  the 
notion of "Global Name Table Data," and the design concepts that govern _this  implementation 
are discussed in Chapter 18, Sections 18.5 and  18.7. 

15.1  Domain Configuration 

The computational domain configuration data are contained in three include files: 

• 

• 

• 

HG RD.EXT - The horizontal grid dimensions in terms of the number of grid cell columns 
and rows and the number of grid cells for which the computational domain boundary is 
extended for boundary data.  The number of these perimeter boundary cells is also 
specified. 
VGRD.EXT - The vertical layer dimensions as the number of vertical layers.  This 
include file also contains declarations for the layer surface and layer center arrays. 

COORD.EXT-The domain coordinate data: 

The map projection type (Lambert, Mercator, Stereographic, UTM, or latitude(cid:173)
longitudc ). 
The map projection parameters. 
The center of the grid's coordinate system with respect to the "mother grid" or 
parent grid (usually the main grid from the meteorology pre-processing). 
The horizontal grid cell sizes in meters. 
The vertical layer type.  There are 7 currently defined: 

crpco>  coordinates. 

1.  crP  coordinates. 
2. 
3.  crz coordinates. 
4. 
llp coordinates. 
5.  Pressure coordinates. 
6.  Z coordinates (meters above ground). 
7.  H coordinates (meters above mean sea level). 

The units of the top vertical layer value. 
The value of the top vertical layer variable. 
The units of the vertical layer surface values. 
The list of vertical layer surface values. 
The list of vertical layer surface values converted to  values monotonically. 
increasing with altitude. 
The grid name used for header description data in I/O API files (discussed in 
Section 15 .2). 


15.2 

Input/Output Applications Programming Interface 

Input and output data access for the CMAQ system is accomplished mainly through the 
Input/Output Applications Programmer's Interface (I/O API) sub-system [1].  The CMAQ system 
implementation of the I/O API is described in Chapter 18, Section 18.3.  In order to access 1/0 
A~rfilcs arid l!.~.~ otherI/O ~I ~ctions, iti~ necessary to specify the required declarations and 
parameters.  Some or all of the following include files are needed in each subroutine that uses the 
I/O API: 

~ 

:;, ... 11111ii1 

.••• 

' 

' 

' '  

•'' 

' 

11r 

1,, 

• 

• 

• 

• 

PARMS3.EXT - I/O API dimensioning parameters, file type and file characteristic 
parameters, coordinate system and map projection parameters, and vertical layer 
parameters. 

' 

.. 

,,, 

' 
'!iiill 

FDESC3.EXT- Fortran common blocks that contain a complete 1/0 API file description. 
The d~ .. !.~. in these comrn<?n. blocks are loaded from an I/OApl file whenopened and read. 
These data must be supplied from the user subroutine when an I/O API  file is opened for 
writing. 

IODECL3.EXT- Declal,'.ations and usage comments for I/O API functions and routines. 

II' 

11111111'11 

'II 

11111" 

• 

'II 

I• 

I 

XSTAT3.EXT- Exit codes for the 1/0 API M3EXIT function.  Generally, M3EXIT is 
called from any subroutine that produces a fatal error during 1/0 API  access. 

15.3  Other CCTM Configuration Control 

15.3.1  CCTM Process Analysis 

Th~ Models-3(~MA.Q system provides a diagnostic tool that allows a user to probe into the way 
the science processing is actually being executed in the CCTM.  The process analysis tool 
optionally provides two types of information, which are termed Integrated Process Rates (IPR) 
and Integrated Reaction Rates (IRR).  Note that these diagnostic tools apply only for the CCTM 
and not for the other models.  The reader is  referred to Chapter 16 for the details, but briefly the 
IPR processing captures the changes to the concentration field  for different species, or groupings 
of species, for each individual science process modeled.  The IRR processing focuses on the gas(cid:173)
phase chemistry and allows a detailed examination of various characteristics of the chemical 
mechanism implemented in the CCTM for the chosen scenario.  The data produced by these tools 
arc collected in 1/0 API output files, which can be further processed or examined using the 
visualization tools. 

. . .   ' 

"""""""' 

""'" 

""'"""" 

1
:::1111 

1111

1111111.,,' 

, 

I 

:11111111111111!" 

" "  

111111,·11 

' '  

""' 

' 

•"' 

" 

. 

, 

The CCTM requires three include files, even if neither IPR nor IRR processing is selected. 1 
These include files are automatically generated from PROCAN, and the Models-3 framework 
then incorporates them in the CCTM build process.  The three IPR/IRR include files are: 

'II 

·11111 

1 If process analysis is not requested while building a CCTM model executable, the  Models-3  framework 
automatic:illy supplies the include files. 

1111111'":111 

::;1 

' 

PA_CTL.EXT-The declarations and values of the two flags  that determine ifIPR or IRR 
(or both) processing is to be performed. 

PA_ CTM.EXT - Declarations and parameters that define the domain, output file 
descriptions, arrays and dimensions, IPR and IRR loop variables, and named common 
blocks for computational data. 

PA_ DAT.EXT - Data statements containing values for the variables needed to fill  in the 
common blocks in PA  CTM.EXT. 

15.3.2  CCTM Fixed Data 

The Models-3/CMAQ system can deal with other types of global include files and reference 
them from a user-supplied full  path to build a model.  The following three categories of global 
include files apply to the CCTM.  The other processor models (MCIP, ECIP, etc.) also have 
include files in this category, but not as extensively. 

• 

• 

• 

• 

• 

FILES_ CTM.EXT - The set of logical file names used in the current CCTM 
implementation.  The include file contains data statements for the file names as variables 
used in the codes and values for the variables.  The values are character strings that are 
UNIX environment variable values set in the scripts launched by the Models-3 
framework to run the models. 

CONST.EXT, CONST3_RADM.EXT-These include files contain parameter statements 
to define basic and frequently used air quality and meteorological modeling physical and 
mathematical constants.  Inclusion of these files in the model codes helps to assure 
consistency in the science calculations across all the processes and modules. 

BLKPRM_500.EXT - Computational blocking: For computational efficiency and 
reduced memory requirements, operations may be performed on groups of grid cells (a 
block of cells) at a time.  This include file provides convenient definitions to use 500-cell 
blocking. 

GRID_DECL.EXT- Declarations for the dimensions and species classes offsets in the 
main concentration array.  See Chapter 18, Section 18.2.2 for details. 

EMISPRM.chem.EXT, EMISPRM.vdif.EXT-These two include files contain the 
declarations that control in which process the emissions sources are injected; either the 
vertical diffusion process of the gas-phase chemistry solver process.  By using a C pre(cid:173)
processor (cpp) #ifdef directive, one or the other include file is actually included when the 
code is compiled.  The cpp directive is set by the user during the model building phase. 
The reader is referred to Chapter 18, Section 18.5 for more details. 

15.4  Generalized Chemistry 


15.4.1  Design 

In the past, a particular chemical mechanism was generally "hardwired" into a chemical transport 
model with mechanism parameters and variables embedded in the solver codes.  Implementing 
even minor changes incurred a high potential for code and consistency errors.  Additionally, 
some mechanism changes necessitated extensive coding changes, requiring careful tracing 
through all the mechanism dependencies.  Worse, not finding these dependencies led to errors 
th~,!. ~er.7 ~ot ?;?,,~c~'~"~arily detected ...  The Models-3/CMAQ system employs a generalized 
c~1~1niJ~aj aje~,b~~,,!11 processor(MP), also called the "mechanism reader," which greatly 
simp ifies the task of implementing or altering gas-phase chemical mechanisms and provides the 
capability of easily and safely using different mechanisms in the CMAQ system. 

MP reads an ASCII file that contains a symbolic description of a gas-phase chemical mechanism, 
and generates three ASCII Fortran source files.  The input ASCII file is called a mechanism 
description, or simply, "mechanism." 

I 

111111111111. 

,.:, 

" 

llll111llli1"'lllll1 

The ASCII mechanism description file is formatted according to a simple set of rules in a free-
fom1  format similar to the approaches used by Jeffries et al.  [2]  and Gery and Crouse [3].  The 
types of reactions that are supported are described below in Section  15.4.3, and the specific 
formats are described in the Models-3 User Manual, Appendix M [4]. 

111""111111111111 

111

',, 

I 

, 

' 

• 

""' 

"' 

• , •  

" 

Tht: Fortran files that are generated are incorporated as include files  in the CMAQ Fortran codes. 
They consist of: 

• 

• 

Fortran named common blocks that declare parameters and explicitly dimensioned arrays 
associated with gas chemistry' kinetic and .photolytic reactions. 

Fortran data statements that fill in the common block arrays with actual values 
determined from the input ASCII mechanism file. 

Th'~ common block~ and the data statements files are global and are used in ali the codes that 
require gas chemistry information .. 

Another file that is generated from the mechanism description file by MP, which is transparent to 
the user, is a species list found in the mechanism description.  This file  is used by the framework 
to generate all the gas chemistry species global include files that are required in the model codes. 

In order to  implement the mechanism reader's capabilities, the CMAQ system requires 
generalized gas-phase chemistry solvers.  At present, there are two such solvers available, 
SMVGEAR and QSSA, which are described in detail in Chapter 8.  The use of generalized 
solvers precludes some code optimizations that can increase performance, but significantly 
facilitates implementing new or altered chemical mechanisms. 

15.4.2  Operation 

The CMAQ system accounts for chemistry in three forms:  gas phase, aerosols (liquid and solid 
phase), and the aqueous phase.  Therefore, the Models-3 framework controls certain aspects of 
how the model species are treated in a model simulation and provides linkages between species 
in different phases.  Setting up the linkages is accomplished by means of a series of four species 
tables in a spread sheet format that are filled out by the user.  These tables also allow the user to 
control some aspects of the simulation and generated outputs and provide links to data such as 
emissions, initial and boundary concentrations, and dry deposition velocities that are generated 
by the CMAQ input processors.  The mechanism definition and species tables become objects 
that the Models-3 framework stores in its database.  Therefore if a required chemical mechanism 
already exists in the database as a predefined mechanism, the user does not have to enter any 
mechanism data into the framework. 

Since different gas-phase chemical mechanisms can be used in the CMAQ system and these 
mechanisms may employ different species names, it is necessary to supply the linkages among 
the gas-phase species, the fixed aerosol species, and the species that participate in aqueous-phase 
chemistry.  Similarly, it is also necessary to link the gas-phase species to emissions, deposition 
velocities, and to aqueous-phase scavenging.  In addition, the species tables allow the user to 
select which species concentrations are written to the output files and whether or not they are to 
be advected or diffused.  In the same manner, most of these linkages must be established for 
aerosol, non-reactive, and possibly tracer species. 

The methodology used to establish links between species names involves the concept of 
surrogate names.  Surrogate names are used to provide linkages between model species within 
the CCTM and to link the model species to those that represent data provided by other CMAQ 
processors.  For example the emissions-chemistry interface processor, ECIP, that links the 
Models-3 emissions processing and projection system (MEPPS) with the CCTM could write a 
species named XXX that represents xxx emissions rates.  However, the CCTM that uses xxx rnay 
have the corresponding model species named YYY.  Using the surrogate name concept, 
emissions species XX:X gets mapped to model species YYY.  The reader is referred to the 
Models-3 User Manual [4] for more details on the implementation of the set of predefined 
surrogate names used in the current version. 

An additional feature that can be applied to any of the surrogate species linkages is the 
application of a multiplicative, or scale factor.  The user can set the factor to be other than unity 
(the default) to easily modify some model input data related to the selected species and process 
linkage.  For example, this could be used to test the effect of changing the deposition velocity for 
a certain species, or to modify initial or boundary conditions data.  Also, the factors can be set to 
modify certain data between model species groups within the C~TM, such as in the gas-phase to 
aerosol linkage. 

These linkages are set by the user and are distributed among the four tables that establish the 
linkages among gas-phase, aerosols, non-reactive, and (possibly) tracer species.  Non-reactive 
species are gas-phase, but do not participate in gas-phase reactions.  Optional tracer species are 
inert and may have special, user-defined initial and boundary concentrations as well as emissions 
sources.  The reader is referred to the Models-3 User Manual [4]  for more details and a complete 
description of the species tables. 

The following is a list of the linkages set up in the current implementation of the Models-
3/CMAQ system.  The linkages take place with respect to the CCTM or model species name; the 
surrogate names and flags point to this name. 

1111 

111111

1,,:, 
2. 
3. 
4. 
5. 

6. 

7. 

8. 

9. 

,,111111111' 

10. 
ti. 
:iiiiii!I: 
12. 
13. 
14. 
15. 

16. 

17. 

18. 

1"11111111" 

,,II' 

,Mo4~l,,,species molecular weight. 

Emissions species surrogate name. 

Emissions species scale factor. 

Initiaf and boundary concentrations species surrogate name. 

Initial and boundary concentrations species scale factor. 

Deposition velocity species surrogate name. 

Deposition velocity species scale factor. 

Gas-phase to aerosol linkage species surrogate name. 

Gas-phase to aqueous-phase linkage species surrogate name. 

11111• 

11111°':111111111111111111 

I 

' 

"'ii' 

I 

"'II 

Gas-phase aqueous scavenging linkage species surrogate name. 
(}as-ph1as~ 1111~queous scavenging linkage species scale factor.' 
AerQ~Ql to aqueous-phase linkage species surrogate name. 

111111111111111·:11 

111111"111111,, 

'Ill 

1111 

I' 

11, 

1,,,,,.,, 

1111' 

Aerosol aqueous scavenging linkage species surrogate name. 

Aerosol aqueous scavenging linkage species scale factor. 

Non-reactive to aerosol linkage species surrogate name. 

Non-reactive to aqueous-phase linkage species surrogate name. 

Non-reactive aqueous scavenging linkage species surrogate name. 

Non-reactive aqueous scavenging linkage species scale factor. 

19.  Model species flag for participation in the advection processes. 

20.  Model species flag for participation in the diffusion processes. 

2!.~ 

:tv;fodet,,species flag for inclusion in the concentration output file. 

22.  Model species flag for inclusion in the dry deposition output file. 
23.  Model species flag f~r inclusion in the wet deposition output file. 
24. 
It should be noted that items 1 - 7 and  19 - 23 apply to all of the four groups of species (gas 
phase, aqueous phase, solid and liquid aerosols). 

Tracer spe:ies - si~lar linkages to any of the above. 

15.4.3  Supported Reaction Types 

In this section we describe the types of gas-phase chemical reactions supported by the 
generalized mechanism processor, MP, in the current version of the Models-3/CMAQ system. 
The reader is referred to Chapter 8 for a description of the available mechanisms. 

The gas-phase mechanism description file is a list of mechanism reactions.  The mechanism 
reactions list consists of lines of symbolic descriptions of elementary reactions among modeled 
chemical species, followed by a rule-based symbolic description of the reaction rate expression 
for that reaction.  The reader is referred to Chapter 8 for mechanism description examples. 

These mechanism reaction lists are generally "free-form," in that spacing of the symbols on the 
page is not important (except, perhaps for readability), and reaction descriptions may span many 
lines if necessary.  Liberal use of comments is facilitated by allowing for comment lines and 
comments embedded within the reaction lines.  In addition, each reaction may be labeled for 
subsequent reference.  The photolysis reactions are given labels for a specific photolytic table 
reference.  These tables are generated by the J-value processor and are used in the CCTM for the 
gas-phase chemistry processing.  Currently, there are 10 different rate constant expressions 
available for thermal reactions, including Arrhenius-type expressions and the class of so-called 
fall-off reactions (Type f,  below).  New expressions can be added, as necessary. 

The type of reaction rate expressions that can be calculated are: 

Type 1 : 
Type 2: 
Type 3: 

k=A 
k =  A(T/300)8
k =  Aec-c!T), 

, 

Type 4: 
Type 5: 
Type 6: 
Type 7: 

Type 8: 

Type 9: 

Type f: 

k = A(T/300)8 ec-c!T) 
k = ~ = kr/AeC·CIT)' 
k = Ak,,, 
k = A(l.O + 0.6P), 
k3 (M] 
k -k  + 
klMJ 
-o  
1+-3-
kz 
k =  k1 + k2[M], 
k =  k = 

ko[ M] 

l+ k 0 (M] I k; 

where  T =  temperature in deg K. 
where  C =  Ea I R, 

Ea  is the activation energy, and 
R is the gas constant. 

where kr is any previously defined forward reaction. 
where ~ refers to the n1
where P =  pressure in atmospheres. 

1t  reaction. 

,  where i,., k2,  and k3  are Type 3. 

~ 

where k1 and k2 are Type 3. 
pG 

where ko  and k;  may be Type 1, 2, 3, or 4, 
G =  { I + [In( ko  [M] I k;) j n ]2 r', 
F =  0.6 (usually), and 
n =  1.0 (usually). 

15-9 


1JM~1,,,11mS1~!J:,~1i,~,m,21~s~ripti()n fil,,~ that MP reads must foll<::>w  a set of format rules in .order to 
"::  describe the reactions listed above.  Generally, reserved ASCII characters and keywords on one 
line (which may wrap around tile page) represent parts of a reaction, includi~g species reactants 
and products, stoichiometric coefficients and rate expressions.  In addition, labels are supported, 
which function to allow one reaction to refer to another and to fix  photolytic reaction table names 
for photolytic reactions.  As mentioned above, the reader is referred to Chapter 8 for mechanism 
description examples.  Also, Appendix M of the Models-3 User Manual contains a complete 
description of these formats. 

"" 

" 

·iilllllllllll11 

·1 

II. 

111111111, 

111',,!lll 

.. 

·':::1111111111111111111

"

1 

·ll":;,,,,,,1111111: 

111111"' 

, "  

,,  15.4.5  Chemical Species Include Files 

,·.,, 

'l!,,1 

'" 

1111111· 

111 

;1!!!1!!!!111,1111 

111 

,,,11 

,,.:I',, 

. ' 

,,,,,,"'II,  ,,11111, 

,,, 

,111111,, 

As described above, MP reads and processes the mechanism description file, and one of the 
"'  0'111""""tpuislt generates is a file that contains the list of chemical species found in the 'mechanism. 
The Models-3 framework reads this species file to initialize the ·gas~phase species table in a 
format similar to a spreadsheet, which the user completes by inserting data such as molecular 
..  : weights, silrrogate names and factors, and processing flags.  The initial set-up presented to the 

user consists of all blank entries in each spreadsheet cell, but with the first column filled in with 
the species found in the MP-generated species file.  Thus all the species in the mechanism are 
li~~ed in the order in which they were found in the mechanism description file.  The top row is 
also filled in with category headers that are related to the linkages described above and that 
determine the framework-generated Fortran include files to be used in the codes. 

11," 

11111 .. 1 

1111,::1,1li;1il:: 

1111111111111 

,11111111111111111111111' 

11111111111111111111

11 

:11 

I· 

·1111 

"1111111111 

Tb~re ru;~,, th!:!::,~,,, ag,,git!9q~l !,a~J~s that fl[~ l,,!li!!,,f;ll,iz~g fqr aer{)sqJ~, non-reactive and tracer species. 
They do not have the first column set up, but the first row is set as in the gas-phase table.  It is up 
tcfthe user to fill in the first column, as with all the other spreadsheet cells. Appendix M of the 
Models-3 User Manual describes the details of how to enter data into these tables. 

"''II 

:111111111111""111" 

• 

''Ill:' 

11111111' 

'"1111 

• 

'111111 111111 

The following sections describe all the standard include files that are generated from the species 
tB;~l~,,~ .ar.d th~ Jiel!!::lvior o(Jhe i:nodels wh,en ?Cces~ing the data declared in the include files. 

15.4.5.1 

1111111!!!'•',, 

111::11111 

!1111111!!!1111' 

',, 111

:111111!!!!!!' 

llrr:!!!ll!1111!'' 

: .. '!"11111111 

Gas-Phase Reactions 

' 

111!,, 

111

, 

,,,,,,, 

' 

' 

'''••''• 

'', 

1111111:!,'', 

Th~ gas-phase reactions data are required in the CCTM by the gas-phase chemistry solvers and 
the subroutine PHOT, which calculates the photolysis rate constants.  These data are also 
required in JPROC, the processor model that calculates the table-based photolysis rates (see 
Chapter 14).  There are two include files associated with this data: 

"1111111111111" 

. """ 

:11111'111,I!,' 
111111" 

1111'' 
111
11111111!

'! 

• 

, 

,llll"''' 

',,,;:ll""lllllll' 

,  llllll"ll'r,,,:: .. , 

\,,::·,Jlllll!llllllllllllll' 

RXCM.EXT - contains all the declarations, parameter statements and array definitions 
I  associ'atec:f Wiih the gas-phase chemistry reactions.  This file also contains three named 
, common blocks for memory allocation of the data from  RXDT.EXT. 
R.XnT':1EXT- cont~ns data stat~ments'assodated with the p1~~eters and arrays declared''  II 
in RXCM.EXT.  These data fill the arrays in the named common blo~ks in RXCM.EXT. 

1'i" 

'  !  l!,ll'!lll1'11 

)''1lll1111illlllllll111r 

:,;,rrrr,,,,;:;,, 

,,,,,,,,,,,,,,,, 

,,llllllllll 

1' 

rrllll::,!I 

11
1111111

,,,,, 

,, 

,, 

,,,,,, 

. 

'' 

; 

' ' '  

' 

,, 

,, 

'

, 

I 

"!l1111il1: 

ll!lllir 

,' 

lllllr 


The CCTM driver program must include both of these files  in its declaration section.  The 
subroutines in the gas-phase chemistry solver process module must include only the common 
block file, RX CM.EXT.  That goes for the subroutine PHOT, as well.  PHOT is called from the 
gas-phase chemistry  "class-driver," the top-level subroutine (see Section 18.2.2 in Chapter 18). 
The CCTM driver, by including both files, causes the common blocks to be loaded with the 
necessary data used by all the modules that need the chemistry data, including the process 
analysis module, PROCAN. 

The remaining sections describe the global include files associated with the four species tables. 
As mentioned above, these files are automatically generated by the Models-3 framework, 
according to the user-specified linkages and flags, and are targeted for inclusion in all model 
routines that require the specific chemistry data in them.  For additional details the reader is 
referred to the Models-3  User Manual [4].  Each of the include files contains declarations and 
parameter statements for the loop index and array dimensioning for each particular species 
group.  If a particular species group is not used (e.g., aerosols or tracers), the include file contains 
declarations and parameter statements that set the species loop counter to zero and its array 
dimensioning parameter to one, thus maintaining complete generality and modularity within the 
codes.  In addition, by setting the dimensioning value to one (Fortran does not allow zero), the 
compiled codes do not waste memory, a typical problem when coding in Fortran with some pre(cid:173)
determined maximum dimension to hopefully account for all cases. 

15.4.5.2 

Model Species 

The framework generates four model species include files that together contain the names and 
molecular weights of all the chemical species available globally to the model. 

The model species include files are: 

• 

• 

• 

• 

GC _ SPC.EXT - gas-phase model species names and molecular weights. 

AE _ SPC.EXT - aerosol species names and molecular weights. 

NR_SPC.EXT- non-reactive species names and molecular weights. 

TR_SPC.EXT- tracer species names and molecular weights. 

The next three sections describe include files that are associated with data access by the CCTM 
from external files.  The data are referenced from 1/0 API files  by means of file variable names 
that are contained in headers in each of the files. 

15.4.5.3 

Emissions 

The CCTM reads the emissions data from an 1/0 API file produced by ECIP using the surrogate 
name concept discussed above.  The data are read by file variable names (surrogates) and stored 
in arrays that are linked to the corresponding model species names. 

The CCT!vf has the option of emissions sources injected as part of the vertical diffusion process 
or11111as part of the chemistry solver process, where the injected sources are treated as part of the 
chemical production terms.  To read source emissions data into the CCTM for processing either 
in the vertical diffusion or in the gas-phase chemistry modules, the following include files are 
required: 

,,·,',',',',11111,•ll' 

llllllllllllf,,I 

llllll,111111'1111111 

" "  

l11i1,.Jlllll'1' 

,.',1111• 

" 

, 

I 

" 

'I, 

"' 

"' 

' 

• 

• 

11111111· 

I 

GC_EMIS.EXT- gas-phase emissions surrogate species names with scale factors and 
indices that point to the positions of the species in the model species name table (in 
GC_SPC.EXT). 

AE_EMIS.EXT - aerosol emissions surrogate species names with scale factors and 
indices that point to the positions of the species in the model species name table (in 
Ap_SPC.EXT). 

'1''1111111111111111111111" 

·11111,,:i,,,,, 

Ill·, 

"' 

il1"'1!·111··;,',· 

'''':11lliillll', 

1
111
:.'.
1'1'
,'1' 
·11!!!111111111111" 

' 

"' 

''111 
11111111 

"' 

1
::1 
,,,,,1::: 

NR_EMIS.EXT - non-reactive emissions surrogate species names with scale factors and 
indices that point to the positions of the species in the model species name table (in 
NR_SPC.EXT). 

"" 

', 

11111· 
,,  ' '   : 

,,11 

'' 

I 

11' 

!,,,,,,'' 

.,, 

.. 

' 

: 

"I' 
' 

' '  '"':1111""1' 
,I. 
11111111 

• 

TR_EMIS.EXT - tracer emissions surrogate species names with scale factors and indices 
that point to the positions of the species in the model species name table (in 
TR_SPC.EXT). 

1111111111 

15.4.5.4 

'"'II 

Initial and Boundary Conditions 

For both the initial and boundary concentrations the CCTM reads I/O API input data by variable 
n3Jpe reference .. ~  The processing first checks to see if the model species name is on the file and 
reads the data associated with that name.  If the model species name is not on the file,  it checks 
for the surrogate name.  If that, too is not available, the input value is set to a minimum value 
("!l}Odel zero").  Additional information on initial and boundary conditions and how they are 
i~Elemented in th~··· Models-3/CM~Q system can be ~ound in  Chap!~r 14. 

• 

• 

• 

• 

GC_ICBC.EXT - gas-phase initial and boundary conditions surrogate species names with 
scale l~(.!tq~~ and in.dic~s th!:!t point to the positions of the species in the model species 
name table (in GC_SPC.EXT). 

AE_ICBC.EXT- aerosol initial arid boundary conditions surrogate species names with 
scale factors and indices that point to the positions of the species in the model species 
name table (in AE_SPC.EXT). 

NR_ICBC.EXT - non-reactive initial and boundary conditions surrogate species names 
""'.,ith  s~,~eJ~ctors and ir1:9k.~s that point to the positions of the species in the model 
species name table (in NR_SPC.EXT). 

· 

TR_ICBC.EXT- tracer initial and boundary conditions surrogate species names with 
scale,,,(~£~~~~ and iIJ-?ic~~ th~t point to the positions of the species in the model species 
name table (in TR_SPC.EXT) 

1111:11::1, 

·111 ::11,,, 

111"''1'' 
',11111111, 
,111"1 

15.4.5.5 

Dry Deposition 

The following include files are used to read in dry deposition velocities from an VO  API file 
produced by the meteorology-chemistry input processor, MCIP.  Using the surrogate name 
concept discussed above, the data are read by file variable names (surrogates) and stored in 
arrays that are linked to the corresponding model species names. 

• 

• 

• 

• 

GC_DEPV.EXT - gas-phase deposition velocity surrogate species names with scale 
factors and indices that point to the positions of the species in the model species name 
table (in GC_SPC.EXT). 

AE_DEPV.EXT - aerosol deposition velocity surrogate species names with scale factors 
and indices that point to the positions of the species in the model species name table (in 
AE_SPC.EXT). 

NR_DEPV.EXT - non-reactive deposition velocity surrogate species names with scale 
factors and indices that point to the positions of the species in the model species name 
table (in NR_SPC.EXT). 

TR_DEPV.EXT- tracer deposition velocity surrogate species names with scale factors 
and indices that point to the positions of the species in the model species name table (in 
TR_SPC.EXT). 

15.4.5.6 

Wet Scavenging 

In both the scavenging and the cross-phase linkages it is necessary to set up a mapping from the 
gas-phase species to the generic species names that are associated with aerosols and aqueous(cid:173)
phase chemistry and to the names of species that are absorbed by cloud and rain water.  Because 
of the generality with respect to the gas-phase species names, these generic names are set in the 
subroutines associated with aerosols, aqueous chemistry, and removal by in-cloud and 
precipitation scavenging.  They are linked to the model species names by employing the 
surrogate name concept described above. 

• 

• 

• 

GC_SCAV.EXT - gas-phase scavenging surrogate species names with scale factors and 
indices that point to the positions of the species in the model species name table (in 
GC_SPC.EXT). 

AE_SCAV.EXT- aerosol scavenging surrogate species names with scale factors and 
indices that point to the positions of the species in the model species name table (in 
AE_SPC.EXT). 

NR_SCAV.EXT - non-reactive scavenging surrogate species names with scale factors 
and indices that point to the positions of the species in the model species name table (in 
NR_SPC.EXT). 

TR_SCAV.EXT- tracer scavenging surrogate species names with scale factors and 
indices that point to the positions of the species in the model species name table (in 
TR_SPC.EXT). 

Cross-Phase Linkage 

15.4.5.7 
• 

1111,,,," 

,1,,,,,, 

• 

• 

• 

• 

• 

• 

GC_GiAE.EXT- surrogate names for gas-phase model species that participate in aerosol 
chemistry with scale factors and indices that point to the positions of the species in the 
m~detspecies name table (in GC_SPC.EXT). 

,1111111111''11,, 

GC_d2AQ.EXT- surrogate names for gas-phase model species that participate in 
aqueous-phase chemistry with scale factors and indices that point to the positions of the 
species in the model species name table (in GC_SPC.EXT). 

AE_A2AQ.EXT- surrogate names for aerosol species that participate in aqueous-phase 
chemistry with scale factors and indices that point to the positions of the species in the 
model species name table (in AE_SPC.EXT). 

NR_N2AE.EXT - surrogate names for non-reactive species that participate in aerosol 
chemistry with scale factors and indices that point to the positions of the species in the 
model species name table (in NR_SPC.EXT). 

NR_N2AQ.EXT- surrogate names for non-reactive species that participate in aqueous(cid:173)
phase chemistry with scale factors and indices that point to the positions of the species in 
the model species name table (in NR_SPC.EXT). 

TR_ T2AE.EXT - surrogate names for tracer species that participate in aerosol chemistry 
with scale factors and indices that point to the positions of the species in the model 
species name table (in TR_SPC.EXT). 

TR_T2AQ.EXT- surrogate names for tracer species that participate in aqueous-phase 
chemistry with scale factors and indices that point to the positions of the species in the 
modetspecies name table (in TR_SPC.EXT). 

15.4.5.8 

Operational Choices 

The Models-3 framework provides the capability of allowing the user to control how some of the 
processing is carried out with respect to the chemical species in the CCTM.  The following lists 
describe the include files that the framework generates for the various processes: 

1. 

Advected species: In order to save memory storage or to minimize computation, the user 
may choose not to advect certain modeled species such as some radicals.  In general, the 
special "counter species,, used in a mechanism should not be advected. 

• 

GC_ADV.EXT - names of gas-phase model species that are advected and indices 
that point to the positions of the species in the model species name table (in 
,,  GC_SPC.EXT). 

AE _ADV .EXT - names of aerosol species that are advected and indices that point 
to the positions of the species in the model species name table (in AE_SPC.EXT). 
NR_ADV.EXT - names of non-reactive species that are advected and indices that 
point to the positions of the species in the model species name table (in 
NR_SPC.EXT). 
TR_ADV.EXT- names of tracer species that are advected and indices that point 
to the positions of the spedes in the model species name table (in TR_SPC.EXT). 

2. 

Species that undergo diffusive processes: The comment above, for advected species, 
applies also to diffused species. 

• 

• 

• 

• 

GC_DIFF.EXT- names of gas-phase model species that are diffused and indices 
that point to the positions of the species in the model species name table (in 
GC _SPC.EXT). 
AE_DIFF.EXT - names of aerosol species that are diffused and indices that point 
to the positions of the species in the model species name table (in AE_SPC.EXT). 
NR_DIFF.EXT - names of non-reactive species that are diffused and indices that 
point to the positions of the species in the model species name table (in 
NR _ SPC.EXT). 
TR  DIFF.EXT- names of tracer species that are diffused and indices that point to 
the positions of the species in the model species name table (in .TR_SPC.EXT). 

3. 

Species that are saved to the dry deposition output file:  Generally, all the dry 
deposition species that are modeled would be saved to the output file, but a user might 
elect to reduce the number and save only a subset. 

• 

• 

• 

• 

-

.• 

GC_DDEP.EXT- names of gas-phase model species that are written to the dry 
deposition output file and indices that point to the positions of the species in the 
model species name table (in GC  SPC.EXT). 
AE_DDEP.EXT- names of aerosol species that are written to the dry deposition 
output file and indices that point to the positions of the species in the model 
species name table (in AE_SPC.EXT). 
NR_DDEP.EXT - names of non-reactive species that are written to the dry 
deposition output file and indices that point to the positions of the species in the 
model species name table (in NR_SPC.EXT). 
TR_DDEP.EXT- names of tracer species that are written to the dry deposition 
output file and indices that point to the positions of the species in the model 
species name table (in TR_SPC.EXT). 

. 

4. 

Species that are saved to the wet deposition output file:  See the comment in item 3. 

• 

• 

GC_ WDEP.EXT- names of gas-phase model species that are written to the wet 
deposition output file and indices that point to the positions of the species in the 
model species name table (in GC_SPC.EXT). 
AE_ WDEP.EXT- names of aerosol species that are written to the wet deposition 
output file and indices that point to the positions of the species in the model 
species name table (in AE_SPC.EXT). 

· 

• 

• 

NR_ WDEP.EXT- names of non-reactive species that are written to the wet 
deposition output file and indices that point to the positions of the species in the 
model species name table (in NR_SPC.EXT). 
TR_ WDEP.EXT- names of tracer species that are written to the wet deposition 
output file and indices that point to the positions of the species in the model 

..........  species name table (iri TR_ SPC.EXT). 

... 

.. 

. .. 

Sp~~i"~s th1~t are saved to the concentration output rile: See the comment in item 3. 
• 

GC_CONC.EXT- names of gas-phase model species that are written to the 
concentration output file and indices that point to the positions of the species in 
the model species name table (in GC _ SPC.EXT). 
AE_CONC.EXT- names of aerosol species that are written to the concentration 
output file and indices that point to the positions of the species in the model 
species name table (in AE_SPC.EXT). 

....  NR_CONC.EXT - names of non-reactive species that are written to the 
I:  concentration output file and indices that point to the positions of the species in 

the ....... model species name table (in NR _ SPC.EXT). 
TR_CONC.EXT - names of tracer species that are written to the concentration 
'output file and indices that point to the positions of the species in the model 
species name table (in TR_SPC.EXT). 

• 

• 

• 

111111111 

15.4.5.9 

Tracer Species 

The use of tracer species is purely user-determined.  An application with tracers can provide the 
modeler withinsights into how the model is simulating various physical processes, like 
advection or diffusion.  If tracer species are to be modeled, the user must have created the special 
table entries appropriate to the application.  In addition special data, such as emissions or initial 
and boundary tracer concentrations, must be created in the corresponding 1/0 API files.  The 
specialized data creation is outside the scope of the Models-3  framework and must be carried out 
by the user in conjunction with the application that is being modeled. 

15.6  Conclusion 

In this chapter we have described how PCP helps to establish modularity and consistency for 
particular applications of models in the CMAQ system.  The Models-3 framework processing, 
through PCP, enables model developers and model users to study the effects of different 
irpplementations of the science and codes or to execute different applications at various scales 
"'{,!~h difieren!,,,,,,,~h~,~ica!,, n;iec~~SQ1S pr with ,,~ifferent nur1~r~cal so!yer~.  'J'h~ d~sign and 
implementation of the concepts in the program control processing helps to establish a true "one(cid:173)
atrnosphere" approach to modeling. 

15.7  References 

': 

,;iu, 

[1) 

''"11

' 

I 

llHllli1111li111 

11!llliiiilll~:: 

,, 

'I' 

I, 

::1 

,, 

'1 

'Ill 

" 

,,, 

1" 

"The EDSS/Models-3 I/O API"  http://sage.mcnc.org/products/l/O APV 

:' 

,, 

,, 

Ii 

Jeffries H.  E: (1990), "User's Guide to Photochemical Kinetics Simulation System PC-

[2] 
PKSS Software Version 3," Chapel Hill, N.C.  27514 

Gery M.  W.  and R.R. Crouse (1990), "User's Guide for Executing OZIPR," EPN600/8-

[3] 
90/069, U.S. Environmental protection Agency, Research Triangle Park, NC 27711 

EPA Third-Generation Air Quality Modeling System Models-3 Volume 9b, User 

[4] 
Manual, Appendices, June 1998, EPA-600/R-98/069(b) 

This chapter is taken from Science Algorithms of the EPA  Models-3 Community 
Multiscale Air Quality (CMAQ) Modeling System, edited by D.  W. Byun and J. K. S. 
Ching, 1999. 

Chapter 16 
==============

PROCESS ANALYSIS 

Human Exposure and Atmospheric Sciences Division 

Gerald L. Gipson* 

National Exposure Research Laboratory 
U.S. Environmental Protection Agency 

Research Triangle Park, NC 27711 

ABSTRACT 

The implementation of process analysis techniques in the Models-3 Community Multiscale Air 
Quality (CMAQ) modeling system is described in this chapter.  These techniques can be used in 
Eulerian photochemical models such as the CMAQ Chemical Transport Model (CCTM) to obtain 
information that provides insights into how model predictions are obtained.  This type of 
information is particularly useful when modeling nonlinear systems such as atmospheric 
photochemistry.  The two techniques available in the CMAQ system - integrated process rate 
(IPR) analysis and integrated reaction rate analysis (IRR) -- are each described.  The manner in 
which IPR analysis can be used to determine the relative contributions of individual physical and 
chemical processes is presented.  Descriptions of how to employ IRR analysis to elucidate 
important chemical pathways and to identify key chemical characteristics are included. Finally, the 
procedures used to apply each technique in the CMAQ system are also described. 

•Corresponding author address: Gerald L. Gipson, MD-80, Research Triangle Park, NC 27711.  E-mail: 
ggb@hpcc.epa.gov 

16.0  PROCESS ANALYSIS 

Major fur{~iion of 8.ir pollution models is to predict the spatial ru1'<l"'temporal distributions of 
ambient air pollutants and other species.  For complex Eulerian grid models, output concentration 
fields of these species are determined by solving systems of partial differential equations.  These 
equations define the time-rate of change in species concentrations due to a series of physical and 
'.  chemical processes (e.g., emissions, chemical reaction, horizontal advection, etc.).  Since most 
grid models are configured to output only the concentration fields that reflect the cumulative 
effect of all processes, information about the impact of individual processes is usually not 
available. Gnd models can be configured to provide quantitative information on the effects of the 
chemical reactions and other atmospheric processes that are being simulated, however (Pleim, 
1990; Jeffries and Tonnesen,  1994; Jang et al.,  1995a,b).  This type of information has been used 
to develop various process analyses that provide descriptions of how a model obtained its 
predictions.  This chapter provides background information on these methods and describes how 
process analysis is implemented in the Models-3 Community Multiscale Air Quality (CMAQ) 
modeling system. 

Although process analysis does not have to be included in a grid model application, it can provide 
5Upplemental information that can be quite useful in assessing a model's performance.  Quantifying 
the contributions of individual processes to model predictions provides a fundamental explanation 
of the reasons for a model's predictions and shows the relative importance of each process.  This 
information can be useful in identifying potential sources of error in the model formulation or its 
inputs.  It can also be useful in interpreting model outputs, particularly with respect to 
understanding differences in model predictions that occur from a change to the model itself or to 
its input.  Further, information provided from the chemical process analysis can be used to 
determine important characteristics of different chemical mechanisms. This is particularly useful 
for investigating mechanistic differences under different chemical regimes (e.g., voe versus NOX 
limiting conditions). 

The inclusion of process analysis in a model application is generally carried out in two steps. 
First, the model itself is "instrumented" (i.e., additional code or modules are added to the model) 
to produce supplemental outputs about the contributions of individual processes and different 
chemical reaction pathways to the model predictions.  These data are then used with the 
C,8~cen~liq2,,,Ji~1~11~s,,~~.P<?Stpro~:~sing operations to provide quantitative explanations of the 
factors affecting a model's predictions.  Although several specific postprocessing techniques have 
b'een develop'e'd to reveaf particular mod.et t'eatUres (e.g., Jeffries and Tonnesen,  1994; Jang et al., 
f995a,b ), ···process analysis data can be extracted and analyzed in many different ways.  The 
iiilp'l'e'mentatlon of process analysis in the CMAQ system has been structured to facilitate data 
~~'i;factiori, fg,r,,,,,,~uE,,~equent model analysis.  Although the main focus of this chapter is on data 
extraction techniques, some example process analyses are also presented to illustrate particular 
allplications. 

·· 

111111' 

I 

For purposes of discussion, it is convenient to separate process analysis into two parts: integrated 
process rate (IPR) analysis and integrated reaction rate (IRR) analysis.  The first deals with the 
effects of all the physical processes and the net effect of chemistry on model predictions. IRR 
analysis deals with the details of the chemical transformations that are described in the model's 
chemical mechanism. In general, IPR analyses are generally much easier to apply and understand 
than IRR analyses since the latter typically requires a fairly thorough understanding of 
atmospheric chemistry.  Thus, the discussion below describes each analysis method separately, 
starting with IPR analyses.  Users not familiar with atmospheric chemistry details may wish to 
omit the sections on IRR analysis.  It should be added that either analysis method can be applied 
independently of the other. 

The CMAQ implementation of process analysis includes a flexible user interface that allows the 
user to request only those particular outputs that are needed for model analysis. The information 
generated for both IPR analysis and IRR analysis is controlled by the Process Analysis Control 
Program (P ACP).  The P ACP processes user-specified commands to instrument the CMAQ 
Chemical Transport Model (hereafter referred to as the CCTM) to generate the specific outputs 
that are selected by the user.  As a consequence, the P ACP must be invoked before configuring a 
CCTM and running a simulation.  The details of how the P ACP works and the syntax for the 
commands are covered in the Models-3 User Manual (EPA,  1998), and they will not be repeated 
in their entirety here.  Nevertheless, some of the command syntax and some simple examples are 
presented in the discussions that follow to illustrate how the P ACP is used to set up a particular 
process analysis. 

16.1 

Integrated Process Rate Analysis 

The governing equation for Eulerian models is the species continuity equation.  Application of 
the continuity equation to a group of chemically reactive species res~lts in a system of partial 
differential equations (PD Es) that gives the time-rate of change in species concentration as a 
function of the rates of change due to various chemical and physical processes that determine the 
ambient species concentrations.  As noted in the introduction, the concentration fields that are the 
numerical solutions to these PD Es reveal only the·net effects of all processes.  This section is 
concerned with how the contributions of individual processes are determined and used in process 
analyses.  The first two subsections deal with the calculation and use of IPRs in general. The last 
two subsections describe the CMAQ implementation of IPR analysis and the use of the PACP to 
set up an IPR analysis. 

16.1.1  Computation of Integrated Process Rates 

All Eulerian models utilize the technique of operator splitting.  As a result, it is relatively easy to 
obtain quantitative information about the contribution of individual processes to total 
concentrations.  In operator splitting, solutions to the system of PD Es are obtained by separating 
the continuity equation for each species into several simpler PDEs or ordinary differential 
equations (OD Es) that give the impact of only one or two processes.  These simpler PDEs or 

16-3 

qp~ ~~,,,~!:,~ s2!,:ve~,~eparately to arrive at the final concentration.  To illustrate, consider the 
simple case of two-dimensional horizontal advection of a single species in the absence of any 
other processes, for which the governing equation can be expressed as follows: 

,. 

', 

' 

' 

' 

ac  +  a(uc)  +  a(vc)  =  0  ' 
at 

ax 

ay 

(16-1) 

where  c is the species concentration, and  u and v are the x- and y-components of the wind 
vefoCity vector, respectively.  With operator splitting, this 2-dimensional equation is split into two 
f:climeiisiOiiaI operators, one for each direction: 

,,11,, 1 

1:::1111' 

iIDd 

111::::111:: 

, 1: : : : : : ! ! : 111 · 
11111!!' 

, , . 
. 

11 

' • 

• ~ : : : : ! ! 111 : : , ! I : : 

"::111::, 

: i 11111 : 

I' 

ac  +  a(uc)  = 0 
at 

ax 

:111 

' '  

ac  +  a(vc)  =  0  . 
at 

ay 

'Ill:,:" 

(16-2a) 

(16-2b) 

l,,!!111111;; 

,;I 

11 

! 

'''''· 

, 

,,,11,,,Ill!i 

'' 

', 

, 

1 

, 

I 

'Ill 

',,,  ,,, 

'!1111111:, 

ii 

, 

These two equations are then solved sequentially, with the solution to the first being used as the 
initial condition for the second.  The solution to the second equation then represents the final 
solution and gives the net effect of 2-dimensional advection. 

The final solution for the example presented above can also be represented as follows: 

1

'""'

11111 

C(,t  + flt)  =  c(t)  +  (flc)x  +  (flc)Y  , 

I 

h 

(16-3) 

···  where c(t+At) is the final solution, c(t) is the initial condition for the 2-dimensional problem, and 
(Ac).r and (Ac)y are the changes in concentration produced by each of the  I-dimensional 
operators.  (Ac).r and (Ac)y  give the impact of each operator in moving from the initial to the final 
concentration and are equivalent to the results obtained by integrating the process rates 
individually. Hence the term integrated process rates is used to describe them.  Note that they can 
be computed with little additional work since they are simply equal to the difference between the 
final and initial concentrations for each operator. 

From the above example, it should be evident that a general mathematical representation of IPRs 
for individual processes can be expressed as follows: 

' , ,  

::: 

1111111 

,,,;11111111 

!1111: 

'!!II 

1
'""  1111,:::ll!  ,11 

.·

'" 

:. 

1111111· 

,::, 

,,111111;; 

111111 i i , , ; , 

' ; i 11 u 

" 

11 i 111111111111 i i I i ! ~ ' , , , , , 

· 11 11 I i I i i I !!111111 

<fl~)  =  r'. At  L  dt 

n 

J t 

n 

' 

(16-4) 

wh~re (Ac)n is the change in a species' concentration due to operator n, Ln is the differential 
d~nitor"iiss'o'ciated with a process, and At is the model synchronization time step (which is 

· , 

, 

, 

' · 

' 

· · · 

, 

' I : ' 

, . 

, , 

16-4 

'Ill 

llllh, 

1111111 
'lh,, 

11111111 

"'II!' 

equivalent to At sync in Chapter 6).  Refer to Chapter 6 for a discussion of the various time steps 
used in CMAQ.  The integration in equation (16-4) is performed by the model regardless of 
whether it has been instrumented for process analysis.  Thus, it is only necessary to save the (Ac)n 
to obtain process analysis capabilities.  In a few cases, however, models may be structured such 
that one operator deals with two or three processes simultaneously.· In those cases, the (Ac)n 
obtained after the integration would represent the compound effect of all of those processes and it 
would not be possible to discern the impacts of the individual processes.  Normally, the only way 
that information could be obtained would be to  integrate the process rates separately.  In some 
instances, however, it may still be possible to isolate the impacts of the individual processes 
without performing additional integrations.  For example; the CCTM treats vertical diffusion, 
emissions, and dry deposition simultaneously in one operator, but the amount of material 
deposited by dry deposition is tabulated and the amount of material that is emitted is known.  As a 
consequence, mass balance techniques can be used to compute the contribution of each process 
subsequent to the simultaneous integration of the process rates without separately integrating 
each process rate.  Thus, the IPRs that are available for process analysis are to some degree 
determined by the underlying structure of the photochemical model that is being used and by the 
effort that is invested in separating individual components when processes are coupled in a single 
operator. 

Analogous to equation ( 16-3), the concentration at the end of a time step can be expressed as 
follows: 

c(t+At)  =  c(t)  + L  (Ac)n  , 

N 

n=I 

(16-5) 

where the model is assumed to have N operators.  It should be noted that most IPRs can be either 
positive or negative since most processes can cause concentrations to either increase or decrease. 
Further, it should also be evident that the IPRs in the above expression are additive.  Thus, for 
example, the IPRs for horizontal advection and vertical advection could be summed to give one 
IPR that represents the net impact of the two advection processes.  The differential operators (Ln) 
themselves are most often nonlinear, however.  Because of these nonlinearities, the magnitude of 
the IPRs for most processes would change ifthe order of the model's operators was altered or 
even if only one of the operators was changed.  Thus, the additive property for IPRs holds only 
for a particular application of the model. 

16.1.2  Example IPR Analyses 

The tabulation and subsequent output of IP Rs provide the user with quantitative information on 
the  effects of individual processes, and these can be examined and depicted in a number of ways. 
Figures 16-1  and  16-2 contain two types of displays that were developed to depict process 
contribution data graphically (Jeffries,  1996).  Figure 16-1  is a time series plot showing both 
predicted concentrations and integrated process rates.  This type of plot shows the hourly 
variations at a cell (or group of cells if the data are aggregated) of a predicted species 
concentration and the change in concentration caused by each process (i.e., the IPRs).  Plots of 
this type illustrate the variations in process contributions during the simulation period.  Figure 16-
2 shows process contributions and total concentrations for different model formulations, in this 
case, different grid resolutions.  Here the data have been aggregated over several cells and hours, 
but could be developed for a single cell or time period just as well.  This figure highlights how 
cumulative process contributions are altered by the different model formulations.  For a more 
thorough discussion of how this type of data can be used to assist in the evaluation of a model's 
performance, the reader is referred to Jang et al.  (l 995a and  l 995b) and to Pleim (1990). 

1, 
: : I h " ~ : : 

111' 

·111111111

1
' ' '  

11 
" 

; I , 

I 

' "'  ' ' I " ' ' 

" ' 

" , , 

16.1.3  Implementation of IPR Analysis in the CMAQ System 
. 

.  ~ 

~ 

11 
' 
'  , , 

II 

" 

I 

The previous section illustrated that instrumenting a model for process analysis involves providing 
the capability to capture IPRs.  Since an IPR can be calculated for every combination of process 
and species, the amount of output data that can be generated is substantial.  As a consequence, 
the PACP has been designed to allow substantial flexibility in selecting the particular IPRs for 
output.  This is accomplished primarily by allowing the user to choose only those particular 
species/process combinations that are of interest.  Additional control and flexibility are provided 
by including the ability to produce lumped IPRs, by allowing special species families to be defined, 
and by pro\riding controls to limit the size of the modeling domain for which outputs are 
generated.  These will be illustrated in the examples presented below. 

The physical processes that are simulated in the CCTM and hence are available for IPR analysis 
are shown in Table 16-1.  As will be illustrated below, these processes are referenced in the PACP 
by the codes shown in the first column.  The procedure for selecting specific IPRs for output is 
species oriented.  Hence,  a user selects a species and then indicates which processes will be 
included in the IPR output.  The species are referenced by their model names.  In addition, the 
user may also define a family of species that is a linear combination of the model species (e.g., 
defining NOx as the sum of NO and N02)  and extract IPRs for the family.  This can be useful in 
saving disk space occupied by the output IPR files when information about individual members of 
a family is not needed. 

It should be apparent from Table 16-1  that IPRs for some species will always be zero (e.g., those 
species not emitted always have zero IPRs for that process).  Thus, the size of the output file can 
be minimized by not extracting those IPRs.  The P ACP also contains an option that allows the 
user to limit the amount of output data by extracting IPR outputs for only part of the modeling 
domain. Currently, the user is restricted to selecting a single, contiguous block of cells within the 
domain for the IPR outputs.  The block is defined relative to the modeling domain by  selecting a 
starting and ending column, row and level. A possible future enhancement would be to provide a 
graphical interface to allow the user to select any particular cell or group of cells within the 
domain. 

The CCTM model has been instrumented to write the IPRs to an output file at the same time as 
the output concentration files are written.  Thus, the IPR outputs represent the cumulative impact 
of the process integrations over the entire output time interval.  Process contributions over shorter 
time intervals can be obtained by increasing the frequency of writing outputs of both the 
concentration fields and the IPRs.  Finally, the IPR output files are standard Models-3 IO/API 
gridded files, and can be viewed with the Models-3 visualization tools described in Models-3 User 
Manual (EPA,  1998). 

16.1.4  Use of the PACP to set up an IPR Analysis 

This section illustrates how the PACP can be used to generate the IPR data for an analysis. 
Details on formatting inputs and using the PACP are contained in the Models-3 User Manual 
(EPA,  1998).  This section borrows from  that discussion to  illustrate how the P ACP is used.  The 
user selects and controls the form of the IPR output data by means of a PACP command file.  A 
few predefined command files are available to set up an analysis, or users can generate their own 
files to customize their analyses.  A command file consists of a series of commands and definitions 
that contain instructions for generating IPR outputs.  The commands are input in a free form 
format to facilitate encoding, and they contain special keywords that have specific meaning to the 
PACP.  The commands related to IPR analysis have been divided into two groups: Global 
commands and IPR output commands.  A description of the commands within each group will be 
presented first,  followed by an example illustrating how these commands are used.  In the 
description that follows, the syntax for each command is given first, with bold type used for 
PACP keywords and normal type used for user supplied input.  Alternative inputs are separated 
by  vertical bars and completely optional inputs are enclosed in curly braces. 

Global Commands: 

OUTPUT_DOMAIN = {LOCOL[ni] + HICOL[n2]  + LOROW[n3)  + HIROW[n4) 

+  LOLEV[n5]  + HILEV[n6]}; 

The OUTPUT _DOMAIN command provides the capability to limit 
the IPR output data to only one portion of the modeling domain. 
The ni  in brackets are numbers that define the bounds of the output 
domain relative to the number of columns, rows, and vertical levels 
in the modeling domain.  Thus, for example, the value for n1 must 
be greater than or equal to one and less than or equal to the number 
of columns in the domain.  If this command is included, at least one 
domain specifier must be present, and the end of the domain is used 
for any that are missing.  If the command is omitted entirely, output 
is generated for the entire domain. 

DEFINE FAMILY familyname = {c 1*}species 1 {+ {c2*}species2 + ... }; 

The DEFINE FAMILY command is used to define a group of 
species as members of a family.  The user specified "familyname" 

16-7 

"""'must be unique  and can be referenced in subsequent commands. 

" , ":'  ' ::::T4~,,,, ci are numerical coefficients that default to one if not specified; 

·:1111111111111111111111, 

.~11, 

"I'',, 

", 

i" 

··1111 

.1111111: 

'Ill" 

, 

, 

,, 

"speciest are the names of individual model species. 

ENDPA; 

'The ENDPA command signifies the end of the command input in 
the P ACP command file. 

", 

"I 

111  , 

·I, 

" 

. 

• 

i11iilllllll1::· 
"'""'1''11"' 

1111111111, 

,, 
11'  11111 

'  , 
IPR Output Command: 

""1 

' 

·" 

' 

IPR_OUTPUT specieslfamilynamelALL {=  pcode 1 + pcode2 + ... }; 

,::11:,,, 

' 

TQ~,, If',R _OUTPUT command defines specific IPR outputs to be 
generated during a CMAQ simulation.  A species name, family 
1ll111lllll11111nrune"1'"''orthe keyword ALL must follow the IRR  OUTPUT 
keyword.  The keyword ALL refers to all model species.  IPRs are 
generated for the selected species or family, and they are controlled 
H  by the specified values of pcodei, where pcodei corresponds to one 
"'"""of the  process codes listed in Table 16-1.  If no process codes are 
, ,  specified, IPRs will be generated for every process.  The output 
111111111:,,1,,.Variables  that are generated are named either species_pcodei or 
111j':  familyname _pcodei 
"",  ,11,J, 

,,,:,,,::11111 

\u111::
',

"', 

-

ilu'  '"' 

111!1!11: 
1

1111111111111, 

"' 

',, 

111111: 

" 

I 

' 

!Iii 
111111:111111," 
111 : ' " 

A  listing of an example PACP command file is contained in Exhibit 16-1.  To facilitate the 
discussion that follows, the commands have been numbered, although this is not required by the 
PACP.  (Note that all information enclosed by curly braces in a command file is treated as 
comments.)  Each numbered line represents a command, and the input for each command is 
terminated by a semicolon.  This particular set of commands causes the CCTM to generate 
several individual IPRs for a special user-defined sub-domain.  Each of the commands is described 
below. 

Command 1 is used to restrict the process analysis output to a subset of the modeling domain. As 
noted above, output would be generated for the entire computational domain if the 
OUTPUT_DOMAIN were omitted.  Since keywords for columns and rows are not present, the 
P ACP default is to include all rows and columns in the modeling domain.  The keywords 
"LOLEV" and "HILEV" restrict the output for the vertical level to layers 1 through 2.  Thus, the 
net effect of this command is to limit the IPR output to all cells within the first two vertical levels 
ofihe modeHng domain. 

111',11''1 

,111111111 

11111111 

Commands 2 and 3 are used to define families of species.  The species names to the right of the 
equal sign are model species.  The effect of the numerical coefficients in the definition of the VOC 
families is to convert the units of the IP Rs for individual organics from ppm to ppmC.  As will be 
seen, these "defined" family names are referenced in subsequent commands. 

Commands 4 through 8 actually cause IPR outputs to be generated.  As described above, IPRs 
are generated for the species and the processes that are referenced by means of the codes listed in 
Table 16-1.  Since no process codes are specified in commands 4 and 5, IPRs will be generated 
for each of the twelve processes in Table 16-1  for the families NOX and VOC (i.e., a total of24 
IPRs).  Command 6 causes three IPRs to be generated for species 03, one each for total 
transport, chemistry, and clouds.  Command 7 causes an IPR for vertical diffusion to be generated 
for every model species.  The last command signifies the end of the command inputs. 

The CCTM will generate the IPR output data in a form comparable to the output concentration 
files.  Hence, the data are written to standard Models-3 IO/ API gridded data files.  The units of 
the IPR data are normally the same as those for the species concentration data (i.e., ppm for gas(cid:173)
phase species and either µg/m 3 or number/m3  for aerosols).  As described in the example of 
creating the family VOC with units ofppmC, however, different output units can be created using 
special family definitions. 

The example just described was formulated primarily to illustrate how IPR commands are 
structured to collect IPR information during a model simulation.  In general, the particular data 
that are collected for process analysis would be determined by the needs of the study, and thus it 
is difficult to define a "default" process analysis.  Nevertheless, a minimal process analysis for 
studying ozone formation might involve collecting the process contributions for NOx, VOC, and 
for ozone.  The example in Exhibit 16-1  could be used as the starting point for such an analysis. 
Commands 4 and 5 capture all the IPRs for NOx and VOC.  Command 6 could be modified to 
capture all IPRs for ozone as well.  Since it would not normally be necessary to capture vertical 
diffusion IPRs for all species, command 7 could be dropped.  Of course, the user would still be 
required to define the domain for outputs (command 1) and to define the voe family for the 
mechanism that is being used (command 3). Thus, commands 1through5 with command 6 
modified to collect all IPRs for ozone would provide some very basic process analysis information 
on the formatio of ozone during a simulation. 

16.2 

Integrated Reaction Rate Analysis 

The second major component of process analysis is IRR analysis.  It is applied to investigate gas(cid:173)
phase chemical transformations that are simulated in the model.  Its primary use to date has been 
to help explain how ambient ozone is formed in the chemical mechanisms that are used in 
photochemical models (e.g., Jeffries and Tonnesen, 1994; Tonnesen and Jeffries, 1994).  Thus, 
the CMAQ implementation oflRR analysis currently addresses only gas-phase reactions. 
Nevertheless, the concepts should be adaptable to the modules simulating aerosol formation and 
aqueous chemistry as well, and this is an area for future enhancement in the CCTM.  The 
remainder of this section describes how the IRRs are calculated and generated in the CMAQ 
system. 

16.2.l  Computation oflntegrated Reaction Rates 

As described in Chapter 8, the simulation of atmospheric chemistry is a key component of a 
photochemical air quality model.  The operator splitting techniques that are used in Eulerian 
photochemical models typically result in a set of nonlinear, coupled, ordinary differential 
equations (ODEs) that describe chemical interactions in the gas-phase.  Solutions to these ODEs 
are obtained using numerical solvers to compute species concentrations as a function of time. 
Again, these computed concentrations show only the net effect of chemical transformations.  As 
hns been done for physical processes, a technique has been developed to provide quantitative 
information on individual chemical transformations (Jeffries and Tonnesen,  1994).  Since the 
technique involves integrating the rates of the individual chemical reaction, the method is termed 
integrated reaction rate analysis. 

As was noted in section 8.3 .1, the mathematical expression for the rate of a chemical reaction 
tnkes one of the forms of equation set 8-3.  The reaction rate is used to compute the change in 
species concentration that is caused by the reactio.n.  Mathematically, this can be expressed as 
follows: 

· 

111'1! 

I 

, .1111111111  .M,1'(t+At)  =  ~ (t)  + r·t.i  r,  dt  , 

(16-6) 

where M1 refers to the integrated reaction rate (IRR) for reaction l,  At is the model 
synchronization time step used by the chemical solver, and r 1 is the rate of reaction l 
corresponding to one of the forms of equation set 8-3.  The value of Mi represents the total 
throughput of the reaction, and can be used with the appropriate stoichiometry to determine the 
amount of an individual species that is produced or consumed by the reaction.  For example, 
assume the IRR for the reaction A + B  -+  2C is 20 ppb for a given time period.  Then, the amount 
of A and B consumed in that time period by this reaction is 20 ppb, and correspondingly, the 
amount of C produced is 40 ppb.  Further, the net change in a species concentration due to all 
chemical reactions is equivalent to the sum of all its production terms less the sum of all its loss 
terms.  As a consequence, the contribution of each reaction to the change in concentration of any 
species is directly available from the IRRs.  With this information, it is possible to identify the 
important chemical pathways that affect species concentrations and thereby unravel the complex 
c~.~mical interactio1:1s that are being simulated. 

As described in Chapter 8-4, the chemistry solvers used in air quality models typically employ 
marching methods that compute species concentrations at the end of a time step given the 
c~,2~e~trat!~~'~"""'~t ,~,e ~ginning of the step.  Since the solvers adjust the time steps to maintain 
st~!?Hity and accuracy, the reaction rates should not vary too greatly over a given time step.  As a 
c~~~~qti~~ce, ··~·~···is  possible to use a fairly simple numerical integration technique to compute the 
IRRs.  The technique used in the CCTM is the same the one used by Jeffries and Tonnesen (1994) 
-- the trapezoid rule.  With this method, the IRRs are computed as follows: 

M, (t+/lt)  =  M, (t)  +  -[ r1(t)  +  rp+llt)]  . 

1 
2 

(16-7) 

Thus, the IRRs are simply computed from the values of the reaction rates at the beginning and the 
end of each chemistry integration time step.  As the chemistry solver marches through time, the 
variable Mt accumulates the IRRs over the simulation period.  Although an IRR could be 
accumulated for the entire simulation, more information can be gained on how the mechanistic 
processes vary with time ifthe accumulated IRRs are periodically output and the value of Mt is 
reset to zero.  In the CCTM, the IRR output is synchronized with the outputs for the 
concentration fields and the integrated process rates.  Thus, just like the IPRs, the IRRs that are 
output represent the integral of the reaction rates over the output time interval. 

16.2.2  Example IRR Analyses 

Most IRR analysis performed to date has been devoted to  studying mechanistic processes that 
affect tropospheric ozone formation.  One method that has been used involves analyzing two 
important, interacting cydes: the OH radical cycle and the NOx oxidation cycle.  This section 
contains a brief discussion of these cycles and other important chemical parameters to illustrate 
how integrated reaction rate analysis can be used to understand different chemical pathways.  For 
more comprehensive discussions, the reader is referred to Jeffries (1995), Jeffries and Tonnesen 
(1994), and Tonnesen and Jeffries (1994). 

Ozone is formed in the atmosphere via the photochemical cycle 

N02  +  hv 

....  NO+ 0(3P) 

0(3P)  +  0 2 

....  0 3 

(RI) 

(R2) 

(R3) 

If these were the only reactions taking place in the atmosphere, an equilibrium condition would be 
established that would determine the ozone concentration.  These levels are almost always lower 
than what is observed in the atmosphere because of other interactions (Seinfeld, 1998).  The 
presence of free radicals can alter the ozone production rate through the following reactions that 
are competitive with R3: 

H02  +  NO 

....  N02  +  OH 

R02  +  NO 

....  N02  +  RO . 

(R4) 

(RS) 

In these reactions, N02 is produced in reactions that do not consume ozone, thereby introducing a 
process by which ozone can accumulate.  Furthermore, these reactions are radical propagation 
reactions since a hydroxyl radical (OH) is produced from the hydroperoxy radical (H02)  and an 

16-11 

,11,,111 

'lh 

::·11ill11 

EP A/600/R-99/030 

illl!!!!I' 

,1111111111 

'illll''!'''I 

,' 

1
',,lll• 

1
!,,,,::::1!

1
!111!!:,, 

/,,'

,,,111,, 

'I 

all5:9xy radical (RO) is produced from an alkylperoxy radical (R02).  These product radicals are 
then available to participate in other reactions, some of which lead to the regeneration of the 
peroxy radicals.  Thus, the production of ozone can be viewed as an autocatalytic process since 
0 3  can be produced without the loss of its precursor N02•  In the atmosphere, however, ozone 
production is limited by termination reactions that remove either radicals or N02 from the system. 

'' 

"',  :"' 

' 

" 

' 

1111 

' 

' 

,, 

11111111111' 

""""' 

"111111111111111111"' 

The ozone formation process has been represented by means of a schematic diagram, shown in 
Figure 16-3a, 'th.at consists of two interacting cycles (Jeffries,  1995).  The top portion of the figure 
is the OH reaction cycle which consists of the three principal categories ofreactions involving 
radicals: initiation, propagation, and termination.  Radical initiation reactions are almost always 
photolytic reactions that generate ''new" radicals. Examples include the photolysis of 
formaldehyde, hydrogen peroxide and ozone . Radical propagation reactions include reactions 
such as R4 and RS  in which NO is converted to N02  but no radicals are lost.  Many reactions in 
which organic compounds are oxidized also propagate radicals.  The termination reactions 
remove radicaj~ through the formation of stable products.  The bottom portion of Figure l 6-3a 
represents the NOx oxidation cycle.  As with the radical cycle, processes in this cycle are classified 
as either initiation, propagation, or termination.  The initiation process for NOx corresponds to 
emissions of NOx, and the termination process corresponds to reactions in which NOx  is converted 
to""stable products.  The NOx cycle is connected to the radical cycle by means of the propagation 
steps that convert NO to N02• 

One form of an IRR analysis that can be conducted involves using the IRRs to develop 
quantitative information about the various initiation, propagation, and termination processes. 
Figure 16-3b shows a cycle diagram similar to  Figure 16-3a in which the IRRs have been used to 
compute the numerical values that are shown.  These values include net throughput for several 
parameters that serve to further characterize the state of the reacting system.  For example, the 
fraction of OH that is regenerated by the chemical reactions (0. 776 in Figure 16-3b) can be 
determined from the amount of OH that reacts (142.7 ppb) and the amount that is re-created 
(110.8 ppb).  This is directly related to the OH chain length parameter (4.46) which corresponds 
to the average number of times each new OH is cycled until it is removed from the system.  An 
analogous chain length parameter (5.13) can be calculated for the NOx oxidation cycle in the form 
of the NO chain length.  The longer these chain lengths, the greater the potential for 0 3  formation 
per unit ofNOx emissions.  Other parameters such as the "NO oxidations per VOe consumed" 
[(NO-NOi)NOe = 1.71]  and "03 produced per 0 3P generated by N02  photolysis" ([03]/[03P] 
= 0. 951)  further quantify the relative efficiency of ozone production, the former being particularly 
useful in providing a measure of the reactivity of the organic compounds. 

These types of analyses are particularly useful for comparing model results that are obtained using 
different chemical mechanisms or that are obtained at different locations with the same chemical 
mechanism.  Other types of IRR analyses can provide other information as well.  For example, 
IRRs have been used to allocate the total production of 0 3 to the individual voes, to examine 
individual characteristics of various chemical mechanisms such as yields of radicals from different 
organics, and to quantify other entities such as the production and loss of odd-oxygen (Ox),  which 
can serve as surrogate for tracking the formation of ozone (Jeffries and Tonnesen,  1994; 
Tonnesen and Jeffries,  1994).  It can be expected that many other types oflRR analyses will be 
developed, especially as newer and possibly more complex chemical mechanisms are developed 
and used in models. 

16.2.3  Implementation of IRR Analysis the CMAQ system 

As described in Chapter 8, the CMAQ system is designed to treat chemical mechanisms in a 
generalized manner.  Since a specific chemical mechanism is not embedded in the CCTM, a 
comparable generalized method is needed to link IRR analysis with the chemical mechanism.  The 
technique that has been incorporated in the CMAQ system is one that provides the user with the 
capability to formulate and then generate particular chemical parameters of interest.  Presumably, 
these parameters would be chosen to reveal special properties of the mechanism and/or to be used 
in generating photochemical cycle diagrams such as Figure l 6-3b.  To illustrate, a special P ACP 
command file has been prepared for the RADM2 mechanism.  For reference, a listing of the 
RADM2 mechanism is contained in Exhibit 16-2, and the reader is referred to the Models-3 User 
Manual for a detailed explanation of the mechanism format.  For purposes of the discussion that 
follows, it is sufficient to note that reaction labels are enclosed in "<" and ">" and precede each 
reaction, and that the reactants and products in each reaction are model species.  Both the 
reaction labels and the species names will be referenced in P ACP commands. 

Table 16-2 lists the chemical parameters that are produced in this example IRR analysis for the 
RADM2 mechanism. Most of these parameters could also be generated for other chemical 
mechanisms, although the specific calculations that would have to be performed would necessarily 
differ because of differences in the mechanisms.  The parameters in Table 16-2 are computed as 
simple, linear combinations of the IRRs that are calculated for each chemical reaction.  The 
domain controls that are specified for the integrated process rate outputs apply to IRR outputs as 
well.  Thus, both the IPR and IRR data will be generated for the same domain and written to 
output files at the same time intervals.  Similarly, the IRR output files are standard Models-3 
IO/API gridded files, and can be used with the standard Models-3 visualization tools.  In addition, 
a special visualization tool that can generate "default" cycle diagrams similar to Figure 16-3b is 
available and is described in Models-3 User Manual (EPA,  1998).  Note, however, that the IPR 
and IRR outputs are written to separate files. 

One of the advantages of generating IRR data in the form of chemical parameters is that the 
output file storage requirements can often be minimized.  Note that there are fewer IRR 
parameters in Table 16-2 than there are species in most mechanisms.  The major disadvantage to 
this approach is that new or different parameters cannot be computed without rerunning a model 
simulation.  As a consequence, the CMAQ implementation oflRR analysis also contains the 
option to capture the complete set of IRRs rather than  chemical parameters when a model is run. 
With this option, one IRR is generated for each chemical reaction, and these IRRs can then be 
manipulated in postprocessing routines to form any particular chemical parameter of interest. 
Thus, it would be anticipated that the chemical parameters such as those in Table 16-2 would be 
generated in fairly routine model applications, whereas IRRs for each reaction would be generated 
for  exploratory analyses.  The form of the outputs is controlled by the P ACP commands that are 
described next. 

16.2.4  Use of the PACP to set up an IRR Analysis 

As with IPR analysis, the IRR outputs that are generated by the CCTM are controlled by 
commands and special operators that are processed by the PACP.  The global commands that 
were described in the IPR section also apply to the IRR output.  Thus, family names created with 
the DEFINE FAMILY may also be used with several of the IRR commands and operators. 
Before describing how the commands are used to construct an IRR analysis, a brief description of 
each IRR command and operator is first presented.  These are divided into three groups: IRR 
global definitions, IRR operators and IRR output commands.  Again, the same syntax conventions 
ar~ used, i.e., P ACP keywords and symbols are in bold type, user supplied values are in normal 
type, alternative inputs are separated by vertical bars, and completely optional inputs are enclosed 
in braces. 

111111'111:... 

111111111111111111111,,,,1 

"111111111111111,,' 

,, 

' 

' 

1•,,:11111 

"""""""' 

""' 

' 

' '  

• 

111111 

" 

1111!'. 

' 

IRR Global Definitions: 

;1: 

I 

,,,1illl111ilh 

IRR_TYPE = FULLIP ARTIALINONE; 

,, 

The IRR_ TYPE command defines the type of IRR analysis.  With 
,,,,,the type set to FULL, IRRs for each reaction will be calculated and 
written to the IRR output file, and all other IRR commands will be 
..  ignored. IRR_TYPE set to PARTIAL indicates that the IRR 
commands following this command are to be processed to 
:"ii"produced user defined IRR outputs.  Type set to NONE causes all 
·:!!:9th~r IRR coll1Il1ands to be ignored and no IRR output to be 
generated.  If the command is omitted, type PARTIAL is assumed. 

111111

• 

DEFINE CYCLE cyclename = species 1; 

The DEFINE CYCLE command is used to compute the net of all 
chemical production and loss of a species involved in more than one 
cyclical reaction set.  Thus, this quantity is computed by summing 
,,,,,,  the IRRs for all reactions in which a species is consumed, and then 
, •• , sub!facting that sum from the sum of the IRRs for all reactions in 
which the species is produced.  The "cyclename" is a user defined 
name that must be unique, and can be referenced in subsequent 
' IRR  OUTPUT commands. 

DEFINE RxNSUM sumname = {±}{ci*}<rxlabl1>  { ±  {c2*}  <rxlabl2> :I: ... }; 

The RXSUM command is used to compute a linear combination of 
IRRs for individual reactions that can then be referenced in a 
subsequent IRR_ OUTPUT  command;  "sumname" is user defined 
and must be unique.  The linear combination of IRRs is defined 
according to the expressions following the equal signs that specify 
the reaction IRRs to sum.  The "rxlabl1"  is the reaction label that is 
used by the generalized mechanism to  identify each reaction and is 
enclosed in "<" and ">".  The "c.'' are optional numerical 
coefficients that default to one if not specified. 

IRR Output Operators: 

PROD(speciesi]  {FROM[species2]  {ANDIOR [species3]  } } 

The production operator (PROD) is  used to compute the total 
production of a species by summing the IRRs of all reactions in 
which species 1 appears as a product.  The optional qualifiers 
FROM, AND, and OR restrict th~ sum to  include only those 
reactions in which species2 and/or species3 are reactants; "species1" 
can be any gas-phase mechanism species or a family of gas-phase 
species that was defined using the DEFINE FAMILY command as 
described in the IPR section; "species2"  or species3"  may also be the 
keyword HV to restrict the selection to photolytic reactions. 

NETP[speciesiJ  {FROM[species2]  {ANDIOR [species3]  } } 

The net production operator (NETP) is very similar to the 
production operator PROD since it is used to compute the 
production of a species.  Whereas the PROD operator includes 
every reaction in which species occurs as a product, the NETP. 
operator includes only those reactions in which the net production 
of species 1 is greater than zero.  Thus, if species1 appears as both a 
reactant and a product with equal stoichiometry in a reaction, the 
PROD operator will include it but the NETP operator will not. 
This operator is useful for getting the net production of a family, 
for example, by eliminating those reactions in which the net effect 
of the reaction on the family concentration is zero. The qualifiers 
FROM, AND and OR restrict the inclusion of reactions to those in 
which species2  and/or species3  are reactants. 

LOSS[species 1]  {ANDIOR [species2]  } 

The loss operator (LOSS) is used to compute the total loss of a 
species by summing the IRRs of all reactions in which species1 
"""'appears as a reactant ...  The optional qualifier AND restricts the sum 
to include only those reactions in which both species 1 and species2 
arei:~act~ts. Similarly, the OR qualifier includes all reactions in 
which either "species1
"species1
mechanism, a family name that includes only gas-phase mechanism 
species, or the keyword HV to restrict the selection of reactions to 
those that are photolytic. 

11  or "species2"  can be any gas-phase species in the 

11  or "species2"  appears as a reactant. The 

NETL[species1]  {ANDIOR [species2]  } } 

111!•,llllllllll"I 

,'1111'" 

I 

""' 

'

''h 

,lllllll:",1111111 

'"""'"11111111 

The net loss operator (NETL) is very similar to the loss operator 
since it is used to compute the loss of a species.  However, it 
, includes only those reactions in which ther~ is a net loss of 
1:::::~'~sp'~'~ies1 11  and/or "species2"  •  Thus, if species1 appears as both a 
~eactanf and a product with equal stoichiometry in the reaction, the 
NETL operator will not include it in summing the loss of that 
species, whereas the LOSS operator will include the IRR for that 
reaction.  This operator is useful for getting the net loss of a family 
of species. 

,11, 

Ill 

,"'1111111111' 

,;1111 

NET[species1] 

I 

:111111:• 

,,1111 

The net operator (NET) is very similar to the CYCLE definition 
since it gives the net of the production and the loss of a species for 
all reactions in which "species1"  appears either as reactant or a 
product;  "species1
any family consisting wholly of gas-phase mechanism species. 

11  may be any gas-phase, mechanism species or 

1r111  I~ Output Co~~ds: 

IRR_ OUTPUT irrname =  {c1*}op1lcyclname{qual 1}lsumname{qual1}1<rxlabl1> 

{ ±  {c2*}op2lcyclname{qual2}lsumname{qual2}1<rxlabl2> + ... }; 

The IRR_ OUTPUT command defines a specific IRR output to be 
generated during a CCTM simulation.  It is constructed by 
specifying a linear combination of IRR operators, IRR global 
definitions, or IRRs for specified reactions.  Each individual term in 
the combination must include either one of the five IRR operators 
just described (i.e., opi), a cycle name, a reaction sum name, or a 
reaction label enclosed in "greater than" and "less than" signs.  The 
optional qualifiers (qual;) for cyclename or reaction sum name can· 
be either POSONL Y or NEGONL Y.  With these qualifiers, the 
defined quantity is included as a term only when it  is positive qr 
negative, respectively.  If the name is not qualified, the quantity is 
included regardless of sign.  The numerical coefficients for each 
term (c;) are assumed to  be one unless they are explicitly included. 
The irrname that is supplied by the user will be assigned as the 
variable name in the IO/API IRR output file. 

DESCRIPTION= 'description'; 

The description command is provided to allow the user to specify a 
long description of the output variable that will be included on the 
IO/ API IRR output name.  If a description is not specified for an 
IRR  OUTPUT variable, the irrname (or short name) will· be used in 
the output file.  If the description command is used, it should be 
located immediately following the IRR_ OUTPUT command to 
which it applies. 

Before describing how these commands are actually used, some additional comments are 
warranted.  First, the specification of any particular IRR output might be accomplished in several 
different ways.  For example, the net production of a species could be obtained using a CYCLE 
definition, a RXNSUM definition, a NET operator, or simply specifying the appropriate sum of 
IRRs directly in the IRR_ OUTPUT command (i.e., via reaction labels).  Although the user is free 
to choose any particular approach, some computational efficiencies may be achieved by using the 
CYCLE and RXNSUM definitions.  The CCTM has been constructed to compute these quantities 
just once, and then use them whenever they are referenced in an output command.  Conversely, 
operator quantities are recomputed every time they are referenced.  Thus, it is more efficient to 
use the RXNSUM and CYCLE commands when they can be referenced several different times in 
IRR_ OUTPUT commands. Second, the NETP and NETL operators are probably most useful for 
computing the production and loss of species families.  When these operators are used, a reaction 
is not included in the sum if there is no net loss or production of a family member in the reaction. 
Thus, all reactions are eliminated from  the computations when a member of a family  is formed 
from another member of the same family and there is no net impact on the family concentration. 
Finally, the sign conventions employed in the CMAQ process analysis need to be defined.  IRRs 
for individual chemical reactions are always positive.  Since IRRs can be subtracted when 
computing CYCLE, RXNSUM, and NET quantities, the result can be either positive or negative. 
The production and loss operators always produce positive values, however, since individual 
IRRs are always summed in their computation. 

To illustrate how these PACP commands are used to generate IRR output data, two examples are 
presented.  The first illustrates how to capture IRRs for each reaction.  The second demonstrates 
how PACP commands are used to compute the special chemical parameters in Table 16-2 for the 
RADM2 chemical mechanism. 

Ezjiibit 16~3 CQ:i:ttaJPs the ~A~}> ccmunands for the first example that corresponds to a full  IRR 
analysis since IRRs will be calculated for each and every reaction.  This option is invoked by the 
first command that specifies that the IRR analysis type is FULL.  Since no OUTPUT_DOMAIN 
command is present, the IRR outputs will be generated for every cell in the modeling domain. 
E,ilii6it 16-4 sho~~1111the p A.CP ~o~ands for the example i'R.R analy;fs that has be~~ set up  for 
the RADM2 chemical mechanism.  In a P ACP command file, all  lines that start with an 
exdamation point(!) in the first column are comments.  To facilitate the discussion below, 
eoffihient lines have been used to block the IRR commands into special groups.  The first four 
groups contain global commands or definitions.  All blocks after the first four contain the IRR 
coµl'rtjands  ~a,, igenerate the particular parameters listed in Table 16-2. 

111,,11111111' 

,,,111, 

II 

'1111111111111111 

'"'II 

I 

'11,,,, 

'llh' 

11"' 

1, 

1,, 

'I 

·"•"'I 

,111'1111111'" 

1111111 

lilil 

II'' 

, 

'" 

'""'"""' 

""' 

'11111111111111 .. ,1

1
: 

.':!.'"" 

"""""""""" 

"' 

""""' 

lllll1111lllllllll' 

'•,,,,''•' 

,' 

'""'  '" 

111111111111111111111111111:•, 

'·,11111111:":1: 

lll1'1llllllllllW:11 

',1,,,,1,,11111111111!:::11' 

'111111111111111 .11111,1111' 

The commands in the first group simply define the type of IRR analysis and the domain for which 
•  th<;1111111!l~Jl11111g,:P,!J>Uts are to be generated.  Th~ second group includes ~ru:1ily definitions.  These 
commands are of the same form as described for IPRs.  The remammg two groups of commands 
......  define cheniica.I cyCles ancfreaction sums that are subsequently referenced in IRR  OUTPUT 
commands. As noted above, the cycle commands give the net production or loss of a species by 
all chemical reactions.  Several of the reaction sums that are defined here are also cycles in that 
they generate the net effect of a few reactions on the production or loss of a few particular 
species.  Most of the others are used to define special quantities.  For example, the defined 
RXNSUM  newM02 in Exhibit 16-4 corresponds to the production of new M02, where new 
refers to an initiation reaction for the radical M02.  As is apparent from the IRR_ OUTPUT 
commands in the subsequent blocks, the cycle and reaction-sum names are referenced fairly 
fr~uently ..... . 

''"" 

" 

""""' 

, 

" 

" 

, 

-

All of the remaining blocks of commands in Exhibit 16-4 contain the commands for IRR outputs. 
Again, one IRR output is generated for each IRR_ OUTPUT command, and the outputs that are 
produced correspond to the chemical parameters listed in Table 16-2.  As indicated above, each 
output is generated by the defined linear combination of predefined cycles, reaction sums, special 
IRR operators, and/or specified reaction IRRs referenced by reaction label.  It should be evident 
that these commands are mechanism specific and require analysis of the mechanism itself to 
formulate.  Thus, this particular P ACP command file would not  be applicable to any mechanism 
other than the RADM2.  It should also be apparent that other important chemical parameters 
could be formulated and generated in an analogous manner.  In fact, this command file can be 
used as the staning point for adding to or modifying some of the selected chemical parameters. 

11 

'11 11
·1::
""1111 

1,,,,,,111111111111 
1111111111111' 

1111111111111 
'1111111111111111;,, 

,II 

111111111 

:1 

11' 

1,ll' 

As11 ~vith II>R ()1!tputs, the CCTM Wi'n generate"the IRR output data in""'a  form comparable to the 
···output coricenfiation files.  That is, the data are contained in standard Models-3 IO/API gridded 
'11!i;11111111!~11110¥1Jmts are Iii:i:~ar combinations of individual reaction throughput, and thus 
dnt,~ fjJ~~· 
have the same units as the gas-phase species concentrations (i.e., ppms).  However, it should be 

111 

'111111' 

''I' 

11" 

'11111111, 

II•' 

11111 

"' 

:1111111111 

.111111: 
,11111 

remembered that these are throughputs calculated by integrating reaction rates over the output 
time interval, and not simply abundances at a particular time. 

16.3  Conclusion 

Process Analysis is a diagnostic method for evaluating the inner workings of a model.  Although 
specific types of techniques have been performed and used in the past, new ways of examining 
and analyzing process data are likely to be developed and used in the future.  As a consequence, 
the emphasis in the CMAQ implementation of process analysis has been placed on providing easy 
methods of extracting key process data from the CCTM simulations. The CMAQ implementation 
also provides tools to allow users to customize their analyses.  These tools are designed to be easy 
to use and not require coding changes to the model. 

As noted previously, a process analysis is set up by using the P ACP before constructing and 
running a CCTM simulation.  Both IPR and IRR data can be gathered during a simulation, but 
each are written to separate output files.  To collect both sets of output during a single simulation 
requires that the PACP command file contain both the IPR commands and the IRR commands. 
Although the IPR and IRR examples have been presented separately, both sets of outputs can be 
produced with a single file containing both sets of commands.  Recall, however, that the 
OUTPUT_DOMAIN applies to both the IPR outputs and the IRR outputs.  Thus, IPR and IRR 
data cannot be generated for different parts of the domain in the same simulation. 

The P ACP program performs a substantial amount of error checking.  The program will check 
for the proper syntax of the input commands and perform some logic checking.  For example, it 
checks to make sure that all species referenced in IRR commands are gas-phase mechanism 
species and that the members of defined families are either all gas-phase species or all aerosol 
species.  As is apparent from  Exhibit 16-4, however, the inputs for a comprehensive IRR analysis 
can be fairly extensive.  As a consequence, the PACP produces an output report that summarizes 
what IRR and IPR outputs are being requested.  One of its major functions is to report on the 
effects of the special IRR operators that are used in the P ACP command file.  A user may wish to 
review this report before proceeding to run the CCTM to  insure that the desired outputs will be 
generated.  The reader is referred to the Models-3 User Manual (EPA, 1998) for an example 
output report. 

Finally, the default configuration for the CCTM is to omit process analysis outputs entirely. Thus, 
no process analysis will be generated in this configuration.  Any  process analysis must be set up 
in the Science Manager of the Models-3 framework.  The reader is referred to the Models-3 User 
Manual (EPA, 1998) for details on how this is done. 

16.4  References 

J~g, J.  C., H. E. Jeffries, D. Byun, and J. E. Pleim,  l 995a. "Sensitivity of Ozone to Model Grid 
11111,, Resolution - I. Application of High-resolution Regional Acid Deposition Model", Atmospheric 
Environment, Volume 29, No. 21, 3085-3100. 

Jang, J.C., H. E. Jeffries, and S. Tonnesen, 1995b. "Sensitivity of Ozone to Model Grid 
Resolution - II. Detailed Process Analysis for Ozone Chemistry", Atmospheric Environment, 
Volwne 29, No. 21, 3101-3114 .. 

Jeffries, H. E.,  1995. "Photochemical Air Pollution," Chapter 9 in Composition,  Chemistry,  and 
Climate of the Atmosphere, Ed. H.B. Singh, Van Nostand-Reinhold, New York, N.Y. 

Jeffries, H.E., 1996. "Ozone Chemistry and Transport'', presentation to the F ACA subcommittee 
for Ozone, Particulate Matter and Regional Haze Implementation, March 21, Alexandria, Va. 

Jeffries, H. E. and S. Tonnesen, 1994.  "A Comparison of Two Photochemical Reaction 
Mechanisms Using Mass Balance and Process Analysis", Atmospheric Environment, Volume 28, 
No.  18, 2991-3003. 

. 

'II'"' 

1111111111111 

I'"' 

Pleim, J.E.,  1990. Development and Application of New Modeling Techniques for Mesoscale 
Atmospheric Chemistry, Ph.D. Thesis, State University of new York at Albany, Albany, New 
York. 

111111111' 

Seinfeld, J. H. and S. N. Pandis,  1998.  Atmospheric Chemistry and Physics,  From Air Pollution 
to Climate Change, John Wiley and Sons, New York, New York. 

Tonnesen, S. and H.  E. Jeffries, 1994.  "Inhibition of Odd Oxygen Production in the Carbon Bond 
Four and Generic Reaction Set Mechanisms", Atmospheric Environment, Volume 28, No. 7, 
1339-1349. 

This chapter is taken from Science Algorithms of the EPA Models-3 Community 
Mu/tiscale Air Quality (CMAQ) Modeling System, edited by D. W. Byun and J. K. S. 
Cbing, 1999. 

16-20 

Table 16-1. 

CCTM Processes and PACP Codes 

P ACP Code  Process Description 

EP A/600/R-99/030 

Vertical advection 
Mass adjustment for advection 
Horizontal diffusion 
Vertical diffusion 
Emissions 
Dry deposition 

X.ADV Advection in the E-W direction 
Y ADV Advection in the N-S direction 
ZADV 
ADJC 
HDIF 
VDIF 
EMIS 
DDEP 
CHEM Chemistry 
AERO 
CLDS 
PING 

Aerosols 
Cloud processes and aqueous chemistry 
Plume-in-grid 

Note:  The following process codes can also be used in the P ACP. 

XYADV  Sum ofX.ADV and YADV 
XYZADV  Sum ofXADV, YADV, and ZADV 
TOTADV  Sum ofXADV, YADV, ZADV, and ADJC 
TOTDIF  Sum of HDIF and VDIF 
TOTTRAN Sum of XADV, YADV, ZADV, ADJC, HDIF and VDIF 

Chemical Parameters Used in Default IRR Analysis 

Table 16-2. 

'11111;,,, 

'111111111 

{ 1}  Production of Odd Oxygen (Ox) 
{2}  Loss of Odd Oxygen (Ox) 
{3}  Production ofNOz from NOx 
{ 4}  Production of NOx from NOz 
{5}  Production of new OH from OlD 
{6}  Production of new OH other than from 010 
{7}  Production of new H02 
{8}  Total production ofH02 
{9}  Production of new R02 
{10}  Total Production of R02 
{ 11}  Loss of CO and CH4 by reaction with OH 
{12}  Production of OH from H02 
{13}  Production ofN02 from H02 
{14}  Production ofN02 from R02 
{15}  Production of PAN and TPAN 
{16}  Net Production of organic nitrates 
{17}  Loss ofVOCs by reaction with OH 
{18}  Loss of OH by reaction with organics 
{19}  Net Production or Loss ofHN03 
{20}  Loss ofHCHO by reaction with OH 
{21}  Loss of isoprene by reaction with OH 
{22}  Production of new H02 from HCHO 
{23}  Production ofH02 from PAN 
{24}  Production of H02 from R02 and NO 
{25}  Production ofH02 from R02 reacting with R02 
{26}  Production of R02 from OH 
{27}  Production of HN03 from N02 reacting with OH 
{28}  Production of new OH from H202 
{29}  Production of new OH from organic peroxides 
{30}  Production of OH from HONO 
{31}  Termination of OH 
{31}  Termination ofH02 
{31}  Termination of H02 by reaction with R02 
{34}  TerminationofR02 
{35}  Termination ofR02 by reaction with H02 
{36}  Termination ofR02 by reaction with R02 
{37}  Loss of OH by reaction with daughter VOCs 

Example P ACP Command File for IPR Analysis 

Exhibit 16-1. 

{1}  OUTPUT  DOMAIN=  LOLEV[l]  +  HILEV[2]; 

{2}  DEFINE  FAMILY  NOX 

NO  +  N02; 

{3}  DEFINE  FAMILY  voe 

{4}  IPR_OUTPUT  NOX; 

{s}  IPR_OUTPUT  VOC; 

2.0*ETH  +  2.9*HC3  +  4.8*HCS  +  7.9*HC8 
+  2.0*0L2  +  3.8*0LT  + 
4.8*0LI  +  S.O*ISO  +  7.l*TOL  +  8.9*XYL 
+  l.O*HCHO  +  2.4*ALD; 

{6}  IPR  OUTPUT  03  =  TOTTRAN  +  CHEM  +  CLDS; 

{-7}  IPR  OUTPUT  ALL  =  VDIF; 

{a}  ENDPA; 

16-23 

<  P2>  03 
<  P3>  03 
<  P4>  HONO 
<  PS>  HN03 
<  P6>  HN04 
<  P7>  N03 
<  PB>  N03 
<  P9>  H202 
.CP10>  liciio 
111  HIC1H'O 
1111111111111· 
~"~~~;  Aili 
<Pl3>  OPl 
<Pl4>  OP2 
<PlS>  PAA 
<Pl6>  KET 
<P17>  GLY 
<Pl9>  GLY 
<Pl9>  MGLY 
<P20>  DCB 
<P21>  ONIT 
<  1>  03P  +  02  +  M  • 
.C'"'  2>  03P  +  N02 
'!S,,,,H,,  3~  Q:!:D  +  !:!,~,, 
4>  OlD  +  02 
< 
5>  010  +  H20 
< 
6>  03  + 
NO 
< 
HO 
7>  03  + 
< 
<  8>  03  + 
H02 
9>  H02  + 
< 
NO 
<  10>  H02  + 
N02 
<  11>  HN04 
c;,,12>  H02  +  H02 
<  13>  H02  +  H02  +  H20  • 
<  14>  H202  +  HO 
.C"  15>  NO  +  HO 
<  16>  NO  + 
NO 
<  17>  03  + 
N02 
NO 
~111111,,,,lB>  Nq~  + 
''""N102 
"iillllllll" ~ 9 >  ~~II~  + 
'"""ito2 
'!\'.  20>  N03  + 
~;,,,,,  ~;> N03  + 
"'  ,~02 
<  22>  N2os 
J""" :23 >  ti2os  +  ii20 ,, 
Ho  + 
111111111 
'No2 
j11:':i  ~:: Hd  +  lllllllHNo:illllllllll 
Jlli1111111:2G'>  HO  +  1111111lii.zoi11111111111111 
~;;;1;::>2?>  HO  +  ,1111111H102 
1111111111 
<  28>  HO  +  "11111:~,',',,,,,',o,',, 2 
Jlllllll' 2"' 9">'  ' co 
i1111111"'":3 0 >  iio 
+  ""~o 
1 
"111'111' 
111111111111' 
~111111" 31 > " ETH  +  HO 
<  32>  HC3  +  HO 
lllllliiii!·:11 
1llh1111111111111111!111::;: 
~111111'.  33> 

,,, 

II 

11111134> 
~111  35> 
~1111""36> 
<11111111111·371> 

HCS  + 
''lio 
~~a  + 
OL2  + 1111  lllllllllllHO 
ot:i'  + 
'ii"o 
ol:i  +  "'iio 

•  2.0*  HO 

03 
NO 
03P 
03P 

N02 
H02 
HO 
N02 
HN04 
H02 
H202 
H202 
H02 
HONO 

N03 

+  02  "'  2.0*N02 

1!111 

+ 

+ 

NO 

03P 

+ 
+ 
+ 

o3P 
01D 
03P 
HO 
HO 
H02 
NO 
N02 

NO 
N02 
N02 

# '' 11i.o 
II  1.ci 
#  1.0 
#  1.0 
#  1.0 
#  1.0 
#  1.0 
#  1.0 
#  1.0 
#  1:0 
,,,,,  #  1. o 
f  1.o 
#  1.0 
#  1.0 
#  1.0 
#  1.0 
#  1.0 
#  1.0 
+ 
#  1.0 
#  1.0 
0.020*AC03 
0.800*KET  +  H02  +  N02  #  1.0 

co 
co 
HO 
HO 

•  2.0*  HO 
co 
H02 
M02 
HCHO 
ALO 
M02 
AC03 

HC)2 
H02 
H02 
H02 
HO 
ETHP 
•  0.13*HCHO  +  1.870*CO 
•  0.4S*HCHO  +  1.sso•co  +  0.800*H02 

+ 
+ 
+ 
+ 
+ 
+ 

•  0.98*H02  + 
•  0.20*ALD  + 

CO 
TC03 

+ 
+ 
+ 
+ 

AC03 

H02 

+ 

+ 

1:1111·1:"1;;:,,,1::1',,,, 

/<No~''""1:w:>M8B~; 
/<030lD_RADM88>; 
/<0303P_RADM88>; 
/<HONO_RADM88>; 
/<HN03_RADM88>; 
/<HN04_RADM88>; 
/<N03NO_RADM88>; 
/<N03N02_RADM88>; 
/<H202  RADM88>; 
/<Hc.Hcimo1  RADM88>; 
( <Hciiorad - RADM8 0 >; 
/<ALo:_:RAnM88>; 
/<MHP_RADM88>; 
/<HOP_RADM88>; 
/<PAA_RADM88>; 
/<KETONE_RADM88>; 
/<GLYform_RADM88>; 
/<GLYmol_RADM88>; 
/<MGLY_RADM88>; 
/<UDC_RADM88>; 
/<ORGNIT  RADM88>; 

#  6.0E-34A-2.3;-
#  6.SE-12 
@  -120.0; 
#  1.8E-ll  @  -110.0; 
#  3.2E-11 
#  2.20E-10; 
#  2.00E-12  ®1400.0; 
#  l.60E-12  ®  940.0; 
#  l.lOE-14  ®  500.0; 
#  3.70E-12  ®  -240.0; 

®  -70.0; 

+ 

+ 

HO 

N02 
If 
\-3 
\-3  # 

#  l.8E-31A-3.2  &4.7E-12A-l.4; 
#  2.lE-27  ®  -10900.0  *E<  10>; 
2.20E-13®-620.0  &  l.90E-33®-98~.0; 
3.08E-34@-2820.0  &  2.66E-54@-3180.0; 

#  7.0E-31A·2.6  &l.5E-11A·0.5; 

#  3.3008-12  @  200.0; 

#  3.300E-39@  -530.0; 
#  l.4000E-13  ~  2500.0; 
#  1.7000E-ll@  -150.0; 
~'''  2. SOOOE-14  ®  123§:. 0; 
#  2.sciooE-i2; 

2.0*N02 

NO 
HN03 
N205 
N02 

2'~ O*HNOJ 

+ 

+ 

HN03 
NOJ 
N02 

N02 

N03 

t2  #7. 2El'-15@-785&4. 1Ei"-i6®-i44o&1. 9E-33@-'72s; 

#  2.2E-30A-4.3  &l.5E-12A·0.5; 
#  l.lOE-27  ®  -l1200~0. *E<21;; 
#  2.00E-2l; 
. 
#  2 .6E-JOA -3. 2 .,,&2. 4E .. ~ 11A-1.3; 
lr 1.3ci6oi~1"2  @ -3BO .O; 
"#"  4.6000E-if  ®  -236.6; 

' 

#  3.0E-Jl:...·J.3  &l.SE-12AO.O; 

\-1.  #1.5000E,~13;  , .. , 

,,. 

' 

•  SULF  +  H02  +  SULAER 

H02 
M02 
ETHP 

(X  300  SQUARED) 
(X  300  SQ~ED) 

.. 

0. s'J*HCJP  +, O. ~ 7*H02  +,  O. 009*HCHO  "' 

0.025;.:KET 

HCSP  +  0.250*X02 
HC8P  +  o. 750*X02  +  HC8AER 
OL2P 
OLTP 
'oil:P  +  oLr.i>.ER 

""'""" 
®  1280.0; 

11'  2B.3"2 
#  l.23JE-12A2  ®  444.0; 

.f.  O. o7s•Af.o 

' 

#  1.S9E-ll  ,,,,,,,!i.  540.0; 
#  i.73E;:11  ®  3~0:0; 
#  3. 64'E:-11  "  ®  38,,o ~,  oi,, 
f, 2.15E-12  @  -411.0; 
#  s:32E:1:2  @  -so4:o; 
#  i.01E:~1:i.  @  -549.o, 
,111 
ii'' 
,.:II 

~?ch!h!,!,,,,J~-:~,;,,,,,,, Lfa!i11g of the RADM2 Chemical Mechanism 
11111111111'"1 

""1111,",1 

11111!1 

"1111111111 

'111111111:" 

'1:::1: 
11111111111, 

'".:,,·,',',,'1111.:··.:111' 
' ' ' I 111 : : ~ ! 11 ' II : ! ' 
I 
1
1
:ii,1
,,  "
:::!!!!:, 
1,.11111111"!1 

' "  

11

"'11"""11111'" 
'!1:! 1::1111
i I i i 11111 " ~ 1111 
111!!!iiil1111,,, 
11111.1111111: 

""'II 

1,6-24 

'lll,,111111111' 

1111111111'" 

'"11' 

':111111' 

11111"11 

Exhibit 16-2.  Listing of the RADM2 Chemical Mechanism 

EP A/600/R-99/030 

<  38>  TOL  +  HO 

<  39>  XYL  +  HO 

<  40>  CSL  +  HO 

<40a>  CSL  +  HO 
<  41>  HCHO  +  HO 
<  42>  ALO  +  HO 
<  43>  KET  +  HO 
<  44>  GLY  +  HO 
<  45>  MGLY  +  HO 
<  46>  DCB  +  HO 
<  47>  OPl  +  HO 
<  48>  OP2  +  HO 
<  49>  PAA  +  HO 
<  50>  PAN  +  HO 
<  51.>  ONIT  +  HO 
<  52>  ISO  +  HO 
<  53>  AC03  +  N02 
<  54>  PAN 
<  55>  TC03  +  N02 
<  56>  TPAN 
<  57>  M02  +  NO 
<  58>  HC3P  +  NO 

<  60>  HC5P  +  NO 

<  62>  HC8P  +  NO 

<  64>  OL2P  +  NO 
<  65>  OLTP  +  NO 
<  66>  OLIP  +  NO 

<  67>  AC03  +  NO 
<  68>  TC03  +  NO 

0.75*TOLP  +  0.250*CSL  +  0.250*H02 
+  TOLAER 
0.83*XYLP  +  O.l.70*CSL  +  0.170*H02 
+  XYLAER 
O.l.O*H02  +  0.900*X02  +  0.900*TC03 
+  CSLAER 

CSL 
H02 
AC03 
KETP 
H02  + 
AC03 
TC03 

+ 

co 

2.000*CO 
co 
+ 

0.5*M02  +  0.500*HCHO  +0.500*HO 
0.5*HC3P  +  0.500*ALD  +  0.500*HO 

+ 

N02 

AC03 
HCHO  +  N03  +  X02  (x  300  sq) 
HC3P 
OLTP 
PAN 
AC03 
TPAN 
TC03 
HCHO 

N02 
H02 

N02 

+ 
+ 

N02 

+ 

+ 

0.75*ALD  + 

0.25*KET  +  0.09*HCHO 

+  0.964*N02  +  0.964*H02 
= 0.38*ALD  +  0.69*KET  +  O.OS*ONIT 
+ 

0.92*N02  +  0.92*H02 
0.35*ALD  +  1.06*KET  +  0.04*HCHO 

+  0.24*0NIT  +  0.76*N02  + 

0.76*H02 

l..6*HCHO  +  H02  +  N02  +  0.20*ALD 

+  HCHO  +  H02  +  N02 

ALD 
H02  +  l..45*ALD  + 
N02 
N02 

+  O.l.*KET 
M02 
N02  +  0.920*H02  + 
+  0.050*AC03  +  0.950*CO 

+ 

+ 

0.28*HCHO 

#  2.lOE-12  ®  -322.0; 

It  l.89E-ll.  @  -116.0; 

#  4.00E-l.l.; 
#  0.9*K<40>; 
#  9.0000E-12; 
#  6.8700E-12@  -256.0; 
#  1.2000E-ll.  ®  745.0; 
#  l.1500E-ll; 
#  1. 7000E-ll.; 
II  2.8E-11; 
#  1.0000E-l.1; 
II  l..OOOOE-11; 
11  1. OOOOE-l.l; 
#  6.1650E-13A2 
II  1. 5500E-ll. 
#  2.5500E-11 
II  2.8000E-l.2 
#  l..9500E+l.6 
#  4.7000E-l.2; 
#  1.9500E+l.6 
II  4.2000E-l.2 
+  0.036*0NIT 
II  4.2000E-l.2  ®  -180.0; 

@  540.0; 
@  -409.0; 
@  -181..0; 
@  l.3543.0; 

@  1.3543.0; 
@  -180.0; 

@  444.0; 

#  4.2000E-12  ®  -l.80.0; 

#  4.2000E-l.2 
#  4.2000E-12 
11  4.2000E-12 

@  -180.0; 
@  -l.80.0; 
®  -l.80.0; 

#  4.2000E-12 
II  4.2000E-l.2 

@  -1.80.0; 
@  -180.0; 

0.890*GLY  +  O.ll.O*MGLY 
+ 

2.000*X02 

<  69>  TOLP  +  NO 

N02  +  H02  +  O.l.7*MGLY 

<  70>  XYLP  +  NO 
<  71.>  ETHP  +  NO 
<  72>  KETP  +  NO 
<  73>  OLN  +  NO 
<  74>  HCHO  +  N03 
<  75>  ALO  +  N03 
<  76>  GLY  +  N03 
<  77>  MGLY  +  N03 
<  78>  DCB  +  N03 
<  79>  CSL  +  N03 

<  80>  OL2  +  N03 
<  Bl.>  OLT  +  N03 
<  82>  OLI  +  N03 
<  83>  ISO  +  N03 
<  84>  OL2  +  03 

+ 

0.70*DCB 
.45*MGLY  + 

.806*DCB 

H02  + 

N02 

0.16*GLY  + 
N02  +  H02  + 
ALO 
+ 
MGLY  + 
HCHO 
H02 
AC03 
HN03 
HN03 
HN03 
HN03 

+ 
+ 
+ 

+ 
+ 
+ 

+ 

+ 

N02 
ALD  + 
HN03 
HN03 
H02  + 
AC03 
TC03 

H02 

2.0*N02 
co 

+ 

2.000*CO 
co 

+ 

XN02 

+  0.500*CSL 

+  O.SOO*CSLAER 

OLN 

OLN 
OLN  +  OLIAER 
OLN 
HCHO  +  0.400*0RAl.  +  0.420*CO 

ii  4.2000E-l.2 

@  -l.80.0; 

11  4.2000E-l.2 
#  4.2000E-l.2 
#  4.2000E-12 
11  4.2000E-l.2 
It  4.20008-12 
It  6.000E-13 
ll  l..400E-12 
It  6.000E-l.3 
#  l..400E-12 
#  l.400E-l.2 

fl  2.200E-11; 
#  2.000E-12 
It  1. OOOE-11. 
11  3.230E-l.l. 
#  5.BlOE-l.3; 

®  -1.80.0; 
@  -l.80.0; 
Cil  -l.80. O; 
@  -180,0; 
@  -l.80.0; 
@  2058.0; 
@  l.900.0; 
(jl  2058.0; 
@  l.900.0; 
@  1900.0; 

@  2923.0; 
@  l.895.0; 
@  975.0; 

<  85>  OLT  + 

03 

0.53*HCHO  +  O.SOO*ALD  + 

0.33*CO  +  0.20*0RA1 

+  0.20*0RA2  +  0.23*H02  + 

0.22*M02  +  O.lO*HO 

+  O.l.20*H02 

#  l.. 200E-14 

@  2633.0; 

#  1.3200E-l.4  @  2105.0; 

<  86>  OLI  + 

03 

O.l.B*HCHO  +  0.72*1>.LD  + 

O.l.O*KET  +  0.23*CO  +  0.06*0RAl. 

EXhibit  i6-2:  Listing of the RADM2 Chemical Mechanism 

< 87>  ISO  + 

C3 

+  0.29*CRA2  +  0.26*HC2  + 
+  CLIAER 
•  0.53*HCHC  +  O.SOO*ALD  + 
+  0.20*CRA2  +  0.23*HC2  + 

0.14*HC  +  0.3l*MC2 

#  7.2900E-15  @  1136.0; 

0.33*CC 

+ 

0.20*CRA1 

0.22*MC2  + 

0.10*HO 

li111llll 

<  88>  H02  + 
< 89>  H02  + 
<  90>  H02  + 
-< ...  91>  H02  + 
1\i,,,,,  941>  H02  + 
<93>  H02  + 
c  94>  H02  + 
<  95>  H02  + 
<  96>  H02  + 
<  97>  H02  + 
<  98>  H02  + 
~"""···99>  H02  + 
<100>  H02  + 
<l.01>  H02  + 
<l.02>  M02  + 
<103>  M02  + 
<104>  M02  + 

,  ""

CPl 
CP2 
CP2 
CP2 
CP2 
CP2 
CP2 
CP2 
CP2 
PAA 
CP2 
CP2 
CP2 
CNIT 

MC2 
ETHP  • 
HC3P  • 
HCSP  • 
HCSP  • 
OL2P  • 
CLTP  • 
CLIP  • 
J<ETP  " 
ACC3  • 
TOLP  • 
XYLP  • 
11Tco3 "'"· 
CLN 
M02 
ETHP  •  0.7S*HCHO 
HC3P  •  0.84*HCHC  +  0.770*ALD  + 

l.S*HCHO 

HC2  + 

HC2 

+ 

+ 

• 

0.75*ALD 

0. 26{J*KET 

+  1. OOO*HC2 

<10S>  M02  +  HCSP  •  0.77*HCHC  +  0.4l*ALD  + 

0.75*KET 

<106>  H02  +  HCSP  •  O.SO*HCHC  +  0.46*ALU  + 

l.39*KET 

+  1. OOO*HC2 

+  1.000*HC2 

HC2 
<l.07>  MC2  + 
<108>  M02  + 
HC2 
<l.09>  M02  +  CLIP  •  0.89*HCHC  +  0.725*ALD  +  HC2 

l..SS*HCHC  +  0.3SO*ALD  + 
l..2S*HCHC  +  0.750*ALD  + 

OL2P  • 
CLTP  • 

+  O.SS*KET 

<110>  H02  + 
<ll.l>  M02  + 

KETP  •  0.75*HCHC  +  0.750*MGLY  +  HC2 
ACO~  •  HCHC  +  O.S*HC2  +  O.S*MC2 

~"h2> 1111 Md2  + 

.111111"'' 
,,,1111111' 

111

,, 

;1'  .,''I 

<:n .. :1.13>  M02  + 

;1111:,,,1111 

1111 111111111111+ 

TOLP  "' 
.. ··.  + 
,,;igLP  • 

... ,,1111111•· 
11:"!111111 

''''11:::11111 
I 
':1111 
,,,,,,1111111. 

O.SO*CRA2 
HCHC  +  er. i 7~MGLY +  0. 16*GLY 
O. 70*DCB  .  +  2. O*HC2 
'HCHO  +  o".4s•MGLY  +  0.806*DCB 
" 

' " '  

,, 

+  2. OOO*HC2  . 

cl.l.4>  M02  + 

TCO~  • 

.SO*HCHC  +  0.445*GLY  +  O.OSS*MGLY 
+  O.SO*CRA2  +  0.025*ACC3  +  0.460*HC2 
+  0.475*CC  +  XC2 

<138>  H02  +  CLN 
<115>  ETHP  +  AC03  • 

1.7S*HCHO  +  O.SO*H02  +  ALD  +  N02 
ALD  +  O.S*HC2  + 
0.5*  CRA2 

O.S*MC2 

<l.16>  HC3P  +  AC03  • 

.77*ALD  +  0.26*  KET+  O.S*HC2 

fl  l.230E-14 
#  7.700E-14 
#  7.700E-14 
#  7.700E-14 
#  7.700E-14 
#  7.700E-14 
#  7. 700E-14 
7.700E-14 
# 
7.700E-14 
# 
# 
7.700E-14 
#  7. 700E-14 
#  7.700E-14 
7.700E-14 
# 
7.700E-14 
# 
7.700E-14 
# 
It 
1.90E-13 
It 
l.40E-13 

'"' 

'"' 

Ill' 

@  2013.0; 
@  -l.300.0; 
®  -1300.0; 
@  -1300.0; 
@  -1300.0; 
@  -1300.0; 
®  -1300.0; 
@  -1300.0; 
®  -1300.0; 
®  -1300.0; 
®  -1300.0; 
@  -1300.0; 
@  -1300.0; 
@  -1300.0; 
(j)  -1300.0; 
@  -220.0; 
(i)  -220.0; 

It  4.20E-14  <il  -220.0; 

It  3.40E-14  ®  -220.0; 

#  2.90E-14 
#  1.40E-13 
#  1. 40E-13 

®  -220.0; 

@  -220.0; 
@  -220.0; 

It  1. 70E-l4 
#  1.70E-14 

(i)  -220.0; 
@  -220.0; 

fl  9.60E-13 

@  -220.0; 

#  1.70E-14 

@  -220.0; 

#  l.70E-14 

@  -220.0; 

#  9.60E-13 
It  1. 70E-14 

@  -220.0; 
(j)  -220.0; 

If  3 .40E-13 

®  -220.0; 

<117>  HCSP  +  ACC3  - 0.4l*ALD  +  0.75*KET  + 

,,  ,,,+  O.SO*MC2  +  0.5*CRA2 

0.5*HC2 

#  8.40E-14  ®  -220.0; 

+  O.SO*M02  +  O.S*CRA2 

#  l.OOE-13 

<il  -220.0; 

'" 

' 

' 11 : '  " 11 " ' 

111 " ' 1111111 11 : : : ' ' 
:,,,,,'llliiiii:,,'" 

..  D  +,,,  l.39*KET  +  O.S*HC2 

"';,,,,,,+  O.SO*MC2  +  O.S*ORA2 

<118>  HCBP  +  AC03  •  0.4,, 6., *AL 
i '1 i 
' 
~1ll9> odP  +  ACC3  - o.ao.:"i-icHC  +  0.6*ALD  +  O.S*HC2 
~11· 
'I'""'.. 
c 1i20>  CLTP  +  ACC3  • 
i!1111'~!i:' 
<121>  OLIP  +  AC03  •  0.725*ALD  +  O.SS*KET  + 
''""'"' 
<122>  KETP  +  AC03  • 

"'  +  O.S*HC2  +  O.SO*M02  +  0.5*CRA2 

ALD  +  0. S*HCHC  +  0. 5*HC2 

·::· 1,,,,,.+  O • 5 *M02  +  O . 5 *oRA2 

MGLY  +  O.S*HC2  + 

,a,,,; ~f~.02, :r.· 

,,,  0'1111~,:,,~··a~2 

0.5*MC2 

::::;~!!11111111:' 

"11:1:·11111111"': 
"i:i  111111' 

'""''""""' 

!!!:::;!!!:::::::,t 

,"  "'""" 

'""' 

' 

,, 

1

0.14*HCHC 

<123>  ACOJ  +  ACC3  • 
<124>  AC03  +  TOLP  • 
+ 

+  O.S*ORA2 
2.0*M02 
MC2  +  0.170*MGLY  +  0.16*GLY 
0.70*DCB  + 

HC2 

16-26 

' 

#  7.20E-14  ®  -220.0; 

' 

#  3.40E-13  ®  -220.0; 

#  3.40E-13 

<il  -220.0;_ 

#  4.20E-14 

,. 

®  -220.0; 

#  4.20E-14 
#  1.l9E-12  @  -220.0; 

@  -220.0; 

#  4.20E-14 

<il  -220.0; 

Exhibit 16-2.  Listing of the RADM2 Chemical Mechanism 

<125>  AC03  +  XYLP 

M02  +  0.45*MGLY  +  0.806*DCB 

+ 

H02 

#  4.20E-14 

@  -220.0; 

EPAJ6DD/R-99/030 

#  l.19E-12  ®  -220.0; 

#  4.20E-14 
#  3.60E-16  @  -220.0; 

®  -220.0; 

@  -220.0; 

#  7.?0E-14  @  -1300.0; 
#  1.70E-14  @  -220.0; 
#  4.20E-14 
II  3.60E-16  ®  -220.0; 
#  4.2000E-12  ®  -180.0; 
#  4.2000E-12  @  -180.0; 
#  7.70E-14  ®  -1300.0; 
#  1. ?OE-14  ®  -220.0; 
#  4.20E-14 
II  3.60E-16  @  -220.0; 
II  1.0*K<37>; 
#  l.O*K<82>; 
#  1.0*K<86>; 

@  -220.0; 

<126>  AC03  +  TC03 

M02  +  0.92*H02  + 
0.11*MGLY  +  0.05*AC03  +  o.95•co 

0.89*GLY 

+ 
+  2.0*X02 

<139>  ACOJ  +  OLN 

HCHO  +  ALO  + 

0.5*0RA2 

+  N02  +  o.5*  M02 

<140>  OLN  +  OLN 

2.0*HCHO  +  2.0*ALD  +  2.0•N02 

<127>  X02  +  H02 
<128>  X02  +  M02 
<129>  X02  +  AC03 
<130>  X02  +  X02 
<131>  X02  +  NO 
<132>  XN02  +  N02 
<133>  XN02  +  H02 
<134>  XN02  +  M02 
<135>  XN02  +  AC03 
<136>  XN02  +  XN02 
<AE1>  TERP  +  HO 
<AE1>  TERP  +  N03 
<AEl>  TERP  +  03 

endmech 

OP2 
HCHO 
M02 

N02 
ONIT 
OP2 
HCHO 
M02 

+ 

H02 

+ 

H02 

TERPAER  +  HO 
TERPAER  +  N03 
TERPAER  +  03 

Exhibit 16-3:  Example PACI> Command File for a Full IRR Analysis · 

16-28 

Exhibit 16-4.  Example P ACP Commands for a.Partial  IRR Analysis 

!************••••······················································· 

Example  PACP  Command  File  illustrating  Partial  IRR  Analysis 

!************************************••····················~············ 

!  IRR  type  and  domain  commands 

IRRTYPE  = PARTIAL; 
OUTPUT_DOMAIN  = LOLEV[l]  +  HILEV[2]; 

!  Family  Definitions 

DEFINE  FAMILY  OX 

DEFINE  FAMILY  NOZ 

DEFINE  FAMILY  NOX 
DEFINE  FAMILY  VOCA 
DEFINE  FAMILY  R02 

DEFINE  FAMILY  voe 

DEFINE  FAMILY  dauHC 

03  +  N02  +  2*N03  +  03P  +OlD  +  PAN  +  HN04  +  3*N205  + 
TPAN  +  OLN  +  HN03  +  ONIT1 
PAN  +  TPAN  +  HONO  +  HN04  +  N03  +  N205  +  ONIT  + 
OLN  +  HN03; 
NO  +  N02; 
OL2  +  OLI  +  OLT  +  ISO; 
M02  +  ETHP  +  HC3P  +  HCSP  +  HC8P  +  0L2P  + 
OLTP  +  OLIP  +  TOLP  +  XYLP  +  AC03  +  KETP  + 
TC03  +  X02  +  XN02; 
{CH4  +}  CO  +  ETH  +  HC3  +  HCS  +  HC8  +  OL2  +  OLT  + 
OLI  +  ISO  +  TOL  +  CSL  +  XYL  +  HCHO  +  AU>  +  KET  + 
GLY  +  MGLY  +  DCB; 
CSL  +  KET  +  GLY  +  MGLY  +  DCB  +  OPl  +  OP2  + 
PAA  +  PAN  +  ONIT; 

I  Cycle  Definitions 

DEFINE  CYCLE  PANcyc 
DEFINE  CYCLE  TPANcyc 
DEFINE  CYCLE  HONOcyc 
DEFINE  CYCLE  HN04cyc 

PAN; 
TPAN; 
HONO; 
HN04; 

!  Reaction  Sum  Definitions 

DEFINE  RXNSUM  N03cyc 
DEFINE  RXNSUM  N205cyc 
DEFINE  RXNSUM  H202 _OHcyc 
DEFINE  RXNSUM  HN03_0Hcyc 
DEFINE  RXNSUM  OPl_OHcyc 
DEFINE  RXNSUM  OP2_0Hcyc 

., 

DEFINE  RXNSUM  PAA_OHcyc 
DEFINE  RXNSUM  HN04 _H02cyc 
DEFINE  RXNSUM  OP2_H02cyc 

P7>  - <  PS>  - <  18>  - <  19>; 
22>; 
12>  - <  13>; 
24>1 
88>; 

<  17>  - < 
<  2l.>  - < 
<  P9>  - < 
<  PS>  - < 
<Pl3>  - < 
<P14>  - < 
<  93>  - < 
<  98>  - < 
<PlS>  - < 
<  P6>  +  < 
<P14>  - < 
-
<  93>  - < 
-
<  98>  - <  99>  - <100>  {- <101>}  - <127> 

89>  - <  90>  - <  91>  - <  92> 
94>  - <  95>  - <  96>  - <  97> 
99>  - <100>{  - <101>}; 
97>; 
11>  - <  10>; 
89>  - <  90>  - <  91>  - <  92> 
94>  - <  95>  - <  96>  - <  97> 

--

-

Exhibit 16-4.  Example P ACP Commands for a Partial  IRR Analysis 

DEFINE  RXNSUM  HOXcyc 
DEFINE  RXNSUM  newM02 
DEFINE  RXNSUM  newAC03 
DEFINE  RXNSUM  newETHP 
DBPINE  RXNSUM  newTC03 
DKFINE  ~SUM .PAN  AC03cyc 
DEFINE  RXNSUMTPAN_TC03cyc 
!DEFINE  RXNSL'M  propR02_NO 

8>; 

7>  - < 

< 
<Pl2>  +  0.22*<  85>  +  0.31*<  86>  +  0.22*<  87>; 
<Pl6>  +  <Pl9>  +  0.02*<P20>  +  <  77>; 
<Pl6>; 
<P20>  +  <  78>; 
s  <  54>  - <  53>; 
<  56>  - <  55>; 

- ~67> +  4.05*<68>  +  1.5*<126>; 

ii,,'::1111: 

::111::::1111111: 

111111::::.. 
~·••••••••••••••••s•••==••a=~=2•=====•=ss====~==c===••======•=zz===••m=c 
I  IRR_OUTPUT  1:  OX  Production 
l••••••••••••••••••••=••••===2ssa::sc3mc:==~•&ac:=2•=•====23mc===2z•3a== 
IRR_OUTPUT  OXprod  ~  NETP[OX]; 

' 

.•• 

!!,gsCRIPTION  • 

'ox  Production' ; 

11111111111" 

'1111111111 

1111111: 

1111 

f••••••••••••••••••~•*&••=2•••==•••==~ssz====c======c3c======m=====s•=== 
I  IRR_OUTPUT  2:  ox  Loss 
l•••••••••••••••••••=•••••==c•az=•••n===~~•£====2:cc=:=mc~======a•c===== 
IRR_OUTPUT  OXloss 

NETL[OX]; 

DESCRIPTION.  'OX  Loss'; 

I  IRR_OUTPUT  3:  Production  of  NOZ  from  NOX 

:i;~_OUTPUT NOZfromNOX.  PANcyc[POSONLY)  + 
TPANcyc[POSONLY]  + 
HONOcyc[POSONLY]  + 
HN04cyc[POSONLY]  + 
N03cyc[POSONLY)  + 
N205cyc[POSONLY]  + 

0. 024*<  62>  + 
Ill:' 
DESCRIPTION•  'NOZ  produced  from  NOX'; 

<132>; 

<  24>  +  0.036*<  58>  +  0.08*<  60>  + 

I  IRR_OUTPUT  4:  Production  of  NOX  from  NOZ 
l•••••••••••••••••••=••ms•==c•~=====••a====•:=====~a~aac===mcac===s•m~== 
IRR_OUTPUT  NOXfromNOZ 

PANcyc[NEGONLY]  + 
TPANcyc[NEGONLY)  + 
HONOcyc[NEGONLY]  + 
HN04cyc[NEGONLY)  + 
N03cyc[NEGONLY)  + 
N20Scyc[NEGONLY]  + 

<  PS>  + 
<  73>  + 

2.0*<140>; 

<P21>  + 
<138>  + 

<  51>  + 
<139>  + 

DESCRIPTION 

'NOX  produced  from  NOZ'; 

'111 

"'lllllh 

IRR_OUTPUT  5:  Production  of  new  OH  from  010 

I 
(••••••••••••••••••••••=2••E•~==2••az=~=•ma=c====•mm~====~m•s=======cc:& 
IRR_OUTPUT  OHfromOlD.  PROD 

[HO]  FROM  [010]; 

16-30 

Exhibit 16-4.  Example PACP Commands for a Partial  IRR Analysis 

DESCRIPTION 

'OH  produced  from  OlD'; 

EPA/600/R-99/030 

!================2===================================c================== 
!  IRR_OUTPUT  6:  Production  of  new  OH  other  than  from  OlD 
!======c=========================================================~====== 
IRR  OUTPUT  newOH  = 

0.1*<  87>  + 

0.1*<  85>  +  0.14*<  86>  + 
2*H202_0Hcyc [POSONLY.] 
+ 
HN03_0Hcyc[POSONLY] 
HONOcyc[NEGONLY] 
OPl_OHcyc[POSONLY] 
OP2_0Hcyc[POSONLY] 
PAA_OHcyc[POSONLY] 

+ 
+ 
+ 
+ 

DESCRIPTION= 

'new  OH'; 

!==========~~~============£============================================= 
!  IRR_OUTPUT  7:  Production  of  new  H02 
!======================================================================= 
IRR  OUTPUT  newH02  = 

2.0*<Pll>  + 

<P12>  + 
<P19>  +  0.98*<P20>  + 
<  74>  + 

0.8*<P18>  + 
<P21>  + 
<  76>  +  0.12*<  84>  + 
0. 23*<  .85>  +  0.26*<  86>  +  0.23*<  87>  + 
OP1_0Hcyc[POSONLY]  + 
OP2_H02cyc[POSONLY]  + 
HN04_H02cyc[POSONLY]  i 

DESCRIPTION 

'new  H02'; 

IRR_OUTPUT  8:  Total  Production  of  H02 

!=============~============:================~===================:======= 
! 
!=========================:=&=====================~===================== 
IRR  OUTPUT  totalH02  = 

2.0*<Pll>  + 

<P12>  + 
<P19>  +  0.98*<P20>  + 
<  74>  + 

0.8*<P18>  + 
<P21>  + 
<  76>  +  0.12*<  84>  + 
0.23*<  85>  +  0.26*<  86>  +  0.23*<  87>  + 

{H02new} 

OPl_OHcyc[POSONLY]  + 
OP2_H02cyc[POSONLY]  + 
HN04_H02cyc[POSONLY]  + 

{H02propbyOH} 

PROD[H02]  FROM 

[HO]  AND 

[VOC]  + 

{H02viaR02_NO} 

PROD[H02]  FROM 

[NO]  AND 

[R0.2)  + 

{H02byR02_R02} 

PROD[H02]  FROM 

[R02]  AND  [R02)  + 

{otherOH} 

HOXcyc[POSONLY] 

DESCRIPTION 

'total  H02'; 

IRR_OUTPUT  9:  Production  of  new  R02 

lc=z=3z======================2==:======================c~=============== 
! 
l=======================2=========================c===================== 
IRR_OUTPUT  newR02  = 

newM02 
+ 
newAC03  + 
newETHP  + 
newTC03  + 

16-31 

Exhibit 16-4.  Example P ACP Commands for a Partial  IRR Analysis 

'1111111111'" 

111111111 

PAN_AC03cyc[POSONLY]  + 
TPAN_TC03cyc[POSONLY]; 

•new  R02'; 

I  IRR_OUTPUT  10:  Total  Production  of  R02 
11J••••••••••••••••••••••••z==••S••====cgm~c=:::cs~a=c==~•••~c===~c=c~a=== 
IRR_OOTPUT  TotalR02  •  newM02  + 
newAC03  + 
newETHP  + 
newTC03  + 
PAN_AC03cyc[POSONLY]  + 
TPAN_TC03cyc[POSONLY]  + 

{neWR02} 

(prcpR02_0H} 

PROD[R02]  FROM 
<  30>  + 
<  50>  + 

[HO]  AND 

[VOC] 

+ 

0.5*<48>  + 

,,l~ropR02_NO} 

PROD[R02]  FROM 

[NO] 

DESCRIPTION• 

'Total  R02'; 

11111111111111 

. , , , , , , -

I  IRR  OUTPUT  11:  Loss  of  co  &  CH4  by  reaction  with  OH 
•···················•a•===••••n••==z:•••=c===·-3·~===2aaaa=z===~c3ac:=== 
IRR_OUTPUT  Loss_CO_CH4 

<  30>  + 

DESCRIPTION.  'Loss  of  co  &  CH4'; 

LOSS 

[CO] 

l••••••••••••••••••••••••s~s••••z~====2msaz3c====z••~====ms~~z========:= 
'"!'  IRR._otfrpui'""l.2 :"""'"i?roducd.on  of  OH  from  H02 

IRR_OUTPUT  H02toOH  •  HOXcyc[NEGONLY]  + 

<9>  + 
,.  2. O*H202_0ltcyc [POSONLY]; 

DESCRIPTION• 

'H02  to  OH'; 

IRR_OUTPUT  13:  Production  of  N02  from  H02 

I 
f••••••••••••••••••••••••cx===•=czz=====2==c•=====•~•a=======u••~•~===== 
IRR_OUTPUT  N02fromH02  •  <  9>; 

DESCRIPTION• 

'N02  FROM  H02'; 

IRR_OUTPUT  14:  Production  of  N02  from  R02 

I 
l•••••••••••••••••••s•••••••a•axa=====••••c====~c~ca:=====2caazz======cm 

IRR_ OUTPUT  N02fromR02  = 

<  57>  +  0.964*<  58>  +  0.92*<  60>  + 
<  65>  + 
<  68>  + 
<  71>  + 
<131>; 

<  64>  + 
<  67>  + 
<  70>  + 
73>  + 
< 

0.76*<  62>  + 
<  66>  + 
<  69>  + 
< 72> 
+ 

Exhibit 16-4.  Example PACP Commands for a Partial  IRR Analysis 

DESCRIPTION 

'N02  FROM  H02'; 

Jcn=a=mc==============3================================================= 
!  IRR_OUTPUT  15:  Production  of  PAN  and  TPAN 
!~==========c===£===============~~=3=====c=====3===:===================3 
IRR_OUTPUT  prodPAN_TPAN  =  PANcyc  +  TPANcyc; 

DESCRIPTION= 

'Production  of  PAN  and  TPAN'; 

l•=c================:£================================================== 
!  IRR_OUTPUT  16:  Net  Production  of  organic  nitrates 
!==2:c:a:=u============================================================= 
IRR  OUTPUT  netONIT  =  NET[ONIT]; 

DESCRIPTION= 

'Net  production  of  ONIT'; 

!a:ca:c==================c==========:=================================== 
!  IRR_OUTPUT  17:  Loss  of  voes  by  reaction  with  OH 

!========c=====cc:3~=============================================c====== 
IRR_OUTPUT  lossOH  HC 

[HO] 

LOSS[VOC]  AND 
+ 
<  30>  +  <  47>  +  <  48>  + 
<  49>  +  <  50>  +  <  51>; 

DESCRIPTION= 

'Loss  of  HC  plus  OH'; 

!:::u=a~c=n===================================:===============~========= 
!  IRR_OUTPUT  18:  Loss  of  OH  by  reaction  with  inorganics 
!================c:==c================================================== 
IRR_OUTPUT  lossOH_INORG 

7>  +  <  14>  +  <  15>  + 
< 
<  24>  +  <  25>  +  <  26>  + 
<  27>; 

DESCRIPTION 

'Loss  of  OH  with  !organics'; 

!=================================c===================================== 
I  IRR_OUTPUT  19:  Net  production  or  loss  of  HN03 
!:========:============================================================= 
IRR  OUTPUT  netHN03  =  NET[HN03]; 

DESCRIPTION= 

'Net  change  in  HN03'; 

!E3=za~a=c==========================================================:=== 
I  IRR_OUTPUT  20:  Loss  of  HCHO  by  reaction  with  OH 
l===z=============================================================c====% 
IRR_OUTPUT  lossHCHO_OH  =  LOSS[HCHO]  AND 

[HO] 

DESCRIPTION= 

'Reaction  OH  HCHO  with  OH'; 

!======================================================================= 
I  IRR_OUTPUT  21:  Loss  of  isoprene  by  reaction  with  OH 
l===============~=:~==c~c==========================================2==== 

Exhibit 16-4.  Example P ACP Commands for a Partial  IRR Analysis 

IRR_OOTPOT  lossISO_OH.  LOSS[ISO]  AND  [HO]; 

DESCRIPTION• 

'Reaction  of  ISO  with  OH'; 

J•••••••••••••••••••~••••D•3==za•:=======mm••~•====cccaaKmcz:=====E=~m•= 
:l"""'  IRRj)tiT'ptiT"'22:''''''''''production  of  new  H02  from  HCHO 
l•••••••••••••••••••••••••c=c2••••======•a~•~mc=====c%a••=c====%=~•na=== 
IRR_OOTPOT  newH02fromHCHO  a  PROD[H02]  FROM 

[HCHO]  AND  [hv]; 

DESCRIPTION. 

'New  H02  from  HCHO'; 

I  IRR_OOTPUT  23:  Production  of  H02  from  PAN 
l••••••••••••••••s••s•a•••~z==c••~3=====c•~=c======3asamc========••:=c== 
IRR_OUTPOT  H02fromPAN  •  PAN_AC03cyc[POSONLY]; 

DESCRIPTION•  'H02  from  PAN'; 

J•••••••••••••••••••=~=•••••zz::cucc•~====E•caccc=c====••••a=~=====••a== 
"i 

IRR_OUTPUT  24 :  Production  of  H02  from  R02  and  NO 

IRR_OOTPUT  H02fro:nR02_NO  a  PROD[H02]  FROM 

[NO]  AND  [R02]; 

. 

1111!!'· 
DESCRIPTION•  'H02  from  R02  and  NO'; 

."'" 

""'1111,;::11111111: 

,11:·111111 

''" 

,, 

1
' 

11111

".. 

,111111111111111:, 

"II'"'" 
11111111·•••••:~,,~.,~~~11:11:•-:11:11~••••••••===.~E••,,•=~===c•.:.:m:a====c•:mc=c====:caam•:m======= 
I  IRR  OtrrPtrr  25:  Production  of  H02  from  R02  and  R02 
l•••••••••••••••••••~••••••~====E•c•::a======•cK•======~=a•:s========z•cc=c 
IRR_OUTPUT  H02fromR02_R02  a  PROD[H02]  FROM  [R02]  AND  [R02]; 

, , , , '   -

,111·, 

·111~ 

1111111111. 

. 

,, 

,. 

,,, 

• 

DESCRIPTION• 

'H02  from  R02  and  R02'; 

I" 

Ill 

'"!iii:ll!!:1111, 

,, 

,,, 

l •••••••••••••••••••••••••••••==-=•••m•====-=~a••••&s~==••••~cc=====••&m.:~ 
'r'  IRR  cUTl>tri"""'"26: 
'i?roduction  of  R.62  from  OH 
! a-~•••~•••-~ •••••••~•c:::1':11"2'a•a'..~"a:c~.===2:c •a ::ac=== ==::2aam:a:z=:i====u9"maa:::1:==== 
x"R.a_OOTP1UT  R:o2fromOH  •  PROD [R02]  FROM  [HO]; 

. -

II 

,, ..  , 
· 

> 

, 

"" 

,,I' 

::11111 

111:'"":1 

"" 

F!ESCRIPTION 

I 

11

:::1111111111 

1,::11111 

'R02  from  OH'; 

111

'

11111, 

:11111' 

l••••••••••••••••••••••=c=•••••=====:c=a::a&======acm~aa•=======•c=~m====== 
'·  IRR_OUTPuT  27:  Production  of  HN03  from  OH  +  N02 
l••••••••••••••••••m3•a=::cc••==z=====a•m======c•2~ccc======~=c~ca~====== 
IRR._OUTPUT  H:No3frornoH_No2  = <  24>; 

DESCRIPTION•  'HN03  from  OH+  N02'; 

'f  IRR_OUTPOT  28:  Production  of  new  OH  from  H202 
)••••••••••••••••••••••c=-=••••s==c=c=czz======a~·~~=====a•••-=z=======c== 
IRR_OOTPOT  newOH_H202  s  2*H202_0Hcyc[POSONLY] 

DESCRIPTION 

•new  OH  from  H202'; 


Exhibit 16-4.  Example PACP Commands for a Partial  IRR Analysis 

l===========~~-K~~-CEc==~============================================z~= 
!  IRR_OUTPUT  29:  Production  of  new  OH  from  organic  peroxides 
!==================scna•z~naz============c=c======~~==~=======a:caKaa•c• 
IRR_OUTPUT  newOH_OPl 

OPl_OHcyc[POSONLY]  + 
OP2_0Hcyc[POSONLY]  + 
PAA_OHcyc[POSONLY]; 

DESCRIPTION  z 

'new  OH  from  OP1  OP2  PAA'; 

!  IRR_OUTPUT  30:  Production  of  OH  from  HONO 
!================================================c====================== 
IRR_OUTPUT  newOHfromHONO  =  HONOcyc[NEGONLY]; 

DESCRIPTION= 

'new  OH  from  HONO'; 

!  IRR_OUTPUT  31:  OH  Termination 
!===============================================c======================= 
IRR_OUTPUT  OHterm  = <  25>  +  <26>  +  <27>  +  <  50>  + 

HN03_0Hcyc[NEGONLY]  + 

HONOcyc[POSONLY]; 

DESCRIPTION 

'OH  Termination'; 

!===============================================c=======c===========~=== 
I  IRR_OUTPUT  32:  H02  Termination 
l======================================c================================ 
IRR_OUTPUT  H02term  % 

<  20>  +  <  27>  +  <101>  + 
2  •  H202_0Hcyc[NEGONLYI  + 

HN04_H02cyc[NEGONLY]; 

DESCRIPTION  2 

1H02  Termination'; 

!==========c===============================~=======================c==== 
!  IRR_OUTPUT  33:  Termination  of  H02  by  reaction  with  R02 
!c=====================================================c=========~=~a~cc 
IRR_OUTPUT  termH02_R02 

OP1_0Hcyc[NEGONLY]  + 
OP2_H02cyc[NEGONLY]  + 

PAA_OHcyc[NEGONLY]1 

DESCRIPTION= 

'H02  term  with  R02'; 

!  IRR_OUTPUT  34:  R02  Termination 
!===============================~=====c====z=======~=====z=~====~aa•~••• 
IRR_OUTPUT  termR02  =  .036*<58>  + 

.08*<60>  +  .24*<62>  + 

.03*<68>  + 

PAN_AC03cyc[NEGONLY]  + 

TPANcyc[POSONLY]; 

Exhibit i6:.~[  Example PACP Commands for.a Partial  IRR Analysis 

DSSCRIPTION.  1 R02  Termination'; 

l•••••••••••••••••••••••••••••••••&c••••~2••sz:2••==~•s==••z=•~acc:2•~== 
i  IRR~OuTPUT3S;Tamination of  R02  by  reaction  with  with  H02 

l••••••••••••••••••••••••••••••••z••••2~••2=••m•==••~==•••==••z::2•==:c& 
IRR_OUTPOT  termR02_H02 

OPl  OHcyc[NEGONLY]  + 
OP2=0Hcyc[NEGONLY]  + 
PAA_OHcyc[NEGONLY] 

DSSCRIPTION.  1 R02  Termination  with  H02'; 

".11111 

"'"' 

:1 

J•••••••••••••••••••••••••••••••••••a••&~••••=•••c=•••==z•~==2••===~a=== 
I  IRR_OUTPOT  361  Termination  of  R02  by  reaction  with  R02 
l•••••••••••••••••••••••••••••••••••a•••zs•••s=s••==••&::aaa:cc•~==~•••~ 

termR02_R02  • 

<102>  +  <103>  +  <104>  +  <105>  +  <106>  + 
<107>  +  <108>  +  <109>  +  <110>  +  <111>  + 

1.515  •  <114>  +  <115>  +  <116>  +  <117>  + 

<118>  +  <119>  +  <120>  +  <121>  +  <122>  + 

1.030  *  <i26>  +  0.500  *  <138>  + 
0.500  *  <139>; 

11111: 

11111·.::"1 

1 

:11!

:1:·,,1;:' 

;;.',1111 

;11. 
'11! 
,,'11111 
~ :  i 111 i 

r 
I!,.. 
DS~CRIPTION 
'II' 

. ... 

,, 

"'1111111:·1 

1l1111'·1ill111 

'R02  Termination  with  R02'; 

·, 

'lllllllli;,:i 

'llii 

1

111:iiii 

l:,l ••••••••••!.::'·•-=!· ....... .la•••••••••••••••"'""a••s"':a••==•••"'="'••"'==•~':;.=.,=•'"" 
'  1,.  IRR .... citri'l?tiis'  3 7;  L011s  of  OH  by  reaction  with  daughter  voes 
l•••••••••••••••••••••••••••••••••sza••••=z•••s=~•a~s=~•a==~•••===2•~=== 
IRR_OUTPUT  dauHC_OH  •LOSS  [HO]  JUlD  [dauHC]; 

I 

DESCRIPTION•  'OH+  daughter  HC'; 

'111 
I 

"·END PA; 

II' 

.:illl" 

16-36 

1 

,,1111

1111111111 

150..---------------------------~ 

EPA/600/R-99/030 

fl) 

140  0 3  Processes 
130  Charlotte, 28718 O'Brien Off 
120  -Plt'l2!tt-Mon~i,.,.to"'r-i::ee;alf.ll--- - - -
... 
110 
-E.  100 
..0 8::  90 
~ 80 
-e  10 
fl)  60 
Q)  50 
(,) e  40 
CL 
.0  30 
0.. 
Q.  20 
.2  10 
~  0 
CJ) 
~ -10 
x E -20 
-30 
-40 
-50 
4 

10 

6 

8 

12 

14 

16 

18 

20 

0 3  Processes 
Charlotte. 287FC O'Brien On 

aza-Monftor-6eli-----------

'-Predicted 

Mixing Ratio 

150 
140 
1SO 
... 120 
~ 110 
!boo 
~ 90 
80 
UJ  70 
UJ 
CD 
e 0.  50 
0  60 
.a  40 
0. a.  30 
0 
~  20 
a  10 
c 
0 
>< "E  -10 

-20 
-30 
-40 
-50'---'--_.__..___._ _  _.__.___._ _  _.___. _  __.__.....___. _  _,_ _  _._____..__~ 
20 

16 

14 

12 

10 

18 

6 

Hours 

4 

8 

Figure 16-1.  Example process analyses showing contributions of individual processes to model 
predicted concentrations (Source: Jeffries,  1996). 

16-37 

Iii 

·:••iilllllllllll: 

1111

::::1: 

" 

·:··:.:,11111111, 

,,111111111··,,li 

New York area 
10·16  EDT 

80Ian 

New Jersey area 
10 ·16  EDT 

EP A/600/R-99/030 

111 

111111111

1]11"'" 

:::11111111:: 

::::1111 

1111111111 

'1111111111:'",,, 

1111 

111111111111" 

1ro 
,,,,,,  1..0 
130 
120 
110 

'8: 100 ;o 
.-a  60 
Q.  70 
80 
"'  <i -g  ro 
40 
CIS  30 
"(:J  20 
Q.  10 
0 
·10 
·20 
·30 
·40 
-&> 
.ft() 

"' 1111 

,11, 

111111:, 

11111 

11111 

!lllllllli 

100 
uo 
80 
70 
'"""''I' eo 
1111111111111  § 50 
40 
11111111111111  ~ 30 
0  20 
1  <l° 
11111111111::o11,  ,,-g 
'  '  """···10 
0 
...  " CIS  ·10 

111111111111111""' 

er ·20 

~ ·30 
·40 
-~ 
·90 
·70 
-ao 

11'

111111111111111, 

1

Figure 16-2.  Example Process Analyses showing model predicted concentrations and process 
c0htributions for different model configurations (Source: Jeffries,  1996). 

16-38 

Pbotochemic-ai. Air .Pollution 

NO 

Emission' 

Nri = n~mberof._C)'c.leut E/e m:.1  f (~~P~ 

Ill = organic proGesses 

. 

0  = ihbtgahlc processes 

~ 

.  . 

Figure 16-3a.  Schematic of OH reaction with NO oxidation cycles (Source: Jeffries, 1996). 

Atlanta. GA 6/611988, Base Case 

4.46 Cycles per new OH 

propagation and termination 

32.0 ppb new OH 

t 

-

---------1  A VOC= 122.5 ppbV 
142. 7 ppb OH  (NO ... N02) I voe - 1.71 
reacted 

P oH=O. 776 

"l10.8ppbOH 
re-created 

[03lp=170.6 ppb 

87.4 ppb hom emiss. 
46.0 ppb lost by met 

.4ppbnewNO 

(0sli/103P] .. 0.951 

222.Sppb NO 
reacted 

PN0 =0.805 

A NOz=- 27.5 ppbV  ~!~b NO 
NO~N02 = 220.4 ppb  1---..,.r-~ 13.6 ppb 
[0s1react 
propaga11011 

24.7ppb 
(OlJentraJn 

13.6 ppb 
[O:ilc1epo 

5.13 Cycles per new NO 

[O:i]i 0:161.2 ppb 

Figure 16-3b.  Example photochemical cycle throughputs derived from integrated reaction rates 
(Source: Jeffries,  1995). 


Chapter 17 
============

AN AGGREGATION AND EPISODE SELECTION SCHEME 

DESIGNED TO SUPPORT MODELS-3 CMAQ 

Richard D. Cohn 

Analytical Sciences, Inc. 

Durham, NC 27713 

Brian K. Eder"  and Sharon K. LeDuc .. 

Atmospheric Modeling Division 

National Exposure Research Laboratory 

Research Triangle Park, NC 27711 

ABSTRACT 

In support of studies mandated by the 1990 Clean Air Act Amendments, the Models-3 
Community Multiscale Air Quality (CMAQ) model can be used to estimate pollutant 
concentrations and deposition associated with specified emission levels.  Assessment studies 
require CMAQ-based distributional estimates of ozone,  acidic deposition,  PM2.5,  and visibility on 
seasonal and annual time frames.  Because it is not financially feasible to execute CMAQ over 
such extended time periods,  CMAQ must be executed for a finite number of episodes under a 
variety of meteorological classes.  A statistical procedure called aggregation, must then be applied 
to the CMAQ outputs to derive seasonal and annual estimates. 

The objective of this research is to develop an aggregation approach and set of episodes that 
would support model-based distributional estimates (over the continental domain) of air quality 
parameters.  The approach utilized cluster analysis and the 700 mb u and v wind field components 
over the time period  1984-1992 to define homogeneous meteorological clusters.  A total of 20 
clusters (five per season) were identified by the technique.  A stratified sample of 40 events was 
selected from the clusters, using a systematic sampling technique. 

This stratified sample is then evaluated through a comparison of aggregated estimates of the mean 
extinction coefficients (bc:J to the actual mean bcxt observed at 201  stations nationwide for a nine 
year period (1984-1992).  The bcxt•  a measure of visibility, was selected for use in the evaluation 
for two reasons.  First, of all of the air quality parameters simulated by CMAQ, this visibility 
parameter provides one of the most spatially and temporally comprehensive data sets available, 
and second, the bcxt  can serve as a surrogate for PM2.5 for which little data exists.  Results from 
the evaluation revealed a high level of agreement (r = 0.988) indicating that the aggregation and 
episode selection scheme was indeed representative. 

"On assignment from the National Oceanic and Atmospheric Administration, U.S.  Department of Commerce. 
Corresponding author address: Brian Eder, l'vID-80,  Research Triangle Park, NC 27711. E-mail: 
eder@hpcc.epa.gov 

.. On assignment from the National Oceanic and Atmospheric Administration, U.S.  Department of Commerce. 

t(~O  AN AGGREGATION AND EPISODE SELECTION SCHEME DESIGNED TO 
SUPPORT MODELS-3 CMAQ 

Introduction 

'"' 
,, 

"''" 

','' 
';,,11111111111:::, 
',,1,,,,11111111, 

1:::::111111111111, 
"''" 

'' 

,, 
''""'' 

1

• 

" 

111
'

11:. 

11111111111111

'"'""""' 

"""""""'""""" 

This chapter describes the development of an aggregation and episode selection scheme to 
support the derivation of annual and seasonal estimates of air quality parameters in Models-3 
, CI\1.AQ.  Refovant background information regarding this activity,  as well as a precise statement 
of the present objectives, is provided in this section.  Section 17.2 summarizes the important 
elements of the approach and the overall strategy, including the rationale behind the methods and 
the limitations associated with them.  Details of the development of an aggregation and episode 
selection are provided in sections 17.3,  17.4, and 17.5.  Section 17.6 contains an example 
application and evaluation of the methodology using one particular air quality parameter (bcxt  ), 
and section  17. 7 provides a summary and discussion. 

17.1.1  Background 

In support of studies mandated by the 1990 Clean Air Act Amendments, the Models-3 
Community Multiscale Air Quality (CMAQ) model is used by EPA Program Offices to estimate 
deposition ancf rur concentrations associated with specified levels of emissions.  Assessment 
studies and effects models require CMAQ-based distributional estimates (such as annual and 
sea5onal averages) of ozone, acidic deposition, and measures related to visibility.  Such estimates 
would ideally be obtained by using CMAQ to simulate atmospheric chemical processes associated 
with meteorological conditions occurring on a daily basis over several years.  However, for 
logistical and cost reasons it is not currently feasible to execute CMAQ over an extended time 
period such as a full year.  Therefore, in practice CMAQ must be executed for a finite number of 
episodes or "events," which are selected to represent a variety of meteorological classes.  A 
st~!~S!ic'!;l procedure called aggregation, must then be applied to the outputs from CMAQ  to 
d~[~ve ~~,,~,required annual- and seasonal-average estimates from this finite number of events.  The 
objective of the research described in  this chapter is to develop such an aggregation approach and 
evaluate its effectiveness using the bcxt· 

"' 

"'" 

11111111111111 

l,,,,,,,,,111 

111,,,11111111111111111, 

'"'"""""""'"" 

T~e tw,s~c problem of developing representative meteorological categories has been explored by 
other researchers for a variety of purposes, including Fernau and Samson (1990a,b ); Davis and 
Kalkstein (1990);  Eder et al.  (1994).  The approach used here is based on a variation of the 
methods previously used by Brook et al.  (1995a,b) in selecting a 30-event aggregation set for the 
Regional Acid Depositio~ Model (RADM).  The approach of Brook et al.  involved four major 
components.  Cluster analysis of wind fields was used to determine meteorologically 
representative categories.  The determination of the number of clusters to retain was based upon 
within-group variance patterns and prior work by Femau and  Samson (1990a,b).  A procedure for 
aggregating the episodic results into annual totals and averages involved frequency-weighted 
s1ims and estimated deposition-precipitation relationships.  Event selection procedures were 
designed to emphasize·categories that accounted for most of the annual wet sulfate deposition, 

' 

,,,,,,,1111''" 

1
: 

11'

II, 

I 

1"illl111" 

'" 1111, 

"1 

'"  111111111 

while also representing some winter and dry events.  A summary of some specific elements of 
their approach is provided in Table 17-1. 

Table 17-1  Summary of Methodology Used by Brook et al.  (l 995a;  1995b) for RADM 

· 1.  Determination of categories 

· ;,• 

·= 

· UsedV:Varc:l;s {1963) method·~f cluster analysis, which riiinimiies ~thin~clu~ter sµms:of squares, hi.:an  ·· 
~g9j9m~rative, hlerarchlcal mode for wind flqw parameters;  .l1sed east~rn North Amerlcan.zon.at .u an.d 
nierfdfon~t v ~q.~kf:>.a wln-C:(c;Omponents for OOOo·:uTC with  5° s·pat~al reSQt'-1tiq~ (two ... varici~~es·~t 48 grid: 
·::, 

.  . ': 

; .. :··  . 

. ::;:. 

:·  .;;· 

: . 

. 

. 

·. 

'·  Clustered.'.'eonsecutlve'' ~day periods from 1979, 19Sf, and 198:(with subsequent classification of . 
. ,.remei~lng !'running" ~~day P$.r'i~ds ~om 19:7.9~1985 into ohe ... C)f these·.~1usters.:·..  ·:. 
: 

. ···  .  . . 

·:,. 

...  nodes over tliree days). 
• 

, 

'2.  Deter/pination.o(number at cluster~ to r~"tain 

.,. 

· • 

·' :Examh~~d i~epwlse increase~ffh within-gro~p variance with. ·decreasltig num~::rof 'cluSt~i'S. e~pre$sed 

. .. 
. · 
· •  .:  Re~alned 19 clusters.based OJ1  results for wind flow,  sulfate'.. deposition, and prior work t;>y  Ferna~ an~ 
· 
· 

: Sa!"Tison  (1990a,b).  Used q~antitatlve information but somewhat subjective criteria. 

·through F-Statlstic. 

. . .. 

· 

· 

· 

. 

. 

.: 

,. 

.,:. 

3.  De.velopn:ient of aggregation procedure·.·: 

.. · 
.·:·. 

'" 

,.  . 

· .. 

··  ,,. 
. 

···. 

· .. ::. 

. . 

:.· 

· •  Estimated total deposition for th~ group of sampled.categories, ffom the sampled e~ents (weight~; 
sum;:.actounting for the number:of...events sampled from each cluster and frequency of occiJrre.r;ice o_f 
· ·· 
the clusters)." 
· .. 

· 
•··  Scaled up by ratio.of total annual.deposition to an estimate of annual deposition that Is bas~d ori 

.  .  . 

• ·. 

· · 

, . 

·. 

. 

. 

., 

a:ggr~ating the sampled categories.  Estimates used either mean deposition from. a sampled eategory 
ordepo"Sitlon esti~ated.~rom the,deposition-precipita~loh relations~~p in _th~eategory.  .... 

..· 

.. 

·. 

., 

. 

,.· 

... 

4.  Selection of "optimum" set of events 

~  : subdiVided t~e 19 categories Into .;;et and dry subsets,  resulting in 3a new ~ategorles> 

.·.·. 

. 

· 

• 

·Primarily represented categories that accounted for most of the annual wet ~ulfate.depo~itlon (at least 
7~% .When Combined).  Se1~cted 19 ·even.ts from thes~· categories.  AJso  seleCted  t~ events from Winter 
(5) and dry (6f events to represent seasonal deposition differences, dry "periods,  and possible nonlinear 
· ··· 
effeets; 
. 

.,'•  Number of events selected from each category Was  based on· proportionality to the:frequency of.,: 
'occurrence of the category and· the percent ottotal sulfate accounted for by the· category. 
·' 
· 
:Ex.ai.nlned 20 potential" sets (ea.eh randomly-:generated) meeting all crlterla, selected. the one ~hat 
:., . 
,.. 
'.::··  minjmized.RMSE for annual sulfate depos~lo.n (prim~rily} and precipitation (secondarily} at ~3 sites.: . 
.. ·set~cted sets in stages, first choosing a set .. of 19 events from the wet categories and then a:.set .. of 11 
,., 
·  events fr'?m winter and dry periods. 

..  · · 

·.::  . · 

· · · · · 

··· 

· · 

··· 

··: 

· 

. 

· 

· 

·· 

·· 

:··.·· 

17.1.2  Objectives 

The present objectives differ somewhat from those which motivated the earlier research.  RADM 
was primarily designed to address issues involving acidic deposition.  CMAQ addresses a more 
diverse cofiection of air quality parameters with equal importance.  In addition, CMAQ will be 
applied to a continental domain that is significantly larger than geographic area for which 
eStimates are supplied by RADM.  The extension from the RADM domain to a continental 
domain is extremely ambitious as it relates to episode selection and aggregation.  Therefore, the 
development of an approach that accommodates this larger continental domain is  particularly 
c~~lenging. 

111" 

'1' 

II' 

,,11111111111111111''"1; 

111,,Jllllllll1 

'1111111'11'  '!I 

11111 

,,,111 

11:,.,,111111 

11

I 

The objective of the activity described in this chapter is the development of an aggregation and 
episode selection approach that supports model-based annual and seasonal air quality estimates 
,.  t~1~~ ~~""~~, !,,~~,~l1  .a~1111111~~~~t~, <:'dt.h resl?ect to sampling uncertainty) as those achieved by RADM, in 
~!!~i~eraJJ.oJ! Q,(~~ JJ?:O.f~ general applicability envisioned for CMAQ both with respect to air 
quality parameters and geographic representation.  This accuracy must be preserved while 
minimizing any additional cost.  In essence, "cost" refers to the number of events for which the 
model provides estimates, each of which adds cost in the form of both computational processing 
time and human labor. 
i7:2  Sum~~ry of the Approach 
, ti~ amJysis ,~~ ~rri'~~,,,,~ut~ 11J,hases, wi~h\~t~rmati~n gatli~red in each p~~~~ co~tAh~ting t~ 
th1e 'design of the next.  For this reason, this chapter is structured to present complete descriptions 
Ill  of the methodology and results achieved in each phase, in sequence, in sections 17.3,  17.4, and 
...  17,5.  T.his se<;tion is intended as an overview of the process prior to those detailed descriptions. 
This overview consists of descriptions of some key elements of the methodology, the rationale, 
s~pe, arid limitations associated with the methodology,  and the strategy used to move in phases 
toward the final result. 

"'II:"',  I''" 

ii'",,,, 

''!il11"ll1 

1
1
1
1'"lllllllll111

: 

!  .. 

"Ill 

1
1
1llllll 
1

"::"::::!!!ll11: 

'1' 

1
1
11111

1
1

1111 

,'" 

.,,:·,;,, 

,lllill'"·,'1'' 

1 iillllliii

. 

''I'" 

.: 

' 

"'1·111'1l

" 

.. 

·II' 

1
1111.
.' 

·.·.'. 

17.2.1  Basic Elements of the Methodology 

Simply stated, the methods that we have employed involve the determination of meteorologically 
representative categories, the selection of events from those categories, and the use of evaluative 
tools to ensure that the detailed aspects of those activities are defined in such a way as to achieve 
..  optimal results, to the extent that we can measure optimality. 

1,1,1,l1l1lllllll1'·1:.·1'.· 

,,'il:l:l:1:
·, 
1

1
!!!! 

'',1111111!

!l"!ll··:lli1:1lllllllll 

,II,· 

,!!: 

;i 

··· 

! 

1, 

1111 

11111111111111 

, 

.Jllllii: 

'::'" 

1 

111111!

/\specific goal is the definition of meteorological categories that account for a significant 
. p:~portioiiof the variability exhibited by the air quality characterizations of interest.  The basic 
"::  approach used in the current analysis for the determination of categories and event selection 
c~12;l})Onents is related to that of Brook et al.  (1995a,b), but certain fundamental considerations 
have been modified to reflect the differences inherent in the present objectives as described in 
section 17 .1.  The common element is the cluster analysis of zonal u and meridional v wind 
,,  components to define meteorological categories. 

111111 

,,,,,h 

11111 

:lll1111li1il11' 

1111111111111111, 

"'ll,l,',1

,,,, 

''I 

.I 

The definition of meteorologic~ categories is designed to support the selection of events from 

' tli9se cat~gories in a process known as stratified sampling (Cochran,  1977).  Stratified sampling 
exploits the internal homogeneity of the meteorological categories, or "strata," to achieve more 
precise estimates than would be possible using simple random sampling (i.e.,  randomly selecting 
events without regard to meteorological category).  Certain variations of stratified sampling are 
relevant to this analysis.  One relatively inefficient option for invoking stratified sampling would 
involve selecting the same number of events from each category/stratum.  This is known as "equal 
allocation."  An alternative is "proportional allocation," which involves selecting numbers of 
events in direct proportion to the size of the stratum.  Thus, more events are selected from strata 
that contain large numbers of events than from smaller strata.  This is potentially much more 
efficient than equal allocation, in the sense that it leads to much more precise (i.e., lower variance) 
estimates.  Estimates exhibiting absolute maximum efficiency (i.e., minimum variance) are 
obtained by modifying this method slightly so that the number of events selected from each 
stratum is in direct proportion to the product of the size of the stratum times the internal 
variability (as characterized by the standard deviation of the measurement of interest) within the 
stratum.  Thus,  strata exhibiting significant variability among events are sampled more heavily 
than strata in which events are more uniform.  This is known as "optimum allocation," which is 
identical to proportional allocation when within-stratum variances are equal. 

While wind flow parameters were used to define the meteorological categories, other 
meteorological parameters were used in subsequent phases of the analysis to refine aspects of the 
episode selection methodology,  and as evaluative tools to assess the effectiveness of the 
approach.  These parameters include visibility (as represented by the be,J,  temperature, and 
relative humidity.  Their specific roles are discussed in more detail in the following sections. 

17.2.2  Rationale, Scope, and Limitations 

As stated previously, the approach to selecting an aggregation and episode scheme is based upon 
the definition of meteorological categories that account for a significant proportion of the 
variability exhibited by the air quality characterizations of interest.  Strictly speaking these 
characterizations include parameters such as acidic deposition, air concentrations, and measures 
of visibility.  Therefore, it might be argued that the definition of categories should be formulated 
directly using these parameters that are ultimately of interest.  However, it is equally important 
that the model simulate the particular transport mechanisms involved in the associated 
atmospheric processes, and in particular that source-attribution analyses be facilitated.  This 
requires that categories be defined with an emphasis on wind flow parameters.  Indeed, 
characterizations of basic wind field  patterns in essence describe frontal passages, along with all of 
the meteorological properties typically associated with them. 

In view of the importance placed on the accurate simulation of transport mechanisms, a complete 
evaluation of the episode selection and aggregation methodology would require an assessment of 
the accuracy with which transport is represented.  However, this accuracy cannot be measured,  as 
there is no technique available to support a direct, quantifiable assessment of the representation of 
atmospheric transport.  In addition, with the exception ofbcxt>  there are little air quality data 
available with the required spatial and temporal resolution and range to support a direct 
evaluation of the methods described in this chapter with regard to the outcome parameters that 
will be of primary interest in CMAQ. 

For these reasons two meteorological parameters (in addition to bcxJ,  which are known to be 
related to many of the air quality parameters of interest, and for which appropriately resolved data 
are available, were used as evaluative measures in this analysis.  Specifically, temperature and 
relative humidity were used; however, primary emphasis will be placed upon the b0'"' which 
,,,  provides a surrogate measure for fine particles.  It must be recognized that this constitutes a 

secondary evaluative tool, in the sense that the effectiveness of the approach cannot be directly 
measured as it relates to atmospheric transport or to specific air quality parameters, both of which 
are primary outcomes.  For this reason, the methods were not developed and refined solely 
toward the goal of optimizing performance associated with the estimation of visibility.  Instead, 
this performance was evaluated in combination with other considerations that were believed to be 
important but for which performance may not be readily quantifiable. 

Jl:,:1111111' 

111111111111111' 

'11111,,,1•" 

""'" 

11 

11111111111

""11,ll'' 

111'11111'"' 

llh 

17.2.3  Strategy 

The basic strategy used for the selection of events to support aggregation-based estimation is 
described in the steps outlined below.  The term "cluster" describes a collection of events that are 
d~1~p;~ ~<;?,,,,,,,~~"""'m~t~,~~<;?,~!'.>~ically si~lar ~ased upon cluster analysis results.  The term "stratum" 
d~§~q})~ ~,,, ~C>I!~ctj~:m of 1T1:~te~r~logically similar events to be used in stratified sampling.  In this 
chapter, "stratum" and "cluster" are essentially interchangeable since the clusters defined in the 
' arl~ysis are ultimately used as the strata for sampling purposes. 

"  ,, 

~~~ 

11::" 

:1111' 

"" 

', 

ii::"';:, 

•j 

111,, 

1. 

,  ' 

, 

,, 

,••' 

'11111, 

, 

"" 

•11111111" 

•· 

,,, 

""  2. 

We explored different approaches to the cluster analysis of wind components, each of 
which resulted in the definition ofa set of clusters (strata) ofmeteorologically similar 
1  ev~nts, for possible use in alternative stratification schemes.  Some alternatives that were 
explored include annually defined clusters (i.e., strata defined using cluster analysis of 
daily wind field  data from several years, without regard to season), seasonally defined 

""1111 

,,,,,,,,  clusters (i.e., strata defined using distinct cluster analyses of wind field  data pertaining to 
different seasons), and regionally defined clusters (i.e., strata defined using distinct cluster 
analyses of wind field data for different geographic regions). 

The alternative stratification schemes explored in step  1 were compared using relative 
efficiencies and meteorological considerations.  The concept of relative efficiency relates 
to the yariance associated with an estimate derived using different sampling schemes.  We 
" explored the variances associated with estimates of the annual means of the evaluative 
meteorological parameters described above (visibility, temperature, relative humidity). 
T~~ r~I,~!:i~,~, effic!ency of each stratification scheme is defined as the ratio of the variance 
associated with simple random sampling to the variance associated with stratified sampling 
, using iil'ai scheme.  A large refative efficiency is indicative of a high degree of precision 
(lower variance) associated with the estimate of interest. As discussed previously,  since 
these evaluative meteorological parameters do not afford a complete, direct assessment of 
the validity of process with regard to the parameters to which it is ultimately to be applied, 
meteorological considerations were taken into account in combination with the relative 
efficiencies in order to select a general stratification scheme.  The selected scheme 
(seasonal stratification) was considered for more detailed refinement in step 3. 

We determined an appropriate number of clusters to retain in combination with an 
acceptable number of events that would be necessary to achieve the objectives.  The 
determination was based on estimated standard deviations associated with several 
alternative formulations,  as well as other considerations.  The standard deviations relate 
specifically to estimates of the annual means and 90th percentiles of the evaluative 
meteorological parameters.  The "other considerations" included the objective of matching 
or exceeding the performance of the current aggregation methodology used for RADM,  as 
well as a goal of avoiding unsampled clusters.  Unsampled clusters (the inclusion of 
clusters for which no events would be selected) were considered to be undesirable because 
there would be no information available in the aggregation process to account for events 
contained in such a cluster.  In concept, our view was that any unsampled cluster should 
be combined with another cluster to which it is most similar.  In practice, we achieved this 
by constraining ourselves to collections of clusters that were adequate to support the 
sampling of at least one event from each cluster.  Twenty clusters were ultimately 
retained,  consisting of five  clusters defined in each of the four seasons,  and the number of 
events necessary to achieve the objectives was determined to be 40. 

A stratified sample of 40 events was randomly selected from the 20 clusters defined in step 
3.  Proportional allocation was used in  determining the number of events to be selected 
from each cluster (stratum).  Optimum allocation was considered but was not used for 
several reasons,  including:  ( 1) it requires the quantification of the variance of a primary 
outcome parameter, whereas only secondary evaluative outcomes (visibility, temperature, 
relative humidity) were available as discussed previously, and (2) the variance of any 
outcome parameter varies geographically,  so that optimum allocation would likely result in 
differing numbers of events depending upon the geographic location, whereas proportional 
allocation would not.  It was verified that,· at least based upon the evaluative outcome 
parameters that are available,  in most geographic locations the distribution of events that 
arises from proportional allocation does not differ substantially from that arising from 
optimum allocation. 

Details concerning the implementation of this approach are discussed in the following sections. 
Sections  17.3  and  17.4 correspond to steps  I and 2 in the strategy outlined above,  and  section 
17. 5 includes a discussion of steps 3 and 4. 

17.3  Cluster Analysis of Wind Fields 

The cluster analysis of wind components is described in this section.  This includes a description 
of the wind field  data, the basic analysis technique, variations of the basic technique, and methods 
of presentation.  Some graphical results of exploratory analyses are also included. 

17~3.l  Description of Wind Data 

To accommodate the continental domain and to achieve adequate spatial resolution,  the cluster 
,~2:1ysis involves data at 336 grid nodes with 2.5°  spatial resolution, as obtained from the 
NQ:E:PlN~~'.'!Q-year reanalysis project (Kalnay et al, 1996).  In this analysis,  700 mb wind 
~owponents for  1800 UTC have been used, in consideration of the mountainous western regions 
:n tf~,111 S,,~11W,~n,,; .... ,11111111111~~,mers ~f!P.~ ~~d were cut back to guard against excessive influence from 
ocean-based meteorology.  Graphical illustrations of this domain are referenced later in this 
section. 

" 1 " "  ' 1111111111 " " 111111 

' ! 11111 ·  " 11111 ' ' 

, 11111111111,,  •  ' 

' " I 

" " ' "  " ' 

' " 

' 

" " 

: ' 

' I " " 

' 

" 

' llli 

111111!:,,, 

1111•!:ii:111111111111: 

' 11·11111111 

1111:''', 

11111111 

17.3.2  Basic Cluster Analysis Technique 

Cluster analysis, in the present formulation,  involves the classification of a set of observations into 
categories that are internally homogeneous with respect to defined multivariate relationships in the 
data.  In this case "multivariate" refers to the multiple variables used to characterize wind fields, 
,,  eonsisting of the u and v components applicable to each location within the previously described 
domain and extending over an event that includes multiple days. 

A 12-year period (1984-1995) was considered in the exploratory cluster analyses, later refined to 
a 9-year period (1984-1992) for the final clustering upon which episode selection was based. 
Since CMAQ is actually run for a 5-day period for each event (the first two days establish initial 
conditions, and model predictions from days 3-5 are saved as a "3-day event"), 5-day periods 
were clustered rather than 3-day periods.  To make the analysis computationally feasible,  the first, 
third, and fifth days of each 5-day event were considered.  Based upon the performance noted by 
Femau and Samson (1990a,b), Ward's method of cluster analysis was used (Ward,  1963), 
minimizing within-cluster sums of squares, in an agglomerative (i.e., moving from many clusters 
toward fewer clusters), hierarchical (i.e., once clusters are joined they cannot be separated) 
process.  Thus, if a single observation (event) is considered to consist of2,016 elements (the 2 u 
,~211111111!" ~~_eon~~ts x  33~ grid nodes  x  3 days considered per event), then the objective of the 
9lq§t~r an!!lysis is to divide these observations into clusters (categories) for which the within(cid:173)
···  gl~11~!er ,~g:t,,,Q,~,,11~9uare~ (sum of squared differences between the elements of individual 
ob~~rvations qi::  m~s) is minimized. 

, 

, 

,
1111111

I 

,,,1111!111111 

111li1111  ""··1 

I' 

11 

1111111,, 

'I 

' 

" 

' 

' 

""' 

'" 

11111111:; 

,1111111!11111111

1
:::1111111111!'' 

, 11111111111111111' 

·1:,,,.11' 

111111

"

11

1
11 

"

''11111111111'' 

In the exploratory analyses,  clusters were initially defined based upon "consecutive" rather than 
"running," or overlapping 5-day periods from 1987-1992.  Then, each remaining event ("running" 
5-day periods from  1984 through 1995) was classified into the cluster that minimizes the sum 
(over the 3 3 6 grid nodes and three days) of the squared deviations of each u and v component 
from the cluster mean u and v.  In the final cluster analysis, using 1984-1992 data, consecutive 5-
day periods from  1984 through 1992 were clustered, and remaining events were classified into 
those clusters according to the same criteria described above.  Cluster analyses were carried out 
using SAS (SAS Institute Inc.,  1989); however, due to the extreme computational burden of these 
analyses it was necessary to calculate the distance matrix externally from the clustering procedure 
itself. 

17.3.3  Illustration of Cluster Analysis Results 

Representative results from the selected exploratory analyses,  as well as all results from the final 
cluster formulation,  are illustrated graphically.  Specifically, cluster definitions are illustrated using 
maps of cluster average wind fields.  In some cases, these are supplemented with specialized maps 
illustrating the intracluster variability in the wind fields.  Star chart histograms are also used to 
illustrate the frequency of occurrence of events from each cluster, for each month of the year. 

To provide proper perspective for a review of this analysis,  it is useful to consider preliminary 
results for a set of 3 0 clusters initially defined using annual data from  1984-199 5.  The most 
prevalent cluster (labeled Cluster 1) accounted for  12.19% of all  5-day events during this time 
period, with nearly all of those events occurring during the summer months.  Map-based graphs of 
mean wind vectors for this cluster are contained in Figure 17- I ( a-c ).  Three maps are included, 
representing mean vectors for days  1,  3,  and 5 of the 5-day event.  These maps illustrate largely 
stagnant conditions associated with an anticyclonic pattern centered over the southeastern U.S.; a 
zonal flow over southern Canada and a trough over the west coast of the U.S. 

As a second example, Figure  l 7-2(a-c) illustrates mean wind vectors for a somewhat less 
prevalent cluster that accounted for 3.65% of all  5-day events during this time period (ranking 
ninth in overall prevalence and labeled as Cluster 9).  Most of these events occurred between the 
months of October and April,  characterized by northwesterly winds associated with a large-scale 
trough moving through the central and eastern portion of th~ domain. 

While these maps are effective in illustrating average behavior associated with each cluster, they 
do not give any indication of the variability inherent in the clusters.  Figures 17-4 (a-c) and  17-5 
(a-c) contain additional maps that address this issue.  The first  map (Figure  l 7-3a) illustrates the 
wind field for the third day of an individual event (January 23-27,  1989) that was assigned to 
Cluster 9.  Comparison of this map to the mean wind field  for day 3 of Cluster 9 (Figure 17-2b) 
reveals fairly close resemblance between the two.  By contrast, the maps in Figures 17-3b and  17-
4c depict the third day from two other events belonging to Cluster 9.  These patterns do not 
resemble the mean wind field  as closely, and are indicative of the variability among individual 
events that were assigned to this cluster. 

Clearly it would be useful to simultaneously visualize the variability exhibited by all of the wind 
fields assigned to each day of Cluster 9,  and Figure 17-4 ( a-c) represents an attempt to do this. 
These maps contain the mean wind vectors for each day of Cluster 9 on a thinned-out grid that 
only includes alternating grid nodes.  In addition,  the maps contain groups of small dots,  each of 
which depicts the location of the wind vector arrowhead for an individual event assigned to this 
cluster.  The groups of dots collectively illustrate the distribution of arrowheads for all events 
b~I,gpging to Cluster 9. 

The dots surrounding each mean wind vector arrowhead appear in a somewhat circular pattern, 
and the extent of spread exhibited by the dots illustrates the degree of variability among wind 
vectors assigned to the cluster.  Similar patterns characterize the variability associated with other 
clusters (not shown).  Clearly there is substantial variability associated with the wind vectors 
as 1signed to incHvidi.ial  clusters.  This variability emphasizes the ambitious nature of the endeavor. 
In essence, the goal is to categorize many years worth of meteorological patterns into a finite 
number of classes.  Furthermore  each meteorological pattern does not simply describe a single 
location at a given point in time; it is required to simultaneously represent a broad spatial domain 
over a significant temporal period.  Indeed, it should not be surprising that a substantial amount of 
variability is associated with the result. 

llllllllllllllll'11lll11••llllllllll,,11lllllll111l 

'lllllllllllll11111lllll'",,1ll11lll: 

!11,,111'",:111111111111111" 

1111111111111111111111111111111111 

,11111111111111111111,• 

""""""""""' 

'"""" 

11111 

II" 

'"""' 

l 

1111 

" 

11

llllli111 

II 

" 

"I' 

111111•11111' 

"dlllllllllll 

'"""""""'"""'"""""" 

1
'11111111111111,11:,.'1
"11 
"

'll,,,,.11111,,,,llllll.,,,l,,,,1111111111111111""11"11h11llllllllllllllllllllllll1 

Figure 17-5 (a-e) contains star chart histograms of the 30 clusters defined using annual data. 
'Each chartillustrates the frequency of 5-day events belonging to a given cluster, and the clusters 
' th1s1m§~ly~,,,,111~1~111111!:>r1111111,~r~121
,1~cco~d~1~g to overall ~equency of occurrence.  As shown on the charts, 
events from Cluster 1 accounted for 12.19% of all 5-day events between  1984 and  1995, those 
from Cluster 2 accounted for  12.10% of all events, etc.  The numbers arranged radially on each 
chart depict the number of events belonging to the cluster from each month of the year.  The 
length of the line pointing to each month is proportional to this frequency of occurrence, and the 
ends of the lines are connected to facilitate the visualization of patterns. 

" 

Several observations may be made based upon these charts: 

• 

,;:1,,,, 

1·.1111111 

11111 

• 

,

Although defined using annual data, the cluster frequencies reveal definite seasonal 
tendencies.  That is,  clusters do not occur randomly throughout the year, but rather exhibit 
aJ~p.g~gcy to occur more frequently within specific seasons.  Thus, the annual clustering 
1  procedure successfully identifies and discriminates wind field  patterns that are associated 
,,,  : V{i~h s~soQally distinct meteorological classes. 
, : 'Yi~11il~1111 51!1~~1l1~r~to!1i~ni~~ s1:1ID.IIler events tend to b~ quite distinct from those containing 
,,  ~1!1E-t~,~1111111~:V~12ts,,,  and vie~ versa), many clusters contam events from a combined 
' transitional" season that includes both spring and fall  months. 

';:::11111111111111111:::::"' 
1
1
,
1',,,,:'":11111111111111111111111::' 

'1~11·'  "'Ill!  "  1111!1  ;,,,·1 

!11111'11111111 
·1.llllilillllllllllll: 

0
1
1
1
,',
,
1111111111ll
I:  .'l
lii:

11,,1ll",,111i,ulllli1111,,;;111' 

::::  ,,,1u,,,11:::'1''  111' 

, 
~11111,.  ,, 

":::11111111  '11!1'' 

I 
,::  ', 

'I·":,, .,111: 

ll1u11llllllll111' 

'11:,,,· :. 

.. ,,,'!11111:, 

"'"' 

,1, 

,,, 

,,11 

.Ill' 

,,,, 

"~' 

"Ill" 

1
" 

''I. 

" 

"' 

11

I 

'" 

I 

I 

·: 

I" 

' 

,. 

11 

111111!'':: 

1111,, 

111111;,,, 

111111111! 

1
1
1
1

1 

111

1111
1
1
1

111111::::111 

1111", 

1111111"1 

:,'!:111111; 

11111111 

1,1,11111111 

1111111111111 

111111111111111 

"'11111"'· 

:111111 

Ill' 

: 

·111111111 

11

1 

' :

·.:1111111:::

1111 

'111111 

:1"" 

:l1111111111'

11

h' 

• 

,111111::: 

1111:;111:'" 

1 

,

111111111111 

'1:• 

,,,,,111111 

I• 

I 

lllll", 

,,,,''1111111111111111111' 

11i11111111lllllll• 

,,'  ~1~1~,,,!~1~ m~s~ prevalent clusters heavily emphasize the summer months; each of these 
111  c:l~~,~~~1~111  !D:1~,!,~~~~,,,,,,,!11ore than,, ~v.:!ce a~n~~y, events as ~y ?ther cluster, ,,,,with the vast 
, Majonty of summer events contained m them. 

•  • 

"""" 

"11" 

"'  111111""111, 

'' 

' 

111111111111' 

'"" 

'""'' 

' 

'' 

" 

"11111111111111,,, 

11111111111'",lll' 

1111111111 i ; , 

",,,111111111111111:::11111'" 
: 11  ' 1111 i 111111111111111111 i i  1 

, , 

, 11 11 " 

' : 11111111 11111111111 

1 

111 
: " 
I : 

1 
11 
" 
" " 11 

:  , ,  , "  11 " " ; : ; ! 11 : : : ! ; 1 

1 
11 

, , , 

' " 111 ~ 1 ~ , 

,  " 

The disproportionate representation of summer events by two of the 3 0 clusters is  not surprising, 
si21~~ t!\~ ~In~""""~~,!,~,,!,~ ,~~ e~pectecl to be less variable in the summer.  However, seasonal 
differences in meteorology and atmospheric chemistry are important in explaining the variability 
eXhlbited by the arr quality parameters of interest.  The addition of more warm season clusters 
could provide improved resolution in this regard.  This is the primary motivation for conducting 
analyses using seasonally distinct clustering. 

17.4  Evaluation of Alternative Aggregation Approaches 

The previous illustration clarifies the motivation for investigating seasonally distinct clustering. 
Similarly, regionally distinct clustering offers an alternative that might provide improved 
resolution of wind field groupings on smaller spatial scales.  An added dimension to the problem is 
that the number of clusters to be retained clearly affects the degree of resolution.  To gain an 
understanding of the importance of these considerations as they relate to estimation of the 
meteorological parameters used as evaluative tools in this analysis, these and other alternatives 
were explored in several combinations.  These explorations, designed to expose patterns and 
trends from which to make an informed selection of a general approach, are described in this 
section. 

17.4.1  Description of Alternative Approaches 

Several variations of the u and v wind vector clustering were investigated.  As discussed 
previously, these were selected to investigate patterns and properties, and not necessarily to be 
considered as final  candidates for cluster definitions.  They are as follows: 

• 

• 

• 

• 

• 

• 

Annually defined strata with variations in the number of strata: 5,  I 0, 20, 30, 60, and 90 
clusters;  · 

Seasonally defined strata using warm and cold seasons: totals of I 0,  20, 30, and 60 
clusters equally divided between the warm season April-September period and the cold 
season October-March period; 

Seasonally defined strata approximately equally divided among summer (June, July, 
August), winter (December, January, February), and transitional (spring and autumn 
combined) seasons: totals of 20, 30, and 60 clusters; 

Seasonally defined strata equally divided between summer and winter seasons, and with 
approximately twice as many strata defined for the transitional season: totals of20 and 30 
clusters; 

Seasonally defined strata approximately equally divided among summer, winter, spring 
(March, April,  May), and autumn (September, October, November) seasons: totals of20 
and 30 clusters; and 

Regionally defined strata: 30 clusters identified in each of four separate cluster analyses 
for the northeast, southeast, northwest, and southwest subsets of the domain 

We also investigated the alternatives of strata defined to simply mirror the four seasons 
(disregarding··· .ai 

...  l clu ...  sters), str. ata defined by clustering of 3-day events rather than 5-day events, 

·  and ~trata ~~~ned ~y clustering the meteorological parameters used to evaluate the approach. 

111.1111. 

1 

'I,,.,, ............ 

···· 

······ 

17.4.2  Description of Meteorological Data 

II,, 
:'111111' 
111111111111' 

""

l';::::;lll 
1
11111
' 

11' 

,1111 

"'"""''11''111,, 

'11111111111"" 

1111"""' 

I', 

'111111111111"' 

"" 

,111111,,111 

11,, 

' 

" 

f~,~"'·~'~ ~~,~P1:8:YV~"""'~tr2;g.~,~~,!~5>11;,,~Sh,~1!1e.~, p~eliminary testing was performed  y examining the 
,,  ~E~r::tail!tY associated with tne use of cluster-based stratified sampling to estimate the annual 
mean of daily noontime levels of visibility, temperature,  and relative humidity, with primary 
emphasis placed upon visibility as discussed previously.  Visibility (units ofkm- 1) was specifically 
ex}Jressed as the light extinction (bm), less observations with precipitation, and less observations 
, with relative humidity greater than 90%.  The light-extinction coefficient is often used to 
cb!!f~Ct~tj,~1~, v~,~~,?H~;x, although in general, it has limited ability to predict human visibility.  The 
visual range vr \kmJ  can be estimated from the bcxt  by using the Koschmieder equation: 

,II""' 

'"""""''""'b 

I''"' 

'" 

'111111111'"1,, 

111111'':111· 

1111111111 

11111111 

:1111111111111111, 

111111111111111111::· 

11 

I• 

'1"' 

3.91 

(17-1) 

Temperature is in units of degrees Celsius, and relative humidity in percent.  These parameters 
were taken from 201  locations in the continental U.S. for which coverage was at least 99%, as 
, illustratecf fu figure  17~6:  Tllis was specifically defined as sites exhibiting at least 99% 
completeness for hght extmction coefficient; allowances were made for m1ssmg  observations that 
1W~1~e associated With precipitation SO  as fiOt  to bias the inclusion Of Sites toward drier climates. 

'""''""""""""  ..  '"'"""  """" 

1
""'""'""

"',::11111111!'" 

'11111111111111!'

·  "' 

1111111111

""""

11111

"·· 

• 

• 

• 

• 

• 

• 

"'

11!:

'"

11

11

11

11111111111111"',1111 

':,, 

1111111 

1"1,,,,,11111111111111111111''11111• 

1!llllli11illllllllll 

·1' 

11111 

•1 

·11111,,1111111111111111111 

1111111·1 

1111 

1111' 

i,,,11111 

11

1
"'

11, 

11

11111

::::111]' 

···"' 

"': 

.. 

' 

17.4.3  Analysis Methods 

'111!!!!1!'' 

li11111iiillll!!!!!lllllllllllll 

''111111111111111! 

,,,, 

,11 

.,1::::11! 

11

'11 

I  ''

11!!!!1111111111: 

'""'' 

' 

1111

· 

'!1111 

'! 

11 

' 

111111, 

'II" 

''" 

:1::: 

'lilll!: 

' 

I 

'1111111 

., 

'!11111111111 

11111111111

· 1:, 

111 

11111:, 

,;11

The average relative efficiency associated with the estimation of mean annual visibility, 
temperature, and relative humidity, using each alternative stratification scheme, was used for 
comparison of the schemes.  Specifically, at each location and for each scheme, the variance of an 
aggregation-based estimate (Cochran,  1977) of the annual mean was determined in three ways, 
assuming that the estimated mean was calculated using (1) a stratified sample with equal 
aJ~~,,<;-:,~!:i~i:t,,,~,~r2,,~,,~  ~,!,,~~t~ {2) ~sti:at~~ed ~a~pl~with pr<?portion~. allocation across strata, and (3) 
simple random sampling, with a total sample size consisting of the same numbers of events in each 

~~6i"~~dq~}i'r~:ct0~¥t{6~'t!1~ ~:!ii~J;~~;i~; ~:1;n: ::~~!~~d:~~ t~x~r:~s:~a~~~he 
'rei'~'tiveeffici~~~y"'()r each of those designs.  FlnaI(y,  those relative efficiencies were averaged 
across sites to provide an indication of the overall efficiency of each scheme. 

11111111.:1·;111111:·:1111111111111111111111111111111111111111111111111111111111111° 

11111111111111111111111. 

'""""'""'"""' 

"111··1 

"" 

::, 

"" 

,,, 

l'""ll 

,1111111111 

111 

11

·''''

' 

11111111 

,. 

' I i 

' : : 11111111 

11111 · 

' ' 

1111111111 

I 

' 11111 " "  ' 111 

1 I " " 11111111 '  1111111111111111111  " 

" I 'Iii ' i 1111111111 

; 111111 

11 
" 

1111

111111111 

11 ~ ! 1111111 

' " ' 11111111111 

' 11111 : 

Tltj.s !§ Q~1)t e?Cpiained using a specific example.  First,  suppose that the mean annual temperature 
at a given location is estimated as the average of the daily temperatures from  30 randomly 
,  sampled 3-day events from the period  1984-1992, completely disregarding any information 

rela~ed ~9 ~!usters; ...  Suppose that the standard deviation associated with that estimate is  1. 5 ° C,  so 
that a 95% confidence interval would yield the estimated mean±2.94°C (=1.96xl.5).  Second, 
suppose that the mean is instead estimated as a weighted average from 30 3-day events, using two 
events per cluster (i.e.,  stratified sampling with equal allocation), and using the frequency of 
occurrence of each cluster as the weight applied to the temperature from the corresponding event. 
Suppose that the standard deviation associated with that estimate is  1.0°C, compared to  I.S°C 
from simple random sampling.  Last,  suppose that 30 events are selected using proportional 
allocation (i.e., the number of events selected from a cluster is proportional to the number of 
events belonging to the cluster),  and that the standard deviation of the resulting estimated annual 
mean temperature is 0.8°C.  These standard deviations (1.5,  1.0, and 0.8) translate to variances of 
2.25,  1.0, and 0.64 for simple random sampling,  stratified sampling with equal allocation, and 
stratified sampling with proportional allocation,  respectively.  Thus, for this hypothetical location, 
the relative efficiency of stratified sampling with equal allocation is 2.25/1.0=2.25, and the relative 
efficiency of stratified sampling with proportional allocation is 2.25/0.64=3.52.  Proportional 
allocation is more efficient than equal allocation in the sense that it leads to lower variances and 
therefore tighter confidence intervals bounding the estimated mean. 

17 .4.4  Results 

Tables 17-2 ( a-b) and  17-3  present mean relative efficiencies associated with annual means of the 
daily noontime temperature, relative humidity,  and extinction coefficient, as estimated using 
aggregation approaches based upon the various schemes described above.  In each table, results 
are presented to illustrate the relative efficiency of estimation methods using equal allocation 
(equal numbers of events selected to represent each cluster) and proportional allocation (numbers 
of events selected in direct proportion to the total number of events categorized into the given 
cluster).  Relative efficiencies reported in this section are valid for any number of events that 
might be selected, as relative efficiency is invariant to sample size under equal or proportional 
allocation 

In the case of proportional allocation, the relative efficiency actually refers to the minimum 
variance that might theoretically be achieved if proportional allocation were carried out precisely. 
In practice this might only be possible if a very large number of events were to be sampled, since 
the appropriate proportions might otherwise dictate sampling of fractional numbers of events from 
some clusters.  Therefore, the relative efficiency reported for proportional allocation may be 
thought of as an upper limit to the relative efficiency that might actually be achieved in practice. 
In all likelihood, this upper limit cannot be attained,  but it should be possible to achieve a relative 
efficiency occurring somewhere within the range defined by this upper limit and the relative 
efficiency associated with equal allocation of events among clusters. 

The first six rows in Table  l 7-2a illustrate relative efficiencies associated with various numbers of 
annually defined strata (i.e., clusters emerging from cluster analyses of daily wind field  data from 
1984-1995 without regard to season).  Several observations may be made by inspecting the first 
six rows in Table 17-2a: 

The relative efficiency associated with the estimation of mean temperature is consistently 
highest, followed by that of relative humidity.  This implies that the meteorological 
"Clusters are most useful in distinguishing between events with regard to temperature, and 
~1~~t ~1§15,ful111111!n gi~tj~~.~shin~ extinction coefficient. 

In the case of temperature, the variability associated with stratified sampling using wind 
field-based clusters is consistently less than the variability associated with simple random 
sampling (i.e., relative efficiencies are uniformly greater than  1.0).  Thus, in each scheme 
the clusters contribute important information that explains variation in temperature. 

For the estimation of mean relative humidity and mean extinction coefficient, the use of 
stratified sampling based upon wind field  clusters is consistently more efficient than simple 
random sampling if proportional allocation is approximately satisfied.  In most cases, the 
use of equal allocation actually results in less efficient estimation than simple random 
sampling; this reflects a wide range of stratum sizes that would be inappropriately 
represented using equal allocation. 

As would be expected, the efficiency associated with proportional allocation increases as 
th~ !1U!!!Qe~ ~(~trata ~c,~~~~'~'~' in~orporating more refined representations of the 
ril~t~qrglogical classes within the strata. 

' The efficiency associated with equal allocation decreases as the number of strata increases. 
The stratum sizes become more divergent when more strata are defined,  so that the 
ineffl~,!,~,pcy of equal allocation is magnified. 

Based upon the well-known properties of stratified sampling discussed above, our objective was 
""""'to"''"Ciesigri  and frnplement a scheme based upon approximate proportional allocation.  The numbers 
fo[,, equal allocation in these tables merely served to provide a lower bound on the efficiency that 
could b~ realiz~d. since it was known that the precise degree of efficiency reported for 
proportional allocation might not be achievable in practice due to the requirement of sampling 
integer-valued numbers of events. 

As discussed in section 17. 3 .3  above in regard to the analysis illustrated in the "3 O Strata" row of 
the table, summer events are disproportionately represented by two of the 30 clusters.  To 
evaluate the effect of improving the resolution of summer meteorological patterns, as well as the 
effects of imposing constraints that would alter the resolution of families  of clusters under a 
varlety of scenarios, various implementations of seasonally distinct clustering were investigated. 
,,,  T~~, l~~,t (oyi: t:QYI~ gf 'J)iJ~l~ ~ 7:7'!JJlustrat~ r~~ult~ associated with stratum definitions based upon 
,,,  a simple warm/cold seasonal dichotomy, in which separate cluster analyses were conducted to 
force equal numbers of strata for each season.  The following observations may be made based 
,i1ponthis portion of th

With the exception of extinction coefficient estimation under proportional allocation, 
stratification using seasonally defined clusters consistently yields improved efficiency over 
stratification using the same number of annually defined clusters.  Thus, although the 
annually defined clusters do adhere to a seasonal pattern, the improved resolution afforded 
by the forced inclusion of more warm weather clusters (and reduction of cold weather 
clusters) is particularly effective in explaining variation in temperature. 

For seasonally defined clusters, the relative gains in efficiency associated with using equal 
allocation are large as compared to the potential gains associated with using proportional 
allocation.  Thus, in departing from proportional allocation (which is not precisely 
achievable in  practice as discussed above),  seasonally defined clusters are likely to afford 
improved efficiency over annually defined clusters. 

Results associated with further seasonal stratification schemes are illustrated in Table  l 7-2b.  The 
first two rows correspond to approximately equal numbers of clusters divided among summer, 
winter,  and transitional (spring and autumn combined) seasons, the next two rows correspond to 
equal numbers of clusters divided between summer and winter with approximately twice as many 
transitional season clusters, and the fifth and sixth rows correspond to approximately equal 
numbers of clusters divided among four seasons.  In each case, the exact distributions are 
constrained to result in total numbers of strata that are directly comparable to the numbers of 
strata investigated in other seasonal and annual analyses. 

Under proportional allocation,  stratification schemes based on three or four seasons offer 
significantly improved efficiency in the estimation of mean temperature compared to two-season 
and annual stratification schemes with comparable total numbers of strata.  They also demonstrate 
slight but uniform improvement in the estimation of extinction coefficient, and mixed results in the 
estimation of relative humidity. 

Table 17-2a.  Mean relative efficiency' associated with estimation of the annual (1984-1995) 
mean of the indicated parameter, using various stratified2  sampling3  approaches relative to simple 
ran  om samp mg. 

/  1· 
c 
ontmenta  ana yszs. 

· 

r 

d 

Temperature 

Relative Humidity 

~H-Adjusted Extinctioli 

Coefficient 

' I 

~ Ill I ' 

1111

'1!

1:11111ii; 

1 "  ' ' 111111111  ' 
1 

,,,,lli1111i::::

,,1111111" 

'l  11' 
111 

I' 

Method 

5 Strata 

10 Strata 

20 Strata 

30 Strata 

60 Strata 

90 Strata 

1 O Strata Defined Seas-
onally (5 Warm, 5 Cold) 

20 strata Defined Seas-
onally (1 o Warm, 1 o 
Cold) 

30 Strata Defined Seas-
onally (15 Warm, 15 
Cold) 

Equal 

Allocation  Propor-
tlonal 

Across 
Strata 

Allocation 

Equal 

Allocation  Propor-
tlonal 

Across 
Strata 

Allocation 

Equal 

Allocation  Propor-

Across 
Strata 

tional  . •· 
Allocation 

2.34 

2.29 

2.11 

2.08 

1.81 

1.43 

2.62 

2.41 

2.50 

2.83 

2.86 

3.05 

3.10 

2.94 

1.14 

1.09 

0.88 

0.86 

0.76 

0.62 

1.11 

1.18 

1.22 

1.26 

1.28 

1.32 

1.33 

1.26 

1.01 

0.90 

0.69 

0.67 

0.59 

0.53 

0.93 

1.12 

1.14 

1.16 

1.17 

1.19 

1.20 

1.13 

2.91 

3.54 

1.11 

1.35 

0.89 

1.16 

3.14 

3.60 

1.17 

1.37 

0.91 

1.17 

60 Strata Defined Seas-
onally (30 Warm, 30 
Cold) 
1 
B~lf:!t1~~,,,,,,,!::,,ffi£,!,,~,,!:1~¥  is defined as the ratio of the variance associated with simple random sampling to 
, 
the variance associated with stratified sampling. The table entries are means of station-specific 
efficiency ratios, averaged across stations within the continental domain. 

2.74 

1.39 

1.20 

0.77 

0.98 

3.89 

2  Unless otherwise noted, stratum definitions are based on  annual clustering of 5-day events from a 
temporal subsample of the wind field data; the remainder of the sample is then classified into those 
strata. 

3  Reflects sampling of 3-day events from 1984-1995. 

111111111: 

1 

11111:111:

111111,, 

ll1 

'·ll1 

1111111,1111111111 

11111111111·,,, 

:11, 

1', 

'" 

,  Ii 

111111::::::'" 

'''!I:',, 

: 11 i i i ~ I 

::,\, 

' 

1]]11111111!' 

Ill' 
iii,,; 

,,,;,,,,l111111ii 

lllllli11illllllllll1 

1
'111 11 

'" 

1
1111111111 

,111:""

1
llllllili

1

:' 

:,,,;Ill 

1',·11111111 
',uullll,, 

17-16 

,11;1;r:1: 

,, 

'lllj,, 

Ill:'·" 

'" 

111111:11, 
'II" 

1 ' 
" 

11111111111111 

'11111::::ii' 

111, 
111111,.
11,"11111 
1lli1 

,1111111111111, 

111, 

I'":::: 

1
!11 

,:11111

,'p 

·li'1 

'''"""""" 

,11 

'1111!·:11" 

'Ill' 

1111:;,;il' 

! 

,  .. ',1111111 

' 

''""''' 

:ii 
111,1 

If, 

Table 17-2b.  Mean relative efficiency1 associated with estimation of the annual (1984-1995) 
mean of the indicated parameter, using various stratified sampling2 approaches relative to simple 
ran d 

r  Ct"  ti  I ·  
on men a  ana ysrs .. 

om samp mg. 

.. 

EP AJ600/R-99/030 

Temperature 

. Relative Humidity 

.. 

.. 

rtH-Adjusted Extinctior 

Coefficient 

. . 

Equal. 

Equal 

Allocation·  ·  Propor- Allocation 

Across 
Strata 

tlonal 

Allocation 

Across 
strata 

:Propor-
tional 

Allocation 

Equal 

Allocation 

eropor- .. 
tional 

Across 
Strata.··  Allocation 

2.66 

3.91 

0.95 

1.31 

0.90 

1.18 

2.60 

4.12 

0.87 

1.35 

0.78 

1.20 

3.31 

4.06 

1.06 

1.33 

0.89 

1.19 

2.91 

4.17 

0.96 

1.36 

0.80 

1.20 

3.23 

3.86 

1.11 

1.36 

0.92 

1.18 

2.82 

3.88 

1.03 

1.38 

0.84 

1.19 

2.93 

2.93 

1.21 

1.21 

1.12 

1.12 

2.24 

2.78 

0.97 

1.29 

0.76 

1.16 

0.92 

1.28 

0.74 

1.15 

0.63 

1.09 

.•. 

... 

.. 

. .. 
..  .. 

; 

.. 
Method 

20 Strata Defined Seas-
anally (6 Summer, 6 
Winter, 7 Transitional) 

30 Strata Defined Seas-
anally (1 o Summer,  1 O 
Winter, 1 O Transitional) 

20 Strata Defined Seas-
anally (5 Summer, 5 
Winter,  1 O Transitional) 

30 Strata Defined Seas-
anally (8 Summer, 8 
Winter,  14 Transitional) 

20 Strata Defined Seas-
anally (5  Summer, 5 
Winter, 5 Spring, 5 Fall) 

30 Strata Defined Seas-
anally (8 Summer, 8 
Winter, 7 Spring, 7 Fall) 

4 Strata Defined as 
Seasons (Dec-Feb, etc.) 

30 Strata Defined by 

Clustering 3-Day Events 

30 Strata; Seasonality 
Removed from Met. 
Parameters 

30 Strata Defined by 
Clustering Lt.  Ext. Coeff. 
1  Relative efficiency is defined as the ratio of the variance associated with simple random sampling to 

0.57 

1.89 

1.45 

0.30 

1.11 

0.51 

the variance associated with stratified sampling. The table entries are means of station-specific 
efficiency ratios,  averaged across stations within the continental domain. 

2  Reflects sampling of 3-day events from 1984-1995. 

The final four rows of Table 17-2b address issues that are useful in that they provide additional 
perspective for this analysis.  They are discussed in sequence below: 

• 

lli1111lll11111lllllli. 

1111
' 

In view of the improvement associated with seasonal stratification schemes relative to 
annual stratification, a natural question to ask is whether a seasonal scheme with one 
stratum per season (i.e.,  no cluster analysis) is sufficient to support comparable efficiency. 
Based upon the results in Table 17-2b, this method offers overall improvement relative to 
an annual scheme with an approximately equal number of strata (i.e., five strata as shown 
in the first row of Table 17-2a).  As might be expected, it is significantly less efficient than 
the use of 20 strata equally divided among four seasons, but not dramatically so. 

,111111111111111::::111111111111111•"" 

,, 

1111111111111111111111111111111111"''"' 

'111111111''1 

'1!11!1111111,11: 

"" 

• 

1111111111111''1 

othl~I~ nit~~~ questi~~ iswhethei-'ihe'clustenng of five-day everiis (using wind data 

II""'' 
fr.o.mth~ fj~~t, third,  and fifth  days) has a noticeable impact on this analysis relative to the 
clustering of three-day events that previous investigators have pursued.  Based upon 
results in Table 17-2b  the definition of30 strata using annual clustering of three-day 
,,,;;;ii1i,,,1111~~!~'hl"~1111111p'id'"""'"'~'~'~~ '~Iiitii~ results to those associated with 30 strata using five-day event 

clustering (fourth row of 17-2a) with respect to the evaluative parameters.  Note that this 
does not necessarily address differences with respect to the characterization of transport. 

• 

111111::11~: 

,,,!ii 

., 

,, 

' 

1 

:::::::111

,1111111111111'"''11 

1111,111,·:111111111,, 

Ill 

11111·111111111111111111111111 

"' 

·· 

"' 

... 

!!I 

1111111111111!, 

111111111:::; 

• 

1

11

,'llllll"""'lll""'. 
"'' 
11111111111, 
I 

1111'11··'

:11·11••' 

,, 

1111"' 

'11111111111111111111, 

111 

"''1111111"'"11 

·1111111111' 

11111,,,,111111111, 

·1:1, 

"''""'·""'Ill,"" 

1111111111111111111111111111111111. 

·:,,,,,::··:''1"11111111111"1"''111 

·1,,,,,11111111111111111111111:,111111111":1111111'"1111""'111' 

A consistent result""in these analyses is th~t the relative efficiency associated'"~ith the 
;,  ~,~1!,!11~11111!p~,:"2f.~~~,,,.\empe:~tur~ is mu~h g.reater than that associated :With the. estimation of 
: ..  mean relative hunudity, which m turn 1s shghtly greater than the relative efficiency 
associated with extinction coefficient.  Since the preliminary results demonstrate 
associations between the clusters and the seasons (even for annually defined clusters),  one 
might hypothesize that this characteristic is related to the more pronounced seasonal 
tiends associated with temperature and the less pronounced trends associated with 
exffnCiion coefficient.  Table l 7-2b illustrates relative efficiencies associated with the three 
.,,.  meteorological parameters following the removal of seasonal trends from each.  (Trends 
were removed by analyzing deviations of each parameter from a sinusoidal curve fitted to 
the raw data at each location.)  Indeed, the relative efficiencies for the three parameters 
"'  are much more comparable in this context, and much more similar to the results for 
····  extinction coefficient in other analyses.  This analysis lends support to the use of extinction 
•• ,.  coefficient as the primary evaluative outcome, because it reflects the ability of each 
. scheme to charactenze short-term meteorolog1cal patterns apart from long-term seasonal 
trends. 

"111111"'"""""""""". 

:11111111111::.:,,.·11:,,11111111111111111111111111: 

11
"111111111111"

11111illlllllllll!lll1 

",111111111111111111111 

111111•11' 

"" 

1111111 

"'' 

11111111 

'"""" 

'" 

" 

' : 11 ~ ' 

" 

• 

"""""""" 

I , 

• 

A tlnafinvestigation in Table  17-2b also relates to the utility of extinction coefficient as the 
,,,  primary evaluative outcome.  Under proportional allocation, the relative efficiencies 
·~~~~~,~~;~~Y'!~t l:fld~tt~a;fu~Ii;l1au~~~a~:ri~;::~~~u~n~~~a~ir:~~~~ ~t;i~!~~de~~~i;; 
(relative to simple random sampling) in the estimation of mean extinction coefficient.  To 
put this observation in its proper perspective, it is useful to consider the maximum relative 
efficiency that might be achieved from any stratified analysis.  In particular, a stratification 
of events was performed based upon extinction coefficient itself (rather than wind fields). 
Under these optimal conditions, the relative efficiency associated with a 30-stratum 
scheme was still only  1.45, compared to a range of 1.17-1.20 for other 30-stratum 
schemes based upon wind field  clusters.  Considered in this context, relative efficiencies 
encountered in these tables are encouraging.  (This clustering of extinction coefficient 
provides some useful perspective regarding this evaluative outcome parameter, but is not 
pursued as a recommended methodology for estimation based upon the rationale outlined 
in section 2.2.) 

To evaluatt? the utility of regionally distinct stratification schemes, the continental domain was 
divided into four quadrants and cluster analyses were performed on wind fields within each 
region,  resulting in four sets of 30 annually defined strata.  For each region,  relative efficiencies 
were summarized as in the previously described analyses.  Since the mean relative efficiencies are 
constrained to sites within each region,  results in Table  17-2a are inappropriate for comparison to 
these regional mean relative efficiencies.  Therefore, Table 17-3  also includes mean relative 
efficiencies only for the sites within each region, from comparable clustering of continental data. 
These are displayed in combination with the results for strata defined using regional data. 

For example, using 30 strata under proportional allocation,  clustering of wind fields in the 
northeast quadrant of the domain results in a mean relative efficiency (averaged over sites in that 
quadrant) of 1.65 associated with the estimation of mean temperature.  For 30 strata, from 
clusters defined over the entire continental domain, the mean relative efficiency, over those same 
northeast sites is 3.14.  The results in Table 17-3  collectively demonstrate that,  under proportional 
allocation, regional stratification produces either no gains or only slight gains in efficiency in both 
the southeast and southwest regions for any of the evaluative parameters.  In the northeast and 
northwest regions,  this technique is markedly less efficient than continental clustering with regard 
to temperature, and somewhat less efficient with regard to relative humidity.  There is only a 
negligible effect on extinction coefficient. 

This result has significant importance, because it demonstrates that in the northern half of the 
domain, clustering of continental wind field  data is  actually more effective than clustering regional 
data in explaining variation in  some meteorological parameters on a regional scale.  Thus, the 
wind field  patterns associated with different levels of temperature (and,  less markedly,  relative 
humidity) in a northern region are more distinctly identified on a continental scale than on a 
regional scale.  Furthermore, wind field  patterns associated with different levels of extinction 
coefficient (a primary evaluative parameter due to its close association with fine particles) in a 
given region are no more distinctly identified on a regional scale than on a continental scale. 

Table 17-3:  Mean ;~lative ~fflcie~cy1  associat~d with esti~ation of th~ annual (1984-1995) mean 
of the indicated parameter, using various stratified sampling2  approaches relative to simple 
ran  om samp mg. 

. 
eg10na  ana yszs. 

R 

d 

l' 

I 

I 

Temperature 

Relative Humidity 

RH-Adjusted Extinctiori 

Coefficient 

Region/Method 

Northeast; 30 strata Def. 
Using Regional Data 

Northeast; 30 Strata Def. 
Using Continental Data 

Southeast; 30 Strata Def. 
Using Regional Data 

Southeast; 30 Strata Def. 
Using Continental Data 

Southwest; 30 Strata Def. 
Using Regional Data 

Southwest; 30 Strata Def. 
Using Continental Data 

Northwest; 30 Strata Def. 
Using Regional Data 

Allocation  Propor- Allocation  Propor- Allocation  Propor-
tlonal 

.tional 

tional 

Allocation 

Allocation 

Equal 

Across 
Strata 

Allocation 

Equal 

Across 
Strata 

Equal 

Across 
Strata 

1.41 

1.65 

0.98 

1.15 

0.95 

1.27 

2.27 

3.14 

0.77 

1.20 

0.61 

2.35 

2.72 

1.04 

1.32 

0.77 

1.28 

1.22 

2.02 

2.62 

0.83 

1.24 

0.61 

1.20 

1.95 

2.42 

0.94 

1.26 

0.81 

1.01 

1.88 

2.43 

0.89 

1.22 

0.84 

1.04 

1.17 

1.66 

0.92 

1.27 

0.82 

1.08 

Northwest; 30 Strata Def. 
Using Continental Data 
1  Relative efficiency is defined as the ratio of the variance associated with simple random sampling to 

1.96 

1.47 

1.03 

2.82 

1.01 

0.71 

the variance associated with stratified sampling. The table entries are means of station-specific 
efficiency ratios,  averaged across stations within the continental domain. 

2  Reflects sampling of 3-day events from 1984-1995. 

lllllllllll;·lli1 

""''' 

11111111111111111111111111 

1111,,illllllllllllll 

•Ii 

'I• 

,  ";,111111111111111, 

11::,,11111111111, 

'l•'ll· 

"',,,1111111111111,'  1 

,11111 

11111111111111!":,;1  '11111111111111111 

i''lllllllllll1""llll" 

In .. Y!~Vf Qf!h~ ~Yf1::~nt o~jective of matching or exceeding the performance of the current RADM 
stratification scheme over the continental domain,  it is appropriate to compare the relative 
efficiency of the stratification scheme used in the aggregation ofRADM output compared to the 
refative efficiency of the schemes defined above.  Table 17-4 addresses this specific issue.  In 
addition to the results associated with equal and proportional allocation, this table illustrates the 
mean relative efficiencies associated with the actual allocation of the 30 RADM events, which lies 
somewhere between those extremes.  (Proportional allocation was not a specific goal of the 
methods developed for RADM, although it is not inconsistent with the less formally stated goal of 
selecting more events from the clusters that accounted for most of the acidic deposition.) 

Table 17-4.  Mean relative efficiency1 associated with estimation of the annual (1982-1985) mean 
of the indicated parameter, using various stratified sampling2 approaches relative to simple 
ran d 

. 
comparative ana yszs. 

om samp mg. 

RADM 

r 

I 

. 

BP A/600/R-99/030 

.. 

Temperatur.e . 

.. 
Relative Humidity 

.. 

. . 

RH~Adjusted Extinctior 
.. 

. 

Coefficient 

Actual 
Propor- Alloc.  of 
tional  RADM  Equal 

Actual 
Propor" Alloc.  01 
Equal 
tional  RADM 
Alloc.  Alloc.  Event~  Alloc.  Alloc.  Events  Alloc.  Alloc.  Events 

Actual 
Propor- Alloc.  of 
tional  RADM  Equal 

.. 

.. 

.. 

Method 

19 Existing RADM Strata 
Defined from  Clustering 
1979-83 3-Day Events 

38 Existing RADM Strata 
Defined After Separating 
Wet &  Dry Categories 

0.98 

1.58 

1.45 

0.76 

1.18 

1.07 

0.67 

1.18 

1.11 

0.83 

1.76 

1.12 

0.59 

1.19 

0.88 

0.49 

1.17 

0.92 

4 Strata Defined as 
Seasons (Dec-Feb, etc.) 
1  The table entries are means of station-spec1f1c efficiency ratios,  averaged across stations within the 

1.18 

2.77 

1.13 

1.13 

1.02 

1.17 

.. 

3.06 

3.05 

1.11 

RADM geographic domain. 

2  Reflects sampling of 3-day events from  1982-1985. 

In the RADM development,  19 strata were defined based upon clustering of3-day events 
occurring between 1979 and  1983.  These were then subdivided into wet and dry categories, 
ultimately resulting in twice as many (3 8) strata that are actually employed in aggregation-based 
estimation.  (Events from the 1982-1985 time period were classified into these strata, with 30 
events selected for use in RADM.)  The temporal and spatial domains applicable to the RADM 
development differ from those of the current analysis; therefore, any comparisons should be 
considered in this context. 

The RADM domain approximately corresponds to the combined northeast and southeast regions 
displayed in Table 17-3.  A comparison of Table 17-4 to Table  17-3  results under proportional 
allocation suggests superior performance associated with the strata identified using clustering of 
continental wind field  data, with respect to the outcome measures used here.  When the actual 
allocation ofRADM events is considered, the superiority of proportional allocation associated 
with the continental analysis is further elevated. 

17.5  Refinement of the Sampling Approach 

Based, in part,  on the results discussed in section 17.4, a stratified sampling scheme involving 
seasonal clustering based upon four distinct seasons was selected for further consideration and 
refinement.  The general superiority of three- and four-season stratification schemes was 
discussed previously in relation to results depicted in Table 17-2 (a-b ),  and a four-season scheme 
was selected following additional considerations regarding differences in emission patterns 
. 
between spring and autumn that would not be apparent using our evaluative parameters alone. t~ 

Another benefit of using this type of scheme is that it naturally lends itself to the development of 
~~~<?!laJ ~stimates based upon four-season partitions.  The derivation of such estimates from a 
two- or three-season scheme would not be as well defined,  and the estimates themselves would 
P~~gly be less precise. 

1111:::11 

"" 

1

''1111111111!1

" 

Having selected this general approach, refinements were needed to determine an appropriate 
nµmp~r of ~trc:i,ta,  and to arrive at an adequate number of events for sampling.  These refinements, 
aiid a description or the sample of events that ultimately was selected, are discussed in this 
section.  This aspect of the analysis was limited to a refined time frame consisting of the nine-year 
'11"'1~11~1R'~'d''fFoni"'f"'9'84:T992:wruch was targeted to ultimately represent baseline meteorology for use 
in modeling. 

· 

, 

17.5.1  Determination of Appropriate Numbers of Strata and Events 

The analysis proceeded under the assumption that, in order to satisfy the goal of matching or 
exceeding the performance of the RADM 30-event stratification scheme, a minimum of30 events 
w9µld ~~ required in the framework of the continental domain.  The precision associated with the 
·····estimation of annual means of the evaluative parameters was investigated for a range of30 to 60 
events,  and for  16, 20, 24, and 28 seasonally defined strata (4,  5,  6,  and 7 strata per season, 
respectively). 

These numbers of strata were chosen as candidates because 19 wind field-based clusters were 
defined in the RADM scheme, which offers a certain degree of resolution with regard to the 
c9i,ifacterization of transport (which is not specifically addressed by the evaluative parameters 
investigated here).  The range of 16 to 28 strata was selected to provide comparable resolution of 
wind fields and associated transport, noting that higher numbers of strata result in greater 
variation in the sizes of those strata, and this would force a more pronounced deviation from the 
goal of proportional allocation.  As discussed previously, a primary goal was to ensure that every 
stratum is sampled,  i.e.,  that there are no  clusters which go unrepresented in the final  set of 
events. 

"",  ""'""'" 

·1111111111111111""""""""'"" 

'" 

""""" 

:!!11111111111111111111111

"'11,,,,11• 

"""''" 

,, 

,111, 

""""' 

"'"' 

'II 

,,111111111' 

:, 

'""' 

, 

'" 

"'"'' 

•. 

:·:1 

II 

Note that we did not adhere to traditional rules of thumb regarding the determination of 
appropriate numbers of clusters to retain.  These rules are based upon an assumption that some 
finite number of clusters is appropriate to represent the variability inherent in these patterns, and 
that additional clusters beyond that point add relatively little information.  In reality, clusters 
d~fiQ~~<!~fi!lg this process represent a continuum, and traditional F-test statistics illustrate this 
continuum quite smoothly.  There is no magic number of clusters after which the relative 
importance of additional clusters drops noticeably.  Indeed, as cluster analysis is used here merely 
for the definition of strata and not as an end in itself, there is no compelling reason to be restricted 
by existing conventions regarding determinations of an optimal number of clusters. 

:::111111111111111 

,lllll'.,11111 

I 

I"' 

11111,11 

I' 

111 

,1111111111' 

111"11111 

,1111, 

11111111, 

'" 

,i; 

'"'1111,,,lll 

'"""''""11111111111: 

'1111 

Standard deviations associated with estimation under all of the combinations described above are 
iliusirate<l""IO:TableT7-s:  'Furtiieiinore, the process was repeated after seasonal adjustment of 
each outcome parameter (seasonality was removed by analyzing deviations from a fitted 
sinusoidal curve), to ensure that long-term seasonal trends do not unduly influence any pattern. 
The standard deviations in Table 17-5  provide an indication of the degree of precision associated 
with estimation, and are influenced by the observed within-stratum variability of the parameter. 
One would expect the inclusion of more strata to facilitate greater precision, unless this increased 
precision is offset by incurred deviations from proportional allocation. 

Table  17-5.  Standard deviation1 associated with estimation of the annual mean of the indicated 
parameter, using stratified sampling2 with 16, 20, 24,  or 28  strata and 30, 35, 40, 45,  50,  55,  or 60 
events.  Continental analysis. 

.  No. ot· 
Events 

Temperature, deg. c 

Relative Humidity, % 

.. 

RH-Adjusted Extinction 
Coefficient, km-1  (x103
) 

16 

20 

24 

28 

16 

20 

24 

28 

16 

Strata  Strata  Strata  Strata  Strata  Strata  Strata  Strata  ~trata  Strata  Strata  Strata 

20 

24 

28 

NOT SEASONALLY ADJUSTED 

30 

35 

40 

45 

50 

55 

60 

30 

35 

40 

45 

50 

55 

0.97 

0.98 

0.95 

0.95 

2.38 

2.40 

2.38 

2.40 

6.69 

6.73 

6.73 

6.77 

0.89 

0.89 

0.87 

0.87 

2.19 

2.20 

2.20 

2.21 

6.03 

6.08 

6.10 

6.23 

0.83 

0.83 

0.81 

0.81 

2.04 

2.05 

2.06 

2.05 

5.71 

5.63 

5.70 

5.71 

0.79 

0.77 

0.76 

0.75 

1.93 

1.92 

1.93 

1.93 

5.38 

5.34 

5.33 

5.36 

0.74 

0.74 

0.72 

0.72 

1.82 

1.83 

1.82 

1.82 

5.09 

5.06 

5.07 

5.08 

0.71 

0.70 

0.69 

0.68 

1.74 

1.74 

1.73 

1.73 

4.78 

4.79 

4.83 

4.83 

0.67 

0.67 

0.66 

0.65 

1.66 

1.66 

1.65 

1.65 

4.62 

4.62 

4.60 

4.60 

SEASONALLY ADJUSTED 

0.75 

0.76 

0.75 

0.75 

2.32 

2.34 

2.33 

2.35 

6.67 

6.70 

6.70 

6.75 

0.69 

0.69 

0.69 

0.69 

2.14 

2.15 

2.16 

2.16 

6.01 

6.05 

6.08 

6.21 

0.64 

0.64 

0.64 

0.64 

1.99 

2.01 

2.02 

2.01 

5.69 

5.61 

5.68 

5.69 

0.61 

0.60 

0.60 

0.60 

1.89 

1.88 

1.89 

1.88 

5.36 

5.32 

5.31 

5.34 

0.57 

0.57 

0.57 

0.57 

1.78 

1.79 

1.78 

1.78 

5.07 

5.04 

5.05 

5.06 

0.54 

0.54 

0.54 

0.54 

1.70 

1.70 

1.70 

1.69 

4.77 

4.78 

4.81 

4.81 

60 

4.59 
1  The table entnes reflect the standard dev1at1on  associated with  the average station-specific variances 

4.59 

4.60 

1.62 

1.62 

1.62 

1.62 

4.60 

0.52 

0.52 

0.51 

0.51 

(averaged across stations within the continental domain). 
2  Results reflect sampling of 3-day events from  1984-1992. 

For temperature and relative humidity,  the table suggests that for any given number of events, any 
effect associated with different numbers of strata is  negligible.  For extinction coefficient,  standard 
deviations for 3 0 and 3 5 event schemes increase slightly with increasing numbers of strata.  There 
.....  is ..  a minimum standard deviation associated with 20 strata for the 40-event scheme, and only 
negligible effects across strata for greater numbers of events. 

The objective of this determination was to develop a sufficiently large set of strata to provide 
some resolution with regard to the characterization of transport, yet be sufficiently concise to 
ayoid any reduction in precision that would result from unsampled strata or from the inability to 
approximately satisfy proportional allocation.  In consideration of these criteria and the above 
results, 20 strata were determined to constitute an appropriately sized set. 

...  figure 17-7 ( a-c) provides perspective regarding the relative precision provided by sample sizes of 
25 or more events associated with estimation of annual means of the ~vall1~tive parameters, based 
upon th~ ~se of2o seasonaily defined clusiers as strata.  The stand aid deviation displayed in each 
••  graph is actu8:!ly associated with the average of the variances across sites.  These graphs illustrate 
•  •':•  tli~ aciy@Jage of stratified sampling with proportional allocation relative to simple random 

,.,,, 

11

• 

1
11

.,

•• 

11111 

1111111

;. 

111 

111111111 

sampling.  They also illustrate the relative gains in precision (expressed as reduction in standard 
···ae\1at1on) thafarereruized as the number of events is increased.  The star symbols plotted on the 
··  .:;11:graphs indicate the actual standard deviation that would be realized for selected sample sizes 
· uilder a 20-stratum scheme, with events distributed in accordance with proportional allocation to 
the extent possible.  The selected sample sizes were chosen based upon practical limitations 
l11voIVingihe number of events that might realistically be implemented.  The stars do not fall 
sfrictly on the proportional allocation curve because of limitations associated with the sampling of 

·····  integer-valued numbers of events. 

These graphs indicate that, for temperature, it might be practical to achieve a standard deviation 
in the range of0.6-l.0°C, and that a much larger sample size would be needed to reduce the 
standard deviation below 0.5°C.  Similarly, standard deviations associated with estimates of mean 
relative humidity can possibly be achieved in the range of 1.5-2.5%, and realistic standard 
deviations associated with extinction coefficient might be in the range of0.0045-0.0070 1an- 1
Geographic variability with respect to many of these results is described later in this section. 

• 

Although the estimation of mean levels of parameters is likely to be a primary point of emphasis 
for many model-based results, the accurate estimation of extremes is also of significant 
importance.  This issue was specifically addressed by investigating the precision associated with 
the estimation of the 90th percentiles of the evaluative parameters . 

·:,,,. 

:11111111: 

•'"'' 

•• 

:11······111111111: •••• 

.. 

" 

························· 

··························11::·· 

·····:11:···::··································································· 

......................................................................................  y 

......  In contrast to the standard deviations associated with estimation of the mean,  there is no closed-
;:iiii' form solution to deternlliie the vanabiHt  associated with the estimation of 90th  ercentiles . 
Therefore  a Monte Carlo-type resampling approach was utilized to estimate these standard 
':lllllllllllllllllllll"'·111llllll1111111111111llll'"'"::1111111111llll11,,,,,,~1111•' 
~ii~1!2;~11~1121~11i1111  ,!,2,!~ 11~,ee~ifically involved randomly selecting 200 artificial samples of actual data, 
ea,~h~Onl?isting of the required number of events, from the 20 seasonally defined strata.  From 
···  e8:'chsample and at each site location, the 90th percentile of the parameter was estimated.  The 
v!;fiance of tlie resuliing collection of 200 estimates was averaged across sites,  and the associated 
standard deviation served as an estimate of the precision associated with the particular sample 
size.  This exercise was repeated for sets of 30, 40,  50, and 60 events. 

The graphs in Figure l 7-8(a-c) illustrate the resulting standard deviations, along with the standard 
deviations associated with estimation of the mean using the indicated number of events.  As would 
be expected, the standard deviations associated with estimation of the 90th percentile are higher 
than those associated with estimation of the mean of each parameter.  This difference is most 
pronounced for extinction coefficient, with standard deviations for 90th percentile estimation 
being approximately three times those for mean estimation.  For relative humidity,  they are 
approximately twice as large.  The difference is least pronounced for temperature, where the 
increase is less then 20%.  In each case, there is only slight, gradual improvement in the precision 
of 90th percentile estimation for sample sizes of greater than 40 events. 

_ The next step is to arrive at an appropriate number of events to be distributed among these 20 
strata.  Table 17-6 displays the standard deviation associated with the estimation of the annual 
mean of each evaluative parameter (both raw and seasonally adjusted) that would result from 
samples consisting of30, 40,  50, and 60 events.  For comparison purposes, these standard 
deviations represent average variances restricted to the RADM geographic domain.  The table 
also displays the standard deviation associated with the aggregation of 30 3-day events in a 
sample stratified using the original RADM clusters.  From this,  it is clear that any number of 
events would be sufficient to provide improved resolution relative to the RADM scheme, in the 
context of the evaluative parameters reviewed here. 

Although these results suggest that a 30-event sample would be sufficient to meet the objective of 
matching or exceeding the performance of the RADM approach with regard to estimation 
precision for these outcome parameters, other results displayed in this section demonstrate clear 
improvement in the precision associated with estimation of both means and extremes by moving 
from a 30-event sample to a 40-event sarriple.  In addition, a 40-event set is  needed to ensure 
equal precision to the RADM approach with regard to the estimation of wet deposition amounts. 
The RADM set of 30 events included 20 events from categories that were identified as "wet'', i.e., 
2
for which average wet S04 
- deposition exceeded the median for each cluster.  In other words, 20 
events were selected from the "wettest" 50% of all events. 

This oversampling of wet events was originally pursued to ensure the adequate representation of 
those events that contributed most significantly to wet deposition,  because the accurate 
characterization of wet deposition was the primary purpose ofRADM at that time.  However, 
concerns have since arisen that the disproportionate representation of these events may have 
introduced an overall bias with regard to the ambient concentrations of pollutants that are 
influenced by cloud cover and precipitation.  In view of these concerns, and since wet deposition 
is not the primary focus for CMAQ, the oversampling of wet events was deemed inappropriate for 
present purposes.  In the absence of this oversampling, it is still necessary to include a sufficient 
number of events to ensure that wet deposition is characterized as accurately here as in the 
RADM approach.  This would require approximately 20 wet events, and the same median-based 
definition of wet versus dry events implies that approximately 20 dry events should also be 
included.  Therefore, a total of 40 events was deemed necessary to satisfy all of the objectives. 

Table 17-6.  Standard deviation1 associated with estimation of the annual mean of the indicated 
parameter, using stratified sampling2 with 20 strata and 30, 40, 50, or 60 events.  RADM 
co 

. 
mparatJV<! a11atys1s. 

I 

Temperature, deg. c 

Relative Humidity, % 

RH-Adjusted Extinction 
Coefficient, km·1  (><103
) 

....... 
' 

20 Strata 

Existing 
RADM 
Sample 

20 Strata 

Existing 
RADM 
Sample 

20 Strata 

Existing 
RADM 
Sample 

(30 Events) 

(30 Events) 

{30 Events) 

.. 

NOT SEASONALLY ADJUSTED 

0.96 

0.82 

0.73 

0.66 

0.74 

0.63 

0.56 

0.51 

1.78 

0.82 

2.34 

2.01 

1.79 

1.63 

2.58 

SEASONALLY ADJUSTED 

2.32 

1.99 

1.77 

1.61 

2.41 

6.65 

5.60 

5.01 

4.59 

6.64 

5.60 

5.00 

4.58 

8.28 

8.23 

No. 
of 
Eve 
nts 

30 

40 

50 

60 

30 

40 

50 

60 

1  The table entnes reflect the standard dev1at1on associated with the average stat1on-spec1fic variances 

(averaged across stations within the RADM geographic domain). 

2  "Existing RADM Sample" results reflect sampling of 3-day events from 1982-1985.  Other results 

reflect sampling of 3-day events from 1984-1992. 

Recalling that for 40 events the precision associated with the estimation of mean annual extinction 
coefficient (the primary evaluative parameter) was optimized using 20 seasonally defined strata 
(Table 17-5), a final plan was adopted for sampling 40 events from 20 strata (5  strata per season) 
using approximately proportional allocation. 

Figure 17-9(a-d) displays star chart histograms of the 20 clusters defined as strata in this 
arrangement.  Each chart illustrates the frequency of occurrence of 5-day events belonging to a 
given cluster, and the clusters themselves are ordered according to overall frequency of 
occurrence.  The numbers arranged radially on each chart depict the number of events belonging 
to the cluster from each month of the year.  Map-based graphs of mean wind vectors for day 3 of 
each cluster are contained in Figures 17-1 O through 17-29. 

In order to examine the impact of this scheme geographically (in the context of the precision 
associated with the estimation of mean levels of the evaluative parameters),  we examined 
graphically (not shown), the standard deviation at each site location alongside the actual mean 
with which that standard deviation is associated.  Similarly, analogous information associated with 
the estimation of 90th percentiles were examined.  This examination confirmed  the relative 
geographic uniformity with respect to the standard deviations, which serves as support for the use 
of"average" standard deviations in drawing conclusions throughout this section. 

17 .5.2  Selection of Stratified Sample of Events 

A stratified sample of events was randomly selected from the 20 seasonally defined strata for the 
period  1984-1992.  The sample was selected without replacement to ensure that no single day 
was selected into more than one five-day event, i.e., that there was no overlap between selected 
events.  Systematic sampling (Cochran,  1977) was used within each stratum for which more than 
one event was to be selected.  Specifically, all events assigned to the stratum were ordered 
chronologically, an event was selected near the beginning of that ordering, and subsequent events 
were selected to be evenly spaced throughout the remainder of the ordering.  If k events were to 
be sampled from a cluster containing n events, to illustrate the simple case in which n/k is integer 
valued, the first event would be randomly selected from any of the chronologically first n/k events, 
and every (n/k)th subsequent event would be selected.  The purpose of this approach was to 
ensure appropriate representation over the entire nine-year period. 

Table  17-7 displays the total number of events belonging to each stratum, the number of events 
sampled, and the dates of the sampled events.  These dates are the middle dates of the three-day 
events for which the model ultimately is to be run (i.e., the last three days of the sampled five-day 
event).  This sample of 40 events includes representation from every month of the year, and from 
every year during the period  1984-1992.  Table 17-8 illustrates this representation by displaying 
the number of events selected from each month and from each year. 

Total# of 
Days in 
Stratum, 
Stratum  Season  1984-1992 

1 
2 
3 
4 
5 
6 
7 
8 
9 
10 
11 
12 
13 
14 
15 
16 
17 
18 
19 
20 

Spring 
Summer 
Autumn 
Winter 
Spring 
Winter 
Spring 
Summer 
Summer 
Winter 
Autumn 
Autumn 
Winter 
Autumn 
Summer 
Autumn 
Winter 
Summer 
Spring 
Spring 

292 
267 
238 
210 
200 
188 
185 
171 
171 
170 
168 
150 
139 
135 
129 
128 
102 
90 
89 
62 

1111111111' 

.,,1111:.111111111 

11,,,,111111111:" 

1111111111 

11111,, 
:Ill 
II" 

"'':1111111!!' 
1111111111' 
'1 'llh·1llllllll: 

1l•'1" 

Table 17-7.  Stratum sizes, number of sampled events per stratum,  and dates of events in sample. 
Dates shown are for middle dav of 3-day event. 

.. . ·~ ... 

, ···r:~'···-: 

: 

., 

Number 

Of 

Sampled 
Events 

.• 

, 

' 

Event Dates 

; ...... :~: ... :: .. ,· 

,,,, 

, 

, 

. 

.. 

3 
3 
3 
3 
2 
2 
2 
2 
2 
2 
2 
2 
2 
2 
2 
2 
1 
1 
1 
1 

12 March 1985, 08May1987, 27 March 1990 
17 July 1985, 20 August 1987, 10 August 1990 
08September1986, 12October1988, 08October1991 
04 January 1986, 15 December 1988, 02 December 1992 
07 May 1984, 06 March 1990 
03 January 1987, 07 January 1992 
01  April  1986, 26 March 1991 
05 August 1986, 29 June 1992 
07 August 1984, 12 July 1989 
18 January 1984, 25 January 1989 
18October1985, 12September1991 
17November1987, 14September1992 
19 February 1985, 27 January 1990 
17 October 1988, 24 November 1991 
03 July 1987, 09 July 1992 
25 November 1985, 07 November 1990 
18 December 1989 
22 July 1989 
09May1990 
30 April 1991 

····:;::;::::::::"""" 

Table 17-8.  Number of sampled events representing each month of the year and each year from 
the period  1984-1992. 

EPN600fR-99(030 

.. 

Month 

January 

February 

March 

April 

May 

June 

July 

August 

September 

October 

November 

December 

Number of Events in 

sample 

Year· 
... • 

•··. 

.. ···  Number of Events in 
'···.· 

~,mple· 

; 

6 

1 

4 

2 

3 

1 

5 

4 

3 

4 

4 

3 

1984 

1985 

1986 

1987 

1988 

1989 

1990 

1991 

1992 

3 

5 

4 

5 

3 

4 

6 

5 

5 

17.6  Application and Evaluation 

In this section,  examples of the aggregation calculation for annual mean concentrations and total 
wet depositions,  applicable to this sample of events,  are provided.  Following this example is a 
description of an evaluation exercise in which the aggregation calculation was carried out for light 
extinction coefficient, and the aggregated estimates were compared to the actual values based on 
data from all of the days in the period. 

17.6.1  Application of the Aggregation Procedure 

Aggregation calculations will be applied to model-based depositions and concentrations obtained 
for each sampled event, to achieve unbiased estimates for annual and seasonal means and other 
summary statistics within each grid cell.  Since the goal of sampling from every defined stratum is 
achieved in this approach, these calculations are simplified in comparison to earlier aggregation 
methods (NAPAP,  1991).  In essence, these aggregation calculations merely produce weighted 
means, totals,  or other summary measures, from the sample of events. 

To illustrate the aggregation approach, consider the estimation of a mean annual air concentration 
using model output for the 40 events selected above.  These events represent 20 strata; denote 
these using the subscript i, i=I,2,  ... , 20.  Let/; denote the frequency of occurrence associated 
with stratum i, i.e., the total number of3-day events belonging to the stratum during the period 
1984-1992.  For an individual grid cell, also let 
... :•··represent the mean model-based concentration associated with all sampled events from stratum i. 
··  Thus, for stiafa with a single sampled event, it is just the event mean concentration in the grid cell. 
"'''''''' 
For strata with two or three sampled events, it is the mean concentration for all of those events. 
Then the esiim'aied annual mean rur concentration is given by 

'"''''''''''''  " "'''"""" 

''"'''''''''' 

""'" 

' 

"" 

... 

,, 

Mean  Air Concentration  =  I= 1 

-

20 
EJ;CMODEL 
/ 

20 
EJ; 
/=l 

(17-2) 

II 

"' 

.llllllllllllll!"!lllii11,,,i:"'l11lll" 

.!!1111''  ,,,!

:illlll,,J,,,,111 .. 1111 .. 

·:1;:]111111111" 

"" 

,,,,. 

:, 

"'· 

"""'l"":':"'!!""'"';;·,,lllllllii 

:'!II: 

, 

,,,,,,,;;;;·"""' 

'lllu,' 

,,'  ""'• 

' 

:II 

, 

""')'"' 

"•:' 

II 

•11111 ......  "1111 

'"""" 

1
!::::1i1111," 

~,gm~!.~,,§fQ£!EP~t,,,2~~~ par~eters (e.g., dry depositions  and other summary statistics are 
calculated using similar methods.  The calculation for wet deposition is different,  primarily 
becaus,~ .,,the ~~~ghtin~}s partially dictated by precipitation.  Let 

.... 

·· 

" 

illllllllll:: 

1111· 

I 

111::::1111:.:' 

1111111":::1111 

'":111111!!!'' 

11111111 

re{)ie's'ent the mean 3-day modeled deposition for sampled events in stratum i, the mean 3-day 
modeled precipitation for sampled events in stratum i, and the total measured precipitation 
accounted for by all events belonging to stratum i, respectively.  Then the estimated total annual 
wet deposition is given by 

Total  Wet  Deposition 

lllllliiillll,,,, 

11:::11111111111111:" 

:1111111111111::::111 

111

!11111 

1''

x  PMEAS  x 

I 

1 
3X9 

(17-3) 

''"""" 

1r:11,,,,::: 

1111111111111":1 

T.W .. ~ ~xpression can be thought of as a weighted sum in which the model-estimated wet 
""  CQ,Q~~tI!!!:!P!1f2~,2: stftitumis ~.~!~~!ed by the total measured precipitation associated with the 
~111,  stratum.  The final component of this expression is included to reflect the fact that each day is 
counted three times in the calculated sum (due to the use of3-day events) and that the strata are 
defined over a nine-year period. 

17.6.2  Evaluation 

In order to determine the effectiveness of the aggregation technique and subsequent episode 
selection, comparisons were made between the observed mean bcxis for the period  1984-1992 and 
the aggregated estimates of that mean using the stratified sample of events described in 17.5.2 and 
listed in Table 17-7.  This preliminary evaluation, which includes simple  regression analysis,  is 
similar to that performed on RADM (Eder and LeDuc,  1996;  Eder et al., 1996). 

Results comparing the observed and aggregated mean bcxis  (based on Equation 17-2) are 
promising as seen in the scatterplot provide in Figure 17-30.  The correlation between the 201 
observed and aggregated mean bcxt  was very high correlation (r =  0.988).  Estimates of the 
regression coefficients between the observed and aggregated mean bcxts reveal an  intercept value 
of -0.0012 that is not significantly different from zero (a= 0.05):  The slope (1.018), however; is 
significantly different from  1.0, (a= 0.05) indicating a slight tendency for these particular 
episodes to provide an over-estimate of the expected mean bcxt·  This slight, "apparent" bias is, 
however, well within the expected variability associated with the particular set of episodes in this 
stratified sample.  To wit,  selection of a different random set of episodes would just as likely 
result in a slight under-estimate of the expected mean  bcxt· 

Perhaps a better way to illustrate the effectiveness of this technique can be shown through an 
examination of the percent deviation in aggregate estimates of the mean bcxi  (where the deviations 
are relative to the observed mean (aggregated bcxt - observed bcxt I bcxt  observed).  These percent 
deviations, which were calculated over the period  1984 -1992, are presented in Figure 17-31.  For 
the most part, the deviations are within ±  10%, indicating excellent agreement between the actual 
mean bcxt  and the aggregated estimates of the mean bcxt· 

The slight over prediction tendency mentioned above appears to be somewhat spatially biased as 
also seen in Figure 17-31.  As seen in the top of the figure,  areas of generally positive deviations 
(aggregation approach yields a higher bcxt>  hence lower visibilities than observed) appear to 
concentrate from east Texas into the southeastern states and again in the upper midwest between 
Minnesota and the Dakotas.  The states of California and Idaho also exhibit positive deviations. 
Negative deviations,  presented in the bottom of the Figure 17-31, tend to predominate from the 
northeast states into the Great Lake States and southwestward toward the states of Kansas, New 
Mexico and Arizona.  This spatial dependence of the estimates is,  once again, well within the 
expected variability.  Selection of a different random set of episodes would likely result in a 
different pattern of positive and negative deviations, as there is a natural tendency for sites at 
close proximity to behave in a similar fashion. 

The scatter plot in Figure  17-30  also reveals an increase in variance about the regression line 
starting at an observed mean bcxt  of 0.085.  Unlike the positive bias,  discussed above, this increase 
in variance does not appear to be spatially biased,  but rather exhibits a random distribution across 
the domain.  This is represented in Figure 17-31  by the scattering of the larger biases (i.e.  biases> 
5.0%) evenly across the domain. 

17.7  Summary and Discussion 

The objective of this research was to develop a new aggregation approach and set of events to 
support model-based distributional estimates of air quality parameters (acidic deposition, air 
concentrations, and measures related to Visibility) over the continental domain.  The basic 
approach is to define meteorological categories that account for a significant proportion of the 
variability exhibited by these air quality parameters, as well as the particular transport mechanisms 
involved,  so that source-attribution analyses are facilitated.  This requires that categories be 
d~.!i.rn~.4 Y!'.!t!1 !:!!! erp.phasis on wind flow parameters.  To this end, the cluster analysis of zonal u 
and meridional v wind field  components has been used to determine meteorologically 
representative categories. 

'1111"1111'11",,,,11 

"'""""'"" 

1111,,.lh 

""""""' 

111111!"

The research described in this chapter was carried out in three phases: 

1111!,ll 

"111111111: 

I 

'" 

1i1 

r::/111 

1'1.1111 

• 

1111111111111

1
' , , :  

: 11 ! ! ! 111111 i I : 

:11111i11i111, 

1111

lllll!

ii11·, 

•  lllli.::;.,. 

1111111111111 

.11111111111 

.1: 

:1111:::1::· 

1111111::::11:' 

• 

Phase  I: Various stratification schemes were evaluated and compared on different 
temporal and geographic scales to support the selection of a preferred general 
methodology.  The selected methodology involved clustering of wind field  data over the 
' c0iitinental domain within each of the four seasons, and defining strata to be equivalent to 
the resulting clusters.  This methodology demonstrated superior relative efficiency 
compared to methods defined on an annual time frame or on a regional scale for estimates 
involving the evaluative meteorological parameters, and is designed to support seasonal 
e5timati.on with both simplicity and precision. 

'  . "  . i 

, . I . 

, 

. " : . 

i i 11 : ~ : : ! 1111111111111111111 j : : 

... 

·:: .. 

111,1::: 

' 11111111111111111 : : : 

' 

' " : 

' , . . '  " 

::.lllu. 

,1  .. 

. , : ' i I i 
, 

. : ' 11 ' 

' 

. ; : 

. . I : : : ' ' ' . " ' . : " " . . . ; "  · 1. 

'1  .. 

'· 

1111. 

•1111 

. , ,  

' ·  

,1111. 

, 

, 

, 

,."'II' 

11 11111111111111111111111, 

PQ,~,~~111111~11;  ~11~~.~~~!:!:tio~~ w,~re.mad~T~~arding appropriate n~mbers of clusters and .events 
to ~upport samphng usmg the general methodology selected m Phase I.  The resultmg 
scheme involved a total of20 clusters (5  per season), and 40 events, defined over the time 
.•:  period 1984-1992.  This scheme affords superior precision to previous approaches for 
,,  estimates involving the evaluative meteorological parameters, supports approximately 
equivalent representation of wet events to those approaches without oversampling, and 
provides adequate resolution of wind field  patterns that characterize transport. 

.1111111'  " 0111'1 

' "   ""'""""'••' 

llh,,,',,11,''I 

,111111··1111111111 

1111''111"111 

1.''!111 

1, 

,, 

'" 

Phase 3:  A stratified sample of events was selected under approximate proportional 
allocation, using systematic sampling within strata, in accordance with the scheme 
determined in Phase 2.  This sample was successfully evaluated through a comparison of 
aggregated estimates of the  mean bex1  to the actual mean bcxt>  revealing a high level of 
agreement, although there was a slight tendency of the aggregation and episode selection 
technique to over-estimate the expected mean bcxt· 

The goal of this research was to categorize many years worth of meteorological patterns into a 
few classes.  This represents a very ambitious goal,  and it should not be surprising that there is 
substantial variability associated with the wind vectors assigned to individual clusters. 
Nevertheless, the results described above suggest that the approach achieves a reasonable 
characterization of frontal passage scenarios and leads to clusters that explain variation in the 
evaluative meteorological parameters used in this analysis (temperature, relative humidity, and 
visibility), and therefore can be used to achieve improved estimates of these parameters relative to 
estimates obtained from simple random sampling.  Moreover, the constrained definition of distinct 
seasonally-based clusters brings further improvement to the ability of the clusters to explain the 
variation in these parameters, and therefore leads to more precise estimates associated with them. 
The evaluative parameters were selected for their known associations with many air quality 
parameters of interest, thus suggesting that the clusters should also be effective in defining strata 
from which events can be selected to estimate those air quality parameters. 

17.8  References 

Brook, J.R., P.J.  Samson, and S.  Sillman,  l 995a. Aggregation of selected three-day periods to 
estimate annual and seasonal wet deposition totals for sulfate, nitrate, and acidity.  Part I:  A 
synoptic and chemical climatology for eastern North America. Journal of Applied Meteorology, 
34, 297-325. 

Brook, J.R., P.J.  Samson, and S.  Sillman,  l 995b. Aggregation of selected three-day periods to 
estimate annual and seasonal wet deposition totals for sulfate, nitrate, and acidity.  Part II: 
Selection of events, deposition totals, and source-receptor relationships. Journal of Applied 
Meteorology,  34, 326-339. 

Cochran, W.G.,  1977. Sampling Techniques.  Wiley & Sons, New York. 

Davis, R. E.  and L. S.  Kalkstein,  1990. Development of an automated spatial synoptic 
climatological classification. International Journal of Climatology,  10, 769-794. 

Eder, B.  K.,  J.M. Davis and P.  Bloomfield,  1994. An automated classification scheme designed 
to better elucidate the dependence of ozone on meteorology.  Journal of Applied Meteorology, 
33,  1182-1199. 

Eder, B.  K.,  S.K. LeDuc and F.  Vestal,  1996.  Aggregation of selected RADM simulations to 
estimate annual ambient air concentrations of fine particulate matter.  Ninth Joint Conference on 
Applications of Air pollution Meteorology with the A&WMA, Jan.28-Feb. 2, Atlanta, GA. 

Eder, B. K.  and  S.K.  LeDuc,  1996.  Can  selected RADM simulations be aggregated to estimate 
annual concentrations of fine particulate matter?  Proceedings of the International Specialty 
Conference on the  Measurement of Toxic and Related Air Pollutants, May 7 - 9, Research 
Triangle Park, NC. 

Fernau, M.E.  and P.J.  Samson,  1990a. Use of cluster analysis to define periods of similar 
meteorology and precipitation chemistry in eastern North America. Part I:  Transport patterns. 
Journal of Applied Meteorology, 29, 735-750. 

Femau, M.E. and P.J.  Samson,  1990b. Use of cluster analysis to define periods of similar 
meteorology and precipitation chemistry in eastern North America.  Part II:  Precipitation patterns 
and pollutant deposition. Journal of Applied Meteorology, 29,  751-761. 

Kalnay, E., M.  Kanamitsu, R.  Kistler, W. Collins, D.  Deaven, L.  Gandin, M.  Iredell,  S.  Saha, G. 
\Vhite, J.  \Voollen,  Y. Zhu, M.  Chelliah, W.  Ebisuzak.i,  W. Higgins, J.  Janowiak, K.  Mo, C. 
Ropelewsk.i, J.  Wang, A.  Leetmaa, R.  Reynolds, R.  Jenne and D. Joseph,  1996. The 
NCEP/NCAR 40-year reanalysis project.  Bull. Amer. Meteor.  Soc.,  77, 437-471. 

NAPAP,  199!:  National Acid Precipitation Assessment Program  1990 Integrated Assessment 
Report, National Acid Precipitation Assessment Program, 722 Jackson Place NW, Washington, 
D.C. 

SAS  Institute Inc.,  1989.  SAS/STAI® User's Guide,  Version  6,  Fourth Edition,  Volume  I.  SAS 
Institute Inc.,  Cary, NC. 

''Iii 

' 

\Vard, J.H.,  1963. Hierarchical grouping to optimize an objective function. Journal of the 
American Statistical Association 58, 236-244. 

This chapter is taken from Science Algorithms of the EPA Models-3 Community 
J't.fultiscale Air Quality (CMAQ) Modeling System, edited by D. W. Byun and J. K. S. 
Ching, 1999. 

Fig.17.1  (a) Mean wind vectors for day  1 of annually defined cluster 
1 (of 30). 


Fig.17 .2 ( c) Mean wind vectors for day 5 of annually defined cluster 
9 (of30). 

Fig.  17.3 (a) Actual wind vectors for 25 January 1986, day 3 of cluster 
9 (of30). 

Fig.  17.3  (b) Actual wind vectors for  13  January  1988, day 3 of cluster 
9(of30). 

Fig.  17.3  (c) Actual wind vectors for 8 January 1990, day 3 of cluster 9 
(of30). 

Fig.  l7.4(a) Mean and distribution of wind vect~r~ for day  I of 
91,1~st.~r 9(of30). 

Fig..  17.4 (b) Mean and distribution of wind vectors for day 3 of 
'111!,,,,clq§tei: 9 (of30). 


Fig.  17.4 ( c) Mean and distribution of wind vectors for day 5 of cluster 9 (of 3 0). 

frequencies  of  30  Clusters  (Annually  Defined) 

Cluster No.  1:  12.197. 

1
'

'

1111ii:!lllllll' 

llli;,, 

Jan 

0 

Ila• 
2 

Apr 
7 

Uay 
32 

Od 
II 

m  Jul 

127 

Jun 
77 

Cluster No.  2:  12.103 

1111 

,,, 

,, 

;'~n 
0 

Oct 

" 

Apr 
10 

Au9 
112 

Jul 
t 32 

Jun 
90 

Cluster No.  3:  5.53% 

Cluster "No.  4:  5.37% 

Jan 

0 

Jan 

I 

Ap< 
18 

Aug 
20 

Jul 
53 

Jun 
69 

Oct 
38 

Sop 
21 

Aug 

3 

Jun 
•6 

Jul 

• 

.... 

15 

Ap< 
27 

llay 
50 

Cluster No.  5:  4.96'7. 

Cluster No.  6:  4.703 

Jon 
25 

Oct 
47 

Apr 
21 

Jon 

2 

rob 

0 

Doc 

• 

Nov 
II 

Oct 
73 

Sop 
63 

liar 

• 
Ap• 
a 

lloy 
17 

;il11' 
""II;, 
,, 

I  I 

11111111111 

'1:'"111 

1lll111i111::, 

Fig.  17.5 (a) Monthly frequencies of annually derived clusters for clusters 1-6. 

Aug 
s 

Jul 
6 

Jun 
12 

Aug 

0 

Jun 

0 

Jul 
0 

,,:111111111 

::I::"''' 
''1111, 

,1111::"11' 

:111111.11 

l''.111 
Ii 

I:, 

"' 

illh 

,, 

,!111111 

17-42 

,,"111111111:, 

:1111 

111111 

,,11111,, 

11111

' 

'1111 
:111,,, 
,111• 

''I::: 

11111: 

:iiiiii:' 


Frequencies  of  30  Clusters  (Annually  Defined) 

Cluster No.  7:  4.29% 

Cluster No.  8:  4.093 

Jon 
0 

Jon 
2 

>lov 
2 

Oct 
25 

Sop 
39 

Apr 
10 

Oct 
1• 

War 
3 

Apr 
15 

!joy 
32 

Aug 
35 

Jul 
26 

Jun 
26 

Aug 
27 

Jul 
23 

Jun 
29 

Cluster No.  9:  3.65% 

Cluster No.  10:  3.61'l';; 

Jon 
23 

Oct 
26 

.... 

19 

Apr 
13 

1'ay 
3 

Jon 
19 

Oc1 

• 

Apr 
32 

Aug 

0 

Jul 
0 

Jun 
0 

Aug 

0 

Jun 

1 

Jul 
0 

Cluster No.  11:  3.473 

Cluster No.  12:  3.403 

Jon 
31 

Jan 
35 

Oct 
7 

Uor 
35 

Apr 
I• 

Uoy 
2 

Ocl 
6 

S•p 
0 

Apr 
0 

Fig.  17. 5 (b) Monthly frequencies of annually derived clusters for clusters 7-12. 

Aug 

0 

Jul 
0 

Jun 
0 

Aug 

0 

Jul 
0 

Jun 
0 

17-43 

"11111 

····1111 
1111
!!111 

··1

' " : : ~ 

1111111111111 

1111111111111: 

. . ~ ! 11111111 

1,,,, 
,1111111111 

11, 

... 

;11111111•11• 

11ili11 

'111111 

"11111' 

'lhlll 

""'

11

111 

111, 

,·1111· 

•Ill! 

" 

:11111 

·Ill!:' 

,'1'1!1

, 

11

Frequencies  of  30  Clusters  (Annually  Defined) 

Cluster No.  13:  2. 797. 

Cluster No.  1 4:  2. 79% 

Oc1 
a 

Sop 
0 

Mor 
18 

Apr 
0 

'lay 
3 

Aug 
0 

Jun 

0 

Jul 
0 

Aug 

0 

Jul 
0 

Jun 

0 

Cluster No.  15:  2.677. 

Cluster  No.  16:  2.35% 

11111111 

lllllllllli11 

1111111111111' 

1,·,,,111111111111111,,, 

:11111111111 

1111··111111111111111111111' 

Oct 

" 

Sep 
I 

Aug 

0 

J..i 
I 

Jun 

' 

Cluster No.  17:  2.17'7. 

1111111 ! II 

1 

11111 ~ ' 

I II 

" II 1 I 1 

11111 

"  " 

II 

Jon 
10 

'" 

111 

Oct 
3 

Sop 
0 

"or 
18 

Apr 
21 

Uoy 
3 

AUQ 

0 

Jul 
0 

Jun 
0 

Cluster No.  18:  2.08% 

,,111r:1111111111, 

Jon 
12 

,,1i, 

011 a 

""r 

1 

Oct 
1 

Apr 
19 

""Y 
3 

11111111 

,,.111111 

1111111111: 

,,, 

111111111 

,,11 

"'111111111111' 

11111111111111111111 

Aug 
.~. 

Jul 
0 

Jun 

0 

Aug 

0 

Jul 
0 

Jun 

0 

Fig.  17. 5 (c) Monthly frequencies of annually derived clusters for clusters  13-18. 

Frequencies  of  30  Clusters  (Annually  Defined) 

Cluster No.  19:  1.853 

Cluster  No.  20:  1 .803 

Apr 
0 

Aug 

0 

Jul 
0 

Jun 
0 

Aug 

0 

Jul 
0 

Jun 
0 

Cluster No.  21:  1. 76% 

Cluster  No.  22:  1.67% 

Oct 
J 

..,., 

~ 

Ap• 
0 

t.loy 
0 

Aug 

0 

Jul 
0 

Jun 
0 

Aug 

0 

Jun 
0 

Jul 
0 

Cluster No.  23:  1 .583 

Cluster No.  24:  1.55% 

Fig.  17. 5 ( d) Monthly frequencies of annually derived clusters for clusters  19-24. 

Aug 

0 

Jul 
0 

Jun 
0 

17-45 

Frequencies  of 30  Clusters  (Annually  Defined) 

Cluster No.  25:  1.487. 

Cluster No.  26:  1 .443 

Jon 

' 

'11'11111• 

111
• 

'11111. 

1111111111111111111111'"''  c);'t 
z 

Apr 
4 

1111111111111""

111

' 

:111111;1,,:11111111!!

11

' 

11111111,lllll 

J.ug 

0 

Jul 
0 

Jun 
0 

C:!usler No.  27:  1 . .307. 

Cluster No.  28:  1.21% 

Jon 
3 

1'pr 
13 

Jun 
3 

Jul 
0 

Cluster No.  29:  1.147. 

Cluster No.  30:  1 .003 

11111111111" 

111111111111" 

1
1111r'' 

Oct 
111111~11, 

111111111111111111,,, 

JGn 
5 

Apr 
3 

Uoy 
2 

Apr 
5 

Fig.  17.5 (e) Monthly frequencies of annually derived clusters for clusters 25-30. 

Aug 
0 

Jun 
1 

Jut 
0 

Aug 
0 

Jul 
0 

Jun 
0 

1 1111illllllll' 

;11::1111 

111111!1!11111•'11111'' 

!11111!"'111 

11111 

1 :111111111 

'

11111

1111111 

Ir""'· 

11, 

,, 

;11111 

,:II' 

,, 

·11111,,,,,,:111111,,,lll· 

1
::!:::1111111111: 

11111,'' 

11111;,,,,,,,;;,, 

11,,' 

1111111111i''I 
,, 

'I' 

1 

:11111111

111111, 

!11111111' 

"!!111111::," 

'''''llii1 

'iilllllllll 
111111 

'1111111111 

Fig.  17. 6 Site locations for 20 I  meteorological parameters used in the evaluation. 

Standard Deviation Versus Sample Size: Temperature 
Av91'age  (Across StaHons) Standard D•vlallon Associated with 

EsHmaUon or 1984-1992 Mean rrom Aggregation or 3-0ay Eplsodn 

2.5 

2.0 

--
0 
" C> 
C> ... a 
C> 
"C  1.5 
. 
>  1.0 
~ 
.. "C 
"C ... 
c .. - 0.0 

0.5 

(/) 

\ 
\ 

\ ' ' 
'',', ........ 

..... ..... ----------------------------

0 

50 

100 

150 

200 

250 

300 

Number of Episodes In Sample 

Samplng 

Fig.  17. 7 (a) Standard deviation of estimated mean temperature 
versus sample size. 

Standard Deviation Versus Sample Size: Relative Humlcllty 

Av•rag• (Across stations) Standard Oevlatlon Associated with 

Esttmatton or 1984-1992 Mean from Aggre~atlon of 3-Day Episodes 

--~ 

> Cl 
0 
.... 
"C 
al 
"C c 

:11111::1111111:  Cl 

"111111  . . .  

(/) 

4.0 

3.5 

3.0 
2.5 
2.0 
1.5 
1.0 
0.5 
"'lllli 
0.0 

111111'' 

'llr',,, 

1111111111111111 

t,:1111;111:, 

1:' 

111111111,, 

\ 

\ 
\, 

',· 

.................... 

-..... -------------------

------

250 

SOQ 

0 

,,,50 

100 

.150 

200 

Numb'!.r of Epis~des i~ San:!ple 

,111111111· 

:111111111111111: 

'111 11111111111111 

11;;;;11111m::11111111w 

11111,,,111111!'' 

Sampling 

I'' 

I' 

1111111111111111: 

,11111'''' 

,,, 

:ll'';lii 

II 

II' 

11111111  Fig.  17. 7 (b) Standard deviation of estimated mean relative humidity 
ver~s sample size. 

17-48 

Standard Deviation Verws Sample Size:  RH-Adj Extinction Coeff 

Average (Across Stations) Standard Deviation Associated with 

Estimation of 1984-1992 Mean lfom Aggregation of 3-0ay Episodes 

EP A/600/R-99/030 

.... 
~ 

I 

> 0 
0 
"C ... 

Ill 
"C 
c 
Ill 

(I,) 

0.010 

0.008 

0.006 

0.004 

0.002 

0.000 

----

0 

50 

100 

150 

200 

250 

300 

Number of Episodes In Sample 

SampRng 

Fig.  17. 7 ( c) Standard deviation of estimated mean extinction 
coefficient (adjusted for relative humidity) versus sample size. 

Standard Deviation Versus Sample Size: Temperature 

Average (Across Stations) Standard D!Mation Associated v.ilh  Estimation of 
1984-1992 Mean & 90lh Pen rtom Aggregallon of 3-Day Episodes In 20 Strata 

1.4 

1.2 

1.0 

0.8 

0.6 

0.4 

0.2 

0.0 

0 
Cll 
0 
0 .... 
Cl 
0 -a 

> 0 
0 
-a 
.... 
«I -a 
c 

ftl -(/) 

..... _ --

----... _ 

------.._. _______ __ 

20 

30 

40 

50 

60 

70 

Number of Episodes In Sample 

Es11maUonof. .. 

+---+--*- Mtan 
... - . - - 90thPe!I 

Fig.  17.8 (a) Standard deviation of estimated mean and 90th 
percentile temperature versus sample size. 

Standard Deviation Versus Sample Size: Relative Humidity 
"  Average (Acrou Stations) Standard Devlafon Auoclated with Esllmallon of 
1984-1992 MNn & 90lh Pct! from Aggregation of 3-Day Epi&Odea In 20 Strata 

'ii 

;  . 

......... .......... 

.......... .......... ........ _ 

-----...,.__ ______ ~ 

6 

"'0"5 
~ 
. 4 
> 
83 
-a ..... 
~2 
c 
al 
Ci)  1 

lllllliiii'', 

'1111,, 

':1111111 

0 

,,1  20 

30 

40 

50 

60 

70 

Number of Episodes In Sample 

Elttmatlon or •.• 

*-+--*  ....... 
.,._ ... _,,. 

9Clt11Pctl 

Fig.  17. 8 (b) Standard deviation of estimated mean and 90th 
percentile relative humidity versus sample size. 

1
: 

11111"''

,"1111111111111 

"' 

~il<fard Deviation Versus Sample Size: RH-Adj  Extinction Coeff 
Awrag• (Across staUons) standard D....taHonAssociatlldwilh Estimation of 
1QB4-1Q92 MHn & 90!h PcU tromAggregaUon or 3-Day Episodes in 20 strata 

'"t"":ll1'i1/1,I'' 

1l1'1'11!

1

1t'!11i"' 
11!

1

11111111111111 

1
1111,,,::11111,lllliiii::, 

11111111111

"'"

1
" 

I" 

•,111 

"11111111111 

0.030 

0.025 

0.020 

0.015 

0.010 

0.005 

..... _ 
--

----·-------.... -------

I 

-..... 
~ 
. 
> C> 
0 
-a ... 
"" 
"'C c 
cd 

-Cl.) 

'11.111111111111  0.000 

,• 

20 

30 

40 

50 

60 

70 

Nt.mber of Episodes In Sample 

j  Estlmadon oL 

_...........,..  Mun 
"*-*"- 901h Ptll 

I 

) 

.. · 

:""""'"" 

: . 
'Ii} 

'.'.": 
111
,:::, 

lll""I' 
:' 
11111111111111: 

~~~1ll1i111illlll 

··· .....  \  " · :II 

•  th 
Fig.  17.8 \.C)  Standard deviation of estimated mean and 90 
percentile extinction coefficient (adjusted for relative humidity) 
versus sample size. 

. 
:: 

" 

· 

111 

, 

... ,. 

111111 

,,,:':· 

,. 

"' 

,,,,, 

. 

·· 

17-50 

"''Ill' 
.. ,:111:. 

1111 

Frequencies  of  20  Clusters  (5  Winter,  5  Spring,  5  Summer,  5  Autumn) 

Cluster No.  1:  8.89%  (SPRING) 

Cluster No.  2:  8. 13%  (SUMMER) 

EP A/600/R-991030 

Oct 
0 

"a• 127 

Ap• 
7~ 

"ay 
90 

Cluster No.  3:  7.25%  (AUTUMN) 

Cluster  No.  4:  6.39%  (WINTER) 

Cluster No.  5:  6.09%  (SPRING) 

Cluster  No.  6:  5. 72%  (WINTER) 

Aug 

0 

Jun 

0 

Jul 
0 

Fig.  17. 9 (a) Monthly frequencies of seasonally derived clusters for clusters  1-6. 

Aug 

0 

Jun 

0 

Jul 
0 

Jun 

0 

Jul 
0 

Frequencies  of  20  Clusters  (5  Winter,  5  Spring,  5  Summer,  5  Autumn) 

Cluster No.  7:  5.63'7.  (SPRING) 

Jon 

Cluster No.  8:  5.213 (SUMMER) 

lh,''lll 

Jon 
0 

,II• 

,II, 

'"'"11111111 

Oct 
0 

Mor 
35 

Woy 
9• 

''1111111
' 

ll1111lllh 

'I' 

'I' 

·111;,;;1111111111,, 

'"""'11111 

/.ug 

0 

Jut 
0 

Jun 
0 

Oct 
0 

Apr 
0 

Aug 
7, 

Jul 
53 

Jun 

" 

Cluster No.  9:  5.21 ~(SUMMER) 

Cluster  No.  10:  5.18'7.  (WINTER) 

1111111111, 

,1111111··:11111111 

/.ug 
·~ 

Jun 
6~ 

Jut 
61 

llor 
0 

Apr 
0 

t.loy 
0 

Oct 
0 

Sop 
0 

Aug 

0 

Jul 
0 

Jun 
0 

Cluster No.  11:  5.12'7.  (AUTUMN) 

Cluster No.  12:  4.573  (AUTUMN) 

: I ! ~ 

,11111111111::::11111 

111111111 

llor 
0 

Uoy 
0 

1111111111:111,,!1::' 

111111111111;1; 

1
'  I!,,: 

1
'
1!11

"'I,, 

"':i' 

" 

,II' 

1111111111111 

Q'll 

'11111 

Aug 

Ju,, 

Q 

J~I'. 

Fig.  17. 9 (b) Monthly frequencies of seasonally derived clusters for clusters 7-12. 

·1111111111111111 

•11111111· 

17-52 

11111111,,m111111 

111111::,111:,1111 

'" 

'''"' 

11

1111il:;

,illllllll[1, 

1ll"u1illll 

,,"111111

1 

11'' 

'I' 

"·,  ,iillllllllll 

11111111111'!11 

Frequencies  of  20  Clusters  (5  Winter,  5  Spring,  5  Summer,  5  Autumn) 

Cluster  No.  1 3:  4.23%  (WINTER) 

Cluster No.  14:  4. 1 1 % {AUTUMN) 

EPN600/R-99/030 

Nov 
58 

Oct 
55 

Sop 
2• 

"0' 
0 

Ap• 
0 

t.loy 
0 

Aug 

0 

Jul 
0 

Jun 
0 

Aug 

0 

Jul 
0 

Jun 
0 

Cluster  No.  1 5:  3.93%  (SUMMER} 

Cluster No.  1 6:  3.90%  {AUTUMN) 

"0' 
0 

Ap• 
0 

"oy 
0 

Oct 
13 

Aug 

0 

Jul 
0 

Jun 

0 

Cluster  No.  17:  3. 11 % (WINTER) 

Cluster No.  18:  2. 7 4%  (SUMMER) 

Oct 
0 

Ap• 
0 

Fig.  17.9 (c) Monthly frequencies of seasonally derived clusters for clusters 13-18. 

Aug 

0 

Jul 
0 

Jun 
0 

Aug 
13 

Jul 
3• 

Jun 
•3 

17-53 

"

" 

"''  Frequencies  of  20  Clusters  (5  Winter,  5  Spring,  5  Summer,  5  Autumn) 

Cluster No.  19:  2. 7 n7- (SPRING) 

Cluster No.  20:  1.897. (SPRING) 

Jon 
0 

;; 

1illllllllllllllllll. 1 

'll!I 
'"  0 

Aug 
0 

Jun 
0 

Jul 
0 

Fig.  17.9 (d) Monthly frequencies of seasonally derived clusters for clusters  19-20. 

11111111111'"11: 

11111111111111111111 

11111111111" 

''11111111111111111!' 

11111111111111111111,,,, 

Ill' 

""'I': 

",,  ''l•1" 

',111111111• 

I' 

" 

•II',, 

Fig.  17 .10 Mean wind vectors for day 3 of seasonally (Spring) defined 
d~sfer i ( of20). 

:111 

1.,,,, 

•111111111111 

1, 

11111"' 

:1 

, 

""II 

Fig.  17.11  Mean wind vectors for day 3 of seasonally (Summer) 
defined cluster 2 (of20). 

Fig.  17.12 Mean wind vectors for day 3 of seasonally (Autumn) defined 
cluster 3 (of 20). 

17-55 


,,,,,II 

Ill',,'' 

lh 

1111111111!1! 

11111111111111111111 

1lliiii1illlllllllll:,, 

'

Fig.  17 .13  Mean wind vectors for day 3 of seasonally (Winter) defined 
,,  cluster 4 (of 20). 

:1111111111:::." 

'1111111111!!111 

1111111111' 

Fig.  17.14 Mean wind vectors for day 3 of seasonally (Spring) defined 
cluster 5 (of20). 

Fig.  17.15 Mean wind vectors for day 3 of seasonally (Winter) defined 
cluster 6 (of20). 

Fig.  17 .16 Mean wind vectors for day 3 of seasonally (Spring) defined 
cluster 7 (of20). 

Fig.  17 .17 Mean wind vectors for day 3 of seasonally (Summer) 
..... defined cluster 8 (of20) . 

",,,,,,,,,,:::  d~f!ned cll;!ster 9 (of 20). 

1s.' 'Mean 

.... "· .. 

·'.··  ~d vecto;s for day 3 of'~easonally'(summer) 


Fig.  17.19 Mean wind vectors for day 3 of seasonally (Winter) 
defined cluster 10 (of 20). 

Fig.  17 .20 Mean wind vectors for day 3 of seasonally (Autumn) 
defined cluster 11  (of20). 

Fig.  17.21  Mean wind vectors for day 3 of seasonally (Autumn) 
defined cluster 12 (of20). 

Fig.  17.22 Mean wind vectors for day 3 of seasonally (W°mter) 
defined cluster 13  (of20). 

Fig.  17.23  Mean wind vectors for day 3 of seasonally (Autumn) defined 
cluster 14 (of 20). 

Fig.  17.24 Mean wind vectors for day 3 of seasonally (Summer) 
defined cluster 15  (of 20). 

Fig.  17.25 Mean wind vectors for day 3 of seasonally (Autumn) 
defined cluster 16 (of20). 

Fig.  17 .26 Mean wind vectors for day 3 of seasonally (Winter) defined 
cluster 17(of20). 

Fig.  17.27 Mean wind vectors for day 3 of seasonally (Summer) defined 
cluster 18 (of 20). 

Fig.  17 .28 Mean wind vectors for day 3 of seasonally (Spring) defined 
cluster 19 (of 20). 

Fig.  17.29 Mean wind vectors for day 3 of seasonally (Spring) 
defined cluster 20(of20). 

Extinction Coefficient (km -1) 

I 

I 
I 

~ 
.l~ 
.?• 
··················+····  ···'·····l·····. 

c:  0.2 
~ 
'(;  0.15  · 
fJ 
~  0.1 
1l 
~0.05  ···············;·~·~······ .... ··1···················1·········· 

·k."'k1 

I  ~:J-

! 

I 
! 
j 

I 

I 
I 

) 

O· 

·'"  l 

0 

0.05 

0.1 

Observed Mean 

I 
0.15 

0.2 

'Ill 

I 

Fig.  17.30 Scatterplot of the observed mean b0x1 (km"1
aggregated estimate of the mean bcxt (km-1
1992. 

)  for the period  1984-

)  versus the 

Fig.  17.31  Spatial variation of the bias of the aggregated estimates of the mean bext 
(km-1) for the period  1984-1992.  (Deviations (%) are relative to the observed mean: 
aggregate-observed/observed).  Top figure indicates sites with positive bias, bottom 
figure sites with negative bias. 


Chapter 18 
===========

INTEGRATION OF SCIENCE CODES INTO MODELS-3 

Jeffrey Young • 

Atmospheric Modeling Division 

National Exposure Research Laboratory 
U.S. Environmental Protection Agency 

Research Triangle Park, NC 27711 

ABSTRACT 

A complete group of CMAQ science codes has been integrated into the Models-3 system 
following a set of rules to ensure compatibility and compliance with design principles that enable 
modularity and flexibility and that allow easy modification and replacement of science process 
components.  This chapter describes the concept of classes and modules, the Models-3 
input/output application programming interface, science code configuration management, and 
model building and execution concepts 

·on assignment from the National Oceanic and Atmospheric Administration, U.S. Department of Commerce. 
Corresponding author address: Jeffrey Young, MD-80, Research Triangle Park, NC 2771 l.  E-mail: 
yoj@hpcc.epa.gov 


18.0 

INTEGRATION OF SCIENCE CODES INTO MODELS-3 

18.l 

Introduction 

Integration of the Community Multiscale Air Quality (CMAQ) science into the Models-3 design 
~aradigm takes place at the level of transforming the science, described by systems of partial 
differential equations, into a discretized and parameterized numerical model.  The integral parts 
that arc involved in the process are the coding language (Fortran 77, currently), an operational 
design, a set of coding rules, computer platforms, model data access methods and storage 
mailagemcnt, and a public code repository.  Models-3  is a user interface system designed to 
fnci11!J,~q.~7 .~S, 11$!~1~,~l~rment and use of simulation models by scientists, model developers and 
regulatory users.  Tne Models-3  framework provides a high-performance computational structure 
for a community modeling system that cun-ently contains distinct emissions, meteorological, and 
chemical transport air quality models.  In this chapter we define a model as a single, complete 
executable built from a set of compiled subroutines that define either a core environmental 
simulation mod~l ora l?roces~ingsystem that provides data to  a simulation model.  The 
framework also links the models to data management tools and analysis/visualization software. 

A complete set ofCMAQ science codes has been integrated into the Models-3 system.  The 
development and integration of these codes has followed a set of principles relating to design and 
implementation concepts that are discussed in this chapter. 

We have promulgated a small set of software requirements and integration rules related to these 
concepts so that science codes can be developed that conform to Models-3 requirements.  With 
this approach, the general user community may readily develop and execute models that use the 
rich and growing base of science codes and data that reside in Models-3.  A user may contribute 
to that base and allow others to  integrate his developments by  applying these integration rules. 

"'111111111111111111111111111111111111 

11111111111111111 

With access to all the released, or publicly available source files,  a developer can supplement his 
O\\TI codes and readily develop and test model versions within a highly modularized building 
environment.  On the other hand, people whose primary interest is studying the effects of control 
strategies or regulatory applications can easily build and execute standard model versions for 
different emissions scenarios and modeling domains. 

The Models-3 and CMAQ systems have been developed to  foster community access, and to 
facilitate the improvement of the CMAQ system over time by  the easy inclusion of new 
scientific models and modules developed by researchers in the larger scientific community. 

The CMAQ system contains a number of models needed to cany out an air quality model 
application.  Defining a "model" to be an executable built for a specific application, the codes 

1

' 

,;;;;Ii 

:'iii  ,,U~q,1111111,!1211~<;;.11,~J? ~~~model are relatively general.  To build a specific model, the user selects a set of 

·  fundamental criteria that determine the application, such as the modeling domain, the chemical 
1111  mechanism, and physical process solvers.  The reader is referred to Chapter 15  for details. 
Defining a generic model as the set of codes from which a particular application can be built, the 
following generic CMAQ models are currently available in the system: 


ICON provides the required initial conditions for a model simulation as concentrations of 
specified individual chemical species for the complete modeling domain. 

BCON provides the needed simulation boundary conditions as concentrations of 
individual chemical species for the grid cells surrounding the modeling domain. 

Emissions-Chemistry Interface Processor (ECIP) transforms emission files produced 
by the Models-3  Emissions Processing and Projection System (MEPPS) into an hourly, 
3-D emissions data file for the CMAQ Chemical Transport Model (CCTM).  For a 
detailed discussion of the MEPPS operations, refer to Chapter 6 of the Models-3 User 
Manual [6]. 

The Meteorology-Chemistry Interface Processor (MCIP) interprets the output from a 
meteorological model, such as the Penn State/NCAR fifth-generation Mesoscale Model 
(MMS) [8], and prepares the data for use in the CCTM. 

The Landuse Processor (LUPROC) provides a high-resolution landuse database for the 
CMAQ system.  For example, MCIP uses the output from LUPROC to obtain surface 
characteristics for computing dry deposition and other planetary boundary layer 
parameters. 

The photolysis model (JPROC) computes photolytic rate constants G-values) for the 
gas-phase chemistry used in the CCTM. 

The Plume Dynamics Model (PDM) generates plume dimensions and positions along 
with other related data for use in applying the plume-in-grid module in a CCTM 
simulation. 

The CMAQ Chemical Transport Model (CCTM) simulates the chemical and physical 
processes affecting tropospheric pollutants and estimates pollutant concentrations (e.g., 
ozone, particulate matter (PM2.5  and PM 10), and carbon monoxide) and acid deposition. 

The reader is referred to  the Models-3  User Manual  [6]  for more details and descriptions of the 
usage of these models. 

Each generic model consists of a complete set of codes that can be compiled and linked into 
different model executables by  means of specific user-selected options with regard to groups of 
code called modules, the horizontal grid and vertical layer domain, the chemical mechanism, the 
computer platform, and compiling options. 

One of the key issues in modeling is the manner in which developers and users must deal  with 
reading, writing and using model data.  Models-3  provides a user-friendly Input/Output 
Applications Programming Interface (1/0 API) library [4] that enables a universal approach to 
managing data across subroutines, models, platforms, and networks. 

The organization of the remainder of this chapter is as follows:  We discuss the concepts that lead 
to and the implementation of classes and modules in the next section ( 18.2).  We describe I/O 
API  usage and function in Section  18.3.  Code management, an important consideration for 
complex models, is discussed in  Section 18.4.  In  Section 18.5 we discuss how a model is 
organized and constructed through Models-3.  Issues in regards to executing a particular model 
are discussed in Section 18.6.  Using the Models-3  framework to  construct and execute a model 
is summarized in Section 18.7.  Finally in Section 18.8, we discuss concepts and issues that 
address Models-3 compliant coding practice and how to ensure code development that is 

11:  confonnant to the Models-3 system. 

18.2  Classes and Modules 

18.2.1  Operational Design 

'Ql~"""'g~sign concept of code classes is used to facilitate the plug&play capability in the Models-
3/CMAQ system.  Science process modules are grouped into classes that are primarily based on 
,!Pe,,,,!!,,r!,~,:,~I?littiI'}g paradigmused in a CMAQ Chemical Transport Model (CCTM).  Generally 
, each class is associated with a particular science process.  A module consists of a complete set of 
subroutines capable of modifying the concentration field related to the science process associated 
with the module's class.  The CCTM is designed so that each module computes the changes in 
the concentration ~ield (C9l.lID) SJ:>ecif!.c to that particular science process.  A science module 
'o,,,,, perates ontheentireihree:climensional gn"dded concentration field for a period of time called 
the synchronization time step interval.  The module performs whatever looping over that grid 
and over whatever internal time steps that are necessary to complete its function. 

,,,,,,111111, 

'11111111:''1111111111111 

111111111, 

.1111111111111'"'11,, 

·1111111111111 

'Ill 

'• 

'i,,,,1111111111111111111111111· 

'1111:"'"111111111111111111111111111111 

,  '11111111111111111111111'"'""""'111111111111:" 

'I 

'",,11 1
' 

'Ill'  1111'"""111' 

Ill' 

,,1111; 

:ii 

,,· 

11  iii 

"""1111'11"':1111111111111111,,,:1111"'111111111111""111""":11'"111111:' 

.111111111111111111111 

''I' 

111' 

'lllll''h 

1111111 

Table 18-1  lists the classes and associated processes and modules currently available for the 
GGIM,:,,,,, !nJ?4U!;!ing a particular CCTM, one module is selected from each class. 

The other CMAQ models (i.e., those other than the CCTM) do not generally follow the time(cid:173)
splitting science process paradigm.  However, for convenience and consistency in model 
building, and for code organization, we have extended the concept of classes and modules to 
apply to the other CMAQ models.  Class and module organizations similar to those in Table 18-1 
exist for the other models but are less extensive. 

Table 18-1.  The Classes, Processes, and Modules Available in CCTM 

CLASS 
driver 
init 
hadv 

(PROCESS) 
(Control  Model  Execution) 
(Initialize  Model) 
(Horizontal  Advection) 

vadv 

(Vertical  Advection) 

hdiff 

(Horizontal  Diffusion) 

vdif f 

(Vertical  Diffusion) 

adj con 

(Advected  Mass  Adjustment) 

MODULES 
ctm 
init 
hbot  (Bott's  scheme) 
hppm  (Piecewise  Parabolic  Method) 
hadv_noop  (no  operation) 
vbot  (Bott' s  scheme) 
vppm  (Piecewise  Parabolic  Method) 
vadv_noop  (no  operation) 
unif  (Uniform  eddy  diffusion) 
hdiff_noop  (no  operation) 
eddy  (eddy  diffusion) 
vdiff _noop  (no  operation) 
denrate 
adjcon_noop  (no  operation) 

(Photolytic  Rate  Constants)  phot 

phot 

chem 

aero 

cloud 

(Aerosol  Solver) 

(Gas  Chemistry  Solver) 

phot_noop  (no  operation) 
smvgear  (SMVGEAR  solver) 
qssa  (Vectorized  QSSA  solver) 
chem_noop  (no  operation) 
aero 
aero_noop  (no  operation) 
aero_depv 
aero_depv_noop  (no  operation) 
(Cloud  and  Aqueous  Chemistry)cloud_radm  (RADM  cloud  scheme) 

aero_depv  (Aerosol  Dry  Deposition) 

ping 

(Plume-in-Grid) 

pro can 
couple 
util 

(Process  Analysis) 
(Couple  for  Transport) 
(Utility  Processing) 

cloud_noop  (no  operation) 
ping_smvgear  (uses  SMVGEAR  sol~er) 
ping_qssa  (uses  QSSA  solver) 
ping_noop  (no  operation) 
pa 
gencoor 
util 

18.2.2  CGRID 

To facilitate the science processing for the different chemistries involved in CMAQ, the 
concentration field array CORID, is partitioned into four species classes: gas chemistry, aerosols, 
non-reactive, and tracer species.  This order is mandatory and maintained throughout the 
processing.  A subroutine, CORID _MAP provides the means to correctly index into the CORID 
array for each science process that deals with individual classes of species.  The tracer species 
group is user-determined and may be empty in CORID.  Aqueous chemistry is dealt with solely 
in the cloud processing, and currently aqueous species are not transported outside of the cloud 
processing, therefore do not appear explicitly in CORID.  A subroutine call to CORID_MAP 
provides pointers to the locations of the species classes within CORID.  A process that deals only 
with one of the classes (e.g. aerosols) can thus determine which part of CORID it needs to 
access. 

18 .. ~ .. 3 ....  CI~ss Driver 

Generally, each module within a class requires a "class-driver," which is the top level subroutine 
within the module - it is at the top of the call chain for that module.  Exceptions for this paradigm 
exist for the util, procan, phot, and aero_depv classes.  The class-driver presents a fixed name 
and calling interface to the driver class subroutine SCIPROC that calls all the science process 
modules.  The calling interface consists of a subroutine argument list containing CGR1D, the 
cuq,rnt s~~p~n .. ~11111111g~~ ~~ ... ~ .. !11~· an~ a t1~.~ ..  ~!ep vector ...  Each class also contains a "no-operation" 
module, if appropriate.  The no-op module has the fixed name and call interface for that class, 
but performs no calculations.  When called, it merely returns control to SCIPROC. 

"'"~"""""""""""'" 

"""""""" 

111' 

' 

,,1111111 

111111111:,, 

1111 

1,,,,1::,,, 

• 

" 

• 

• 

• 

The following algorithm illustrates the processing and call sequence used in a CMAQ model for 
fractional time steps processed non-symmetrically with respect to the chemistry processes: 

Load  CGRID  from  initial  data;  set  initial  Date/Time 
Get  the  TimeStep  vector:  TimeStep[l] 
TimeStep[2] 
TimeStep[3] 

output  time  interval 
synchronization  time  interval 

c  horizontal  advection  time  interval 

Foreach  output_time_step 

Call  Couple  (  CGRID,  Date,  Time,  TimeStep  )* 

Foreach  sync_step 

[in  output  time  interval] 

Call  Horizontal_Advection  (  CGRID,  Date,  Time,  TimeStep 
(  CGRID,  Date,  Time,  TimeStep 
Call  Vertical  Advection 
(  CGRID,  Date,  Time,  TimeStep 
Call  Mass_ Adjustment 
Call  Horizontal - diffusion  (  CGRID,  Date,  Time,  T.imeStep 
Call  De-Couple 
Call  Vertical  diffusion 
Call  Plume  in  Grid 
Call  Gas_Chemistry 
Call  Aerosol 
Call  Cloud 

(  CGRID,  Date,  Time,  TimeStep  ) * 
(  CGRID,  Date,  Time,  TimeStep  ) 
CGRID,  Date,  Time,  TimeStep  ) 
( 
(  CGRID,  Date,  Time,  TimeStep  ) 
(  CGRID,  Date,  Time,  TimeStep  ) 
(  CGRID,  Date,  Time,  TimeStep  ) 

-

11111111111•• 

• ••• 1111111111  Advance  Date/Time  by  synchronization  time  interval 

(  CGRID,  Date,  Time,  TimeStep  ) * 

111111111::·  •••.• 

····:111111; 

"'Ill 

,,,1,, 

End  Foreach  sync_step 

Call  Couple 

.... , 

:111: 

II' 

,1 

•• 

······:111111111· 

1111111!!

11

1:: 

Call  De-Couple  (  CGRID,  Date,  Time,  TimeStep  ) * 
Write  Concentration  File 

End  Foreach  output_time_step 

•  Couple  CGRID  concentrations  with,  or  de-couple  CGRID  from  the  air  density  x  the 
Jacobian  of  the  computational  grid.  See  Chapter  6  for  a  complete  discussion  on  the 
concept. 

'I 

1111, 

"''1111 

I, 

"':11111111111 

No.~ shown in tl!e algorithm are processes that deal with source emissions (in either 
Vexticnl_diffusion or Gas_chemistry), dry deposition (in Vertical_ diffusion), and wet deposition 
(in Cloud).  Also not shown are calls to process analysis routines after each science process, 
which compute the integrated process rates for that particular process.  Such calls are also 
embedded in science process modules that affect CGR1D, such as emissions injection in either 
the vertical diffusion process or gas chemistry.  The Science Process Code Template in Section 
18.8.3 below illustrates how these calls can be integrated within a module. 

In order to  maintain the Models-3/CMAQ modularity and data-independence, the science 
process class-drivers must adhere to coding standards with regard to  the calling interface, file 
data 1/0, and standardized, uniform domain and mechanism data within global include files.  See 
Section 18.5, below, and Chapter  I 5 for a more complete discussion on the use of global include 
files.  These coding standards have not been propagated to the level below the class-driver.  At 
the sub-module level there are no strict 1/0 or coding standards, however we offer suggestions to 
facilitate the potential incorporation of a module into the Models-3 system in Section 18.8 below. 

18.2.4  Synchronization Time Step 

There are many different time scales that are important in modeling.  The CCTM deals with four 
levels of time stepping: 

1. 

2. 

3. 

4. 

Output time step - the time interval for which output data is written to disk. 

Synchronization time step - the time interval for which the science processes, 
represented by science modules, are considered to  run independently of the other 
processes.  This is the time interval during which no interaction with the other time-split 
science processes needs to take place. 

Advection time step - the time interval over which horizontal advection occurs.  It may 
be less than or the same as the synchronization time interval. 

Local or internal time looping - a possibly variable time interval that subdivides the 
synchronization time step and is dependent on the user's implementation of a particular 
algorithm. 

There may also be some science processes that don't fit  into this type of time scale hierarchy. 
The sub-grid cloud time step in CCTM for example, has a fixed  lifetime that may span the 
synchronization time interval. 

In the CCTM the synchronization time step is essentially the time interval over which the 
chemistry processes are considered to  be time-split and independent of the other processes. 

The proper relationship between the first three time steps listed above is determined by the 
"ADVSTEP" algorithm.  Based on a user-supplied output time step interval, and optionally an 
upper and lower limit for the synchronization time step interval, 1 the algorithm: 

• 

• 

• 

Ensures the synchronization time interval evenly divides the output time interval. 

Ensures the synchronization interval to not be greater than the upper limit. 

Determines a horizontal advection time interval that ensures all  horizontal advection 
calculations satisfy a Courant condition with respect to  the horizontal winds for each 
output time step.  See Chapter 7 for details about the Courant condition requirement. 

11fthese limits are not specified, the algorithm uses defaults of 900 and 300 seconds, 
respectively. 

Attempts to establish a horizontal advection time interval as close to the synchronization 
! iriteivaf as possible, but evenly divides the synchronization interval. 

1111 

1

''"'!

ii

• 

In case the Courant condition restriction forces an advection time interval to  be less than 
the lower synchronization interval limit, sets advection time intervals to be as dose to the 
lower limit as possible but still evenly divide2 the lower limit. 

If none of these criteria can be satisfied, reports the issue and aborts the execution. 

18.3 

Input/Output Applications Programming Interface 

··  · :" 

"''''"" 

A model needs access to external data.  Data access, including output to external files,  is done at 
the modulelevel.  The Models-3  IIO API [4] provides a standardized interface to external data 
that enables a user to follow the object oriented design concept of encapsulation.  For example, 
all basic and some derived meteorological data are calculated outside the CCTM (see MCIP 
documentation in Chapter 12, e.g.) and available to a module through calls to the Models-3 1/0 
A~,,! l~,J~rnry [~J:Thus the user can avoid the re-calculation of various meteorological variables 
,wi1.~I~. ~l!~r.!?l!'.~ .. !,!!:e~ ..  ~s!~& different algorithms and parameterizations to re-compute essentially the 
same quantities, which may give rise to errors and modeling inconsistencies.  It is expected that 
the modules treat these I/O API data completely independently, not knowing or caring if files 
haye beeq opened or read by any other module.  In particular, any subroutine within a module 
can open an I/O API file.  It is recommended that at least one routine within a module, preferably 
the class-driver, should open any I/O API files that are required in the module. 

In general, the 1/0 API provides the Models-3  user with a library containing both Fortran and C 
routines, which manage all the necessary file manipulations for data storage and access.  The 
main requirement is that the user follows the I/O API conventions for data structures, naming 
conventions, and representations of scenario date and time.  The 1/0 API routines manage access 
to the files in such a manner that data can be read or written flexibly, virtually in any order, and 
freeing the user from being concerned with low level file manipulation details, such as the order 
or format of file variables. 

In addition, the I/O API routines can be used for both file storage and cross-media model 
coupling using Parallel Virtual Machine (PVM) mailboxes. 

For file storage and access, the 1/0 API, which is the standard data access library for Models-3, 
is built on top ofNCAR's netCDF files [5].  NetCDF (network Common Data Form) is a library 
that provides an interface for array-oriented data access.  The netCDF library also defines a 
mt;lchine-independent format for representing scientific data.  Together, the interface, library, and 
form~t support the creation, access, and sharing of scientific data.  The netCDF software was 
developed at the Unidata Program Center in Boulder, Colorado.  The freely available source can 
be obtained by anonymous FTP [5]. 

The I/O API provides a variety of data structure types for organizing the data, and a set of access 
routines that offer selective direct access to the data in terms meaningful to the user. 

Jll  ,!!!: 

.illlllllllllll: 

2S!!ictly speaking, this means divides without remainder, not by a factor of two. 

Since they are netCDF files, 1/0 API files share the following characteristics: 

1. 

2. 

3. 

4. 

5. 

They are machine-independent and network-transparent.  Files created on a Cray 
Supercomputer can be read on a desktop workstation (or vice versa) either via NFS 
mounting or FTP, with no data format translation necessary; 

They are self-describing.  That is, they contain headers that provide a complete set of 
information necessary to use and interpret the data they contain; 

They are direct access.  A small subset of a large dataset may be accessed efficiently 
without first reading through all the preceding data.  This feature is mandatory in 
visualization requiring rapid access of large datasets; 

They are appendable.  Data can be appended to a netCDF dataset along one dimension 
without copying the dataset or redefining its structure.  For example, the I/O API can add 
more time step data to a previously created file; and 

They are sharable.  One writer and multiple readers may simultaneously access the same 
netCDF file.  This means, for example, that visualization tools can access the file and 
display data while the file is being created by the model. 

The 1/0 API has been designed to support a variety of data types used in the environmental 
sciences, among them: 

• 

• 

• 

• 

Gridded data (e.g., concentration or meteorological fields); 

Grid-boundary data (for model boundary conditions); 

Scattered data (e.g., meteorology observations or source level emissions); and 

Sparse matrix data (a specialized data type used in an emissions model). 

1/0 API files support three different time step structures: 

1. 

2. 

3. 

Time-stepped with regular time steps (e.g.  hourly model output concentration fields or 
twice-daily upper air meteorology observation profiles); 

Time-independent (e.g.  terrain height); and 

Restart, which always maintains the last two time step records of output from a running 
process as "even" and "odd." The "odd" is available for restart in case of a crash while 
the "even" step is being written, and vice versa. Restart data does not consume an 
inordinate amount of disk space with only two time steps worth of data at all times. 

The 1/0 API provides automated built-in mechanisms to support production and application 
requirements for dataset histories and audit trails: 

• 

Identifiers of the program execution that produced the file. 

Description of the study scenario in which the file was generated. 

The UO API also contains an extensive set of utility routines for manipulating dates and times, 
performing coordinate conversions, storing and recalling grid definitions, sparse matrix 
arithmetic, etc.  There are a variety of related programs that perform various analysis or data(cid:173)
manipulation tasks, including statistical analysis, file comparison, and data extraction.  Section 
18.8.3 below illustrates the use of some of these utilities in coding practice, and the web site [5] 
provides background materials, a user manual, and a tutorial. 

18.4  Code Configuration Management 

1111" 

,1111111111'·'1" 

1111111111111111, 

''1111111, 

•111111, 

'Ill'  ,111111'" 

llllllllli, 

'I"" 

,lllllllllllllllr"' 

"'1111111111111111111111111 

1  ::1111111 

18.4.1  The Need 

1 

Ill 

'I 

"I 

II 

~~~151~,,,~~!!,!,,,~ lfi!l~e ~d growing community that uses and develops a wide variety of programs, 

"""""  nfo  ules and codes, it is imperative to systematically manage the cross-community access to this 

software.  Typically, successful management of software involves: 

,, 

"Ill 

11111 ! ~ 

• 

• 

• 

A repository - a place where all of the public code resides; 

11111111111 

The concept of archived code - codes that have been deposited into the repository in such 
'a manne'r''that anyone can extract the exact code at a later time.  This involves some kind 
of transformation program to maintain master copies of the codes with embedded change 
tables; 

The concept of revision control - archiving codes results in modifying the tags or unique 
revision identifiers in the change tables in the master copies in order to  recover the exact 
code at a later date; and 

11111

1111111111111 

1
:::111 

1i1" 

11

• •  

' " " ' '   The concept of released code - codes that have reached some state of maturity and have 
I' b~,,~11~ d~1~!~gnated ~i~ ~ome kind of "released" status.  They can be used with reasonable 

::1111 

11

, 

111

:
::::

illl" .. t,  , expectation,,,,cf reha~1ht:y.,, 

1

, 

.,. 

.. 

The paradigm used employs the following scenario. 

1. 

2. 

3.~ 

A user modifies or develops code.  The code may be one subroutine or many, possibly 
comprising whole science models.  The code may originate from "scratch," or be 
extri;1:ct~g fr9gi !]J.e repository and modified. 

After testing or reaching a point of being satisfied with his/her results, he/she decides to 
save it in the repository so that others can have access to  it. 

Some ru;chiyed codes may still be in an experimental, or development, state while others 
may be reasonably stable and more completely tested.  The latter may be designated as 
"released." There is no enforceable means to control access based on an experimental or 
released state.  The community will have and should have access indiscriminately, well 
aware that using development state code is risky. 

As the user continues to work with the codes, he/she may make enhancements or 
discover and fix errors.  The upgrades are then installed in the repository, which 
automatically assigns unique revision identifiers. 

The repository is  located where it is conveniently accessible to all pertinent users, and it 
is maintained by an administrator who sets and enforces general access rules. 

18.4.2  The Tool 

There are many configuration management tools both free and commercially available.  We 
chose The Concurrent Versions System (CVS) [1]  mainly because of its versatility.  CVS 
controls the concurrent editing of sources by several users working on releases built from a 
hierarchical set of directories.  CVS uses the Revision Control System (RCS) [2]  as the base 
system.  Other reasons that CVS was an attractive choice include: 

• 

• 

• 

• 

It works on virtually all UNIX platforms and many PCs; 

It is publicly available and free; 

CVS is a state-of-the-art system, constantly being improved; and 

MM5 codes are managed by CVS, and MM5  is a primary meteorology model for the 
CMAQ system. 

From the UNIX man pages (online manual): 

CVS is a front end to the Revision Control System (RCS) that extends the notion 
of revision control from a collection of files  in a single directory to a hierarchical 
collection of directories consisting of revision controlled files.  These directories 
and files can be combined together to  form a software release.  CVS provides the 
functions necessary to manage these software releases and to control the 
concurrent editing of source files among multiple software developers [emphasis 
added]. 

The Revision Control System (RCS) manages multiple revisions of files.  RCS 
automates the storing, retrieval, logging, identification, and merging of revisions. 

Another widely used source code management system is the Source Code Control System 
(SCCS), which is usually distributed with UNIX systems.  The main note is that RCS and SCCS 
act on files only, while CVS operates on projects.  Working with entire projects works better and 
easier with CVS.  Multi-developer project development works better with CVS as well.  CVS 
supports a client/server mode of operation that can be very useful.  CVS also allows 
customization by adding hooks so that local scripts or programs can be called when executing 
various CVS commands.  This can be useful to force naming conventions of tags, or reference to 
bug-tracking software, etc.  Thus CVS adds power and features that are attractive for the 
ModelsS-3/CMAQ system. 

18.4.3  The Repository 

The repository structure, that is, the UNIX directory hierarchy, follows the class/module 

111111  grganization discussed above in Section 18.2.  The repository is actually divided into many 

repositories, one for each generic model.  This division makes it easier to  maintain the 
class/module organization that is important for the model building operation described below in 
Section 18.5. 

CVS allows for the use of a "modules" file3
,  which enables a user to easily check out or extract a 
complete CMAQ module.  For example, a module might be checked out by a user to  make code 
modifications, and complete modules are checked out during the model building operation. 

''11111, 

'11111111111'' 

,11 

'1111111111111 

''11111111 1..i: 

,;, 

''1111111' 

1111111111111111111111111!""' 

.""111111111111111111111 

'lllilllllllh 

,,llllllllllll"!I 

'1:..111111111 

11111111' 

'111111111, 

1111 

II' 

ill" 

.111:'':111111• 

1111111111111111111111111 

'1111::':111111111:· 

" 

II 

"llllllllllr"'lllll"' 

11° 

, 

·:,,,11 

''1 

11111111111111' 

The following shows a symbolic CVS UNIX directory tree that represents the current structure 
for the CCTM: 

111111111 

'111111111111' 

111 

,,,,,::1111111111111 

,1111111 

:1• 

I 

1111 

'I 

1
':11111111 

111

111111::,,,,,'''. 

ii111lllllllllllll 

'111111111,,' 

:1111111111, 

"111111111 

,lllll',:11111
• 
1
1111111 "' ~ : : 

,, 

I I ' 

, I ' 

"'',111111111111111111111" 

111'''111111111111 

,,"'''::1111111111111111111: 

"" 

,1111111111 

'!Iii, 

II 

,111111[ 

,, 

"' 

111111111111'''11' 

llll"',,,;,,111111: 

,;11: 

'" 

11111111""11, 

3The terminology is unfortunate.  The CVS modules file  has no  intrinsic relationship with the 
CMAQ classes/module design implementation. 

18-12 

... CCTM  -+->  CVSROOT  ---+->  CVS  administrative  files 

I 
\->  src  -------+->  driver  --+-------> ctm  ------+->  RCS  files 

I 

EPA/600/R-99/03 0 

I 
+-> 
I 
I 
I 
+-> 

hadv 

---+---> hadv _noop  ---+-> 
+--->  hbot  --------+-> 
+--->  hppm  --------+-> 

RCS  files 
RCS  files 
RCS  files 

vadv 

---+---> vadv _noop  ---+-> 
+--->  vbot  --------+-> 
+--->  vppm  --------+-> 

RCS  files 
RCS  files 
RCS  files 

+-> 

vdiff 

--+---> vdiff  no op  --+-> 
+--->eddy  --------+-> 

-

RCS  files 
RCS  files 

+-> 

chem 

---+---> chem_noop  ---+-> 
+--->  smvgear  -----+-> 
+--->  qssa  --------+-> 

RCS  files 
RCS  files 
RCS  files 

+-> 

phot 

---+---> phot  no op  ---+-> 
+--->  phot  --------+-> 

-

RCS  files 
RCS  files 

+-> 

aero 

---+--->  aero _noop  ---+-> 
+--->aero  --------+-> 

RCS  files 
RCS  files 

+->  couple  -+--->  gencoor  -----+->  RCS  files 

+->  cloud  --+---> cloud  noop  --+->  RCS  files 
+--->  cloud-radm  --+->RCS  files 

+->  procan  -+--->  pa  ----------+->  RCS  files 

+->  hdiff  --+--->  hdiff_noop  --+->  RCS  files 
+--->  unif  --------+->  RCS  files 

+->  init  ---+--->  init  --------+->  RCS  files 

+->  util  ---+--->  util  --------+->  RCS  files 

+->  aero_depv  -+->  RCS  files 

+->  aero_depv  +->  aero_depv_noop  +->  RCS  files 
I 
I 
+->  adjcon  -+--->  adjcon_noop  -+->  RCS  files 
I 
\--->  denrate  -----+->  RCS  files 
I 
\->  ping  ---+--->  ping_noop  ---+->  RCS  files 
+--->  ping_qssa  ---+->  RCS  files 
\--->  ping_smvgear  +->  RCS  files 

The symbolic tree is shown relative to the subdirectory in the repository named for the CCTM 
model.  Similar trees exist for each of the generic models.  The RCS  files are the revision control 
history files that contain the change tables to reconstruct the actual source code according to a 
specific revision identifier.  Also note that the tree closely follows the organization of classes and 
modules for the CCTM described in Table  18-1, and contains alternate modules within the 
classes.  In particular, most classes contain a "no-operation" (_noop) module that allows a user to 
essentially turn off that particular science process modeling.  This is useful, for example in 
debugging, where rapid turn-around is important, and a computationally demanding module that 
is not needed can be bypassed. 

18.5  How a Model is Constructed 

18.5.1  Object Oriented Concepts 

To make the Models-3/CMAQ system robust and flexible, object oriented concepts were 
incorporated into the design of the CMAQ system.  Incorporating these ideas into the design 
helps avoid introducing errors when code modifications are necessary.  Additionally, the system 
is capable of easy and efficient modification, allowing the user to quickly make models for 
different applications. 

The implementation language for CMAQ is Fortran 77, which imposes limits on how far one can 
go in terms of object oriented design.  In particular, since Fortran is a static language, objects 
cannot be instantiated dynamically; they must be declared explicitly in the source code to  be 
created at compile time.  However, to encourage a user community that will be contributing code 
for future enhancements, every attempt has been made to adhere to  the Fortran 77 standard.  In 
the future, the use of other implementation languages such as Fortran 90 will be considered. 

18.5.2  Global Name Table Data 

In order to implement modularity and data-independence, we have employed design ideas that 
draw heavily from the object-oriented concept of inheritance and code re-use.  The data 
structures in the codes that deal with the domain sizes, chemical mechanism, I/O API, logical file 
names, general constants, and CGRID pointers are determined by Fortran declarations in data 
and parameter statements that are created through the Models-3 system.  These data structures 
pertain to a particular application (domain, mechanism, etc.) and are meant to apply globally, not 
only to one particular CCTM through all its subroutines, but also to all the models that supply 
data to the CCTM for that application.  These data structures are contained in Fortran INCLUDE 
files, which are essentially header files,  included in the declaration sections near the top of the 
Fortran code source files.  The inclusion of these source files is made automatic by using a 
generic string that represents the include file and which is parsed and expanded to  the actual 
include file during a pre-processing stage in the compilation.  The Fortran global include files 
contain name tables that define: 

1. 

2. 

3. 

4. 

5. 

The computational grid domain; 

The chemical mechanism; 

The 110 A.PI  interface, including logical file names; 

The global modeling constants; and 

Other constants or parameters that apply across the model. 

q,,::,::1

;

111111

I  h 

,::,,  In q'~Cier to effect th~'impleme~t~tion of the i~clude files int~ the c~de) a special compiling 
system; ni3bld, has been developed (3], which reads a configuration file that, based on the 
application, completely determines the model executable to be built.  The ASCII configuration 
file can be generated either by the Models-3  system or by the user folloWing a few, simple 

, , ,  syntactical rules illustrated below.  For additional details, the reader is referred to Chapter 15. 

In addition to the global include files, the configuration file contains module commands that tell 
m3bld to extract the codes for that module from the model code repository for compilation. 

18.5.3  Build Template 

The following exhibit is an example of a configuration file that m3bld would use to  build a 
model executable: (The numerals at the left-hand margin are labels for the legend and are not 
part of the configuration file.  The"//" represents a non-parsed, comment line.) 

Example Configuration File 
(1)  model  TUTO_r4y; 

(2) 
(2) 
(2) 

cpp_flags 
f77_flags 
link_flags 

"  -Demis  vdif 
"  -e  -fast  -04  -xtarget=ultra2  -xcache=16/32/1:1024/64/1" 
"  -e  -fast  -04  -xtarget=ultra2"  ; 

"  ; 

(3) 

libraries 

"-L/home/models3/tools/IOAPI/release/m3io/lib/SunOS5  -lm3io. 
-L/home/models3/tools/netCDF/SunOS5  -lnetcdf"  ; 

(4)  global  verbose; 

(5) 
(5) 
(5) 
(5) 
(5) 
(5) 
(5) 
(5) 
(5) 
(6) 
(6) 
(6) 
(6) 
(6) 
(6) 
(6) 
(6) 
(6) 
(6) 
(6) 
(6) 
(6) 
(6) 
(6) 
(6) 
(6) 
(6) 
(6) 
(6) 
(6) 
(6) 

include 
include 
include 
include 
include 
include 
include 
include 
include 
include 
include 
include 
include 
include 
include 
include 
include 
include 
include 
include 
include 
include 
include 
include 
include 
include 
include 
include 
include 
include 
include 

-

-
-

SUBST  BLKPRM 
SUBST  CONST 
SUBST  FILES  ID 
SUBST  EMPR  VD 
SUBST  EMPR  CH 
SUBST  IOPARMS 
SUBST  IOFDESC 
SUBST  IODECL 
SUBST  XSTAT 
SUBST  COORD  ID 
-
SUBST  HGRD  ID 
SUBST  VGRD  ID 
SUBST  RXCMMN 
SUBST  RXDATA 
SUBST  GC  SPC 
SUBST  GC  EMIS 
SUBST  GC  ICBC 
SUBST  GC  DIFF 
SUBST  GC  DDEP 
SUBST  GC  DEPV 
SUBST  GC  ADV 
SUBST  GC  CONC 
SUBST  GC  G2AE 
SUBST_GC_G2AQ 
SUBST  GC  SCAV 
SUBST  GC  WDEP 
SUBST  AE  SPC 
SUBST  AE  EMIS 
SUBST  AE  ICBC 
SUBST  AE  DIFF 
SUBST  AE  DDEP 

/work/rep/include/release/BLKPRM_500.EXT; 
/work/rep/include/release/CONST3_RADM.EXT; 
/work/rep/include/release/FILES_CTM.EXT; 
. 
/work/rep/include/release/EMISPRM.vdif.EXT; 
/work/rep/include/release/EMISPRM.chem.EXT; 
/work/rep/include/release/PARMS3.EXT; 
/work/rep/include/release/FDESC3.EXT; 
/work/rep/include/release/IODECL3.EXT; 
/work/rep/include/release/XSTAT3.EXT; 
/work/yoj/tgt/BLD/COORD.EXT; 
/work/yoj/tgt/BLD/HGRD.EXT; 
/work/yoj/tgt/BLD/VGRD.EXT; 
/work/yoj/tgt/BLD/RXCM.EXT; 
/work/yoj/tgt/BLD/RXDT.EXT; 
/work/yoj/tgt/BLD/GC_SPC.EXT; 
/work/yoj/tgt/BLD/GC_EMIS.EXT; 
/work/yoj/tgt/BLD/GC_ICBC.EXT; 
/work/yoj/tgt/BLD/GC_DIFF.EXT; 
/work/yoj/tgt/BLD/GC_DDEP.EXT; 
/work/yoj/tgt/BLD/GC_DEPV.EXT; 
/work/yoj/tgt/BLD/GC_ADV.EXT; 
/work/yoj/tgt/BLD/GC_CONC.EXT; 
/work/yoj/tgt/BLD/GC_G2AE.EXT; 
/work/yoj/tgt/BLD/GC_G2AQ.EXT; 
/work/yoj/tgt/BLD/GC_SCAV.EXT; 
/work/yoj/tgt/BLD/GC_WDEP.EXT; 
/work/yoj/tgt/BLD/AE_SPC.EXT; 
/work/yoj/tgt/BLD/AE_EMIS.EXT; 
/work/yoj/tgt/BLD/AE_ICBC.EXT; 
/work/yoj/tgt/BLD/AE_DIFF.EXT; 
/work/yoj/tgt/BLD/AE_DDEP.EXT; 

Simple Configuration File 
(6) 
(6) 
(6) 
(6) 
(6) 
(6) 
(6) 
(6) 
(6) 
(6) 
(6) 
(6) 
( 6) 
(6) 
(6) 
(6) 
(6) 
<6) 
<6) 
(6) 
(6) 
(6) 
(6) 
(6) 
(6) 
(6) 
(6) 

SUBST  AE  DEPV 
SUBST_AE_ADV 
SUBST_AE_CONC 
SUBST_AE_A2AQ 
SUBST  AE  SCAV 
SUBST  AE  WDEP 
SUBST_NR_SPC 
SUBST_NR_EMIS 
SUBST  NR  ICBC 
SUBST  NR  DIFF 
SUBST  NR  DDEP 
SUBST  NR  DEPV 
SUBST  NR  ADV 
SUBST  NR  N2AE 
SUBST_NR_N2AQ 
SUBST  NR  SCAV 
SUBST_NR_WDEP 
SUBST  TR  SPC 
SUBST  TR  EMIS 
SUBST  TR  ICBC 
SUBST_TR_DIFF 
SUBST  TR  DDEP 
SUBST_TR_DEPV 
SUBST  TR  ADV 
SUBST_TR_T2AQ 
SUBST_TR_SCAV 
SUBST  TR  WDEP 

lworklyojltgtlBLD/AE_DEPV.EXT; 
lworklyojltgtlBLD/AE_ADV.EXT; 
lworklyojltgtlBLDIAE_CONC.EXT; 
lworklyojltgt/BLD/AE_A2AQ.EXT; 
lworklyojltgtlBLD/AE_SCAV.EXT; 
/worklyojltgtlBLD/AE_WDEP.EXT; 
lworklyojltgtlBLD/NR_SPC.EXT; 
lworklyojltgtlBLDINR_EMIS.EXT; 
lworklyojltgtlBLDINR_ICBC.EXT; 
lworklyojltgt/BLDINR_DIFF.EXT; 
lworklyojltgt/BLDINR_DDEP.EXT; 
lworklyojltgtlBLDINR_DEPV.EXT; 
lworklyojltgt/BLD/NR_ADV.EXT; 
lworklyojltgt1BLD/NR_N2AE.EXT; 
lworklyojltgtlBLD/NR_N2AQ.EXT; 
lworklyoj/tgtlBLD/NR_SCAV.EXT; 
lworklyojltgt/BLDINR_WDEP.EXT; 
lworklyojltgtlBLD/TR_SPC.EXT; 
lworklyojltgtlBLD/TR_EMIS.EXT; 
lworklyojltgtlBLDITR_ICBC.EXT; 
lworklyojltgtlBLD/TR_DIFF.EXT; 
lworklyoj/tgt/BLDITR_DDEP.EXT; 
lworklyojltgtlBLDITR_DEPV.EXT; 
lworklyojltgtlBLD/TR_ADV.EXT; 
lwork/yojltgtlBLD/TR_T2AQ.EXT; 
lworklyojltgtlBLD/TR_SCAV.EXT; 
lworklyojltgtlBLDITR_WDEP.EXT; 

include 
include 
include 
include 
include 
include 
include 
include 
include 
include 
include 
include 
include 
include 
include 
include 
include 
include 
include 
include 
include 
include 
include 
include 
include 
include 
include 
II  Process  Analysis  I  Integrated  Reaction  Rates  processing 
include 
include 
include 

lworklyojltgtlBLD/PA_CTL.EXT; 
lworklyojltgtlBLDIPA_CMN.EXT; 
lworklyojltgtlBLDIPA_DAT.EXT; 

(6) 
(6) 
(6) 

,,1, 

-

SUBST  PACTL  ID 
SUBST_PACMN_ID 
SUBST  PADAT  ID 

-

-

-

(7)  module  ctm  release  ; 

(7)  module  init  release  ; 

II  options  are  denrate  and  adjcon_noop 

(7)  w.odule  denrate  release 

(7)  module  gencoor  release 

II  options  are  hbot  and  hadv_noop 
module  hppm  release  ; 

Iii'' 

(7) 

II options  are  vbot  and  vadv_noop 

(7) 

module  vppm  release  ; 

II  options  are  phot  and  phot_noop 

(7) 

module  phot  release  ; 

:, 

I'' 

II  options  are  ping_qssa,  ping_smvgear  and  ping_noop 

1111111111111 

18-16 

Example Corifiguration File 

(7)  module  ping_qssa  release 

II  options  are  qssa,  smvgear  and  chem_noop 

(7)  module  qssa  release 

EPA/600/R-99/030 

II  aerosols 

(7)  module  aero  release  ; 

II  aerosol  dep  vel 

(7)  module  aero  depv  release 

II  options  are  eddy  and  vdiff_noop 

(7)  module  eddy  release 

II  options  are  canst  and  hdiff_noop 

(7)  module  unif  release 

II  options  are  cloud_radm  and  cloud_noop 

(7)  module  cloud_radm  release  ; 

II  options  are  pa  and  pa_noop,  which  requires  the  replacment  of  the  three 
II  global  include  files  with  their  pa_noop  counterparts 

(7)  module  pa  release  i 

(7)  module  util  release 

-

IIO  AP!  and  netCDF  object  libraries  to  be  linked.  The  format  is 

- The  C  pre-processor,  Fortran  compiler  and  link  flags.  The  flags 

- Model  name  definition.  This  string  is  what  the  model  executable  will 

Legend: 
(1) 
be  named. 
(2) 
specified  indicate  that  the  model  is  to  be  compiled  with  the  option  to  input 
emissions  in  the  vertical  diffusion  processing,  and  to  compile  and  link  on  a 
Sun  Spare,  Ultra-30  workstation. 
(3) 
virtually  identical  to  that  of  a  UNIX  make  command. 
(4) 
Other  options  are: 
compile_all  -
clean_up 
no_compile 
no  link 

force  compile,  even  if  object  files  are  current 
remove  all  source  files  upon  successful  completion 
do  everything  except  compile 
do  everything  except  link 
compile  and  link  in  one  step 
checks  config  file  syntax 
show  requested  commands  but  doesn't  execute  them 

- m3bld  flag:  one  of  many  options.  verbose  indicates  report  all  actions. 

• 
• 
• 
• 
•  one_step 
•  parse_only 
show_only 
• 
(5), 
(6) 
include 

- global  include  files.  The  syntax  is: 
internal-string 

full-path-name. 

Every  routine  that  requires  a  specific  include  file  must  contain  a  Fortran 
include  statement  using  the  internal-string  (see  Section  18.3  for  examples) 

(5) 

- "fixed"  global  include  files.  The  fixed  include  files  have  been 
constructed  outside  of  the  Models-3  framework  and  contain  global  data  not 
directly  related  to  the  domain  or  chemical  mechanism  such  as  modeling 

- The  Models-3  framework  automatically  generates  all  the  include  files 

Example Configuration File 
cC:~stants  and  file  logical  names. 
(6) 
labeled  (6)  .  The  user  supplies 
Manager  that  determines  the  data  in  these  include  files.  These  data  define 
the  complete  problem  domain  for  a  particular  CMAQ  application.  See  Chapter 
15  for  a  complete  discussion. 
(7) 
optional  revision  flag  to  select  a  particular  module  version.  The  syntax  is: 
module  module  name 

information  through  the  Models-3  Science 

- The  module  name  to  extract  from  the  model  code  repository  and  an 

revision  flag. 

For additional information on this implementation, the reader is referred to the Model Building 
Tool described in Fine et al.  [3]. 

18.6  How a Model is Executed 

In order to run a model executable, various UNIX environment variables must be set in the shell 
that invokes the execute command.  Generally, these involve the modeling scenario start date and 
time, the run duration, the output time step interval, various internal code flags that differ among 
the models, and all the input and output logical, or symbolic file names (see Section 15.4.3  in 
Chapter 15).  There are various ways by which external file  names can be referenced in the code, 
but the most general across all  UNIX platforms is to link them by means of environment 
variables.  There are I/O API utility functions that allow a user easy access to  these variables 
within the code, making such accesses generic and portable. 

A:11nt!!li~i9I'),a~[~flt~!~e ~J:!at i .. ~ provided through the J/O  API is to declare a file "volatile" by 
appending a -v flag in the shell's declaration for the environment variable.  By doing this, the 1/0 
A.Pl will  cause the netCDF file to  update (sync) its disk copy after every write and thereby 
upcfat~ il1e riciCbFhcader:·  Otlierwise, netCDF file headers are not updated until  the files are 
closed.  This is useful, for example, to allow a user to  analyze an open netCDF file  using 
visualization tools while the model is executing.  It is also useful  in case of a system crash.  A 
CCTi\.1  model can be restarted at the scenario time step after the last successful write using the 
aborted output file as the input initial data. 

18.7  Using the Models-3 Framework 

The Modcls-3  framework simplifies the model building and model execution tasks, especially if 
key objects have been pre-defined.  Thus if a user is conducting a study that uses the same 
domain or chemical mechanism, but uses different code options, e.g., then rebuilding and re(cid:173)
executing using the framework makes conducting the study very straightforward.  Other 
examples where the fran1ework greatly simplifies operational tasks would be where a model is to 
be applied on different domains, or for control strategies in which the only thing that changes are 
thi: ..  ~1!1issic:ms input files.  A knowledgeable user is still able to  build and execute model 
?PPlications outside the framework.  In fact, one can easily run  model applications using 
executables and UNIX scripts generated by the framework. 

In general, in order to build a model within the framework, the coordinate system, horizontal grid 
and vertical layer definitions, and chemical mechanism must be specified.  This is done within 
the Models-3  Science Manager component.  If objects required for a particular application, such 
as a coordinate system specification, are already defined, then the user needs only to select those 
objects.  The Configuration File Manager, an additional subcomponent within the Science 
Manager, allows a user to  control the module definitions and fixed  4  include files that go into the 
configuration file used to  build the model.  Also the user can specify compiling and linking flags 
related to a specific platform on which the model is to  be executed. 

With all  required Models-3  objects defined, the task of building a model  is made simple using 
the Models-3 component, Model Builder.  It's important to note that as users develop models, the 
set of objects will grow to become a rich pool from  which to select for a particular application. 
The Models-3 framework was designed to  allow extensive re-use of objects.  Model Builder 
generates all the "non-fixed" include files,  then builds a model, linking in the include files 
including the user-specified fixed ones.  See the section  above for the include file  definitions. 
Perhaps one of the most useful features of the Models-3  framework  is the ability to graphically 
set up and execute single or multiple model executions with automatic data registration.  This 
allows a user to carefully control the order of model executions and the management of all the 
input and output data.  The Models-3  component that performs this function  is the Study Planner. 
Study Planner allows a user to specify input data sets, executables, and UNIX environment 
variables, and to initiate (possibly multiple) model runs. 

18.8  Conformant Code 

18.8.1  Thin Interface 

As mentioned above in section  18.5.1  , the Models-3/CMAQ system was designed to  be robust 
and flexible with respect to the interchange of modules and the elimination of cross-module data 
dependencies.  Consequently, the concept of a "thin interface" has been employed in the design, 
which applies principally to the class-drivers.  At the least, the thin interface implementation 
implies the following requirements: 

• 

• 

• 

Eliminate global memory references (across modules).  This implies no common blocks 
across modules, no hidden data paths, no "back doors"; 

Each module reads and interpolates its required data independently. The I/O API helps to 
ensure this kind of data independence; and 

Standardized argument list (CGRJD, Date, Time, TimeStep) for the class-driver, as 
described in the section above. 

These requirements attempt to  incorporate the object-oriented idea of encapsulation in the 
Models-3/CMAQ design.  The following quotation is  from  Rumbaugh et al.  [7]: 

Encapsulation (also information hiding) consists of separating the external aspects 
of an object, which are accessible to  other objects, from  the internal 

4not generated by the framework 

implementation details of the object, which are hidden from other objects. 
Encapsulation prevents a program from becoming so interdependent that a small 
change has massive ripple effects.  The implementation of an object can be 
changed without affecting the applications that use it  [emphasis added]. 

The encapsulation design makes the CMAQ system safer and enables the transaction processing, 
plug&play capability.  This design also makes it easier for a user to  trace data and usage within a 
module, particularly at the class-driver level. 

18.8.2  Coding Rules 

In order to maintain the object oriented concepts implemented in the CMAQ system design, we 
have established a small set of coding rules that apply for those that develop CMAQ science and 
affect the low-level design of the models.  We have developed standards to control data 
...  dependencies at the class-driver level, but we have not propagated these coding standards to the 
sub-module level. 

1. 

2. 

3. 

4. 

S. 

6. 

7. 

The models are generally coded in Fortran (Fortran-77 conventions are used).  It is 
possible to link in subroutines written in the C language, although this has not been done 
within the current CMAQ implementation. 

The modules must be controlled ~y a top-level class-driver routine, whose calling 
arguments must be the computational concentration grid array, CORID, the current 
scenario data and time, and the controlling time step vector.  See the section above. 

The class-driver is also responsible for any temporal integration required within the 
module.  (The time steps for process integration at the module level are usually shorter 
than those of the CCTM synchronization time step.) 

Any reads and writes for the module should be done at the level of the class-driver 
routine.  Although not absolutely necessary, this is strongly suggested because it is 
usually much easier to  control the timing of the data accesses at the highest level of the 
module where the current scenario date and time are known. 

Use the IMPLICIT NONE Fortran declaration to maintain some control on typographic 
errors and undefined variables.  Although not standard Fortran-77, the use ofIMPLICIT 
NONE forces the developer to declare all  internal variables. 

Use the global include files for domain definitions, chemical mechanism data, and other 
data where available. 

Use the 110 API for external data references where appropriate.  For an illustration of 
these rules, the reader is referred to  the code template below. 

At the sub-module level there are no strict 1/0 or coding standards.  Here it is envisioned that 
individual researchers/programmers use their own coding styles for their algorithms.  However 
U1e  following suggestions are offered to facilitate the potential incorporation of a module into the 
CMAQ system: 

It is expected that MKS units are used for input and output variables, as these units have 
been standardized throughout the CMAQ system. Within a sub-module subroutine 
whatever units are most convenient can be used.  However, the developer must be 
responsible for any unit conversions to MKS for input and output, and thus avoid any 
potential errors. 

For efficiency and performance considerations, operations may need to be done on 
groups of grid cells (a block of cells) at a time.  If there are N cells in the block and the 
entire domain contains M cells, then the entire domain can be decomposed into MIN 
blocks.  We have used N=500.  For operations in the horizontal (x,y), the cell constraint 
becomes Xx Y ~ N, where X=  number of cells in the x-direction, and  Y=  number of cells 
in they-direction. For operations in both the horizontal and vertical, the constraint 
becomes Xx Y x Z ~ N, where Z=  number of cells in the z-direction. There may be some 
operations, such as for some horizontal advection schemes, where this decomposition 
into blocks becomes more difficult or impossible. 

18.8.3  Science Process Code Template 

The following demonstrates what a science process class-driver Fortran 77 subroutine might look 
like.  We recommend that a code developer follows this template, where appropriate, to get 
maximum benefit from the design concepts implemented in the Models-3/CMAQ system.  This 
template is generic and attempts to show most, if not all  the features available.  Some class(cid:173)
drivers and most other sub-programs within a module may not have, nor require, most or any of 
these features.  (The numerals at the left-hand margin are for the legend and are not part of the 
text, and the text within"<>" indicates code not included.) 

CGRID,  JDATE,  JTIME,  TSTEP  ) 

Example of Science Process Class-driver 
SUBROUTINE  VDIFF  SUBST_GRID_ID 
1) 
2)  c------------------------------------
2)  C  Function: 
2) 
2)  c  Preconditions: 
2) 
2)  C  Subroutines  and  Functions  Called: 
2) 
2)  C  Revision  History: 
2)  c------------------------------------
3) 

IMPLICIT  NONE 

4) 
4) 

5) 
5) 
5) 
5) 
5) 

5) 
5) 
5) 
5) 

5) 
5) 
5) 

INCLUDE 
INCLUDE 

SUBST_HGRD_ID 
SUBST_VGRD_ID 

horizontal  dimensioning  parameters 
vertical  dimensioning  parameters 

INCLUDE 
INCLUDE 
INCLUDE 
INCLUDE 
INCLUDE 

SUBST_GC_SPC 
SUBST_GC_EMIS 
SUBST_GC_DEPV 
SUBST_GC_DDEP 
SUBST_GC_DIFF 

gas  chemistry  species  table 
gas  chem  emis  surrogate  names  and  map  table 

I  gas  chem  dep  vel  surrogate  names  and  map  table 
I  gas  chem  dry  dep  species  and  map  table 

gas  chem  diffusion  species  and  map  table 

INCLUDE 
INCLUDE 
INCLUDE 
INCLUDE 

SUBST  AE  SPC 
SUBST  AE  DEPV 
SUBST  AE  DDEP 
SUBST  AE  DIFF 

aerosol  species  table 
aerosol  dep  vel  surrogate  names  and  map  table 
aerosol  dry  dep  species  and  map  table 
aerosol  diffusion  species  and  map  table 

INCLUDE 
INCLUDE 
INCLUDE 

SUBST_NR_SPC 
SUBST_NR_EMIS 
SUBST_NR_DEPV 

non-reactive  species  table 
non-react  emis  surrogate  names  and  map  table 

I  non-react  dep  vel  surrogate  names  and  map  table 

18-21 

Example of Science Process Class-driver 
(  5) 
(  SI 

INCLUDE  SUBST_NR_DDEP 
INCLUDE  SUBST_NR_DIPF 

non-react  dry  dep  species  and  map  table 
non-react  diffusion  species  and  map  table 

"""""' 

''" 

111111111, 

' '

5) 
SI 
(  5) 
(  5) 
I  SI 

6) 
(  6) 
(  61 
(  6) 
(  61 
(  7) 
(  71 
(  71 
(  71 
(  ?l 
(  71 
(  7) 
(  4) 

(  8) 
(  •> 
(  81 
(  •I 
(  al 
(  8) 
(  81 
(  81 
iJ> 
( 

9) 
(  !I) 
(101 
(10) 
(10) 
(10) 

(11) 
(lll 
(1:21 
(1:2) 
(13) 
(13) 
(13) 
(13) 
(13) 
(13) 
(13) 
(13) 
(13) 
(lJ) 
(13) 
(13) 
(13) 
(13) 
(13) 
(13) 
(13) 
(13) 
(13) 
(13) 

INCLUDE  SUBST_TR_SPC 
INCLUDE  SUBST_TR_EMIS 
INCLUDE  SUBST_TR_DEPV 
INCLUDE  SUBST_TR_DDEP 
INCLUDE  SUBST_TR_DIFF 

tracer  species  table 
tracer  emis  surrogate  names  and  map  table 
tracer  dep  vel  surrogate  names  and  map  table 
tracer  dry  dep  species  and  map  table 
tracer  diffusion  species  and  map  table 

lli!def  emis_vdif 

INCLUDE  SUBST  EMPR  VD 

emissions  processing  in  vdif 

llel•e 

INCLUDE  SUBST_EMPR_CH 

emissions  processing  in  chem 

Hendif 

INCLUDE  SUBST_PACTL_ID 
IN!=LUDE  SUBST_CONST 
INCLUDE  SUBST_FILES_ID 
INCL.UDE  SUBST_IOPARMS 
INCLUDE  SUBST_IOFDESC 
INCLUDE  SUBST_IODECL 
INCLUDE  SUBST_XSTAT 
INCLUDE  SUBST_COORD_ID 

PA  control  parameters 
constants 
file  name  parameters 
I/O  parameters  definitions 
file  header  data  structure 
I/O  definitions  and  declarations 
M3EXIT  status  codes 
coordinate  and  domain  definitions  (req  IOPARMS) 

C  Arguments: 

REAL 
INTEGER 
INTEGER 
INTEGER 

C  Parameters: 

CGRID(  NCOLS,NROWS,NLAYS,*  ) 
JDATE 
JTIME 
TSTEP(  3  ) 

concentrations 
I  current  model  date,  coded  YYYYDDD 

current  model  time,  coded  HHMMSS 
time  step  vector  (HHMMSS) 
TSTEP(l) 
TSTEP(2) 
TSTEP(3) 

local  output  step 
sciproc  sync. 

z  advection  time  step 

step  (chem) 

< 

> 

C  External  Functions  not  previously  declared  in  IODECL3.EXT: 

INTEGER 
EXTERNAL 

SECSDIFF,  SEC2TIME,  TIME2SEC 
SECSDIFF,  SEC2TIME,  TIME2SEC 

C  File  variables: 

< 

> 

C  Local  variables: 

> 

< 
IF  (  FIRSTIME  )  THEN 

FIRSTIME  z 

.FALSE. 

LOGDE:V  •  INIT3 () 

C  Open  the  met  files: 

IF  ( 

.NOT.  OPEN3(  MET_CR0_3D,  FSREAD3,  PNAME) 

)  THEN 

XMSG  •  •could  not  open  '// MET_CR0_3D  //  •  file' 
CALL  M3EXIT(  PNAME,  JDATE,  JTIME,  XMSG,  XSTATl  ) 
END  IF 

<  open  other  met  files  > 

C  Open  Emissions  files: 

<  do  other  intialization  or  operations  that  need  be  done  only  once  > 

END  IF 

if  f irstime 

(14)  C  set  file  interpolation  to  middle  of  time  step 

1
':,,111111111,11111,,::111 

11111111111111 

111111111111111111111, 

11111111 

11111111111:' 


Example of Science Process Class-driver 
(14) 
(14) 
(14) 
(14) 
(14) 

JD ATE 
JTIME 
TIME2SEC(  TSTEP(  2  ) 

MDATE 
MTIME 
MSTEP 
CALL  NEXTIME 

(  MDATE,  MTIME,  SEC2TIME(  MSTEP  I  2  )  ) 

EP A/600/R-991030 

INTERP3(  MET_CR0_3D,  VNAME,  PNAME, 

MDATE,  MTIME,  NCOLS*NROWS*NLAYS, 
RRHOJ  )  )  THEN 

'Could  not  'interpolate  DENSA_J  from  •  II  MET_CR0_3D 

XMSG  = 
CALL  M3EXIT(  PNAME,  MDATE,  MTIME,  XMSG,  XSTATl  ) 
END  IF 

& 
& 

.NOT. 

'DENSA_J' 

VNAME  = 
IF  ( 

(15)  C  read&interpolate  met  data 
(15) 
(15) 
(15) 
(15) 
(15) 
(15) 
(15) 
(15) 
(15) 
(15) 
(15) 
(15) 
(15) 
(15) 
(15) 
(15)  C  read&interpolate  emissions 
(15) 
(15) 
(15) 
(15) 
(16) 

<  do  other  reads  > 

<  do  operations  > 

CALL  RDEMIS 

VDEMIS  ) 

& 

C  read&interpolate  deposition  velocities 

(  MDATE,  MTIME,  NCOLS,  NROWS,  EMISLYRS,  NEMIS,  EM_TRAC, 

IF  (LIPR)  CALL  PA_UPDATE_EMIS 

( 

'VDIF',  VDEMIS,  JDATE,  JTIME,  TSTEP  ) 

(17) 

(18) 
(18) 

(19) 

<  do  other  operations  > 

CALL  EDYINTB  SUBST_GRID  ID  (  EDDYV,  OT,  JDATE,  JTIME,  TSTEP(  2  )  ) 

DO  345  R  = 1,  NROWS 

DO  344  C  =  1,  NCOLS 

<  do  operations  > 

DO  301  N  = 1,  NSTEPS(  C,R  ) 

<  do  operations  > 

(19)  301 
(18)  344 
(18)  345 

CONTINUE 

CONTINUE 

CONTINUE 

end  time  steps  loop 
end  loop  on  col  C 
end  loop  on  row  R 

) 

)  THEN 

.GE.  TIME2SEC(  TSTEP(  1 

WSTEP  = WSTEP  +  TIME2SEC(  TSTEP(  2  )  ) 
IF  (  WSTEP 
) 

MDATE  = JDATE 
MTIME  = JTIME 
CALL  NEXTIME(  MDATE,  MTIME,  TSTEP(  2  )  ) 
WSTEP  = 0 

(20)  C  If  last  call  this  hour:  write  accumulated  depositions: 
(20) 
(20) 
(20) 
(20) 
(20) 
(20) 
(20) 
(20) 
(20) 
(20) 
(20) 
(20) 
(20) 
(20) 
(20) 
(20) 
(20) 
(20) 
(16) 

'Timestep  written  to',  CTM_DRY_DEP_l, 
'for  date  and  time',  MDATE,  MTIME 

XMSG  =  •could  not  write  •  II  CTM_DRY_DEP_l  II  •  file' 
CALL  M3EXIT(  PNAME,  MDATE,  MTIME,  XMSG,  XSTATl  ) 
END  IF 

IF  (LIPR)  CALL  PA  UPDATE  DDEP 

.NOT.  WRITE3(  CTM_DRY_DEP_l, 

WRITE(  LOGDEV, 

IF  ( 

& 
& 

( 

& 

ALLVAR3,  MDATE,  MTIME,  DDEP  )  )  THEN 

'(  /5X,  3(  A,:,  lX  ),  IS,":",  I6.6  )') 

'VDIF',  DDEP,  JDATE,  JTIME,  TSTEP  ) 

Example of Science Process Class-driver 
(20) 
(20) 
(20) 
c2o> 

<  do  other  operations  > 

END  IF 

( 21) 
(21) 

RETURN 
END 

l'..egend: 

is  used  for  developing  run-time  nesting  applications, 

- Domain  array  dimensioning  and  looping  global  variables,  e.g.  NCOLS,  NROWS,  NLAYS. 

IMPLICIT  NONE  will  catch  typo's  and  other  undeclared 

(  1)  - Class-driver  subroutine  internal  name.  Note  the  calling  argument  list.  It  is  fixed  for 
claaa-drivers.  The  string  ~  SUBST_GRID_IDN 
which  has  not  been  fully  implemented  in  the  current  version.  By  specifying  subroutine  names 
aaaociated  with  a  particular  nest  and  using  corresponding  domain  include  files  for  that 
aubroutine,  it  is  possible  to  set  up  a  multi-nest  application.  The  details  have  not  been 
diacuaaed  because  this  kind  of  nesting  has  not  been  implemented  in  the  current  release  of  the 
Hodela-3/o-tAQ  system. 
(  ·2)  - Header  com:nents.  Highly  recommended  for  internal  documentation. 
(  3)  - Highly  recommended  for  Fortran. 
variable  errors  at  compile  time. 
(  4) 
(  5)  - Chemical  mechanism  array  dimensioning  and  looping  global  variables. 
(  6)  - C  Preprocessor  flags  that  determine  which  emissions  control  dimensioning  and  looping 
variables  are  compiled. 
(  7) 
- Other  global  array  dimensioning  and  looping  global  variables  including  those  for  the  I/O 
API.  The  logical  variable  LIPR  is  defined  in  the  SUBST_PACTL_ID  include  file  for  use  at  lines 
labeled  (16)  . 
(  8)  - Declarations  for  the  argument  list  (standardized) . 
(  9) 
(10) 
(11) 
(12)  - Declarations  for  local  variables. 
(13)  - Code  section  for  subroutine  initialization  and  for  any  local  data  that  need  not  be  set  at 
every  entry  into  the  subroutine.  Such  data  would  require  a  SAVE  statement  in  the  declarations. 
For  example  FIRSTIME  is  initialized  to  .TRUE.  in  the  local  variables  section  (12). 
(14) 
(15) 
(16) 
function. 
(17) 
(18) 
(19) 
(20)  - Illustrates  writing  to  an  I/O  API  file  within  a  module. 
(21)  - Subroutine  end 

- Illustrates  using  an  I/O  API  function  to  set  file  interpolation  time. 
- Read  accesses  from  I/O  API  files  using  the  I/O  API  time-interpolation  function. 
- Call  to  process  analysis  routine  to  obtain  data  for  the  optional  integrated  process  rates 

- Declarations  and  PARAMETER  statements  for  local  Fortran  parameters. 
- Declarations  for  external  functions  not  previously  declared. 
- Declarations  for  arrays  to  hold  external  file  data. 

- Illustrates  call  to  another  science  process  within  the  module. 
- Main  computational  loop  over  the  horizontal  grid. 
- Time  step  loop  over  sub-synchronization  time  step  intervals. 

18.8.4  Robustness and Computational Efficiency 

Scientists, while working in their discipline, are generally not interested in the physical situations 
that don't significantly affect the phenomena they are studying and modeling.  Typically, the 
scientist works with box models, and uses specialized data to test hypotheses, parameterizations 
and numerical schemes.  The focus is to generate new results based on output from these 
relatively simple models.  In trying to integrate these codes into a more general grid model, 
,.  prbblems may arise when modeling simulations carry their formulations into regimes not 
explored in initial studies, therefore not properly accounted for in the grid model.  The scientist 
who is developing codes that may go into a grid model should be cognizant of these issues and 
should make every effort to make the codes robust. 

Another issue is code efficiency.  In order to handle the pathological situations, codes like these 
may become inefficient, spending many cycles dealing with the "off-problem" cases.  A good 
example is solving for the roots of a cubic polynomial whose coefficients, depending closely on 
the locally modeled physics, may range over broad values.  So, in addition to robustness, 
attention should be paid to code performance.  As the science improves in environmental 
modeling, this usually translates into increased computational complexity.  Although hardware 
performance is continually improving, it cannot keep pace with the computational demands of 
new science developments.  Not typically the main interest of the science developer, software 
performance is nevertheless a critical issue and must be addressed.  Otherwise scientifically 
sound models will not be of much general use if they take an inordinate amount of time to 
execute. 

18.9  Conclusion 

The CMAQ system has been designed and implemented in such a way that its integration into 
Models-3 allows access to the extensive functionality of the Models-3 framework.  Users can 
easily select important model options and can readily develop and execute models that apply to 
their requirements. 

We have integrated the CMAQ codes into the Models-3 system by following the basic set of 
guidelines and rules presented in this chapter. 

18.'10  References 

[ 1]  http://interactivate.com/public/cvswebsites/cvs _toc.html, http://www.cyclic.com/cvs/, and 
the UNIX man pages 

[2]  http://www.cs.cmu.edu/People/vaschelp/ Archiving/Res/, and the UNIX man pages 

[3]  Fine, S.  S., W.  T.  Smith, D.  Hwang, T.  L.  Turner,  1998: Improving model development 
with configuration management, IEEE Computational Science and Engineering, 5(1, Ja-Mr), 56-
65.  and http://envpro.ncsc.org/pub _files/fine l 998b.html 

[ 4]  http://sage.mcnc.org/products/ioapi/ 

[ 5)  ftp:! /ftp. uni data. ucar.edu/pub/netcdf/ 

[6]  EPA Third-Generation Air Quality Modeling System, Models-3 Volume 9b, User Manual, 
Appendices, June 1998, EPA-600/R-98/069(b) 

[7]  J.  Rumbaugh, M. Blaha, W.  Premerlani, F. Eddy, and W. Lorensen,  1991: Object-Oriented 
Modeling and Design, Prentice Hall 

[8]  Grell, G.  A., J.  Dudhia and D.R. Stauffer, 1994: A description of the fifth-generation Penn 
State/NCAR mesoscale model (MM5).  NCAR Technical Note,  NCAR/TN-398+STR, 122 pp. 
